var RO=Object.defineProperty;var OO=(n,e,t)=>e in n?RO(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Qs=(n,e,t)=>OO(n,typeof e!="symbol"?e+"":e,t);function TO(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function ti(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var jp={exports:{}},fl={},Lp={exports:{}},ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l0;function AO(){if(l0)return ze;l0=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;function g(T){return T===null||typeof T!="object"?null:(T=m&&T[m]||T["@@iterator"],typeof T=="function"?T:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,v={};function x(T,M,X){this.props=T,this.context=M,this.refs=v,this.updater=X||y}x.prototype.isReactComponent={},x.prototype.setState=function(T,M){if(typeof T!="object"&&typeof T!="function"&&T!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,T,M,"setState")},x.prototype.forceUpdate=function(T){this.updater.enqueueForceUpdate(this,T,"forceUpdate")};function E(){}E.prototype=x.prototype;function P(T,M,X){this.props=T,this.context=M,this.refs=v,this.updater=X||y}var S=P.prototype=new E;S.constructor=P,w(S,x.prototype),S.isPureReactComponent=!0;var R=Array.isArray,$=Object.prototype.hasOwnProperty,I={current:null},D={key:!0,ref:!0,__self:!0,__source:!0};function F(T,M,X){var ae,Q={},le=null,Re=null;if(M!=null)for(ae in M.ref!==void 0&&(Re=M.ref),M.key!==void 0&&(le=""+M.key),M)$.call(M,ae)&&!D.hasOwnProperty(ae)&&(Q[ae]=M[ae]);var Ee=arguments.length-2;if(Ee===1)Q.children=X;else if(1<Ee){for(var be=Array(Ee),je=0;je<Ee;je++)be[je]=arguments[je+2];Q.children=be}if(T&&T.defaultProps)for(ae in Ee=T.defaultProps,Ee)Q[ae]===void 0&&(Q[ae]=Ee[ae]);return{$$typeof:n,type:T,key:le,ref:Re,props:Q,_owner:I.current}}function K(T,M){return{$$typeof:n,type:T.type,key:M,ref:T.ref,props:T.props,_owner:T._owner}}function Y(T){return typeof T=="object"&&T!==null&&T.$$typeof===n}function ie(T){var M={"=":"=0",":":"=2"};return"$"+T.replace(/[=:]/g,function(X){return M[X]})}var de=/\/+/g;function ue(T,M){return typeof T=="object"&&T!==null&&T.key!=null?ie(""+T.key):M.toString(36)}function V(T,M,X,ae,Q){var le=typeof T;(le==="undefined"||le==="boolean")&&(T=null);var Re=!1;if(T===null)Re=!0;else switch(le){case"string":case"number":Re=!0;break;case"object":switch(T.$$typeof){case n:case e:Re=!0}}if(Re)return Re=T,Q=Q(Re),T=ae===""?"."+ue(Re,0):ae,R(Q)?(X="",T!=null&&(X=T.replace(de,"$&/")+"/"),V(Q,M,X,"",function(je){return je})):Q!=null&&(Y(Q)&&(Q=K(Q,X+(!Q.key||Re&&Re.key===Q.key?"":(""+Q.key).replace(de,"$&/")+"/")+T)),M.push(Q)),1;if(Re=0,ae=ae===""?".":ae+":",R(T))for(var Ee=0;Ee<T.length;Ee++){le=T[Ee];var be=ae+ue(le,Ee);Re+=V(le,M,X,be,Q)}else if(be=g(T),typeof be=="function")for(T=be.call(T),Ee=0;!(le=T.next()).done;)le=le.value,be=ae+ue(le,Ee++),Re+=V(le,M,X,be,Q);else if(le==="object")throw M=String(T),Error("Objects are not valid as a React child (found: "+(M==="[object Object]"?"object with keys {"+Object.keys(T).join(", ")+"}":M)+"). If you meant to render a collection of children, use an array instead.");return Re}function G(T,M,X){if(T==null)return T;var ae=[],Q=0;return V(T,ae,"","",function(le){return M.call(X,le,Q++)}),ae}function q(T){if(T._status===-1){var M=T._result;M=M(),M.then(function(X){(T._status===0||T._status===-1)&&(T._status=1,T._result=X)},function(X){(T._status===0||T._status===-1)&&(T._status=2,T._result=X)}),T._status===-1&&(T._status=0,T._result=M)}if(T._status===1)return T._result.default;throw T._result}var J={current:null},j={transition:null},B={ReactCurrentDispatcher:J,ReactCurrentBatchConfig:j,ReactCurrentOwner:I};function W(){throw Error("act(...) is not supported in production builds of React.")}return ze.Children={map:G,forEach:function(T,M,X){G(T,function(){M.apply(this,arguments)},X)},count:function(T){var M=0;return G(T,function(){M++}),M},toArray:function(T){return G(T,function(M){return M})||[]},only:function(T){if(!Y(T))throw Error("React.Children.only expected to receive a single React element child.");return T}},ze.Component=x,ze.Fragment=t,ze.Profiler=s,ze.PureComponent=P,ze.StrictMode=r,ze.Suspense=c,ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B,ze.act=W,ze.cloneElement=function(T,M,X){if(T==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+T+".");var ae=w({},T.props),Q=T.key,le=T.ref,Re=T._owner;if(M!=null){if(M.ref!==void 0&&(le=M.ref,Re=I.current),M.key!==void 0&&(Q=""+M.key),T.type&&T.type.defaultProps)var Ee=T.type.defaultProps;for(be in M)$.call(M,be)&&!D.hasOwnProperty(be)&&(ae[be]=M[be]===void 0&&Ee!==void 0?Ee[be]:M[be])}var be=arguments.length-2;if(be===1)ae.children=X;else if(1<be){Ee=Array(be);for(var je=0;je<be;je++)Ee[je]=arguments[je+2];ae.children=Ee}return{$$typeof:n,type:T.type,key:Q,ref:le,props:ae,_owner:Re}},ze.createContext=function(T){return T={$$typeof:l,_currentValue:T,_currentValue2:T,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},T.Provider={$$typeof:a,_context:T},T.Consumer=T},ze.createElement=F,ze.createFactory=function(T){var M=F.bind(null,T);return M.type=T,M},ze.createRef=function(){return{current:null}},ze.forwardRef=function(T){return{$$typeof:u,render:T}},ze.isValidElement=Y,ze.lazy=function(T){return{$$typeof:h,_payload:{_status:-1,_result:T},_init:q}},ze.memo=function(T,M){return{$$typeof:f,type:T,compare:M===void 0?null:M}},ze.startTransition=function(T){var M=j.transition;j.transition={};try{T()}finally{j.transition=M}},ze.unstable_act=W,ze.useCallback=function(T,M){return J.current.useCallback(T,M)},ze.useContext=function(T){return J.current.useContext(T)},ze.useDebugValue=function(){},ze.useDeferredValue=function(T){return J.current.useDeferredValue(T)},ze.useEffect=function(T,M){return J.current.useEffect(T,M)},ze.useId=function(){return J.current.useId()},ze.useImperativeHandle=function(T,M,X){return J.current.useImperativeHandle(T,M,X)},ze.useInsertionEffect=function(T,M){return J.current.useInsertionEffect(T,M)},ze.useLayoutEffect=function(T,M){return J.current.useLayoutEffect(T,M)},ze.useMemo=function(T,M){return J.current.useMemo(T,M)},ze.useReducer=function(T,M,X){return J.current.useReducer(T,M,X)},ze.useRef=function(T){return J.current.useRef(T)},ze.useState=function(T){return J.current.useState(T)},ze.useSyncExternalStore=function(T,M,X){return J.current.useSyncExternalStore(T,M,X)},ze.useTransition=function(){return J.current.useTransition()},ze.version="18.3.1",ze}var u0;function by(){return u0||(u0=1,Lp.exports=AO()),Lp.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c0;function $O(){if(c0)return fl;c0=1;var n=by(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(u,c,f){var h,m={},g=null,y=null;f!==void 0&&(g=""+f),c.key!==void 0&&(g=""+c.key),c.ref!==void 0&&(y=c.ref);for(h in c)r.call(c,h)&&!a.hasOwnProperty(h)&&(m[h]=c[h]);if(u&&u.defaultProps)for(h in c=u.defaultProps,c)m[h]===void 0&&(m[h]=c[h]);return{$$typeof:e,type:u,key:g,ref:y,props:m,_owner:s.current}}return fl.Fragment=t,fl.jsx=l,fl.jsxs=l,fl}var d0;function IO(){return d0||(d0=1,jp.exports=$O()),jp.exports}var O=IO(),k=by();const Ha=ti(k),NO=TO({__proto__:null,default:Ha},[k]);var Bc={},Mp={exports:{}},bn={},Dp={exports:{}},Fp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f0;function jO(){return f0||(f0=1,function(n){function e(j,B){var W=j.length;j.push(B);e:for(;0<W;){var T=W-1>>>1,M=j[T];if(0<s(M,B))j[T]=B,j[W]=M,W=T;else break e}}function t(j){return j.length===0?null:j[0]}function r(j){if(j.length===0)return null;var B=j[0],W=j.pop();if(W!==B){j[0]=W;e:for(var T=0,M=j.length,X=M>>>1;T<X;){var ae=2*(T+1)-1,Q=j[ae],le=ae+1,Re=j[le];if(0>s(Q,W))le<M&&0>s(Re,Q)?(j[T]=Re,j[le]=W,T=le):(j[T]=Q,j[ae]=W,T=ae);else if(le<M&&0>s(Re,W))j[T]=Re,j[le]=W,T=le;else break e}}return B}function s(j,B){var W=j.sortIndex-B.sortIndex;return W!==0?W:j.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,u=l.now();n.unstable_now=function(){return l.now()-u}}var c=[],f=[],h=1,m=null,g=3,y=!1,w=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(j){for(var B=t(f);B!==null;){if(B.callback===null)r(f);else if(B.startTime<=j)r(f),B.sortIndex=B.expirationTime,e(c,B);else break;B=t(f)}}function R(j){if(v=!1,S(j),!w)if(t(c)!==null)w=!0,q($);else{var B=t(f);B!==null&&J(R,B.startTime-j)}}function $(j,B){w=!1,v&&(v=!1,E(F),F=-1),y=!0;var W=g;try{for(S(B),m=t(c);m!==null&&(!(m.expirationTime>B)||j&&!ie());){var T=m.callback;if(typeof T=="function"){m.callback=null,g=m.priorityLevel;var M=T(m.expirationTime<=B);B=n.unstable_now(),typeof M=="function"?m.callback=M:m===t(c)&&r(c),S(B)}else r(c);m=t(c)}if(m!==null)var X=!0;else{var ae=t(f);ae!==null&&J(R,ae.startTime-B),X=!1}return X}finally{m=null,g=W,y=!1}}var I=!1,D=null,F=-1,K=5,Y=-1;function ie(){return!(n.unstable_now()-Y<K)}function de(){if(D!==null){var j=n.unstable_now();Y=j;var B=!0;try{B=D(!0,j)}finally{B?ue():(I=!1,D=null)}}else I=!1}var ue;if(typeof P=="function")ue=function(){P(de)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,G=V.port2;V.port1.onmessage=de,ue=function(){G.postMessage(null)}}else ue=function(){x(de,0)};function q(j){D=j,I||(I=!0,ue())}function J(j,B){F=x(function(){j(n.unstable_now())},B)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(j){j.callback=null},n.unstable_continueExecution=function(){w||y||(w=!0,q($))},n.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<j?Math.floor(1e3/j):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(j){switch(g){case 1:case 2:case 3:var B=3;break;default:B=g}var W=g;g=B;try{return j()}finally{g=W}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(j,B){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var W=g;g=j;try{return B()}finally{g=W}},n.unstable_scheduleCallback=function(j,B,W){var T=n.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?T+W:T):W=T,j){case 1:var M=-1;break;case 2:M=250;break;case 5:M=1073741823;break;case 4:M=1e4;break;default:M=5e3}return M=W+M,j={id:h++,callback:B,priorityLevel:j,startTime:W,expirationTime:M,sortIndex:-1},W>T?(j.sortIndex=W,e(f,j),t(c)===null&&j===t(f)&&(v?(E(F),F=-1):v=!0,J(R,W-T))):(j.sortIndex=M,e(c,j),w||y||(w=!0,q($))),j},n.unstable_shouldYield=ie,n.unstable_wrapCallback=function(j){var B=g;return function(){var W=g;g=B;try{return j.apply(this,arguments)}finally{g=W}}}}(Fp)),Fp}var h0;function LO(){return h0||(h0=1,Dp.exports=jO()),Dp.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p0;function MO(){if(p0)return bn;p0=1;var n=by(),e=LO();function t(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,d=1;d<arguments.length;d++)o+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(i,o){l(i,o),l(i+"Capture",o)}function l(i,o){for(s[i]=o,i=0;i<o.length;i++)r.add(o[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},m={};function g(i){return c.call(m,i)?!0:c.call(h,i)?!1:f.test(i)?m[i]=!0:(h[i]=!0,!1)}function y(i,o,d,p){if(d!==null&&d.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return p?!1:d!==null?!d.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function w(i,o,d,p){if(o===null||typeof o>"u"||y(i,o,d,p))return!0;if(p)return!1;if(d!==null)switch(d.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function v(i,o,d,p,_,b,C){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=p,this.attributeNamespace=_,this.mustUseProperty=d,this.propertyName=i,this.type=o,this.sanitizeURL=b,this.removeEmptyString=C}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){x[i]=new v(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];x[o]=new v(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){x[i]=new v(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){x[i]=new v(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){x[i]=new v(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){x[i]=new v(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){x[i]=new v(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){x[i]=new v(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){x[i]=new v(i,5,!1,i.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function P(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(E,P);x[o]=new v(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(E,P);x[o]=new v(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(E,P);x[o]=new v(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){x[i]=new v(i,1,!1,i.toLowerCase(),null,!1,!1)}),x.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){x[i]=new v(i,1,!1,i.toLowerCase(),null,!0,!0)});function S(i,o,d,p){var _=x.hasOwnProperty(o)?x[o]:null;(_!==null?_.type!==0:p||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(w(o,d,_,p)&&(d=null),p||_===null?g(o)&&(d===null?i.removeAttribute(o):i.setAttribute(o,""+d)):_.mustUseProperty?i[_.propertyName]=d===null?_.type===3?!1:"":d:(o=_.attributeName,p=_.attributeNamespace,d===null?i.removeAttribute(o):(_=_.type,d=_===3||_===4&&d===!0?"":""+d,p?i.setAttributeNS(p,o,d):i.setAttribute(o,d))))}var R=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,$=Symbol.for("react.element"),I=Symbol.for("react.portal"),D=Symbol.for("react.fragment"),F=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),Y=Symbol.for("react.provider"),ie=Symbol.for("react.context"),de=Symbol.for("react.forward_ref"),ue=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),J=Symbol.for("react.offscreen"),j=Symbol.iterator;function B(i){return i===null||typeof i!="object"?null:(i=j&&i[j]||i["@@iterator"],typeof i=="function"?i:null)}var W=Object.assign,T;function M(i){if(T===void 0)try{throw Error()}catch(d){var o=d.stack.trim().match(/\n( *(at )?)/);T=o&&o[1]||""}return`
`+T+i}var X=!1;function ae(i,o){if(!i||X)return"";X=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(H){var p=H}Reflect.construct(i,[],o)}else{try{o.call()}catch(H){p=H}i.call(o.prototype)}else{try{throw Error()}catch(H){p=H}i()}}catch(H){if(H&&p&&typeof H.stack=="string"){for(var _=H.stack.split(`
`),b=p.stack.split(`
`),C=_.length-1,A=b.length-1;1<=C&&0<=A&&_[C]!==b[A];)A--;for(;1<=C&&0<=A;C--,A--)if(_[C]!==b[A]){if(C!==1||A!==1)do if(C--,A--,0>A||_[C]!==b[A]){var N=`
`+_[C].replace(" at new "," at ");return i.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",i.displayName)),N}while(1<=C&&0<=A);break}}}finally{X=!1,Error.prepareStackTrace=d}return(i=i?i.displayName||i.name:"")?M(i):""}function Q(i){switch(i.tag){case 5:return M(i.type);case 16:return M("Lazy");case 13:return M("Suspense");case 19:return M("SuspenseList");case 0:case 2:case 15:return i=ae(i.type,!1),i;case 11:return i=ae(i.type.render,!1),i;case 1:return i=ae(i.type,!0),i;default:return""}}function le(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case D:return"Fragment";case I:return"Portal";case K:return"Profiler";case F:return"StrictMode";case ue:return"Suspense";case V:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case ie:return(i.displayName||"Context")+".Consumer";case Y:return(i._context.displayName||"Context")+".Provider";case de:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case G:return o=i.displayName||null,o!==null?o:le(i.type)||"Memo";case q:o=i._payload,i=i._init;try{return le(i(o))}catch{}}return null}function Re(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return le(o);case 8:return o===F?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Ee(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function be(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function je(i){var o=be(i)?"checked":"value",d=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),p=""+i[o];if(!i.hasOwnProperty(o)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var _=d.get,b=d.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return _.call(this)},set:function(C){p=""+C,b.call(this,C)}}),Object.defineProperty(i,o,{enumerable:d.enumerable}),{getValue:function(){return p},setValue:function(C){p=""+C},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function ct(i){i._valueTracker||(i._valueTracker=je(i))}function qt(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var d=o.getValue(),p="";return i&&(p=be(i)?i.checked?"true":"false":i.value),i=p,i!==d?(o.setValue(i),!0):!1}function Un(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Ir(i,o){var d=o.checked;return W({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??i._wrapperState.initialChecked})}function ls(i,o){var d=o.defaultValue==null?"":o.defaultValue,p=o.checked!=null?o.checked:o.defaultChecked;d=Ee(o.value!=null?o.value:d),i._wrapperState={initialChecked:p,initialValue:d,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function Ot(i,o){o=o.checked,o!=null&&S(i,"checked",o,!1)}function pt(i,o){Ot(i,o);var d=Ee(o.value),p=o.type;if(d!=null)p==="number"?(d===0&&i.value===""||i.value!=d)&&(i.value=""+d):i.value!==""+d&&(i.value=""+d);else if(p==="submit"||p==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?et(i,o.type,d):o.hasOwnProperty("defaultValue")&&et(i,o.type,Ee(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function nr(i,o,d){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var p=o.type;if(!(p!=="submit"&&p!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,d||o===i.value||(i.value=o),i.defaultValue=o}d=i.name,d!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,d!==""&&(i.name=d)}function et(i,o,d){(o!=="number"||Un(i.ownerDocument)!==i)&&(d==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+d&&(i.defaultValue=""+d))}var rr=Array.isArray;function vt(i,o,d,p){if(i=i.options,o){o={};for(var _=0;_<d.length;_++)o["$"+d[_]]=!0;for(d=0;d<i.length;d++)_=o.hasOwnProperty("$"+i[d].value),i[d].selected!==_&&(i[d].selected=_),_&&p&&(i[d].defaultSelected=!0)}else{for(d=""+Ee(d),o=null,_=0;_<i.length;_++){if(i[_].value===d){i[_].selected=!0,p&&(i[_].defaultSelected=!0);return}o!==null||i[_].disabled||(o=i[_])}o!==null&&(o.selected=!0)}}function $s(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return W({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function ai(i,o){var d=o.value;if(d==null){if(d=o.children,o=o.defaultValue,d!=null){if(o!=null)throw Error(t(92));if(rr(d)){if(1<d.length)throw Error(t(93));d=d[0]}o=d}o==null&&(o=""),d=o}i._wrapperState={initialValue:Ee(d)}}function Mt(i,o){var d=Ee(o.value),p=Ee(o.defaultValue);d!=null&&(d=""+d,d!==i.value&&(i.value=d),o.defaultValue==null&&i.defaultValue!==d&&(i.defaultValue=d)),p!=null&&(i.defaultValue=""+p)}function zn(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function us(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Pn(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?us(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var xt,Is=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,d,p,_){MSApp.execUnsafeLocalFunction(function(){return i(o,d,p,_)})}:i}(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(xt=xt||document.createElement("div"),xt.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=xt.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function dt(i,o){if(o){var d=i.firstChild;if(d&&d===i.lastChild&&d.nodeType===3){d.nodeValue=o;return}}i.textContent=o}var wa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Nu=["Webkit","ms","Moz","O"];Object.keys(wa).forEach(function(i){Nu.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),wa[o]=wa[i]})});function nn(i,o,d){return o==null||typeof o=="boolean"||o===""?"":d||typeof o!="number"||o===0||wa.hasOwnProperty(i)&&wa[i]?(""+o).trim():o+"px"}function Bn(i,o){i=i.style;for(var d in o)if(o.hasOwnProperty(d)){var p=d.indexOf("--")===0,_=nn(d,o[d],p);d==="float"&&(d="cssFloat"),p?i.setProperty(d,_):i[d]=_}}var Oo=W({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zf(i,o){if(o){if(Oo[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function Gf(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jf=null;function Kf(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Xf=null,ii=null,oi=null;function Cw(i){if(i=Xo(i)){if(typeof Xf!="function")throw Error(t(280));var o=i.stateNode;o&&(o=rc(o),Xf(i.stateNode,i.type,o))}}function Pw(i){ii?oi?oi.push(i):oi=[i]:ii=i}function kw(){if(ii){var i=ii,o=oi;if(oi=ii=null,Cw(i),o)for(i=0;i<o.length;i++)Cw(o[i])}}function Rw(i,o){return i(o)}function Ow(){}var Yf=!1;function Tw(i,o,d){if(Yf)return i(o,d);Yf=!0;try{return Rw(i,o,d)}finally{Yf=!1,(ii!==null||oi!==null)&&(Ow(),kw())}}function To(i,o){var d=i.stateNode;if(d===null)return null;var p=rc(d);if(p===null)return null;d=p[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(d&&typeof d!="function")throw Error(t(231,o,typeof d));return d}var Qf=!1;if(u)try{var Ao={};Object.defineProperty(Ao,"passive",{get:function(){Qf=!0}}),window.addEventListener("test",Ao,Ao),window.removeEventListener("test",Ao,Ao)}catch{Qf=!1}function Nk(i,o,d,p,_,b,C,A,N){var H=Array.prototype.slice.call(arguments,3);try{o.apply(d,H)}catch(ne){this.onError(ne)}}var $o=!1,ju=null,Lu=!1,eh=null,jk={onError:function(i){$o=!0,ju=i}};function Lk(i,o,d,p,_,b,C,A,N){$o=!1,ju=null,Nk.apply(jk,arguments)}function Mk(i,o,d,p,_,b,C,A,N){if(Lk.apply(this,arguments),$o){if($o){var H=ju;$o=!1,ju=null}else throw Error(t(198));Lu||(Lu=!0,eh=H)}}function ba(i){var o=i,d=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,o.flags&4098&&(d=o.return),i=o.return;while(i)}return o.tag===3?d:null}function Aw(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function $w(i){if(ba(i)!==i)throw Error(t(188))}function Dk(i){var o=i.alternate;if(!o){if(o=ba(i),o===null)throw Error(t(188));return o!==i?null:i}for(var d=i,p=o;;){var _=d.return;if(_===null)break;var b=_.alternate;if(b===null){if(p=_.return,p!==null){d=p;continue}break}if(_.child===b.child){for(b=_.child;b;){if(b===d)return $w(_),i;if(b===p)return $w(_),o;b=b.sibling}throw Error(t(188))}if(d.return!==p.return)d=_,p=b;else{for(var C=!1,A=_.child;A;){if(A===d){C=!0,d=_,p=b;break}if(A===p){C=!0,p=_,d=b;break}A=A.sibling}if(!C){for(A=b.child;A;){if(A===d){C=!0,d=b,p=_;break}if(A===p){C=!0,p=b,d=_;break}A=A.sibling}if(!C)throw Error(t(189))}}if(d.alternate!==p)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?i:o}function Iw(i){return i=Dk(i),i!==null?Nw(i):null}function Nw(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=Nw(i);if(o!==null)return o;i=i.sibling}return null}var jw=e.unstable_scheduleCallback,Lw=e.unstable_cancelCallback,Fk=e.unstable_shouldYield,Uk=e.unstable_requestPaint,mt=e.unstable_now,zk=e.unstable_getCurrentPriorityLevel,th=e.unstable_ImmediatePriority,Mw=e.unstable_UserBlockingPriority,Mu=e.unstable_NormalPriority,Bk=e.unstable_LowPriority,Dw=e.unstable_IdlePriority,Du=null,Nr=null;function Hk(i){if(Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(Du,i,void 0,(i.current.flags&128)===128)}catch{}}var sr=Math.clz32?Math.clz32:qk,Wk=Math.log,Vk=Math.LN2;function qk(i){return i>>>=0,i===0?32:31-(Wk(i)/Vk|0)|0}var Fu=64,Uu=4194304;function Io(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function zu(i,o){var d=i.pendingLanes;if(d===0)return 0;var p=0,_=i.suspendedLanes,b=i.pingedLanes,C=d&268435455;if(C!==0){var A=C&~_;A!==0?p=Io(A):(b&=C,b!==0&&(p=Io(b)))}else C=d&~_,C!==0?p=Io(C):b!==0&&(p=Io(b));if(p===0)return 0;if(o!==0&&o!==p&&!(o&_)&&(_=p&-p,b=o&-o,_>=b||_===16&&(b&4194240)!==0))return o;if(p&4&&(p|=d&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=p;0<o;)d=31-sr(o),_=1<<d,p|=i[d],o&=~_;return p}function Zk(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Gk(i,o){for(var d=i.suspendedLanes,p=i.pingedLanes,_=i.expirationTimes,b=i.pendingLanes;0<b;){var C=31-sr(b),A=1<<C,N=_[C];N===-1?(!(A&d)||A&p)&&(_[C]=Zk(A,o)):N<=o&&(i.expiredLanes|=A),b&=~A}}function nh(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Fw(){var i=Fu;return Fu<<=1,!(Fu&4194240)&&(Fu=64),i}function rh(i){for(var o=[],d=0;31>d;d++)o.push(i);return o}function No(i,o,d){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-sr(o),i[o]=d}function Jk(i,o){var d=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var p=i.eventTimes;for(i=i.expirationTimes;0<d;){var _=31-sr(d),b=1<<_;o[_]=0,p[_]=-1,i[_]=-1,d&=~b}}function sh(i,o){var d=i.entangledLanes|=o;for(i=i.entanglements;d;){var p=31-sr(d),_=1<<p;_&o|i[p]&o&&(i[p]|=o),d&=~_}}var Ge=0;function Uw(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var zw,ah,Bw,Hw,Ww,ih=!1,Bu=[],Ns=null,js=null,Ls=null,jo=new Map,Lo=new Map,Ms=[],Kk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Vw(i,o){switch(i){case"focusin":case"focusout":Ns=null;break;case"dragenter":case"dragleave":js=null;break;case"mouseover":case"mouseout":Ls=null;break;case"pointerover":case"pointerout":jo.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lo.delete(o.pointerId)}}function Mo(i,o,d,p,_,b){return i===null||i.nativeEvent!==b?(i={blockedOn:o,domEventName:d,eventSystemFlags:p,nativeEvent:b,targetContainers:[_]},o!==null&&(o=Xo(o),o!==null&&ah(o)),i):(i.eventSystemFlags|=p,o=i.targetContainers,_!==null&&o.indexOf(_)===-1&&o.push(_),i)}function Xk(i,o,d,p,_){switch(o){case"focusin":return Ns=Mo(Ns,i,o,d,p,_),!0;case"dragenter":return js=Mo(js,i,o,d,p,_),!0;case"mouseover":return Ls=Mo(Ls,i,o,d,p,_),!0;case"pointerover":var b=_.pointerId;return jo.set(b,Mo(jo.get(b)||null,i,o,d,p,_)),!0;case"gotpointercapture":return b=_.pointerId,Lo.set(b,Mo(Lo.get(b)||null,i,o,d,p,_)),!0}return!1}function qw(i){var o=va(i.target);if(o!==null){var d=ba(o);if(d!==null){if(o=d.tag,o===13){if(o=Aw(d),o!==null){i.blockedOn=o,Ww(i.priority,function(){Bw(d)});return}}else if(o===3&&d.stateNode.current.memoizedState.isDehydrated){i.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Hu(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var d=lh(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(d===null){d=i.nativeEvent;var p=new d.constructor(d.type,d);Jf=p,d.target.dispatchEvent(p),Jf=null}else return o=Xo(d),o!==null&&ah(o),i.blockedOn=d,!1;o.shift()}return!0}function Zw(i,o,d){Hu(i)&&d.delete(o)}function Yk(){ih=!1,Ns!==null&&Hu(Ns)&&(Ns=null),js!==null&&Hu(js)&&(js=null),Ls!==null&&Hu(Ls)&&(Ls=null),jo.forEach(Zw),Lo.forEach(Zw)}function Do(i,o){i.blockedOn===o&&(i.blockedOn=null,ih||(ih=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Yk)))}function Fo(i){function o(_){return Do(_,i)}if(0<Bu.length){Do(Bu[0],i);for(var d=1;d<Bu.length;d++){var p=Bu[d];p.blockedOn===i&&(p.blockedOn=null)}}for(Ns!==null&&Do(Ns,i),js!==null&&Do(js,i),Ls!==null&&Do(Ls,i),jo.forEach(o),Lo.forEach(o),d=0;d<Ms.length;d++)p=Ms[d],p.blockedOn===i&&(p.blockedOn=null);for(;0<Ms.length&&(d=Ms[0],d.blockedOn===null);)qw(d),d.blockedOn===null&&Ms.shift()}var li=R.ReactCurrentBatchConfig,Wu=!0;function Qk(i,o,d,p){var _=Ge,b=li.transition;li.transition=null;try{Ge=1,oh(i,o,d,p)}finally{Ge=_,li.transition=b}}function eR(i,o,d,p){var _=Ge,b=li.transition;li.transition=null;try{Ge=4,oh(i,o,d,p)}finally{Ge=_,li.transition=b}}function oh(i,o,d,p){if(Wu){var _=lh(i,o,d,p);if(_===null)Ch(i,o,p,Vu,d),Vw(i,p);else if(Xk(_,i,o,d,p))p.stopPropagation();else if(Vw(i,p),o&4&&-1<Kk.indexOf(i)){for(;_!==null;){var b=Xo(_);if(b!==null&&zw(b),b=lh(i,o,d,p),b===null&&Ch(i,o,p,Vu,d),b===_)break;_=b}_!==null&&p.stopPropagation()}else Ch(i,o,p,null,d)}}var Vu=null;function lh(i,o,d,p){if(Vu=null,i=Kf(p),i=va(i),i!==null)if(o=ba(i),o===null)i=null;else if(d=o.tag,d===13){if(i=Aw(o),i!==null)return i;i=null}else if(d===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return Vu=i,null}function Gw(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zk()){case th:return 1;case Mw:return 4;case Mu:case Bk:return 16;case Dw:return 536870912;default:return 16}default:return 16}}var Ds=null,uh=null,qu=null;function Jw(){if(qu)return qu;var i,o=uh,d=o.length,p,_="value"in Ds?Ds.value:Ds.textContent,b=_.length;for(i=0;i<d&&o[i]===_[i];i++);var C=d-i;for(p=1;p<=C&&o[d-p]===_[b-p];p++);return qu=_.slice(i,1<p?1-p:void 0)}function Zu(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function Gu(){return!0}function Kw(){return!1}function kn(i){function o(d,p,_,b,C){this._reactName=d,this._targetInst=_,this.type=p,this.nativeEvent=b,this.target=C,this.currentTarget=null;for(var A in i)i.hasOwnProperty(A)&&(d=i[A],this[A]=d?d(b):b[A]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Gu:Kw,this.isPropagationStopped=Kw,this}return W(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Gu)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Gu)},persist:function(){},isPersistent:Gu}),o}var ui={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ch=kn(ui),Uo=W({},ui,{view:0,detail:0}),tR=kn(Uo),dh,fh,zo,Ju=W({},Uo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ph,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==zo&&(zo&&i.type==="mousemove"?(dh=i.screenX-zo.screenX,fh=i.screenY-zo.screenY):fh=dh=0,zo=i),dh)},movementY:function(i){return"movementY"in i?i.movementY:fh}}),Xw=kn(Ju),nR=W({},Ju,{dataTransfer:0}),rR=kn(nR),sR=W({},Uo,{relatedTarget:0}),hh=kn(sR),aR=W({},ui,{animationName:0,elapsedTime:0,pseudoElement:0}),iR=kn(aR),oR=W({},ui,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),lR=kn(oR),uR=W({},ui,{data:0}),Yw=kn(uR),cR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},fR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function hR(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=fR[i])?!!o[i]:!1}function ph(){return hR}var pR=W({},Uo,{key:function(i){if(i.key){var o=cR[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Zu(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?dR[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ph,charCode:function(i){return i.type==="keypress"?Zu(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Zu(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),mR=kn(pR),gR=W({},Ju,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qw=kn(gR),yR=W({},Uo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ph}),_R=kn(yR),wR=W({},ui,{propertyName:0,elapsedTime:0,pseudoElement:0}),bR=kn(wR),vR=W({},Ju,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),xR=kn(vR),SR=[9,13,27,32],mh=u&&"CompositionEvent"in window,Bo=null;u&&"documentMode"in document&&(Bo=document.documentMode);var ER=u&&"TextEvent"in window&&!Bo,eb=u&&(!mh||Bo&&8<Bo&&11>=Bo),tb=" ",nb=!1;function rb(i,o){switch(i){case"keyup":return SR.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sb(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ci=!1;function CR(i,o){switch(i){case"compositionend":return sb(o);case"keypress":return o.which!==32?null:(nb=!0,tb);case"textInput":return i=o.data,i===tb&&nb?null:i;default:return null}}function PR(i,o){if(ci)return i==="compositionend"||!mh&&rb(i,o)?(i=Jw(),qu=uh=Ds=null,ci=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return eb&&o.locale!=="ko"?null:o.data;default:return null}}var kR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ab(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!kR[i.type]:o==="textarea"}function ib(i,o,d,p){Pw(p),o=ec(o,"onChange"),0<o.length&&(d=new ch("onChange","change",null,d,p),i.push({event:d,listeners:o}))}var Ho=null,Wo=null;function RR(i){Eb(i,0)}function Ku(i){var o=mi(i);if(qt(o))return i}function OR(i,o){if(i==="change")return o}var ob=!1;if(u){var gh;if(u){var yh="oninput"in document;if(!yh){var lb=document.createElement("div");lb.setAttribute("oninput","return;"),yh=typeof lb.oninput=="function"}gh=yh}else gh=!1;ob=gh&&(!document.documentMode||9<document.documentMode)}function ub(){Ho&&(Ho.detachEvent("onpropertychange",cb),Wo=Ho=null)}function cb(i){if(i.propertyName==="value"&&Ku(Wo)){var o=[];ib(o,Wo,i,Kf(i)),Tw(RR,o)}}function TR(i,o,d){i==="focusin"?(ub(),Ho=o,Wo=d,Ho.attachEvent("onpropertychange",cb)):i==="focusout"&&ub()}function AR(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Ku(Wo)}function $R(i,o){if(i==="click")return Ku(o)}function IR(i,o){if(i==="input"||i==="change")return Ku(o)}function NR(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var ar=typeof Object.is=="function"?Object.is:NR;function Vo(i,o){if(ar(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var d=Object.keys(i),p=Object.keys(o);if(d.length!==p.length)return!1;for(p=0;p<d.length;p++){var _=d[p];if(!c.call(o,_)||!ar(i[_],o[_]))return!1}return!0}function db(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function fb(i,o){var d=db(i);i=0;for(var p;d;){if(d.nodeType===3){if(p=i+d.textContent.length,i<=o&&p>=o)return{node:d,offset:o-i};i=p}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=db(d)}}function hb(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?hb(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function pb(){for(var i=window,o=Un();o instanceof i.HTMLIFrameElement;){try{var d=typeof o.contentWindow.location.href=="string"}catch{d=!1}if(d)i=o.contentWindow;else break;o=Un(i.document)}return o}function _h(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function jR(i){var o=pb(),d=i.focusedElem,p=i.selectionRange;if(o!==d&&d&&d.ownerDocument&&hb(d.ownerDocument.documentElement,d)){if(p!==null&&_h(d)){if(o=p.start,i=p.end,i===void 0&&(i=o),"selectionStart"in d)d.selectionStart=o,d.selectionEnd=Math.min(i,d.value.length);else if(i=(o=d.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var _=d.textContent.length,b=Math.min(p.start,_);p=p.end===void 0?b:Math.min(p.end,_),!i.extend&&b>p&&(_=p,p=b,b=_),_=fb(d,b);var C=fb(d,p);_&&C&&(i.rangeCount!==1||i.anchorNode!==_.node||i.anchorOffset!==_.offset||i.focusNode!==C.node||i.focusOffset!==C.offset)&&(o=o.createRange(),o.setStart(_.node,_.offset),i.removeAllRanges(),b>p?(i.addRange(o),i.extend(C.node,C.offset)):(o.setEnd(C.node,C.offset),i.addRange(o)))}}for(o=[],i=d;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<o.length;d++)i=o[d],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var LR=u&&"documentMode"in document&&11>=document.documentMode,di=null,wh=null,qo=null,bh=!1;function mb(i,o,d){var p=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;bh||di==null||di!==Un(p)||(p=di,"selectionStart"in p&&_h(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),qo&&Vo(qo,p)||(qo=p,p=ec(wh,"onSelect"),0<p.length&&(o=new ch("onSelect","select",null,o,d),i.push({event:o,listeners:p}),o.target=di)))}function Xu(i,o){var d={};return d[i.toLowerCase()]=o.toLowerCase(),d["Webkit"+i]="webkit"+o,d["Moz"+i]="moz"+o,d}var fi={animationend:Xu("Animation","AnimationEnd"),animationiteration:Xu("Animation","AnimationIteration"),animationstart:Xu("Animation","AnimationStart"),transitionend:Xu("Transition","TransitionEnd")},vh={},gb={};u&&(gb=document.createElement("div").style,"AnimationEvent"in window||(delete fi.animationend.animation,delete fi.animationiteration.animation,delete fi.animationstart.animation),"TransitionEvent"in window||delete fi.transitionend.transition);function Yu(i){if(vh[i])return vh[i];if(!fi[i])return i;var o=fi[i],d;for(d in o)if(o.hasOwnProperty(d)&&d in gb)return vh[i]=o[d];return i}var yb=Yu("animationend"),_b=Yu("animationiteration"),wb=Yu("animationstart"),bb=Yu("transitionend"),vb=new Map,xb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Fs(i,o){vb.set(i,o),a(o,[i])}for(var xh=0;xh<xb.length;xh++){var Sh=xb[xh],MR=Sh.toLowerCase(),DR=Sh[0].toUpperCase()+Sh.slice(1);Fs(MR,"on"+DR)}Fs(yb,"onAnimationEnd"),Fs(_b,"onAnimationIteration"),Fs(wb,"onAnimationStart"),Fs("dblclick","onDoubleClick"),Fs("focusin","onFocus"),Fs("focusout","onBlur"),Fs(bb,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Zo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),FR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Zo));function Sb(i,o,d){var p=i.type||"unknown-event";i.currentTarget=d,Mk(p,o,void 0,i),i.currentTarget=null}function Eb(i,o){o=(o&4)!==0;for(var d=0;d<i.length;d++){var p=i[d],_=p.event;p=p.listeners;e:{var b=void 0;if(o)for(var C=p.length-1;0<=C;C--){var A=p[C],N=A.instance,H=A.currentTarget;if(A=A.listener,N!==b&&_.isPropagationStopped())break e;Sb(_,A,H),b=N}else for(C=0;C<p.length;C++){if(A=p[C],N=A.instance,H=A.currentTarget,A=A.listener,N!==b&&_.isPropagationStopped())break e;Sb(_,A,H),b=N}}}if(Lu)throw i=eh,Lu=!1,eh=null,i}function nt(i,o){var d=o[Ah];d===void 0&&(d=o[Ah]=new Set);var p=i+"__bubble";d.has(p)||(Cb(o,i,2,!1),d.add(p))}function Eh(i,o,d){var p=0;o&&(p|=4),Cb(d,i,p,o)}var Qu="_reactListening"+Math.random().toString(36).slice(2);function Go(i){if(!i[Qu]){i[Qu]=!0,r.forEach(function(d){d!=="selectionchange"&&(FR.has(d)||Eh(d,!1,i),Eh(d,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Qu]||(o[Qu]=!0,Eh("selectionchange",!1,o))}}function Cb(i,o,d,p){switch(Gw(o)){case 1:var _=Qk;break;case 4:_=eR;break;default:_=oh}d=_.bind(null,o,d,i),_=void 0,!Qf||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(_=!0),p?_!==void 0?i.addEventListener(o,d,{capture:!0,passive:_}):i.addEventListener(o,d,!0):_!==void 0?i.addEventListener(o,d,{passive:_}):i.addEventListener(o,d,!1)}function Ch(i,o,d,p,_){var b=p;if(!(o&1)&&!(o&2)&&p!==null)e:for(;;){if(p===null)return;var C=p.tag;if(C===3||C===4){var A=p.stateNode.containerInfo;if(A===_||A.nodeType===8&&A.parentNode===_)break;if(C===4)for(C=p.return;C!==null;){var N=C.tag;if((N===3||N===4)&&(N=C.stateNode.containerInfo,N===_||N.nodeType===8&&N.parentNode===_))return;C=C.return}for(;A!==null;){if(C=va(A),C===null)return;if(N=C.tag,N===5||N===6){p=b=C;continue e}A=A.parentNode}}p=p.return}Tw(function(){var H=b,ne=Kf(d),re=[];e:{var te=vb.get(i);if(te!==void 0){var fe=ch,me=i;switch(i){case"keypress":if(Zu(d)===0)break e;case"keydown":case"keyup":fe=mR;break;case"focusin":me="focus",fe=hh;break;case"focusout":me="blur",fe=hh;break;case"beforeblur":case"afterblur":fe=hh;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=Xw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=rR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=_R;break;case yb:case _b:case wb:fe=iR;break;case bb:fe=bR;break;case"scroll":fe=tR;break;case"wheel":fe=xR;break;case"copy":case"cut":case"paste":fe=lR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=Qw}var ye=(o&4)!==0,gt=!ye&&i==="scroll",U=ye?te!==null?te+"Capture":null:te;ye=[];for(var L=H,z;L!==null;){z=L;var oe=z.stateNode;if(z.tag===5&&oe!==null&&(z=oe,U!==null&&(oe=To(L,U),oe!=null&&ye.push(Jo(L,oe,z)))),gt)break;L=L.return}0<ye.length&&(te=new fe(te,me,null,d,ne),re.push({event:te,listeners:ye}))}}if(!(o&7)){e:{if(te=i==="mouseover"||i==="pointerover",fe=i==="mouseout"||i==="pointerout",te&&d!==Jf&&(me=d.relatedTarget||d.fromElement)&&(va(me)||me[cs]))break e;if((fe||te)&&(te=ne.window===ne?ne:(te=ne.ownerDocument)?te.defaultView||te.parentWindow:window,fe?(me=d.relatedTarget||d.toElement,fe=H,me=me?va(me):null,me!==null&&(gt=ba(me),me!==gt||me.tag!==5&&me.tag!==6)&&(me=null)):(fe=null,me=H),fe!==me)){if(ye=Xw,oe="onMouseLeave",U="onMouseEnter",L="mouse",(i==="pointerout"||i==="pointerover")&&(ye=Qw,oe="onPointerLeave",U="onPointerEnter",L="pointer"),gt=fe==null?te:mi(fe),z=me==null?te:mi(me),te=new ye(oe,L+"leave",fe,d,ne),te.target=gt,te.relatedTarget=z,oe=null,va(ne)===H&&(ye=new ye(U,L+"enter",me,d,ne),ye.target=z,ye.relatedTarget=gt,oe=ye),gt=oe,fe&&me)t:{for(ye=fe,U=me,L=0,z=ye;z;z=hi(z))L++;for(z=0,oe=U;oe;oe=hi(oe))z++;for(;0<L-z;)ye=hi(ye),L--;for(;0<z-L;)U=hi(U),z--;for(;L--;){if(ye===U||U!==null&&ye===U.alternate)break t;ye=hi(ye),U=hi(U)}ye=null}else ye=null;fe!==null&&Pb(re,te,fe,ye,!1),me!==null&&gt!==null&&Pb(re,gt,me,ye,!0)}}e:{if(te=H?mi(H):window,fe=te.nodeName&&te.nodeName.toLowerCase(),fe==="select"||fe==="input"&&te.type==="file")var _e=OR;else if(ab(te))if(ob)_e=IR;else{_e=AR;var Ce=TR}else(fe=te.nodeName)&&fe.toLowerCase()==="input"&&(te.type==="checkbox"||te.type==="radio")&&(_e=$R);if(_e&&(_e=_e(i,H))){ib(re,_e,d,ne);break e}Ce&&Ce(i,te,H),i==="focusout"&&(Ce=te._wrapperState)&&Ce.controlled&&te.type==="number"&&et(te,"number",te.value)}switch(Ce=H?mi(H):window,i){case"focusin":(ab(Ce)||Ce.contentEditable==="true")&&(di=Ce,wh=H,qo=null);break;case"focusout":qo=wh=di=null;break;case"mousedown":bh=!0;break;case"contextmenu":case"mouseup":case"dragend":bh=!1,mb(re,d,ne);break;case"selectionchange":if(LR)break;case"keydown":case"keyup":mb(re,d,ne)}var Pe;if(mh)e:{switch(i){case"compositionstart":var Ae="onCompositionStart";break e;case"compositionend":Ae="onCompositionEnd";break e;case"compositionupdate":Ae="onCompositionUpdate";break e}Ae=void 0}else ci?rb(i,d)&&(Ae="onCompositionEnd"):i==="keydown"&&d.keyCode===229&&(Ae="onCompositionStart");Ae&&(eb&&d.locale!=="ko"&&(ci||Ae!=="onCompositionStart"?Ae==="onCompositionEnd"&&ci&&(Pe=Jw()):(Ds=ne,uh="value"in Ds?Ds.value:Ds.textContent,ci=!0)),Ce=ec(H,Ae),0<Ce.length&&(Ae=new Yw(Ae,i,null,d,ne),re.push({event:Ae,listeners:Ce}),Pe?Ae.data=Pe:(Pe=sb(d),Pe!==null&&(Ae.data=Pe)))),(Pe=ER?CR(i,d):PR(i,d))&&(H=ec(H,"onBeforeInput"),0<H.length&&(ne=new Yw("onBeforeInput","beforeinput",null,d,ne),re.push({event:ne,listeners:H}),ne.data=Pe))}Eb(re,o)})}function Jo(i,o,d){return{instance:i,listener:o,currentTarget:d}}function ec(i,o){for(var d=o+"Capture",p=[];i!==null;){var _=i,b=_.stateNode;_.tag===5&&b!==null&&(_=b,b=To(i,d),b!=null&&p.unshift(Jo(i,b,_)),b=To(i,o),b!=null&&p.push(Jo(i,b,_))),i=i.return}return p}function hi(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Pb(i,o,d,p,_){for(var b=o._reactName,C=[];d!==null&&d!==p;){var A=d,N=A.alternate,H=A.stateNode;if(N!==null&&N===p)break;A.tag===5&&H!==null&&(A=H,_?(N=To(d,b),N!=null&&C.unshift(Jo(d,N,A))):_||(N=To(d,b),N!=null&&C.push(Jo(d,N,A)))),d=d.return}C.length!==0&&i.push({event:o,listeners:C})}var UR=/\r\n?/g,zR=/\u0000|\uFFFD/g;function kb(i){return(typeof i=="string"?i:""+i).replace(UR,`
`).replace(zR,"")}function tc(i,o,d){if(o=kb(o),kb(i)!==o&&d)throw Error(t(425))}function nc(){}var Ph=null,kh=null;function Rh(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Oh=typeof setTimeout=="function"?setTimeout:void 0,BR=typeof clearTimeout=="function"?clearTimeout:void 0,Rb=typeof Promise=="function"?Promise:void 0,HR=typeof queueMicrotask=="function"?queueMicrotask:typeof Rb<"u"?function(i){return Rb.resolve(null).then(i).catch(WR)}:Oh;function WR(i){setTimeout(function(){throw i})}function Th(i,o){var d=o,p=0;do{var _=d.nextSibling;if(i.removeChild(d),_&&_.nodeType===8)if(d=_.data,d==="/$"){if(p===0){i.removeChild(_),Fo(o);return}p--}else d!=="$"&&d!=="$?"&&d!=="$!"||p++;d=_}while(d);Fo(o)}function Us(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function Ob(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var d=i.data;if(d==="$"||d==="$!"||d==="$?"){if(o===0)return i;o--}else d==="/$"&&o++}i=i.previousSibling}return null}var pi=Math.random().toString(36).slice(2),jr="__reactFiber$"+pi,Ko="__reactProps$"+pi,cs="__reactContainer$"+pi,Ah="__reactEvents$"+pi,VR="__reactListeners$"+pi,qR="__reactHandles$"+pi;function va(i){var o=i[jr];if(o)return o;for(var d=i.parentNode;d;){if(o=d[cs]||d[jr]){if(d=o.alternate,o.child!==null||d!==null&&d.child!==null)for(i=Ob(i);i!==null;){if(d=i[jr])return d;i=Ob(i)}return o}i=d,d=i.parentNode}return null}function Xo(i){return i=i[jr]||i[cs],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function mi(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function rc(i){return i[Ko]||null}var $h=[],gi=-1;function zs(i){return{current:i}}function rt(i){0>gi||(i.current=$h[gi],$h[gi]=null,gi--)}function tt(i,o){gi++,$h[gi]=i.current,i.current=o}var Bs={},Zt=zs(Bs),mn=zs(!1),xa=Bs;function yi(i,o){var d=i.type.contextTypes;if(!d)return Bs;var p=i.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===o)return p.__reactInternalMemoizedMaskedChildContext;var _={},b;for(b in d)_[b]=o[b];return p&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=_),_}function gn(i){return i=i.childContextTypes,i!=null}function sc(){rt(mn),rt(Zt)}function Tb(i,o,d){if(Zt.current!==Bs)throw Error(t(168));tt(Zt,o),tt(mn,d)}function Ab(i,o,d){var p=i.stateNode;if(o=o.childContextTypes,typeof p.getChildContext!="function")return d;p=p.getChildContext();for(var _ in p)if(!(_ in o))throw Error(t(108,Re(i)||"Unknown",_));return W({},d,p)}function ac(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Bs,xa=Zt.current,tt(Zt,i),tt(mn,mn.current),!0}function $b(i,o,d){var p=i.stateNode;if(!p)throw Error(t(169));d?(i=Ab(i,o,xa),p.__reactInternalMemoizedMergedChildContext=i,rt(mn),rt(Zt),tt(Zt,i)):rt(mn),tt(mn,d)}var ds=null,ic=!1,Ih=!1;function Ib(i){ds===null?ds=[i]:ds.push(i)}function ZR(i){ic=!0,Ib(i)}function Hs(){if(!Ih&&ds!==null){Ih=!0;var i=0,o=Ge;try{var d=ds;for(Ge=1;i<d.length;i++){var p=d[i];do p=p(!0);while(p!==null)}ds=null,ic=!1}catch(_){throw ds!==null&&(ds=ds.slice(i+1)),jw(th,Hs),_}finally{Ge=o,Ih=!1}}return null}var _i=[],wi=0,oc=null,lc=0,Hn=[],Wn=0,Sa=null,fs=1,hs="";function Ea(i,o){_i[wi++]=lc,_i[wi++]=oc,oc=i,lc=o}function Nb(i,o,d){Hn[Wn++]=fs,Hn[Wn++]=hs,Hn[Wn++]=Sa,Sa=i;var p=fs;i=hs;var _=32-sr(p)-1;p&=~(1<<_),d+=1;var b=32-sr(o)+_;if(30<b){var C=_-_%5;b=(p&(1<<C)-1).toString(32),p>>=C,_-=C,fs=1<<32-sr(o)+_|d<<_|p,hs=b+i}else fs=1<<b|d<<_|p,hs=i}function Nh(i){i.return!==null&&(Ea(i,1),Nb(i,1,0))}function jh(i){for(;i===oc;)oc=_i[--wi],_i[wi]=null,lc=_i[--wi],_i[wi]=null;for(;i===Sa;)Sa=Hn[--Wn],Hn[Wn]=null,hs=Hn[--Wn],Hn[Wn]=null,fs=Hn[--Wn],Hn[Wn]=null}var Rn=null,On=null,st=!1,ir=null;function jb(i,o){var d=Gn(5,null,null,0);d.elementType="DELETED",d.stateNode=o,d.return=i,o=i.deletions,o===null?(i.deletions=[d],i.flags|=16):o.push(d)}function Lb(i,o){switch(i.tag){case 5:var d=i.type;return o=o.nodeType!==1||d.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,Rn=i,On=Us(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,Rn=i,On=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(d=Sa!==null?{id:fs,overflow:hs}:null,i.memoizedState={dehydrated:o,treeContext:d,retryLane:1073741824},d=Gn(18,null,null,0),d.stateNode=o,d.return=i,i.child=d,Rn=i,On=null,!0):!1;default:return!1}}function Lh(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Mh(i){if(st){var o=On;if(o){var d=o;if(!Lb(i,o)){if(Lh(i))throw Error(t(418));o=Us(d.nextSibling);var p=Rn;o&&Lb(i,o)?jb(p,d):(i.flags=i.flags&-4097|2,st=!1,Rn=i)}}else{if(Lh(i))throw Error(t(418));i.flags=i.flags&-4097|2,st=!1,Rn=i}}}function Mb(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Rn=i}function uc(i){if(i!==Rn)return!1;if(!st)return Mb(i),st=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!Rh(i.type,i.memoizedProps)),o&&(o=On)){if(Lh(i))throw Db(),Error(t(418));for(;o;)jb(i,o),o=Us(o.nextSibling)}if(Mb(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var d=i.data;if(d==="/$"){if(o===0){On=Us(i.nextSibling);break e}o--}else d!=="$"&&d!=="$!"&&d!=="$?"||o++}i=i.nextSibling}On=null}}else On=Rn?Us(i.stateNode.nextSibling):null;return!0}function Db(){for(var i=On;i;)i=Us(i.nextSibling)}function bi(){On=Rn=null,st=!1}function Dh(i){ir===null?ir=[i]:ir.push(i)}var GR=R.ReactCurrentBatchConfig;function Yo(i,o,d){if(i=d.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var p=d.stateNode}if(!p)throw Error(t(147,i));var _=p,b=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===b?o.ref:(o=function(C){var A=_.refs;C===null?delete A[b]:A[b]=C},o._stringRef=b,o)}if(typeof i!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,i))}return i}function cc(i,o){throw i=Object.prototype.toString.call(o),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Fb(i){var o=i._init;return o(i._payload)}function Ub(i){function o(U,L){if(i){var z=U.deletions;z===null?(U.deletions=[L],U.flags|=16):z.push(L)}}function d(U,L){if(!i)return null;for(;L!==null;)o(U,L),L=L.sibling;return null}function p(U,L){for(U=new Map;L!==null;)L.key!==null?U.set(L.key,L):U.set(L.index,L),L=L.sibling;return U}function _(U,L){return U=Xs(U,L),U.index=0,U.sibling=null,U}function b(U,L,z){return U.index=z,i?(z=U.alternate,z!==null?(z=z.index,z<L?(U.flags|=2,L):z):(U.flags|=2,L)):(U.flags|=1048576,L)}function C(U){return i&&U.alternate===null&&(U.flags|=2),U}function A(U,L,z,oe){return L===null||L.tag!==6?(L=Op(z,U.mode,oe),L.return=U,L):(L=_(L,z),L.return=U,L)}function N(U,L,z,oe){var _e=z.type;return _e===D?ne(U,L,z.props.children,oe,z.key):L!==null&&(L.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===q&&Fb(_e)===L.type)?(oe=_(L,z.props),oe.ref=Yo(U,L,z),oe.return=U,oe):(oe=Nc(z.type,z.key,z.props,null,U.mode,oe),oe.ref=Yo(U,L,z),oe.return=U,oe)}function H(U,L,z,oe){return L===null||L.tag!==4||L.stateNode.containerInfo!==z.containerInfo||L.stateNode.implementation!==z.implementation?(L=Tp(z,U.mode,oe),L.return=U,L):(L=_(L,z.children||[]),L.return=U,L)}function ne(U,L,z,oe,_e){return L===null||L.tag!==7?(L=$a(z,U.mode,oe,_e),L.return=U,L):(L=_(L,z),L.return=U,L)}function re(U,L,z){if(typeof L=="string"&&L!==""||typeof L=="number")return L=Op(""+L,U.mode,z),L.return=U,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case $:return z=Nc(L.type,L.key,L.props,null,U.mode,z),z.ref=Yo(U,null,L),z.return=U,z;case I:return L=Tp(L,U.mode,z),L.return=U,L;case q:var oe=L._init;return re(U,oe(L._payload),z)}if(rr(L)||B(L))return L=$a(L,U.mode,z,null),L.return=U,L;cc(U,L)}return null}function te(U,L,z,oe){var _e=L!==null?L.key:null;if(typeof z=="string"&&z!==""||typeof z=="number")return _e!==null?null:A(U,L,""+z,oe);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case $:return z.key===_e?N(U,L,z,oe):null;case I:return z.key===_e?H(U,L,z,oe):null;case q:return _e=z._init,te(U,L,_e(z._payload),oe)}if(rr(z)||B(z))return _e!==null?null:ne(U,L,z,oe,null);cc(U,z)}return null}function fe(U,L,z,oe,_e){if(typeof oe=="string"&&oe!==""||typeof oe=="number")return U=U.get(z)||null,A(L,U,""+oe,_e);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case $:return U=U.get(oe.key===null?z:oe.key)||null,N(L,U,oe,_e);case I:return U=U.get(oe.key===null?z:oe.key)||null,H(L,U,oe,_e);case q:var Ce=oe._init;return fe(U,L,z,Ce(oe._payload),_e)}if(rr(oe)||B(oe))return U=U.get(z)||null,ne(L,U,oe,_e,null);cc(L,oe)}return null}function me(U,L,z,oe){for(var _e=null,Ce=null,Pe=L,Ae=L=0,$t=null;Pe!==null&&Ae<z.length;Ae++){Pe.index>Ae?($t=Pe,Pe=null):$t=Pe.sibling;var We=te(U,Pe,z[Ae],oe);if(We===null){Pe===null&&(Pe=$t);break}i&&Pe&&We.alternate===null&&o(U,Pe),L=b(We,L,Ae),Ce===null?_e=We:Ce.sibling=We,Ce=We,Pe=$t}if(Ae===z.length)return d(U,Pe),st&&Ea(U,Ae),_e;if(Pe===null){for(;Ae<z.length;Ae++)Pe=re(U,z[Ae],oe),Pe!==null&&(L=b(Pe,L,Ae),Ce===null?_e=Pe:Ce.sibling=Pe,Ce=Pe);return st&&Ea(U,Ae),_e}for(Pe=p(U,Pe);Ae<z.length;Ae++)$t=fe(Pe,U,Ae,z[Ae],oe),$t!==null&&(i&&$t.alternate!==null&&Pe.delete($t.key===null?Ae:$t.key),L=b($t,L,Ae),Ce===null?_e=$t:Ce.sibling=$t,Ce=$t);return i&&Pe.forEach(function(Ys){return o(U,Ys)}),st&&Ea(U,Ae),_e}function ye(U,L,z,oe){var _e=B(z);if(typeof _e!="function")throw Error(t(150));if(z=_e.call(z),z==null)throw Error(t(151));for(var Ce=_e=null,Pe=L,Ae=L=0,$t=null,We=z.next();Pe!==null&&!We.done;Ae++,We=z.next()){Pe.index>Ae?($t=Pe,Pe=null):$t=Pe.sibling;var Ys=te(U,Pe,We.value,oe);if(Ys===null){Pe===null&&(Pe=$t);break}i&&Pe&&Ys.alternate===null&&o(U,Pe),L=b(Ys,L,Ae),Ce===null?_e=Ys:Ce.sibling=Ys,Ce=Ys,Pe=$t}if(We.done)return d(U,Pe),st&&Ea(U,Ae),_e;if(Pe===null){for(;!We.done;Ae++,We=z.next())We=re(U,We.value,oe),We!==null&&(L=b(We,L,Ae),Ce===null?_e=We:Ce.sibling=We,Ce=We);return st&&Ea(U,Ae),_e}for(Pe=p(U,Pe);!We.done;Ae++,We=z.next())We=fe(Pe,U,Ae,We.value,oe),We!==null&&(i&&We.alternate!==null&&Pe.delete(We.key===null?Ae:We.key),L=b(We,L,Ae),Ce===null?_e=We:Ce.sibling=We,Ce=We);return i&&Pe.forEach(function(kO){return o(U,kO)}),st&&Ea(U,Ae),_e}function gt(U,L,z,oe){if(typeof z=="object"&&z!==null&&z.type===D&&z.key===null&&(z=z.props.children),typeof z=="object"&&z!==null){switch(z.$$typeof){case $:e:{for(var _e=z.key,Ce=L;Ce!==null;){if(Ce.key===_e){if(_e=z.type,_e===D){if(Ce.tag===7){d(U,Ce.sibling),L=_(Ce,z.props.children),L.return=U,U=L;break e}}else if(Ce.elementType===_e||typeof _e=="object"&&_e!==null&&_e.$$typeof===q&&Fb(_e)===Ce.type){d(U,Ce.sibling),L=_(Ce,z.props),L.ref=Yo(U,Ce,z),L.return=U,U=L;break e}d(U,Ce);break}else o(U,Ce);Ce=Ce.sibling}z.type===D?(L=$a(z.props.children,U.mode,oe,z.key),L.return=U,U=L):(oe=Nc(z.type,z.key,z.props,null,U.mode,oe),oe.ref=Yo(U,L,z),oe.return=U,U=oe)}return C(U);case I:e:{for(Ce=z.key;L!==null;){if(L.key===Ce)if(L.tag===4&&L.stateNode.containerInfo===z.containerInfo&&L.stateNode.implementation===z.implementation){d(U,L.sibling),L=_(L,z.children||[]),L.return=U,U=L;break e}else{d(U,L);break}else o(U,L);L=L.sibling}L=Tp(z,U.mode,oe),L.return=U,U=L}return C(U);case q:return Ce=z._init,gt(U,L,Ce(z._payload),oe)}if(rr(z))return me(U,L,z,oe);if(B(z))return ye(U,L,z,oe);cc(U,z)}return typeof z=="string"&&z!==""||typeof z=="number"?(z=""+z,L!==null&&L.tag===6?(d(U,L.sibling),L=_(L,z),L.return=U,U=L):(d(U,L),L=Op(z,U.mode,oe),L.return=U,U=L),C(U)):d(U,L)}return gt}var vi=Ub(!0),zb=Ub(!1),dc=zs(null),fc=null,xi=null,Fh=null;function Uh(){Fh=xi=fc=null}function zh(i){var o=dc.current;rt(dc),i._currentValue=o}function Bh(i,o,d){for(;i!==null;){var p=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,p!==null&&(p.childLanes|=o)):p!==null&&(p.childLanes&o)!==o&&(p.childLanes|=o),i===d)break;i=i.return}}function Si(i,o){fc=i,Fh=xi=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&o&&(yn=!0),i.firstContext=null)}function Vn(i){var o=i._currentValue;if(Fh!==i)if(i={context:i,memoizedValue:o,next:null},xi===null){if(fc===null)throw Error(t(308));xi=i,fc.dependencies={lanes:0,firstContext:i}}else xi=xi.next=i;return o}var Ca=null;function Hh(i){Ca===null?Ca=[i]:Ca.push(i)}function Bb(i,o,d,p){var _=o.interleaved;return _===null?(d.next=d,Hh(o)):(d.next=_.next,_.next=d),o.interleaved=d,ps(i,p)}function ps(i,o){i.lanes|=o;var d=i.alternate;for(d!==null&&(d.lanes|=o),d=i,i=i.return;i!==null;)i.childLanes|=o,d=i.alternate,d!==null&&(d.childLanes|=o),d=i,i=i.return;return d.tag===3?d.stateNode:null}var Ws=!1;function Wh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Hb(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function ms(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function Vs(i,o,d){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,He&2){var _=p.pending;return _===null?o.next=o:(o.next=_.next,_.next=o),p.pending=o,ps(i,d)}return _=p.interleaved,_===null?(o.next=o,Hh(p)):(o.next=_.next,_.next=o),p.interleaved=o,ps(i,d)}function hc(i,o,d){if(o=o.updateQueue,o!==null&&(o=o.shared,(d&4194240)!==0)){var p=o.lanes;p&=i.pendingLanes,d|=p,o.lanes=d,sh(i,d)}}function Wb(i,o){var d=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,d===p)){var _=null,b=null;if(d=d.firstBaseUpdate,d!==null){do{var C={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};b===null?_=b=C:b=b.next=C,d=d.next}while(d!==null);b===null?_=b=o:b=b.next=o}else _=b=o;d={baseState:p.baseState,firstBaseUpdate:_,lastBaseUpdate:b,shared:p.shared,effects:p.effects},i.updateQueue=d;return}i=d.lastBaseUpdate,i===null?d.firstBaseUpdate=o:i.next=o,d.lastBaseUpdate=o}function pc(i,o,d,p){var _=i.updateQueue;Ws=!1;var b=_.firstBaseUpdate,C=_.lastBaseUpdate,A=_.shared.pending;if(A!==null){_.shared.pending=null;var N=A,H=N.next;N.next=null,C===null?b=H:C.next=H,C=N;var ne=i.alternate;ne!==null&&(ne=ne.updateQueue,A=ne.lastBaseUpdate,A!==C&&(A===null?ne.firstBaseUpdate=H:A.next=H,ne.lastBaseUpdate=N))}if(b!==null){var re=_.baseState;C=0,ne=H=N=null,A=b;do{var te=A.lane,fe=A.eventTime;if((p&te)===te){ne!==null&&(ne=ne.next={eventTime:fe,lane:0,tag:A.tag,payload:A.payload,callback:A.callback,next:null});e:{var me=i,ye=A;switch(te=o,fe=d,ye.tag){case 1:if(me=ye.payload,typeof me=="function"){re=me.call(fe,re,te);break e}re=me;break e;case 3:me.flags=me.flags&-65537|128;case 0:if(me=ye.payload,te=typeof me=="function"?me.call(fe,re,te):me,te==null)break e;re=W({},re,te);break e;case 2:Ws=!0}}A.callback!==null&&A.lane!==0&&(i.flags|=64,te=_.effects,te===null?_.effects=[A]:te.push(A))}else fe={eventTime:fe,lane:te,tag:A.tag,payload:A.payload,callback:A.callback,next:null},ne===null?(H=ne=fe,N=re):ne=ne.next=fe,C|=te;if(A=A.next,A===null){if(A=_.shared.pending,A===null)break;te=A,A=te.next,te.next=null,_.lastBaseUpdate=te,_.shared.pending=null}}while(!0);if(ne===null&&(N=re),_.baseState=N,_.firstBaseUpdate=H,_.lastBaseUpdate=ne,o=_.shared.interleaved,o!==null){_=o;do C|=_.lane,_=_.next;while(_!==o)}else b===null&&(_.shared.lanes=0);Ra|=C,i.lanes=C,i.memoizedState=re}}function Vb(i,o,d){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var p=i[o],_=p.callback;if(_!==null){if(p.callback=null,p=d,typeof _!="function")throw Error(t(191,_));_.call(p)}}}var Qo={},Lr=zs(Qo),el=zs(Qo),tl=zs(Qo);function Pa(i){if(i===Qo)throw Error(t(174));return i}function Vh(i,o){switch(tt(tl,o),tt(el,i),tt(Lr,Qo),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:Pn(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=Pn(o,i)}rt(Lr),tt(Lr,o)}function Ei(){rt(Lr),rt(el),rt(tl)}function qb(i){Pa(tl.current);var o=Pa(Lr.current),d=Pn(o,i.type);o!==d&&(tt(el,i),tt(Lr,d))}function qh(i){el.current===i&&(rt(Lr),rt(el))}var at=zs(0);function mc(i){for(var o=i;o!==null;){if(o.tag===13){var d=o.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Zh=[];function Gh(){for(var i=0;i<Zh.length;i++)Zh[i]._workInProgressVersionPrimary=null;Zh.length=0}var gc=R.ReactCurrentDispatcher,Jh=R.ReactCurrentBatchConfig,ka=0,it=null,St=null,Tt=null,yc=!1,nl=!1,rl=0,JR=0;function Gt(){throw Error(t(321))}function Kh(i,o){if(o===null)return!1;for(var d=0;d<o.length&&d<i.length;d++)if(!ar(i[d],o[d]))return!1;return!0}function Xh(i,o,d,p,_,b){if(ka=b,it=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,gc.current=i===null||i.memoizedState===null?QR:eO,i=d(p,_),nl){b=0;do{if(nl=!1,rl=0,25<=b)throw Error(t(301));b+=1,Tt=St=null,o.updateQueue=null,gc.current=tO,i=d(p,_)}while(nl)}if(gc.current=bc,o=St!==null&&St.next!==null,ka=0,Tt=St=it=null,yc=!1,o)throw Error(t(300));return i}function Yh(){var i=rl!==0;return rl=0,i}function Mr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tt===null?it.memoizedState=Tt=i:Tt=Tt.next=i,Tt}function qn(){if(St===null){var i=it.alternate;i=i!==null?i.memoizedState:null}else i=St.next;var o=Tt===null?it.memoizedState:Tt.next;if(o!==null)Tt=o,St=i;else{if(i===null)throw Error(t(310));St=i,i={memoizedState:St.memoizedState,baseState:St.baseState,baseQueue:St.baseQueue,queue:St.queue,next:null},Tt===null?it.memoizedState=Tt=i:Tt=Tt.next=i}return Tt}function sl(i,o){return typeof o=="function"?o(i):o}function Qh(i){var o=qn(),d=o.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=i;var p=St,_=p.baseQueue,b=d.pending;if(b!==null){if(_!==null){var C=_.next;_.next=b.next,b.next=C}p.baseQueue=_=b,d.pending=null}if(_!==null){b=_.next,p=p.baseState;var A=C=null,N=null,H=b;do{var ne=H.lane;if((ka&ne)===ne)N!==null&&(N=N.next={lane:0,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null}),p=H.hasEagerState?H.eagerState:i(p,H.action);else{var re={lane:ne,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null};N===null?(A=N=re,C=p):N=N.next=re,it.lanes|=ne,Ra|=ne}H=H.next}while(H!==null&&H!==b);N===null?C=p:N.next=A,ar(p,o.memoizedState)||(yn=!0),o.memoizedState=p,o.baseState=C,o.baseQueue=N,d.lastRenderedState=p}if(i=d.interleaved,i!==null){_=i;do b=_.lane,it.lanes|=b,Ra|=b,_=_.next;while(_!==i)}else _===null&&(d.lanes=0);return[o.memoizedState,d.dispatch]}function ep(i){var o=qn(),d=o.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=i;var p=d.dispatch,_=d.pending,b=o.memoizedState;if(_!==null){d.pending=null;var C=_=_.next;do b=i(b,C.action),C=C.next;while(C!==_);ar(b,o.memoizedState)||(yn=!0),o.memoizedState=b,o.baseQueue===null&&(o.baseState=b),d.lastRenderedState=b}return[b,p]}function Zb(){}function Gb(i,o){var d=it,p=qn(),_=o(),b=!ar(p.memoizedState,_);if(b&&(p.memoizedState=_,yn=!0),p=p.queue,tp(Xb.bind(null,d,p,i),[i]),p.getSnapshot!==o||b||Tt!==null&&Tt.memoizedState.tag&1){if(d.flags|=2048,al(9,Kb.bind(null,d,p,_,o),void 0,null),At===null)throw Error(t(349));ka&30||Jb(d,o,_)}return _}function Jb(i,o,d){i.flags|=16384,i={getSnapshot:o,value:d},o=it.updateQueue,o===null?(o={lastEffect:null,stores:null},it.updateQueue=o,o.stores=[i]):(d=o.stores,d===null?o.stores=[i]:d.push(i))}function Kb(i,o,d,p){o.value=d,o.getSnapshot=p,Yb(o)&&Qb(i)}function Xb(i,o,d){return d(function(){Yb(o)&&Qb(i)})}function Yb(i){var o=i.getSnapshot;i=i.value;try{var d=o();return!ar(i,d)}catch{return!0}}function Qb(i){var o=ps(i,1);o!==null&&cr(o,i,1,-1)}function ev(i){var o=Mr();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:sl,lastRenderedState:i},o.queue=i,i=i.dispatch=YR.bind(null,it,i),[o.memoizedState,i]}function al(i,o,d,p){return i={tag:i,create:o,destroy:d,deps:p,next:null},o=it.updateQueue,o===null?(o={lastEffect:null,stores:null},it.updateQueue=o,o.lastEffect=i.next=i):(d=o.lastEffect,d===null?o.lastEffect=i.next=i:(p=d.next,d.next=i,i.next=p,o.lastEffect=i)),i}function tv(){return qn().memoizedState}function _c(i,o,d,p){var _=Mr();it.flags|=i,_.memoizedState=al(1|o,d,void 0,p===void 0?null:p)}function wc(i,o,d,p){var _=qn();p=p===void 0?null:p;var b=void 0;if(St!==null){var C=St.memoizedState;if(b=C.destroy,p!==null&&Kh(p,C.deps)){_.memoizedState=al(o,d,b,p);return}}it.flags|=i,_.memoizedState=al(1|o,d,b,p)}function nv(i,o){return _c(8390656,8,i,o)}function tp(i,o){return wc(2048,8,i,o)}function rv(i,o){return wc(4,2,i,o)}function sv(i,o){return wc(4,4,i,o)}function av(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function iv(i,o,d){return d=d!=null?d.concat([i]):null,wc(4,4,av.bind(null,o,i),d)}function np(){}function ov(i,o){var d=qn();o=o===void 0?null:o;var p=d.memoizedState;return p!==null&&o!==null&&Kh(o,p[1])?p[0]:(d.memoizedState=[i,o],i)}function lv(i,o){var d=qn();o=o===void 0?null:o;var p=d.memoizedState;return p!==null&&o!==null&&Kh(o,p[1])?p[0]:(i=i(),d.memoizedState=[i,o],i)}function uv(i,o,d){return ka&21?(ar(d,o)||(d=Fw(),it.lanes|=d,Ra|=d,i.baseState=!0),o):(i.baseState&&(i.baseState=!1,yn=!0),i.memoizedState=d)}function KR(i,o){var d=Ge;Ge=d!==0&&4>d?d:4,i(!0);var p=Jh.transition;Jh.transition={};try{i(!1),o()}finally{Ge=d,Jh.transition=p}}function cv(){return qn().memoizedState}function XR(i,o,d){var p=Js(i);if(d={lane:p,action:d,hasEagerState:!1,eagerState:null,next:null},dv(i))fv(o,d);else if(d=Bb(i,o,d,p),d!==null){var _=sn();cr(d,i,p,_),hv(d,o,p)}}function YR(i,o,d){var p=Js(i),_={lane:p,action:d,hasEagerState:!1,eagerState:null,next:null};if(dv(i))fv(o,_);else{var b=i.alternate;if(i.lanes===0&&(b===null||b.lanes===0)&&(b=o.lastRenderedReducer,b!==null))try{var C=o.lastRenderedState,A=b(C,d);if(_.hasEagerState=!0,_.eagerState=A,ar(A,C)){var N=o.interleaved;N===null?(_.next=_,Hh(o)):(_.next=N.next,N.next=_),o.interleaved=_;return}}catch{}finally{}d=Bb(i,o,_,p),d!==null&&(_=sn(),cr(d,i,p,_),hv(d,o,p))}}function dv(i){var o=i.alternate;return i===it||o!==null&&o===it}function fv(i,o){nl=yc=!0;var d=i.pending;d===null?o.next=o:(o.next=d.next,d.next=o),i.pending=o}function hv(i,o,d){if(d&4194240){var p=o.lanes;p&=i.pendingLanes,d|=p,o.lanes=d,sh(i,d)}}var bc={readContext:Vn,useCallback:Gt,useContext:Gt,useEffect:Gt,useImperativeHandle:Gt,useInsertionEffect:Gt,useLayoutEffect:Gt,useMemo:Gt,useReducer:Gt,useRef:Gt,useState:Gt,useDebugValue:Gt,useDeferredValue:Gt,useTransition:Gt,useMutableSource:Gt,useSyncExternalStore:Gt,useId:Gt,unstable_isNewReconciler:!1},QR={readContext:Vn,useCallback:function(i,o){return Mr().memoizedState=[i,o===void 0?null:o],i},useContext:Vn,useEffect:nv,useImperativeHandle:function(i,o,d){return d=d!=null?d.concat([i]):null,_c(4194308,4,av.bind(null,o,i),d)},useLayoutEffect:function(i,o){return _c(4194308,4,i,o)},useInsertionEffect:function(i,o){return _c(4,2,i,o)},useMemo:function(i,o){var d=Mr();return o=o===void 0?null:o,i=i(),d.memoizedState=[i,o],i},useReducer:function(i,o,d){var p=Mr();return o=d!==void 0?d(o):o,p.memoizedState=p.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},p.queue=i,i=i.dispatch=XR.bind(null,it,i),[p.memoizedState,i]},useRef:function(i){var o=Mr();return i={current:i},o.memoizedState=i},useState:ev,useDebugValue:np,useDeferredValue:function(i){return Mr().memoizedState=i},useTransition:function(){var i=ev(!1),o=i[0];return i=KR.bind(null,i[1]),Mr().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,d){var p=it,_=Mr();if(st){if(d===void 0)throw Error(t(407));d=d()}else{if(d=o(),At===null)throw Error(t(349));ka&30||Jb(p,o,d)}_.memoizedState=d;var b={value:d,getSnapshot:o};return _.queue=b,nv(Xb.bind(null,p,b,i),[i]),p.flags|=2048,al(9,Kb.bind(null,p,b,d,o),void 0,null),d},useId:function(){var i=Mr(),o=At.identifierPrefix;if(st){var d=hs,p=fs;d=(p&~(1<<32-sr(p)-1)).toString(32)+d,o=":"+o+"R"+d,d=rl++,0<d&&(o+="H"+d.toString(32)),o+=":"}else d=JR++,o=":"+o+"r"+d.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},eO={readContext:Vn,useCallback:ov,useContext:Vn,useEffect:tp,useImperativeHandle:iv,useInsertionEffect:rv,useLayoutEffect:sv,useMemo:lv,useReducer:Qh,useRef:tv,useState:function(){return Qh(sl)},useDebugValue:np,useDeferredValue:function(i){var o=qn();return uv(o,St.memoizedState,i)},useTransition:function(){var i=Qh(sl)[0],o=qn().memoizedState;return[i,o]},useMutableSource:Zb,useSyncExternalStore:Gb,useId:cv,unstable_isNewReconciler:!1},tO={readContext:Vn,useCallback:ov,useContext:Vn,useEffect:tp,useImperativeHandle:iv,useInsertionEffect:rv,useLayoutEffect:sv,useMemo:lv,useReducer:ep,useRef:tv,useState:function(){return ep(sl)},useDebugValue:np,useDeferredValue:function(i){var o=qn();return St===null?o.memoizedState=i:uv(o,St.memoizedState,i)},useTransition:function(){var i=ep(sl)[0],o=qn().memoizedState;return[i,o]},useMutableSource:Zb,useSyncExternalStore:Gb,useId:cv,unstable_isNewReconciler:!1};function or(i,o){if(i&&i.defaultProps){o=W({},o),i=i.defaultProps;for(var d in i)o[d]===void 0&&(o[d]=i[d]);return o}return o}function rp(i,o,d,p){o=i.memoizedState,d=d(p,o),d=d==null?o:W({},o,d),i.memoizedState=d,i.lanes===0&&(i.updateQueue.baseState=d)}var vc={isMounted:function(i){return(i=i._reactInternals)?ba(i)===i:!1},enqueueSetState:function(i,o,d){i=i._reactInternals;var p=sn(),_=Js(i),b=ms(p,_);b.payload=o,d!=null&&(b.callback=d),o=Vs(i,b,_),o!==null&&(cr(o,i,_,p),hc(o,i,_))},enqueueReplaceState:function(i,o,d){i=i._reactInternals;var p=sn(),_=Js(i),b=ms(p,_);b.tag=1,b.payload=o,d!=null&&(b.callback=d),o=Vs(i,b,_),o!==null&&(cr(o,i,_,p),hc(o,i,_))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var d=sn(),p=Js(i),_=ms(d,p);_.tag=2,o!=null&&(_.callback=o),o=Vs(i,_,p),o!==null&&(cr(o,i,p,d),hc(o,i,p))}};function pv(i,o,d,p,_,b,C){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,b,C):o.prototype&&o.prototype.isPureReactComponent?!Vo(d,p)||!Vo(_,b):!0}function mv(i,o,d){var p=!1,_=Bs,b=o.contextType;return typeof b=="object"&&b!==null?b=Vn(b):(_=gn(o)?xa:Zt.current,p=o.contextTypes,b=(p=p!=null)?yi(i,_):Bs),o=new o(d,b),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=vc,i.stateNode=o,o._reactInternals=i,p&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=_,i.__reactInternalMemoizedMaskedChildContext=b),o}function gv(i,o,d,p){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(d,p),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(d,p),o.state!==i&&vc.enqueueReplaceState(o,o.state,null)}function sp(i,o,d,p){var _=i.stateNode;_.props=d,_.state=i.memoizedState,_.refs={},Wh(i);var b=o.contextType;typeof b=="object"&&b!==null?_.context=Vn(b):(b=gn(o)?xa:Zt.current,_.context=yi(i,b)),_.state=i.memoizedState,b=o.getDerivedStateFromProps,typeof b=="function"&&(rp(i,o,b,d),_.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(o=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),o!==_.state&&vc.enqueueReplaceState(_,_.state,null),pc(i,d,_,p),_.state=i.memoizedState),typeof _.componentDidMount=="function"&&(i.flags|=4194308)}function Ci(i,o){try{var d="",p=o;do d+=Q(p),p=p.return;while(p);var _=d}catch(b){_=`
Error generating stack: `+b.message+`
`+b.stack}return{value:i,source:o,stack:_,digest:null}}function ap(i,o,d){return{value:i,source:null,stack:d??null,digest:o??null}}function ip(i,o){try{console.error(o.value)}catch(d){setTimeout(function(){throw d})}}var nO=typeof WeakMap=="function"?WeakMap:Map;function yv(i,o,d){d=ms(-1,d),d.tag=3,d.payload={element:null};var p=o.value;return d.callback=function(){Rc||(Rc=!0,vp=p),ip(i,o)},d}function _v(i,o,d){d=ms(-1,d),d.tag=3;var p=i.type.getDerivedStateFromError;if(typeof p=="function"){var _=o.value;d.payload=function(){return p(_)},d.callback=function(){ip(i,o)}}var b=i.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(d.callback=function(){ip(i,o),typeof p!="function"&&(Zs===null?Zs=new Set([this]):Zs.add(this));var C=o.stack;this.componentDidCatch(o.value,{componentStack:C!==null?C:""})}),d}function wv(i,o,d){var p=i.pingCache;if(p===null){p=i.pingCache=new nO;var _=new Set;p.set(o,_)}else _=p.get(o),_===void 0&&(_=new Set,p.set(o,_));_.has(d)||(_.add(d),i=gO.bind(null,i,o,d),o.then(i,i))}function bv(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function vv(i,o,d,p,_){return i.mode&1?(i.flags|=65536,i.lanes=_,i):(i===o?i.flags|=65536:(i.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(o=ms(-1,1),o.tag=2,Vs(d,o,1))),d.lanes|=1),i)}var rO=R.ReactCurrentOwner,yn=!1;function rn(i,o,d,p){o.child=i===null?zb(o,null,d,p):vi(o,i.child,d,p)}function xv(i,o,d,p,_){d=d.render;var b=o.ref;return Si(o,_),p=Xh(i,o,d,p,b,_),d=Yh(),i!==null&&!yn?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~_,gs(i,o,_)):(st&&d&&Nh(o),o.flags|=1,rn(i,o,p,_),o.child)}function Sv(i,o,d,p,_){if(i===null){var b=d.type;return typeof b=="function"&&!Rp(b)&&b.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(o.tag=15,o.type=b,Ev(i,o,b,p,_)):(i=Nc(d.type,null,p,o,o.mode,_),i.ref=o.ref,i.return=o,o.child=i)}if(b=i.child,!(i.lanes&_)){var C=b.memoizedProps;if(d=d.compare,d=d!==null?d:Vo,d(C,p)&&i.ref===o.ref)return gs(i,o,_)}return o.flags|=1,i=Xs(b,p),i.ref=o.ref,i.return=o,o.child=i}function Ev(i,o,d,p,_){if(i!==null){var b=i.memoizedProps;if(Vo(b,p)&&i.ref===o.ref)if(yn=!1,o.pendingProps=p=b,(i.lanes&_)!==0)i.flags&131072&&(yn=!0);else return o.lanes=i.lanes,gs(i,o,_)}return op(i,o,d,p,_)}function Cv(i,o,d){var p=o.pendingProps,_=p.children,b=i!==null?i.memoizedState:null;if(p.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},tt(ki,Tn),Tn|=d;else{if(!(d&1073741824))return i=b!==null?b.baseLanes|d:d,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,tt(ki,Tn),Tn|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=b!==null?b.baseLanes:d,tt(ki,Tn),Tn|=p}else b!==null?(p=b.baseLanes|d,o.memoizedState=null):p=d,tt(ki,Tn),Tn|=p;return rn(i,o,_,d),o.child}function Pv(i,o){var d=o.ref;(i===null&&d!==null||i!==null&&i.ref!==d)&&(o.flags|=512,o.flags|=2097152)}function op(i,o,d,p,_){var b=gn(d)?xa:Zt.current;return b=yi(o,b),Si(o,_),d=Xh(i,o,d,p,b,_),p=Yh(),i!==null&&!yn?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~_,gs(i,o,_)):(st&&p&&Nh(o),o.flags|=1,rn(i,o,d,_),o.child)}function kv(i,o,d,p,_){if(gn(d)){var b=!0;ac(o)}else b=!1;if(Si(o,_),o.stateNode===null)Sc(i,o),mv(o,d,p),sp(o,d,p,_),p=!0;else if(i===null){var C=o.stateNode,A=o.memoizedProps;C.props=A;var N=C.context,H=d.contextType;typeof H=="object"&&H!==null?H=Vn(H):(H=gn(d)?xa:Zt.current,H=yi(o,H));var ne=d.getDerivedStateFromProps,re=typeof ne=="function"||typeof C.getSnapshotBeforeUpdate=="function";re||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(A!==p||N!==H)&&gv(o,C,p,H),Ws=!1;var te=o.memoizedState;C.state=te,pc(o,p,C,_),N=o.memoizedState,A!==p||te!==N||mn.current||Ws?(typeof ne=="function"&&(rp(o,d,ne,p),N=o.memoizedState),(A=Ws||pv(o,d,A,p,te,N,H))?(re||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(o.flags|=4194308)):(typeof C.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=p,o.memoizedState=N),C.props=p,C.state=N,C.context=H,p=A):(typeof C.componentDidMount=="function"&&(o.flags|=4194308),p=!1)}else{C=o.stateNode,Hb(i,o),A=o.memoizedProps,H=o.type===o.elementType?A:or(o.type,A),C.props=H,re=o.pendingProps,te=C.context,N=d.contextType,typeof N=="object"&&N!==null?N=Vn(N):(N=gn(d)?xa:Zt.current,N=yi(o,N));var fe=d.getDerivedStateFromProps;(ne=typeof fe=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(A!==re||te!==N)&&gv(o,C,p,N),Ws=!1,te=o.memoizedState,C.state=te,pc(o,p,C,_);var me=o.memoizedState;A!==re||te!==me||mn.current||Ws?(typeof fe=="function"&&(rp(o,d,fe,p),me=o.memoizedState),(H=Ws||pv(o,d,H,p,te,me,N)||!1)?(ne||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(p,me,N),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(p,me,N)),typeof C.componentDidUpdate=="function"&&(o.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof C.componentDidUpdate!="function"||A===i.memoizedProps&&te===i.memoizedState||(o.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&te===i.memoizedState||(o.flags|=1024),o.memoizedProps=p,o.memoizedState=me),C.props=p,C.state=me,C.context=N,p=H):(typeof C.componentDidUpdate!="function"||A===i.memoizedProps&&te===i.memoizedState||(o.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||A===i.memoizedProps&&te===i.memoizedState||(o.flags|=1024),p=!1)}return lp(i,o,d,p,b,_)}function lp(i,o,d,p,_,b){Pv(i,o);var C=(o.flags&128)!==0;if(!p&&!C)return _&&$b(o,d,!1),gs(i,o,b);p=o.stateNode,rO.current=o;var A=C&&typeof d.getDerivedStateFromError!="function"?null:p.render();return o.flags|=1,i!==null&&C?(o.child=vi(o,i.child,null,b),o.child=vi(o,null,A,b)):rn(i,o,A,b),o.memoizedState=p.state,_&&$b(o,d,!0),o.child}function Rv(i){var o=i.stateNode;o.pendingContext?Tb(i,o.pendingContext,o.pendingContext!==o.context):o.context&&Tb(i,o.context,!1),Vh(i,o.containerInfo)}function Ov(i,o,d,p,_){return bi(),Dh(_),o.flags|=256,rn(i,o,d,p),o.child}var up={dehydrated:null,treeContext:null,retryLane:0};function cp(i){return{baseLanes:i,cachePool:null,transitions:null}}function Tv(i,o,d){var p=o.pendingProps,_=at.current,b=!1,C=(o.flags&128)!==0,A;if((A=C)||(A=i!==null&&i.memoizedState===null?!1:(_&2)!==0),A?(b=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(_|=1),tt(at,_&1),i===null)return Mh(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(o.mode&1?i.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(C=p.children,i=p.fallback,b?(p=o.mode,b=o.child,C={mode:"hidden",children:C},!(p&1)&&b!==null?(b.childLanes=0,b.pendingProps=C):b=jc(C,p,0,null),i=$a(i,p,d,null),b.return=o,i.return=o,b.sibling=i,o.child=b,o.child.memoizedState=cp(d),o.memoizedState=up,i):dp(o,C));if(_=i.memoizedState,_!==null&&(A=_.dehydrated,A!==null))return sO(i,o,C,p,A,_,d);if(b){b=p.fallback,C=o.mode,_=i.child,A=_.sibling;var N={mode:"hidden",children:p.children};return!(C&1)&&o.child!==_?(p=o.child,p.childLanes=0,p.pendingProps=N,o.deletions=null):(p=Xs(_,N),p.subtreeFlags=_.subtreeFlags&14680064),A!==null?b=Xs(A,b):(b=$a(b,C,d,null),b.flags|=2),b.return=o,p.return=o,p.sibling=b,o.child=p,p=b,b=o.child,C=i.child.memoizedState,C=C===null?cp(d):{baseLanes:C.baseLanes|d,cachePool:null,transitions:C.transitions},b.memoizedState=C,b.childLanes=i.childLanes&~d,o.memoizedState=up,p}return b=i.child,i=b.sibling,p=Xs(b,{mode:"visible",children:p.children}),!(o.mode&1)&&(p.lanes=d),p.return=o,p.sibling=null,i!==null&&(d=o.deletions,d===null?(o.deletions=[i],o.flags|=16):d.push(i)),o.child=p,o.memoizedState=null,p}function dp(i,o){return o=jc({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function xc(i,o,d,p){return p!==null&&Dh(p),vi(o,i.child,null,d),i=dp(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function sO(i,o,d,p,_,b,C){if(d)return o.flags&256?(o.flags&=-257,p=ap(Error(t(422))),xc(i,o,C,p)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(b=p.fallback,_=o.mode,p=jc({mode:"visible",children:p.children},_,0,null),b=$a(b,_,C,null),b.flags|=2,p.return=o,b.return=o,p.sibling=b,o.child=p,o.mode&1&&vi(o,i.child,null,C),o.child.memoizedState=cp(C),o.memoizedState=up,b);if(!(o.mode&1))return xc(i,o,C,null);if(_.data==="$!"){if(p=_.nextSibling&&_.nextSibling.dataset,p)var A=p.dgst;return p=A,b=Error(t(419)),p=ap(b,p,void 0),xc(i,o,C,p)}if(A=(C&i.childLanes)!==0,yn||A){if(p=At,p!==null){switch(C&-C){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(p.suspendedLanes|C)?0:_,_!==0&&_!==b.retryLane&&(b.retryLane=_,ps(i,_),cr(p,i,_,-1))}return kp(),p=ap(Error(t(421))),xc(i,o,C,p)}return _.data==="$?"?(o.flags|=128,o.child=i.child,o=yO.bind(null,i),_._reactRetry=o,null):(i=b.treeContext,On=Us(_.nextSibling),Rn=o,st=!0,ir=null,i!==null&&(Hn[Wn++]=fs,Hn[Wn++]=hs,Hn[Wn++]=Sa,fs=i.id,hs=i.overflow,Sa=o),o=dp(o,p.children),o.flags|=4096,o)}function Av(i,o,d){i.lanes|=o;var p=i.alternate;p!==null&&(p.lanes|=o),Bh(i.return,o,d)}function fp(i,o,d,p,_){var b=i.memoizedState;b===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:p,tail:d,tailMode:_}:(b.isBackwards=o,b.rendering=null,b.renderingStartTime=0,b.last=p,b.tail=d,b.tailMode=_)}function $v(i,o,d){var p=o.pendingProps,_=p.revealOrder,b=p.tail;if(rn(i,o,p.children,d),p=at.current,p&2)p=p&1|2,o.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Av(i,d,o);else if(i.tag===19)Av(i,d,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}if(tt(at,p),!(o.mode&1))o.memoizedState=null;else switch(_){case"forwards":for(d=o.child,_=null;d!==null;)i=d.alternate,i!==null&&mc(i)===null&&(_=d),d=d.sibling;d=_,d===null?(_=o.child,o.child=null):(_=d.sibling,d.sibling=null),fp(o,!1,_,d,b);break;case"backwards":for(d=null,_=o.child,o.child=null;_!==null;){if(i=_.alternate,i!==null&&mc(i)===null){o.child=_;break}i=_.sibling,_.sibling=d,d=_,_=i}fp(o,!0,d,null,b);break;case"together":fp(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Sc(i,o){!(o.mode&1)&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function gs(i,o,d){if(i!==null&&(o.dependencies=i.dependencies),Ra|=o.lanes,!(d&o.childLanes))return null;if(i!==null&&o.child!==i.child)throw Error(t(153));if(o.child!==null){for(i=o.child,d=Xs(i,i.pendingProps),o.child=d,d.return=o;i.sibling!==null;)i=i.sibling,d=d.sibling=Xs(i,i.pendingProps),d.return=o;d.sibling=null}return o.child}function aO(i,o,d){switch(o.tag){case 3:Rv(o),bi();break;case 5:qb(o);break;case 1:gn(o.type)&&ac(o);break;case 4:Vh(o,o.stateNode.containerInfo);break;case 10:var p=o.type._context,_=o.memoizedProps.value;tt(dc,p._currentValue),p._currentValue=_;break;case 13:if(p=o.memoizedState,p!==null)return p.dehydrated!==null?(tt(at,at.current&1),o.flags|=128,null):d&o.child.childLanes?Tv(i,o,d):(tt(at,at.current&1),i=gs(i,o,d),i!==null?i.sibling:null);tt(at,at.current&1);break;case 19:if(p=(d&o.childLanes)!==0,i.flags&128){if(p)return $v(i,o,d);o.flags|=128}if(_=o.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),tt(at,at.current),p)break;return null;case 22:case 23:return o.lanes=0,Cv(i,o,d)}return gs(i,o,d)}var Iv,hp,Nv,jv;Iv=function(i,o){for(var d=o.child;d!==null;){if(d.tag===5||d.tag===6)i.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===o)break;for(;d.sibling===null;){if(d.return===null||d.return===o)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},hp=function(){},Nv=function(i,o,d,p){var _=i.memoizedProps;if(_!==p){i=o.stateNode,Pa(Lr.current);var b=null;switch(d){case"input":_=Ir(i,_),p=Ir(i,p),b=[];break;case"select":_=W({},_,{value:void 0}),p=W({},p,{value:void 0}),b=[];break;case"textarea":_=$s(i,_),p=$s(i,p),b=[];break;default:typeof _.onClick!="function"&&typeof p.onClick=="function"&&(i.onclick=nc)}Zf(d,p);var C;d=null;for(H in _)if(!p.hasOwnProperty(H)&&_.hasOwnProperty(H)&&_[H]!=null)if(H==="style"){var A=_[H];for(C in A)A.hasOwnProperty(C)&&(d||(d={}),d[C]="")}else H!=="dangerouslySetInnerHTML"&&H!=="children"&&H!=="suppressContentEditableWarning"&&H!=="suppressHydrationWarning"&&H!=="autoFocus"&&(s.hasOwnProperty(H)?b||(b=[]):(b=b||[]).push(H,null));for(H in p){var N=p[H];if(A=_!=null?_[H]:void 0,p.hasOwnProperty(H)&&N!==A&&(N!=null||A!=null))if(H==="style")if(A){for(C in A)!A.hasOwnProperty(C)||N&&N.hasOwnProperty(C)||(d||(d={}),d[C]="");for(C in N)N.hasOwnProperty(C)&&A[C]!==N[C]&&(d||(d={}),d[C]=N[C])}else d||(b||(b=[]),b.push(H,d)),d=N;else H==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,A=A?A.__html:void 0,N!=null&&A!==N&&(b=b||[]).push(H,N)):H==="children"?typeof N!="string"&&typeof N!="number"||(b=b||[]).push(H,""+N):H!=="suppressContentEditableWarning"&&H!=="suppressHydrationWarning"&&(s.hasOwnProperty(H)?(N!=null&&H==="onScroll"&&nt("scroll",i),b||A===N||(b=[])):(b=b||[]).push(H,N))}d&&(b=b||[]).push("style",d);var H=b;(o.updateQueue=H)&&(o.flags|=4)}},jv=function(i,o,d,p){d!==p&&(o.flags|=4)};function il(i,o){if(!st)switch(i.tailMode){case"hidden":o=i.tail;for(var d=null;o!==null;)o.alternate!==null&&(d=o),o=o.sibling;d===null?i.tail=null:d.sibling=null;break;case"collapsed":d=i.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function Jt(i){var o=i.alternate!==null&&i.alternate.child===i.child,d=0,p=0;if(o)for(var _=i.child;_!==null;)d|=_.lanes|_.childLanes,p|=_.subtreeFlags&14680064,p|=_.flags&14680064,_.return=i,_=_.sibling;else for(_=i.child;_!==null;)d|=_.lanes|_.childLanes,p|=_.subtreeFlags,p|=_.flags,_.return=i,_=_.sibling;return i.subtreeFlags|=p,i.childLanes=d,o}function iO(i,o,d){var p=o.pendingProps;switch(jh(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Jt(o),null;case 1:return gn(o.type)&&sc(),Jt(o),null;case 3:return p=o.stateNode,Ei(),rt(mn),rt(Zt),Gh(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(i===null||i.child===null)&&(uc(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,ir!==null&&(Ep(ir),ir=null))),hp(i,o),Jt(o),null;case 5:qh(o);var _=Pa(tl.current);if(d=o.type,i!==null&&o.stateNode!=null)Nv(i,o,d,p,_),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!p){if(o.stateNode===null)throw Error(t(166));return Jt(o),null}if(i=Pa(Lr.current),uc(o)){p=o.stateNode,d=o.type;var b=o.memoizedProps;switch(p[jr]=o,p[Ko]=b,i=(o.mode&1)!==0,d){case"dialog":nt("cancel",p),nt("close",p);break;case"iframe":case"object":case"embed":nt("load",p);break;case"video":case"audio":for(_=0;_<Zo.length;_++)nt(Zo[_],p);break;case"source":nt("error",p);break;case"img":case"image":case"link":nt("error",p),nt("load",p);break;case"details":nt("toggle",p);break;case"input":ls(p,b),nt("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!b.multiple},nt("invalid",p);break;case"textarea":ai(p,b),nt("invalid",p)}Zf(d,b),_=null;for(var C in b)if(b.hasOwnProperty(C)){var A=b[C];C==="children"?typeof A=="string"?p.textContent!==A&&(b.suppressHydrationWarning!==!0&&tc(p.textContent,A,i),_=["children",A]):typeof A=="number"&&p.textContent!==""+A&&(b.suppressHydrationWarning!==!0&&tc(p.textContent,A,i),_=["children",""+A]):s.hasOwnProperty(C)&&A!=null&&C==="onScroll"&&nt("scroll",p)}switch(d){case"input":ct(p),nr(p,b,!0);break;case"textarea":ct(p),zn(p);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(p.onclick=nc)}p=_,o.updateQueue=p,p!==null&&(o.flags|=4)}else{C=_.nodeType===9?_:_.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=us(d)),i==="http://www.w3.org/1999/xhtml"?d==="script"?(i=C.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof p.is=="string"?i=C.createElement(d,{is:p.is}):(i=C.createElement(d),d==="select"&&(C=i,p.multiple?C.multiple=!0:p.size&&(C.size=p.size))):i=C.createElementNS(i,d),i[jr]=o,i[Ko]=p,Iv(i,o,!1,!1),o.stateNode=i;e:{switch(C=Gf(d,p),d){case"dialog":nt("cancel",i),nt("close",i),_=p;break;case"iframe":case"object":case"embed":nt("load",i),_=p;break;case"video":case"audio":for(_=0;_<Zo.length;_++)nt(Zo[_],i);_=p;break;case"source":nt("error",i),_=p;break;case"img":case"image":case"link":nt("error",i),nt("load",i),_=p;break;case"details":nt("toggle",i),_=p;break;case"input":ls(i,p),_=Ir(i,p),nt("invalid",i);break;case"option":_=p;break;case"select":i._wrapperState={wasMultiple:!!p.multiple},_=W({},p,{value:void 0}),nt("invalid",i);break;case"textarea":ai(i,p),_=$s(i,p),nt("invalid",i);break;default:_=p}Zf(d,_),A=_;for(b in A)if(A.hasOwnProperty(b)){var N=A[b];b==="style"?Bn(i,N):b==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&Is(i,N)):b==="children"?typeof N=="string"?(d!=="textarea"||N!=="")&&dt(i,N):typeof N=="number"&&dt(i,""+N):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(s.hasOwnProperty(b)?N!=null&&b==="onScroll"&&nt("scroll",i):N!=null&&S(i,b,N,C))}switch(d){case"input":ct(i),nr(i,p,!1);break;case"textarea":ct(i),zn(i);break;case"option":p.value!=null&&i.setAttribute("value",""+Ee(p.value));break;case"select":i.multiple=!!p.multiple,b=p.value,b!=null?vt(i,!!p.multiple,b,!1):p.defaultValue!=null&&vt(i,!!p.multiple,p.defaultValue,!0);break;default:typeof _.onClick=="function"&&(i.onclick=nc)}switch(d){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Jt(o),null;case 6:if(i&&o.stateNode!=null)jv(i,o,i.memoizedProps,p);else{if(typeof p!="string"&&o.stateNode===null)throw Error(t(166));if(d=Pa(tl.current),Pa(Lr.current),uc(o)){if(p=o.stateNode,d=o.memoizedProps,p[jr]=o,(b=p.nodeValue!==d)&&(i=Rn,i!==null))switch(i.tag){case 3:tc(p.nodeValue,d,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&tc(p.nodeValue,d,(i.mode&1)!==0)}b&&(o.flags|=4)}else p=(d.nodeType===9?d:d.ownerDocument).createTextNode(p),p[jr]=o,o.stateNode=p}return Jt(o),null;case 13:if(rt(at),p=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(st&&On!==null&&o.mode&1&&!(o.flags&128))Db(),bi(),o.flags|=98560,b=!1;else if(b=uc(o),p!==null&&p.dehydrated!==null){if(i===null){if(!b)throw Error(t(318));if(b=o.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(t(317));b[jr]=o}else bi(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;Jt(o),b=!1}else ir!==null&&(Ep(ir),ir=null),b=!0;if(!b)return o.flags&65536?o:null}return o.flags&128?(o.lanes=d,o):(p=p!==null,p!==(i!==null&&i.memoizedState!==null)&&p&&(o.child.flags|=8192,o.mode&1&&(i===null||at.current&1?Et===0&&(Et=3):kp())),o.updateQueue!==null&&(o.flags|=4),Jt(o),null);case 4:return Ei(),hp(i,o),i===null&&Go(o.stateNode.containerInfo),Jt(o),null;case 10:return zh(o.type._context),Jt(o),null;case 17:return gn(o.type)&&sc(),Jt(o),null;case 19:if(rt(at),b=o.memoizedState,b===null)return Jt(o),null;if(p=(o.flags&128)!==0,C=b.rendering,C===null)if(p)il(b,!1);else{if(Et!==0||i!==null&&i.flags&128)for(i=o.child;i!==null;){if(C=mc(i),C!==null){for(o.flags|=128,il(b,!1),p=C.updateQueue,p!==null&&(o.updateQueue=p,o.flags|=4),o.subtreeFlags=0,p=d,d=o.child;d!==null;)b=d,i=p,b.flags&=14680066,C=b.alternate,C===null?(b.childLanes=0,b.lanes=i,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=C.childLanes,b.lanes=C.lanes,b.child=C.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=C.memoizedProps,b.memoizedState=C.memoizedState,b.updateQueue=C.updateQueue,b.type=C.type,i=C.dependencies,b.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),d=d.sibling;return tt(at,at.current&1|2),o.child}i=i.sibling}b.tail!==null&&mt()>Ri&&(o.flags|=128,p=!0,il(b,!1),o.lanes=4194304)}else{if(!p)if(i=mc(C),i!==null){if(o.flags|=128,p=!0,d=i.updateQueue,d!==null&&(o.updateQueue=d,o.flags|=4),il(b,!0),b.tail===null&&b.tailMode==="hidden"&&!C.alternate&&!st)return Jt(o),null}else 2*mt()-b.renderingStartTime>Ri&&d!==1073741824&&(o.flags|=128,p=!0,il(b,!1),o.lanes=4194304);b.isBackwards?(C.sibling=o.child,o.child=C):(d=b.last,d!==null?d.sibling=C:o.child=C,b.last=C)}return b.tail!==null?(o=b.tail,b.rendering=o,b.tail=o.sibling,b.renderingStartTime=mt(),o.sibling=null,d=at.current,tt(at,p?d&1|2:d&1),o):(Jt(o),null);case 22:case 23:return Pp(),p=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==p&&(o.flags|=8192),p&&o.mode&1?Tn&1073741824&&(Jt(o),o.subtreeFlags&6&&(o.flags|=8192)):Jt(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function oO(i,o){switch(jh(o),o.tag){case 1:return gn(o.type)&&sc(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Ei(),rt(mn),rt(Zt),Gh(),i=o.flags,i&65536&&!(i&128)?(o.flags=i&-65537|128,o):null;case 5:return qh(o),null;case 13:if(rt(at),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(t(340));bi()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return rt(at),null;case 4:return Ei(),null;case 10:return zh(o.type._context),null;case 22:case 23:return Pp(),null;case 24:return null;default:return null}}var Ec=!1,Kt=!1,lO=typeof WeakSet=="function"?WeakSet:Set,pe=null;function Pi(i,o){var d=i.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(p){ft(i,o,p)}else d.current=null}function pp(i,o,d){try{d()}catch(p){ft(i,o,p)}}var Lv=!1;function uO(i,o){if(Ph=Wu,i=pb(),_h(i)){if("selectionStart"in i)var d={start:i.selectionStart,end:i.selectionEnd};else e:{d=(d=i.ownerDocument)&&d.defaultView||window;var p=d.getSelection&&d.getSelection();if(p&&p.rangeCount!==0){d=p.anchorNode;var _=p.anchorOffset,b=p.focusNode;p=p.focusOffset;try{d.nodeType,b.nodeType}catch{d=null;break e}var C=0,A=-1,N=-1,H=0,ne=0,re=i,te=null;t:for(;;){for(var fe;re!==d||_!==0&&re.nodeType!==3||(A=C+_),re!==b||p!==0&&re.nodeType!==3||(N=C+p),re.nodeType===3&&(C+=re.nodeValue.length),(fe=re.firstChild)!==null;)te=re,re=fe;for(;;){if(re===i)break t;if(te===d&&++H===_&&(A=C),te===b&&++ne===p&&(N=C),(fe=re.nextSibling)!==null)break;re=te,te=re.parentNode}re=fe}d=A===-1||N===-1?null:{start:A,end:N}}else d=null}d=d||{start:0,end:0}}else d=null;for(kh={focusedElem:i,selectionRange:d},Wu=!1,pe=o;pe!==null;)if(o=pe,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,pe=i;else for(;pe!==null;){o=pe;try{var me=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(me!==null){var ye=me.memoizedProps,gt=me.memoizedState,U=o.stateNode,L=U.getSnapshotBeforeUpdate(o.elementType===o.type?ye:or(o.type,ye),gt);U.__reactInternalSnapshotBeforeUpdate=L}break;case 3:var z=o.stateNode.containerInfo;z.nodeType===1?z.textContent="":z.nodeType===9&&z.documentElement&&z.removeChild(z.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(oe){ft(o,o.return,oe)}if(i=o.sibling,i!==null){i.return=o.return,pe=i;break}pe=o.return}return me=Lv,Lv=!1,me}function ol(i,o,d){var p=o.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var _=p=p.next;do{if((_.tag&i)===i){var b=_.destroy;_.destroy=void 0,b!==void 0&&pp(o,d,b)}_=_.next}while(_!==p)}}function Cc(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var d=o=o.next;do{if((d.tag&i)===i){var p=d.create;d.destroy=p()}d=d.next}while(d!==o)}}function mp(i){var o=i.ref;if(o!==null){var d=i.stateNode;switch(i.tag){case 5:i=d;break;default:i=d}typeof o=="function"?o(i):o.current=i}}function Mv(i){var o=i.alternate;o!==null&&(i.alternate=null,Mv(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[jr],delete o[Ko],delete o[Ah],delete o[VR],delete o[qR])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Dv(i){return i.tag===5||i.tag===3||i.tag===4}function Fv(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Dv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function gp(i,o,d){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?d.nodeType===8?d.parentNode.insertBefore(i,o):d.insertBefore(i,o):(d.nodeType===8?(o=d.parentNode,o.insertBefore(i,d)):(o=d,o.appendChild(i)),d=d._reactRootContainer,d!=null||o.onclick!==null||(o.onclick=nc));else if(p!==4&&(i=i.child,i!==null))for(gp(i,o,d),i=i.sibling;i!==null;)gp(i,o,d),i=i.sibling}function yp(i,o,d){var p=i.tag;if(p===5||p===6)i=i.stateNode,o?d.insertBefore(i,o):d.appendChild(i);else if(p!==4&&(i=i.child,i!==null))for(yp(i,o,d),i=i.sibling;i!==null;)yp(i,o,d),i=i.sibling}var Dt=null,lr=!1;function qs(i,o,d){for(d=d.child;d!==null;)Uv(i,o,d),d=d.sibling}function Uv(i,o,d){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(Du,d)}catch{}switch(d.tag){case 5:Kt||Pi(d,o);case 6:var p=Dt,_=lr;Dt=null,qs(i,o,d),Dt=p,lr=_,Dt!==null&&(lr?(i=Dt,d=d.stateNode,i.nodeType===8?i.parentNode.removeChild(d):i.removeChild(d)):Dt.removeChild(d.stateNode));break;case 18:Dt!==null&&(lr?(i=Dt,d=d.stateNode,i.nodeType===8?Th(i.parentNode,d):i.nodeType===1&&Th(i,d),Fo(i)):Th(Dt,d.stateNode));break;case 4:p=Dt,_=lr,Dt=d.stateNode.containerInfo,lr=!0,qs(i,o,d),Dt=p,lr=_;break;case 0:case 11:case 14:case 15:if(!Kt&&(p=d.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){_=p=p.next;do{var b=_,C=b.destroy;b=b.tag,C!==void 0&&(b&2||b&4)&&pp(d,o,C),_=_.next}while(_!==p)}qs(i,o,d);break;case 1:if(!Kt&&(Pi(d,o),p=d.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=d.memoizedProps,p.state=d.memoizedState,p.componentWillUnmount()}catch(A){ft(d,o,A)}qs(i,o,d);break;case 21:qs(i,o,d);break;case 22:d.mode&1?(Kt=(p=Kt)||d.memoizedState!==null,qs(i,o,d),Kt=p):qs(i,o,d);break;default:qs(i,o,d)}}function zv(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var d=i.stateNode;d===null&&(d=i.stateNode=new lO),o.forEach(function(p){var _=_O.bind(null,i,p);d.has(p)||(d.add(p),p.then(_,_))})}}function ur(i,o){var d=o.deletions;if(d!==null)for(var p=0;p<d.length;p++){var _=d[p];try{var b=i,C=o,A=C;e:for(;A!==null;){switch(A.tag){case 5:Dt=A.stateNode,lr=!1;break e;case 3:Dt=A.stateNode.containerInfo,lr=!0;break e;case 4:Dt=A.stateNode.containerInfo,lr=!0;break e}A=A.return}if(Dt===null)throw Error(t(160));Uv(b,C,_),Dt=null,lr=!1;var N=_.alternate;N!==null&&(N.return=null),_.return=null}catch(H){ft(_,o,H)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Bv(o,i),o=o.sibling}function Bv(i,o){var d=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(ur(o,i),Dr(i),p&4){try{ol(3,i,i.return),Cc(3,i)}catch(ye){ft(i,i.return,ye)}try{ol(5,i,i.return)}catch(ye){ft(i,i.return,ye)}}break;case 1:ur(o,i),Dr(i),p&512&&d!==null&&Pi(d,d.return);break;case 5:if(ur(o,i),Dr(i),p&512&&d!==null&&Pi(d,d.return),i.flags&32){var _=i.stateNode;try{dt(_,"")}catch(ye){ft(i,i.return,ye)}}if(p&4&&(_=i.stateNode,_!=null)){var b=i.memoizedProps,C=d!==null?d.memoizedProps:b,A=i.type,N=i.updateQueue;if(i.updateQueue=null,N!==null)try{A==="input"&&b.type==="radio"&&b.name!=null&&Ot(_,b),Gf(A,C);var H=Gf(A,b);for(C=0;C<N.length;C+=2){var ne=N[C],re=N[C+1];ne==="style"?Bn(_,re):ne==="dangerouslySetInnerHTML"?Is(_,re):ne==="children"?dt(_,re):S(_,ne,re,H)}switch(A){case"input":pt(_,b);break;case"textarea":Mt(_,b);break;case"select":var te=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!b.multiple;var fe=b.value;fe!=null?vt(_,!!b.multiple,fe,!1):te!==!!b.multiple&&(b.defaultValue!=null?vt(_,!!b.multiple,b.defaultValue,!0):vt(_,!!b.multiple,b.multiple?[]:"",!1))}_[Ko]=b}catch(ye){ft(i,i.return,ye)}}break;case 6:if(ur(o,i),Dr(i),p&4){if(i.stateNode===null)throw Error(t(162));_=i.stateNode,b=i.memoizedProps;try{_.nodeValue=b}catch(ye){ft(i,i.return,ye)}}break;case 3:if(ur(o,i),Dr(i),p&4&&d!==null&&d.memoizedState.isDehydrated)try{Fo(o.containerInfo)}catch(ye){ft(i,i.return,ye)}break;case 4:ur(o,i),Dr(i);break;case 13:ur(o,i),Dr(i),_=i.child,_.flags&8192&&(b=_.memoizedState!==null,_.stateNode.isHidden=b,!b||_.alternate!==null&&_.alternate.memoizedState!==null||(bp=mt())),p&4&&zv(i);break;case 22:if(ne=d!==null&&d.memoizedState!==null,i.mode&1?(Kt=(H=Kt)||ne,ur(o,i),Kt=H):ur(o,i),Dr(i),p&8192){if(H=i.memoizedState!==null,(i.stateNode.isHidden=H)&&!ne&&i.mode&1)for(pe=i,ne=i.child;ne!==null;){for(re=pe=ne;pe!==null;){switch(te=pe,fe=te.child,te.tag){case 0:case 11:case 14:case 15:ol(4,te,te.return);break;case 1:Pi(te,te.return);var me=te.stateNode;if(typeof me.componentWillUnmount=="function"){p=te,d=te.return;try{o=p,me.props=o.memoizedProps,me.state=o.memoizedState,me.componentWillUnmount()}catch(ye){ft(p,d,ye)}}break;case 5:Pi(te,te.return);break;case 22:if(te.memoizedState!==null){Vv(re);continue}}fe!==null?(fe.return=te,pe=fe):Vv(re)}ne=ne.sibling}e:for(ne=null,re=i;;){if(re.tag===5){if(ne===null){ne=re;try{_=re.stateNode,H?(b=_.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(A=re.stateNode,N=re.memoizedProps.style,C=N!=null&&N.hasOwnProperty("display")?N.display:null,A.style.display=nn("display",C))}catch(ye){ft(i,i.return,ye)}}}else if(re.tag===6){if(ne===null)try{re.stateNode.nodeValue=H?"":re.memoizedProps}catch(ye){ft(i,i.return,ye)}}else if((re.tag!==22&&re.tag!==23||re.memoizedState===null||re===i)&&re.child!==null){re.child.return=re,re=re.child;continue}if(re===i)break e;for(;re.sibling===null;){if(re.return===null||re.return===i)break e;ne===re&&(ne=null),re=re.return}ne===re&&(ne=null),re.sibling.return=re.return,re=re.sibling}}break;case 19:ur(o,i),Dr(i),p&4&&zv(i);break;case 21:break;default:ur(o,i),Dr(i)}}function Dr(i){var o=i.flags;if(o&2){try{e:{for(var d=i.return;d!==null;){if(Dv(d)){var p=d;break e}d=d.return}throw Error(t(160))}switch(p.tag){case 5:var _=p.stateNode;p.flags&32&&(dt(_,""),p.flags&=-33);var b=Fv(i);yp(i,b,_);break;case 3:case 4:var C=p.stateNode.containerInfo,A=Fv(i);gp(i,A,C);break;default:throw Error(t(161))}}catch(N){ft(i,i.return,N)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function cO(i,o,d){pe=i,Hv(i)}function Hv(i,o,d){for(var p=(i.mode&1)!==0;pe!==null;){var _=pe,b=_.child;if(_.tag===22&&p){var C=_.memoizedState!==null||Ec;if(!C){var A=_.alternate,N=A!==null&&A.memoizedState!==null||Kt;A=Ec;var H=Kt;if(Ec=C,(Kt=N)&&!H)for(pe=_;pe!==null;)C=pe,N=C.child,C.tag===22&&C.memoizedState!==null?qv(_):N!==null?(N.return=C,pe=N):qv(_);for(;b!==null;)pe=b,Hv(b),b=b.sibling;pe=_,Ec=A,Kt=H}Wv(i)}else _.subtreeFlags&8772&&b!==null?(b.return=_,pe=b):Wv(i)}}function Wv(i){for(;pe!==null;){var o=pe;if(o.flags&8772){var d=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:Kt||Cc(5,o);break;case 1:var p=o.stateNode;if(o.flags&4&&!Kt)if(d===null)p.componentDidMount();else{var _=o.elementType===o.type?d.memoizedProps:or(o.type,d.memoizedProps);p.componentDidUpdate(_,d.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var b=o.updateQueue;b!==null&&Vb(o,b,p);break;case 3:var C=o.updateQueue;if(C!==null){if(d=null,o.child!==null)switch(o.child.tag){case 5:d=o.child.stateNode;break;case 1:d=o.child.stateNode}Vb(o,C,d)}break;case 5:var A=o.stateNode;if(d===null&&o.flags&4){d=A;var N=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&d.focus();break;case"img":N.src&&(d.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var H=o.alternate;if(H!==null){var ne=H.memoizedState;if(ne!==null){var re=ne.dehydrated;re!==null&&Fo(re)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Kt||o.flags&512&&mp(o)}catch(te){ft(o,o.return,te)}}if(o===i){pe=null;break}if(d=o.sibling,d!==null){d.return=o.return,pe=d;break}pe=o.return}}function Vv(i){for(;pe!==null;){var o=pe;if(o===i){pe=null;break}var d=o.sibling;if(d!==null){d.return=o.return,pe=d;break}pe=o.return}}function qv(i){for(;pe!==null;){var o=pe;try{switch(o.tag){case 0:case 11:case 15:var d=o.return;try{Cc(4,o)}catch(N){ft(o,d,N)}break;case 1:var p=o.stateNode;if(typeof p.componentDidMount=="function"){var _=o.return;try{p.componentDidMount()}catch(N){ft(o,_,N)}}var b=o.return;try{mp(o)}catch(N){ft(o,b,N)}break;case 5:var C=o.return;try{mp(o)}catch(N){ft(o,C,N)}}}catch(N){ft(o,o.return,N)}if(o===i){pe=null;break}var A=o.sibling;if(A!==null){A.return=o.return,pe=A;break}pe=o.return}}var dO=Math.ceil,Pc=R.ReactCurrentDispatcher,_p=R.ReactCurrentOwner,Zn=R.ReactCurrentBatchConfig,He=0,At=null,wt=null,Ft=0,Tn=0,ki=zs(0),Et=0,ll=null,Ra=0,kc=0,wp=0,ul=null,_n=null,bp=0,Ri=1/0,ys=null,Rc=!1,vp=null,Zs=null,Oc=!1,Gs=null,Tc=0,cl=0,xp=null,Ac=-1,$c=0;function sn(){return He&6?mt():Ac!==-1?Ac:Ac=mt()}function Js(i){return i.mode&1?He&2&&Ft!==0?Ft&-Ft:GR.transition!==null?($c===0&&($c=Fw()),$c):(i=Ge,i!==0||(i=window.event,i=i===void 0?16:Gw(i.type)),i):1}function cr(i,o,d,p){if(50<cl)throw cl=0,xp=null,Error(t(185));No(i,d,p),(!(He&2)||i!==At)&&(i===At&&(!(He&2)&&(kc|=d),Et===4&&Ks(i,Ft)),wn(i,p),d===1&&He===0&&!(o.mode&1)&&(Ri=mt()+500,ic&&Hs()))}function wn(i,o){var d=i.callbackNode;Gk(i,o);var p=zu(i,i===At?Ft:0);if(p===0)d!==null&&Lw(d),i.callbackNode=null,i.callbackPriority=0;else if(o=p&-p,i.callbackPriority!==o){if(d!=null&&Lw(d),o===1)i.tag===0?ZR(Gv.bind(null,i)):Ib(Gv.bind(null,i)),HR(function(){!(He&6)&&Hs()}),d=null;else{switch(Uw(p)){case 1:d=th;break;case 4:d=Mw;break;case 16:d=Mu;break;case 536870912:d=Dw;break;default:d=Mu}d=n0(d,Zv.bind(null,i))}i.callbackPriority=o,i.callbackNode=d}}function Zv(i,o){if(Ac=-1,$c=0,He&6)throw Error(t(327));var d=i.callbackNode;if(Oi()&&i.callbackNode!==d)return null;var p=zu(i,i===At?Ft:0);if(p===0)return null;if(p&30||p&i.expiredLanes||o)o=Ic(i,p);else{o=p;var _=He;He|=2;var b=Kv();(At!==i||Ft!==o)&&(ys=null,Ri=mt()+500,Ta(i,o));do try{pO();break}catch(A){Jv(i,A)}while(!0);Uh(),Pc.current=b,He=_,wt!==null?o=0:(At=null,Ft=0,o=Et)}if(o!==0){if(o===2&&(_=nh(i),_!==0&&(p=_,o=Sp(i,_))),o===1)throw d=ll,Ta(i,0),Ks(i,p),wn(i,mt()),d;if(o===6)Ks(i,p);else{if(_=i.current.alternate,!(p&30)&&!fO(_)&&(o=Ic(i,p),o===2&&(b=nh(i),b!==0&&(p=b,o=Sp(i,b))),o===1))throw d=ll,Ta(i,0),Ks(i,p),wn(i,mt()),d;switch(i.finishedWork=_,i.finishedLanes=p,o){case 0:case 1:throw Error(t(345));case 2:Aa(i,_n,ys);break;case 3:if(Ks(i,p),(p&130023424)===p&&(o=bp+500-mt(),10<o)){if(zu(i,0)!==0)break;if(_=i.suspendedLanes,(_&p)!==p){sn(),i.pingedLanes|=i.suspendedLanes&_;break}i.timeoutHandle=Oh(Aa.bind(null,i,_n,ys),o);break}Aa(i,_n,ys);break;case 4:if(Ks(i,p),(p&4194240)===p)break;for(o=i.eventTimes,_=-1;0<p;){var C=31-sr(p);b=1<<C,C=o[C],C>_&&(_=C),p&=~b}if(p=_,p=mt()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*dO(p/1960))-p,10<p){i.timeoutHandle=Oh(Aa.bind(null,i,_n,ys),p);break}Aa(i,_n,ys);break;case 5:Aa(i,_n,ys);break;default:throw Error(t(329))}}}return wn(i,mt()),i.callbackNode===d?Zv.bind(null,i):null}function Sp(i,o){var d=ul;return i.current.memoizedState.isDehydrated&&(Ta(i,o).flags|=256),i=Ic(i,o),i!==2&&(o=_n,_n=d,o!==null&&Ep(o)),i}function Ep(i){_n===null?_n=i:_n.push.apply(_n,i)}function fO(i){for(var o=i;;){if(o.flags&16384){var d=o.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var p=0;p<d.length;p++){var _=d[p],b=_.getSnapshot;_=_.value;try{if(!ar(b(),_))return!1}catch{return!1}}}if(d=o.child,o.subtreeFlags&16384&&d!==null)d.return=o,o=d;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ks(i,o){for(o&=~wp,o&=~kc,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var d=31-sr(o),p=1<<d;i[d]=-1,o&=~p}}function Gv(i){if(He&6)throw Error(t(327));Oi();var o=zu(i,0);if(!(o&1))return wn(i,mt()),null;var d=Ic(i,o);if(i.tag!==0&&d===2){var p=nh(i);p!==0&&(o=p,d=Sp(i,p))}if(d===1)throw d=ll,Ta(i,0),Ks(i,o),wn(i,mt()),d;if(d===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,Aa(i,_n,ys),wn(i,mt()),null}function Cp(i,o){var d=He;He|=1;try{return i(o)}finally{He=d,He===0&&(Ri=mt()+500,ic&&Hs())}}function Oa(i){Gs!==null&&Gs.tag===0&&!(He&6)&&Oi();var o=He;He|=1;var d=Zn.transition,p=Ge;try{if(Zn.transition=null,Ge=1,i)return i()}finally{Ge=p,Zn.transition=d,He=o,!(He&6)&&Hs()}}function Pp(){Tn=ki.current,rt(ki)}function Ta(i,o){i.finishedWork=null,i.finishedLanes=0;var d=i.timeoutHandle;if(d!==-1&&(i.timeoutHandle=-1,BR(d)),wt!==null)for(d=wt.return;d!==null;){var p=d;switch(jh(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&sc();break;case 3:Ei(),rt(mn),rt(Zt),Gh();break;case 5:qh(p);break;case 4:Ei();break;case 13:rt(at);break;case 19:rt(at);break;case 10:zh(p.type._context);break;case 22:case 23:Pp()}d=d.return}if(At=i,wt=i=Xs(i.current,null),Ft=Tn=o,Et=0,ll=null,wp=kc=Ra=0,_n=ul=null,Ca!==null){for(o=0;o<Ca.length;o++)if(d=Ca[o],p=d.interleaved,p!==null){d.interleaved=null;var _=p.next,b=d.pending;if(b!==null){var C=b.next;b.next=_,p.next=C}d.pending=p}Ca=null}return i}function Jv(i,o){do{var d=wt;try{if(Uh(),gc.current=bc,yc){for(var p=it.memoizedState;p!==null;){var _=p.queue;_!==null&&(_.pending=null),p=p.next}yc=!1}if(ka=0,Tt=St=it=null,nl=!1,rl=0,_p.current=null,d===null||d.return===null){Et=1,ll=o,wt=null;break}e:{var b=i,C=d.return,A=d,N=o;if(o=Ft,A.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var H=N,ne=A,re=ne.tag;if(!(ne.mode&1)&&(re===0||re===11||re===15)){var te=ne.alternate;te?(ne.updateQueue=te.updateQueue,ne.memoizedState=te.memoizedState,ne.lanes=te.lanes):(ne.updateQueue=null,ne.memoizedState=null)}var fe=bv(C);if(fe!==null){fe.flags&=-257,vv(fe,C,A,b,o),fe.mode&1&&wv(b,H,o),o=fe,N=H;var me=o.updateQueue;if(me===null){var ye=new Set;ye.add(N),o.updateQueue=ye}else me.add(N);break e}else{if(!(o&1)){wv(b,H,o),kp();break e}N=Error(t(426))}}else if(st&&A.mode&1){var gt=bv(C);if(gt!==null){!(gt.flags&65536)&&(gt.flags|=256),vv(gt,C,A,b,o),Dh(Ci(N,A));break e}}b=N=Ci(N,A),Et!==4&&(Et=2),ul===null?ul=[b]:ul.push(b),b=C;do{switch(b.tag){case 3:b.flags|=65536,o&=-o,b.lanes|=o;var U=yv(b,N,o);Wb(b,U);break e;case 1:A=N;var L=b.type,z=b.stateNode;if(!(b.flags&128)&&(typeof L.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(Zs===null||!Zs.has(z)))){b.flags|=65536,o&=-o,b.lanes|=o;var oe=_v(b,A,o);Wb(b,oe);break e}}b=b.return}while(b!==null)}Yv(d)}catch(_e){o=_e,wt===d&&d!==null&&(wt=d=d.return);continue}break}while(!0)}function Kv(){var i=Pc.current;return Pc.current=bc,i===null?bc:i}function kp(){(Et===0||Et===3||Et===2)&&(Et=4),At===null||!(Ra&268435455)&&!(kc&268435455)||Ks(At,Ft)}function Ic(i,o){var d=He;He|=2;var p=Kv();(At!==i||Ft!==o)&&(ys=null,Ta(i,o));do try{hO();break}catch(_){Jv(i,_)}while(!0);if(Uh(),He=d,Pc.current=p,wt!==null)throw Error(t(261));return At=null,Ft=0,Et}function hO(){for(;wt!==null;)Xv(wt)}function pO(){for(;wt!==null&&!Fk();)Xv(wt)}function Xv(i){var o=t0(i.alternate,i,Tn);i.memoizedProps=i.pendingProps,o===null?Yv(i):wt=o,_p.current=null}function Yv(i){var o=i;do{var d=o.alternate;if(i=o.return,o.flags&32768){if(d=oO(d,o),d!==null){d.flags&=32767,wt=d;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Et=6,wt=null;return}}else if(d=iO(d,o,Tn),d!==null){wt=d;return}if(o=o.sibling,o!==null){wt=o;return}wt=o=i}while(o!==null);Et===0&&(Et=5)}function Aa(i,o,d){var p=Ge,_=Zn.transition;try{Zn.transition=null,Ge=1,mO(i,o,d,p)}finally{Zn.transition=_,Ge=p}return null}function mO(i,o,d,p){do Oi();while(Gs!==null);if(He&6)throw Error(t(327));d=i.finishedWork;var _=i.finishedLanes;if(d===null)return null;if(i.finishedWork=null,i.finishedLanes=0,d===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var b=d.lanes|d.childLanes;if(Jk(i,b),i===At&&(wt=At=null,Ft=0),!(d.subtreeFlags&2064)&&!(d.flags&2064)||Oc||(Oc=!0,n0(Mu,function(){return Oi(),null})),b=(d.flags&15990)!==0,d.subtreeFlags&15990||b){b=Zn.transition,Zn.transition=null;var C=Ge;Ge=1;var A=He;He|=4,_p.current=null,uO(i,d),Bv(d,i),jR(kh),Wu=!!Ph,kh=Ph=null,i.current=d,cO(d),Uk(),He=A,Ge=C,Zn.transition=b}else i.current=d;if(Oc&&(Oc=!1,Gs=i,Tc=_),b=i.pendingLanes,b===0&&(Zs=null),Hk(d.stateNode),wn(i,mt()),o!==null)for(p=i.onRecoverableError,d=0;d<o.length;d++)_=o[d],p(_.value,{componentStack:_.stack,digest:_.digest});if(Rc)throw Rc=!1,i=vp,vp=null,i;return Tc&1&&i.tag!==0&&Oi(),b=i.pendingLanes,b&1?i===xp?cl++:(cl=0,xp=i):cl=0,Hs(),null}function Oi(){if(Gs!==null){var i=Uw(Tc),o=Zn.transition,d=Ge;try{if(Zn.transition=null,Ge=16>i?16:i,Gs===null)var p=!1;else{if(i=Gs,Gs=null,Tc=0,He&6)throw Error(t(331));var _=He;for(He|=4,pe=i.current;pe!==null;){var b=pe,C=b.child;if(pe.flags&16){var A=b.deletions;if(A!==null){for(var N=0;N<A.length;N++){var H=A[N];for(pe=H;pe!==null;){var ne=pe;switch(ne.tag){case 0:case 11:case 15:ol(8,ne,b)}var re=ne.child;if(re!==null)re.return=ne,pe=re;else for(;pe!==null;){ne=pe;var te=ne.sibling,fe=ne.return;if(Mv(ne),ne===H){pe=null;break}if(te!==null){te.return=fe,pe=te;break}pe=fe}}}var me=b.alternate;if(me!==null){var ye=me.child;if(ye!==null){me.child=null;do{var gt=ye.sibling;ye.sibling=null,ye=gt}while(ye!==null)}}pe=b}}if(b.subtreeFlags&2064&&C!==null)C.return=b,pe=C;else e:for(;pe!==null;){if(b=pe,b.flags&2048)switch(b.tag){case 0:case 11:case 15:ol(9,b,b.return)}var U=b.sibling;if(U!==null){U.return=b.return,pe=U;break e}pe=b.return}}var L=i.current;for(pe=L;pe!==null;){C=pe;var z=C.child;if(C.subtreeFlags&2064&&z!==null)z.return=C,pe=z;else e:for(C=L;pe!==null;){if(A=pe,A.flags&2048)try{switch(A.tag){case 0:case 11:case 15:Cc(9,A)}}catch(_e){ft(A,A.return,_e)}if(A===C){pe=null;break e}var oe=A.sibling;if(oe!==null){oe.return=A.return,pe=oe;break e}pe=A.return}}if(He=_,Hs(),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(Du,i)}catch{}p=!0}return p}finally{Ge=d,Zn.transition=o}}return!1}function Qv(i,o,d){o=Ci(d,o),o=yv(i,o,1),i=Vs(i,o,1),o=sn(),i!==null&&(No(i,1,o),wn(i,o))}function ft(i,o,d){if(i.tag===3)Qv(i,i,d);else for(;o!==null;){if(o.tag===3){Qv(o,i,d);break}else if(o.tag===1){var p=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Zs===null||!Zs.has(p))){i=Ci(d,i),i=_v(o,i,1),o=Vs(o,i,1),i=sn(),o!==null&&(No(o,1,i),wn(o,i));break}}o=o.return}}function gO(i,o,d){var p=i.pingCache;p!==null&&p.delete(o),o=sn(),i.pingedLanes|=i.suspendedLanes&d,At===i&&(Ft&d)===d&&(Et===4||Et===3&&(Ft&130023424)===Ft&&500>mt()-bp?Ta(i,0):wp|=d),wn(i,o)}function e0(i,o){o===0&&(i.mode&1?(o=Uu,Uu<<=1,!(Uu&130023424)&&(Uu=4194304)):o=1);var d=sn();i=ps(i,o),i!==null&&(No(i,o,d),wn(i,d))}function yO(i){var o=i.memoizedState,d=0;o!==null&&(d=o.retryLane),e0(i,d)}function _O(i,o){var d=0;switch(i.tag){case 13:var p=i.stateNode,_=i.memoizedState;_!==null&&(d=_.retryLane);break;case 19:p=i.stateNode;break;default:throw Error(t(314))}p!==null&&p.delete(o),e0(i,d)}var t0;t0=function(i,o,d){if(i!==null)if(i.memoizedProps!==o.pendingProps||mn.current)yn=!0;else{if(!(i.lanes&d)&&!(o.flags&128))return yn=!1,aO(i,o,d);yn=!!(i.flags&131072)}else yn=!1,st&&o.flags&1048576&&Nb(o,lc,o.index);switch(o.lanes=0,o.tag){case 2:var p=o.type;Sc(i,o),i=o.pendingProps;var _=yi(o,Zt.current);Si(o,d),_=Xh(null,o,p,i,_,d);var b=Yh();return o.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,gn(p)?(b=!0,ac(o)):b=!1,o.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Wh(o),_.updater=vc,o.stateNode=_,_._reactInternals=o,sp(o,p,i,d),o=lp(null,o,p,!0,b,d)):(o.tag=0,st&&b&&Nh(o),rn(null,o,_,d),o=o.child),o;case 16:p=o.elementType;e:{switch(Sc(i,o),i=o.pendingProps,_=p._init,p=_(p._payload),o.type=p,_=o.tag=bO(p),i=or(p,i),_){case 0:o=op(null,o,p,i,d);break e;case 1:o=kv(null,o,p,i,d);break e;case 11:o=xv(null,o,p,i,d);break e;case 14:o=Sv(null,o,p,or(p.type,i),d);break e}throw Error(t(306,p,""))}return o;case 0:return p=o.type,_=o.pendingProps,_=o.elementType===p?_:or(p,_),op(i,o,p,_,d);case 1:return p=o.type,_=o.pendingProps,_=o.elementType===p?_:or(p,_),kv(i,o,p,_,d);case 3:e:{if(Rv(o),i===null)throw Error(t(387));p=o.pendingProps,b=o.memoizedState,_=b.element,Hb(i,o),pc(o,p,null,d);var C=o.memoizedState;if(p=C.element,b.isDehydrated)if(b={element:p,isDehydrated:!1,cache:C.cache,pendingSuspenseBoundaries:C.pendingSuspenseBoundaries,transitions:C.transitions},o.updateQueue.baseState=b,o.memoizedState=b,o.flags&256){_=Ci(Error(t(423)),o),o=Ov(i,o,p,d,_);break e}else if(p!==_){_=Ci(Error(t(424)),o),o=Ov(i,o,p,d,_);break e}else for(On=Us(o.stateNode.containerInfo.firstChild),Rn=o,st=!0,ir=null,d=zb(o,null,p,d),o.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(bi(),p===_){o=gs(i,o,d);break e}rn(i,o,p,d)}o=o.child}return o;case 5:return qb(o),i===null&&Mh(o),p=o.type,_=o.pendingProps,b=i!==null?i.memoizedProps:null,C=_.children,Rh(p,_)?C=null:b!==null&&Rh(p,b)&&(o.flags|=32),Pv(i,o),rn(i,o,C,d),o.child;case 6:return i===null&&Mh(o),null;case 13:return Tv(i,o,d);case 4:return Vh(o,o.stateNode.containerInfo),p=o.pendingProps,i===null?o.child=vi(o,null,p,d):rn(i,o,p,d),o.child;case 11:return p=o.type,_=o.pendingProps,_=o.elementType===p?_:or(p,_),xv(i,o,p,_,d);case 7:return rn(i,o,o.pendingProps,d),o.child;case 8:return rn(i,o,o.pendingProps.children,d),o.child;case 12:return rn(i,o,o.pendingProps.children,d),o.child;case 10:e:{if(p=o.type._context,_=o.pendingProps,b=o.memoizedProps,C=_.value,tt(dc,p._currentValue),p._currentValue=C,b!==null)if(ar(b.value,C)){if(b.children===_.children&&!mn.current){o=gs(i,o,d);break e}}else for(b=o.child,b!==null&&(b.return=o);b!==null;){var A=b.dependencies;if(A!==null){C=b.child;for(var N=A.firstContext;N!==null;){if(N.context===p){if(b.tag===1){N=ms(-1,d&-d),N.tag=2;var H=b.updateQueue;if(H!==null){H=H.shared;var ne=H.pending;ne===null?N.next=N:(N.next=ne.next,ne.next=N),H.pending=N}}b.lanes|=d,N=b.alternate,N!==null&&(N.lanes|=d),Bh(b.return,d,o),A.lanes|=d;break}N=N.next}}else if(b.tag===10)C=b.type===o.type?null:b.child;else if(b.tag===18){if(C=b.return,C===null)throw Error(t(341));C.lanes|=d,A=C.alternate,A!==null&&(A.lanes|=d),Bh(C,d,o),C=b.sibling}else C=b.child;if(C!==null)C.return=b;else for(C=b;C!==null;){if(C===o){C=null;break}if(b=C.sibling,b!==null){b.return=C.return,C=b;break}C=C.return}b=C}rn(i,o,_.children,d),o=o.child}return o;case 9:return _=o.type,p=o.pendingProps.children,Si(o,d),_=Vn(_),p=p(_),o.flags|=1,rn(i,o,p,d),o.child;case 14:return p=o.type,_=or(p,o.pendingProps),_=or(p.type,_),Sv(i,o,p,_,d);case 15:return Ev(i,o,o.type,o.pendingProps,d);case 17:return p=o.type,_=o.pendingProps,_=o.elementType===p?_:or(p,_),Sc(i,o),o.tag=1,gn(p)?(i=!0,ac(o)):i=!1,Si(o,d),mv(o,p,_),sp(o,p,_,d),lp(null,o,p,!0,i,d);case 19:return $v(i,o,d);case 22:return Cv(i,o,d)}throw Error(t(156,o.tag))};function n0(i,o){return jw(i,o)}function wO(i,o,d,p){this.tag=i,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Gn(i,o,d,p){return new wO(i,o,d,p)}function Rp(i){return i=i.prototype,!(!i||!i.isReactComponent)}function bO(i){if(typeof i=="function")return Rp(i)?1:0;if(i!=null){if(i=i.$$typeof,i===de)return 11;if(i===G)return 14}return 2}function Xs(i,o){var d=i.alternate;return d===null?(d=Gn(i.tag,o,i.key,i.mode),d.elementType=i.elementType,d.type=i.type,d.stateNode=i.stateNode,d.alternate=i,i.alternate=d):(d.pendingProps=o,d.type=i.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=i.flags&14680064,d.childLanes=i.childLanes,d.lanes=i.lanes,d.child=i.child,d.memoizedProps=i.memoizedProps,d.memoizedState=i.memoizedState,d.updateQueue=i.updateQueue,o=i.dependencies,d.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},d.sibling=i.sibling,d.index=i.index,d.ref=i.ref,d}function Nc(i,o,d,p,_,b){var C=2;if(p=i,typeof i=="function")Rp(i)&&(C=1);else if(typeof i=="string")C=5;else e:switch(i){case D:return $a(d.children,_,b,o);case F:C=8,_|=8;break;case K:return i=Gn(12,d,o,_|2),i.elementType=K,i.lanes=b,i;case ue:return i=Gn(13,d,o,_),i.elementType=ue,i.lanes=b,i;case V:return i=Gn(19,d,o,_),i.elementType=V,i.lanes=b,i;case J:return jc(d,_,b,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case Y:C=10;break e;case ie:C=9;break e;case de:C=11;break e;case G:C=14;break e;case q:C=16,p=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return o=Gn(C,d,o,_),o.elementType=i,o.type=p,o.lanes=b,o}function $a(i,o,d,p){return i=Gn(7,i,p,o),i.lanes=d,i}function jc(i,o,d,p){return i=Gn(22,i,p,o),i.elementType=J,i.lanes=d,i.stateNode={isHidden:!1},i}function Op(i,o,d){return i=Gn(6,i,null,o),i.lanes=d,i}function Tp(i,o,d){return o=Gn(4,i.children!==null?i.children:[],i.key,o),o.lanes=d,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function vO(i,o,d,p,_){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rh(0),this.expirationTimes=rh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rh(0),this.identifierPrefix=p,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Ap(i,o,d,p,_,b,C,A,N){return i=new vO(i,o,d,A,N),o===1?(o=1,b===!0&&(o|=8)):o=0,b=Gn(3,null,null,o),i.current=b,b.stateNode=i,b.memoizedState={element:p,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Wh(b),i}function xO(i,o,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:I,key:p==null?null:""+p,children:i,containerInfo:o,implementation:d}}function r0(i){if(!i)return Bs;i=i._reactInternals;e:{if(ba(i)!==i||i.tag!==1)throw Error(t(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(gn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(i.tag===1){var d=i.type;if(gn(d))return Ab(i,d,o)}return o}function s0(i,o,d,p,_,b,C,A,N){return i=Ap(d,p,!0,i,_,b,C,A,N),i.context=r0(null),d=i.current,p=sn(),_=Js(d),b=ms(p,_),b.callback=o??null,Vs(d,b,_),i.current.lanes=_,No(i,_,p),wn(i,p),i}function Lc(i,o,d,p){var _=o.current,b=sn(),C=Js(_);return d=r0(d),o.context===null?o.context=d:o.pendingContext=d,o=ms(b,C),o.payload={element:i},p=p===void 0?null:p,p!==null&&(o.callback=p),i=Vs(_,o,C),i!==null&&(cr(i,_,C,b),hc(i,_,C)),C}function Mc(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function a0(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var d=i.retryLane;i.retryLane=d!==0&&d<o?d:o}}function $p(i,o){a0(i,o),(i=i.alternate)&&a0(i,o)}function SO(){return null}var i0=typeof reportError=="function"?reportError:function(i){console.error(i)};function Ip(i){this._internalRoot=i}Dc.prototype.render=Ip.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(t(409));Lc(i,o,null,null)},Dc.prototype.unmount=Ip.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Oa(function(){Lc(null,i,null,null)}),o[cs]=null}};function Dc(i){this._internalRoot=i}Dc.prototype.unstable_scheduleHydration=function(i){if(i){var o=Hw();i={blockedOn:null,target:i,priority:o};for(var d=0;d<Ms.length&&o!==0&&o<Ms[d].priority;d++);Ms.splice(d,0,i),d===0&&qw(i)}};function Np(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Fc(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function o0(){}function EO(i,o,d,p,_){if(_){if(typeof p=="function"){var b=p;p=function(){var H=Mc(C);b.call(H)}}var C=s0(o,p,i,0,null,!1,!1,"",o0);return i._reactRootContainer=C,i[cs]=C.current,Go(i.nodeType===8?i.parentNode:i),Oa(),C}for(;_=i.lastChild;)i.removeChild(_);if(typeof p=="function"){var A=p;p=function(){var H=Mc(N);A.call(H)}}var N=Ap(i,0,!1,null,null,!1,!1,"",o0);return i._reactRootContainer=N,i[cs]=N.current,Go(i.nodeType===8?i.parentNode:i),Oa(function(){Lc(o,N,d,p)}),N}function Uc(i,o,d,p,_){var b=d._reactRootContainer;if(b){var C=b;if(typeof _=="function"){var A=_;_=function(){var N=Mc(C);A.call(N)}}Lc(o,C,i,_)}else C=EO(d,o,i,_,p);return Mc(C)}zw=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var d=Io(o.pendingLanes);d!==0&&(sh(o,d|1),wn(o,mt()),!(He&6)&&(Ri=mt()+500,Hs()))}break;case 13:Oa(function(){var p=ps(i,1);if(p!==null){var _=sn();cr(p,i,1,_)}}),$p(i,1)}},ah=function(i){if(i.tag===13){var o=ps(i,134217728);if(o!==null){var d=sn();cr(o,i,134217728,d)}$p(i,134217728)}},Bw=function(i){if(i.tag===13){var o=Js(i),d=ps(i,o);if(d!==null){var p=sn();cr(d,i,o,p)}$p(i,o)}},Hw=function(){return Ge},Ww=function(i,o){var d=Ge;try{return Ge=i,o()}finally{Ge=d}},Xf=function(i,o,d){switch(o){case"input":if(pt(i,d),o=d.name,d.type==="radio"&&o!=null){for(d=i;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<d.length;o++){var p=d[o];if(p!==i&&p.form===i.form){var _=rc(p);if(!_)throw Error(t(90));qt(p),pt(p,_)}}}break;case"textarea":Mt(i,d);break;case"select":o=d.value,o!=null&&vt(i,!!d.multiple,o,!1)}},Rw=Cp,Ow=Oa;var CO={usingClientEntryPoint:!1,Events:[Xo,mi,rc,Pw,kw,Cp]},dl={findFiberByHostInstance:va,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},PO={bundleType:dl.bundleType,version:dl.version,rendererPackageName:dl.rendererPackageName,rendererConfig:dl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Iw(i),i===null?null:i.stateNode},findFiberByHostInstance:dl.findFiberByHostInstance||SO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zc.isDisabled&&zc.supportsFiber)try{Du=zc.inject(PO),Nr=zc}catch{}}return bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=CO,bn.createPortal=function(i,o){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Np(o))throw Error(t(200));return xO(i,o,null,d)},bn.createRoot=function(i,o){if(!Np(i))throw Error(t(299));var d=!1,p="",_=i0;return o!=null&&(o.unstable_strictMode===!0&&(d=!0),o.identifierPrefix!==void 0&&(p=o.identifierPrefix),o.onRecoverableError!==void 0&&(_=o.onRecoverableError)),o=Ap(i,1,!1,null,null,d,!1,p,_),i[cs]=o.current,Go(i.nodeType===8?i.parentNode:i),new Ip(o)},bn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=Iw(o),i=i===null?null:i.stateNode,i},bn.flushSync=function(i){return Oa(i)},bn.hydrate=function(i,o,d){if(!Fc(o))throw Error(t(200));return Uc(null,i,o,!0,d)},bn.hydrateRoot=function(i,o,d){if(!Np(i))throw Error(t(405));var p=d!=null&&d.hydratedSources||null,_=!1,b="",C=i0;if(d!=null&&(d.unstable_strictMode===!0&&(_=!0),d.identifierPrefix!==void 0&&(b=d.identifierPrefix),d.onRecoverableError!==void 0&&(C=d.onRecoverableError)),o=s0(o,null,i,1,d??null,_,!1,b,C),i[cs]=o.current,Go(i),p)for(i=0;i<p.length;i++)d=p[i],_=d._getVersion,_=_(d._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[d,_]:o.mutableSourceEagerHydrationData.push(d,_);return new Dc(o)},bn.render=function(i,o,d){if(!Fc(o))throw Error(t(200));return Uc(null,i,o,!1,d)},bn.unmountComponentAtNode=function(i){if(!Fc(i))throw Error(t(40));return i._reactRootContainer?(Oa(function(){Uc(null,null,i,!1,function(){i._reactRootContainer=null,i[cs]=null})}),!0):!1},bn.unstable_batchedUpdates=Cp,bn.unstable_renderSubtreeIntoContainer=function(i,o,d,p){if(!Fc(d))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return Uc(i,o,d,!1,p)},bn.version="18.3.1-next-f1338f8080-20240426",bn}var m0;function T1(){if(m0)return Mp.exports;m0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Mp.exports=MO(),Mp.exports}var g0;function DO(){if(g0)return Bc;g0=1;var n=T1();return Bc.createRoot=n.createRoot,Bc.hydrateRoot=n.hydrateRoot,Bc}var FO=DO();function qr(n){return Object.keys(n)}function Up(n){return n&&typeof n=="object"&&!Array.isArray(n)}function vy(n,e){const t={...n},r=e;return Up(n)&&Up(e)&&Object.keys(e).forEach(s=>{Up(r[s])&&s in n?t[s]=vy(t[s],r[s]):t[s]=r[s]}),t}function UO(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}function zO(n){var e;return typeof n!="string"||!n.includes("var(--mantine-scale)")?n:(e=n.match(/^calc\((.*?)\)$/))==null?void 0:e[1].split("*")[0].trim()}function BO(n){const e=zO(n);return typeof e=="number"?e:typeof e=="string"?e.includes("calc")||e.includes("var")?e:e.includes("px")?Number(e.replace("px","")):e.includes("rem")?Number(e.replace("rem",""))*16:e.includes("em")?Number(e.replace("em",""))*16:Number(e):NaN}function zp(n){return n==="0rem"?"0rem":`calc(${n} * var(--mantine-scale))`}function A1(n,{shouldScale:e=!1}={}){function t(r){if(r===0||r==="0")return`0${n}`;if(typeof r=="number"){const s=`${r/16}${n}`;return e?zp(s):s}if(typeof r=="string"){if(r===""||r.startsWith("calc(")||r.startsWith("clamp(")||r.includes("rgba("))return r;if(r.includes(","))return r.split(",").map(a=>t(a)).join(",");if(r.includes(" "))return r.split(" ").map(a=>t(a)).join(" ");if(r.includes(n))return e?zp(r):r;const s=r.replace("px","");if(!Number.isNaN(Number(s))){const a=`${Number(s)/16}${n}`;return e?zp(a):a}}return r}return t}const ee=A1("rem",{shouldScale:!0}),y0=A1("em");function tf(n){return Object.keys(n).reduce((e,t)=>(n[t]!==void 0&&(e[t]=n[t]),e),{})}function $1(n){if(typeof n=="number")return!0;if(typeof n=="string"){if(n.startsWith("calc(")||n.startsWith("var(")||n.includes(" ")&&n.trim()!=="")return!0;const e=/^[+-]?[0-9]+(\.[0-9]+)?(px|em|rem|ex|ch|lh|rlh|vw|vh|vmin|vmax|vb|vi|svw|svh|lvw|lvh|dvw|dvh|cm|mm|in|pt|pc|q|cqw|cqh|cqi|cqb|cqmin|cqmax|%)?$/;return n.trim().split(/\s+/).every(r=>e.test(r))}return!1}function cu(n){return Array.isArray(n)||n===null?!1:typeof n=="object"?n.type!==k.Fragment:!1}function ni(n){const e=k.createContext(null);return[({children:s,value:a})=>O.jsx(e.Provider,{value:a,children:s}),()=>{const s=k.useContext(e);if(s===null)throw new Error(n);return s}]}function I1(n=null){const e=k.createContext(n);return[({children:s,value:a})=>O.jsx(e.Provider,{value:a,children:s}),()=>k.useContext(e)]}function _0(n,e){return t=>{if(typeof t!="string"||t.trim().length===0)throw new Error(e);return`${n}-${t}`}}function Rg(n,e){let t=n;for(;(t=t.parentElement)&&!t.matches(e););return t}function HO(n,e,t){for(let r=n-1;r>=0;r-=1)if(!e[r].disabled)return r;if(t){for(let r=e.length-1;r>-1;r-=1)if(!e[r].disabled)return r}return n}function WO(n,e,t){for(let r=n+1;r<e.length;r+=1)if(!e[r].disabled)return r;if(t){for(let r=0;r<e.length;r+=1)if(!e[r].disabled)return r}return n}function VO(n,e,t){return Rg(n,t)===Rg(e,t)}function qO({parentSelector:n,siblingSelector:e,onKeyDown:t,loop:r=!0,activateOnFocus:s=!1,dir:a="rtl",orientation:l}){return u=>{var g;t==null||t(u);const c=Array.from(((g=Rg(u.currentTarget,n))==null?void 0:g.querySelectorAll(e))||[]).filter(y=>VO(u.currentTarget,y,n)),f=c.findIndex(y=>u.currentTarget===y),h=WO(f,c,r),m=HO(f,c,r);switch(u.key){case"ArrowRight":break;case"ArrowLeft":break;case"ArrowUp":{u.stopPropagation(),u.preventDefault(),c[m].focus(),s&&c[m].click();break}case"ArrowDown":{u.stopPropagation(),u.preventDefault(),c[h].focus(),s&&c[h].click();break}case"Home":{u.stopPropagation(),u.preventDefault(),!c[0].disabled&&c[0].focus();break}case"End":{u.stopPropagation(),u.preventDefault();const y=c.length-1;!c[y].disabled&&c[y].focus();break}}}}const ZO={app:100,modal:200,popover:300,overlay:400,max:9999};function N1(n){return ZO[n]}const GO=()=>{};function JO(n,e={active:!0}){return typeof n!="function"||!e.active?e.onKeyDown||GO:t=>{var r;t.key==="Escape"&&(n(t),(r=e.onTrigger)==null||r.call(e))}}function _t(n,e="size",t=!0){if(n!==void 0)return $1(n)?t?ee(n):n:`var(--${e}-${n})`}function j1(n){return _t(n,"mantine-spacing")}function rs(n){return n===void 0?"var(--mantine-radius-default)":_t(n,"mantine-radius")}function dn(n){return _t(n,"mantine-font-size")}function KO(n){return _t(n,"mantine-line-height",!1)}function L1(n){if(n)return _t(n,"mantine-shadow",!1)}function XO(n="mantine-"){return`${n}${Math.random().toString(36).slice(2,11)}`}function ja(n){const e=k.useRef(n);return k.useEffect(()=>{e.current=n}),k.useMemo(()=>(...t)=>{var r;return(r=e.current)==null?void 0:r.call(e,...t)},[])}const YO=()=>{};function nf(n,e){const t=typeof e=="number"?e:e.delay,r=typeof e=="number"?!1:e.flushOnUnmount,s=ja(n),a=k.useRef(0),l=Object.assign(k.useCallback((...u)=>{window.clearTimeout(a.current);const c=()=>{a.current!==0&&(a.current=0,s(...u))};l.flush=c,a.current=window.setTimeout(c,t)},[s,t]),{flush:YO});return k.useEffect(()=>()=>{window.clearTimeout(a.current),r&&l.flush()},[l,r]),l}const w0=["mousedown","touchstart"];function QO(n,e,t){const r=k.useRef(null);return k.useEffect(()=>{const s=a=>{const{target:l}=a??{};if(Array.isArray(t)){const u=(l==null?void 0:l.hasAttribute("data-ignore-outside-clicks"))||!document.body.contains(l)&&l.tagName!=="HTML";t.every(f=>!!f&&!a.composedPath().includes(f))&&!u&&n()}else r.current&&!r.current.contains(l)&&n()};return(e||w0).forEach(a=>document.addEventListener(a,s)),()=>{(e||w0).forEach(a=>document.removeEventListener(a,s))}},[r,n,t]),r}function eT(n,e){try{return n.addEventListener("change",e),()=>n.removeEventListener("change",e)}catch{return n.addListener(e),()=>n.removeListener(e)}}function tT(n,e){return typeof window<"u"&&"matchMedia"in window?window.matchMedia(n).matches:!1}function nT(n,e,{getInitialValueInEffect:t}={getInitialValueInEffect:!0}){const[r,s]=k.useState(t?e:tT(n)),a=k.useRef(null);return k.useEffect(()=>{if("matchMedia"in window)return a.current=window.matchMedia(n),s(a.current.matches),eT(a.current,l=>s(l.matches))},[n]),r}const du=typeof document<"u"?k.useLayoutEffect:k.useEffect;function Wa(n,e){const t=k.useRef(!1);k.useEffect(()=>()=>{t.current=!1},[]),k.useEffect(()=>{if(t.current)return n();t.current=!0},e)}function rT({opened:n,shouldReturnFocus:e=!0}){const t=k.useRef(null),r=()=>{var s;t.current&&"focus"in t.current&&typeof t.current.focus=="function"&&((s=t.current)==null||s.focus({preventScroll:!0}))};return Wa(()=>{let s=-1;const a=l=>{l.key==="Tab"&&window.clearTimeout(s)};return document.addEventListener("keydown",a),n?t.current=document.activeElement:e&&(s=window.setTimeout(r,10)),()=>{window.clearTimeout(s),document.removeEventListener("keydown",a)}},[n,e]),r}const sT=/input|select|textarea|button|object/,M1="a, input, select, textarea, button, object, [tabindex]";function aT(n){return n.style.display==="none"}function iT(n){if(n.getAttribute("aria-hidden")||n.getAttribute("hidden")||n.getAttribute("type")==="hidden")return!1;let t=n;for(;t&&!(t===document.body||t.nodeType===11);){if(aT(t))return!1;t=t.parentNode}return!0}function D1(n){let e=n.getAttribute("tabindex");return e===null&&(e=void 0),parseInt(e,10)}function Og(n){const e=n.nodeName.toLowerCase(),t=!Number.isNaN(D1(n));return(sT.test(e)&&!n.disabled||n instanceof HTMLAnchorElement&&n.href||t)&&iT(n)}function F1(n){const e=D1(n);return(Number.isNaN(e)||e>=0)&&Og(n)}function oT(n){return Array.from(n.querySelectorAll(M1)).filter(F1)}function lT(n,e){const t=oT(n);if(!t.length){e.preventDefault();return}const r=t[e.shiftKey?0:t.length-1],s=n.getRootNode();let a=r===s.activeElement||n===s.activeElement;const l=s.activeElement;if(l.tagName==="INPUT"&&l.getAttribute("type")==="radio"&&(a=t.filter(h=>h.getAttribute("type")==="radio"&&h.getAttribute("name")===l.getAttribute("name")).includes(r)),!a)return;e.preventDefault();const c=t[e.shiftKey?t.length-1:0];c&&c.focus()}function uT(n=!0){const e=k.useRef(null),t=s=>{let a=s.querySelector("[data-autofocus]");if(!a){const l=Array.from(s.querySelectorAll(M1));a=l.find(F1)||l.find(Og)||null,!a&&Og(s)&&(a=s)}a&&a.focus({preventScroll:!0})},r=k.useCallback(s=>{n&&s!==null&&e.current!==s&&(s?(setTimeout(()=>{s.getRootNode()&&t(s)}),e.current=s):e.current=null)},[n]);return k.useEffect(()=>{if(!n)return;e.current&&setTimeout(()=>t(e.current));const s=a=>{a.key==="Tab"&&e.current&&lT(e.current,a)};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[n]),r}const cT=Ha.useId||(()=>{});function dT(){const n=cT();return n?`mantine-${n.replace(/:/g,"")}`:""}function lo(n){const e=dT(),[t,r]=k.useState(e);return du(()=>{r(XO())},[]),typeof n=="string"?n:typeof window>"u"?e:t}function Cd(n,e){if(typeof n=="function")return n(e);typeof n=="object"&&n!==null&&"current"in n&&(n.current=e)}function U1(...n){const e=new Map;return t=>{if(n.forEach(r=>{const s=Cd(r,t);s&&e.set(r,s)}),e.size>0)return()=>{n.forEach(r=>{const s=e.get(r);s?s():Cd(r,null)}),e.clear()}}}function Cn(...n){return k.useCallback(U1(...n),n)}function Va({value:n,defaultValue:e,finalValue:t,onChange:r=()=>{}}){const[s,a]=k.useState(e!==void 0?e:t),l=(u,...c)=>{a(u),r==null||r(u,...c)};return n!==void 0?[n,r,!0]:[s,l,!1]}function z1(n,e){return nT("(prefers-reduced-motion: reduce)",n,e)}function fT(n){const e=k.useRef(void 0);return k.useEffect(()=>{e.current=n},[n]),e.current}var hT={};function pT(){return typeof process<"u"&&hT?"production":"development"}function B1(n){var t;const e=Ha.version;return typeof Ha.version!="string"||e.startsWith("18.")?n==null?void 0:n.ref:(t=n==null?void 0:n.props)==null?void 0:t.ref}function H1(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=H1(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function ss(){for(var n,e,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=H1(n))&&(r&&(r+=" "),r+=e);return r}const mT={};function gT(n){const e={};return n.forEach(t=>{Object.entries(t).forEach(([r,s])=>{e[r]?e[r]=ss(e[r],s):e[r]=s})}),e}function rf({theme:n,classNames:e,props:t,stylesCtx:r}){const a=(Array.isArray(e)?e:[e]).map(l=>typeof l=="function"?l(n,t,r):l||mT);return gT(a)}function Pd({theme:n,styles:e,props:t,stylesCtx:r}){return(Array.isArray(e)?e:[e]).reduce((a,l)=>typeof l=="function"?{...a,...l(n,t,r)}:{...a,...l},{})}const W1=k.createContext(null);function ri(){const n=k.useContext(W1);if(!n)throw new Error("[@mantine/core] MantineProvider was not found in tree");return n}function yT(){return ri().cssVariablesResolver}function _T(){return ri().classNamesPrefix}function xy(){return ri().getStyleNonce}function wT(){return ri().withStaticClasses}function bT(){return ri().headless}function vT(){var n;return(n=ri().stylesTransform)==null?void 0:n.sx}function xT(){var n;return(n=ri().stylesTransform)==null?void 0:n.styles}function ST(n){return/^#?([0-9A-F]{3}){1,2}([0-9A-F]{2})?$/i.test(n)}function ET(n){let e=n.replace("#","");if(e.length===3){const l=e.split("");e=[l[0],l[0],l[1],l[1],l[2],l[2]].join("")}if(e.length===8){const l=parseInt(e.slice(6,8),16)/255;return{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16),a:l}}const t=parseInt(e,16),r=t>>16&255,s=t>>8&255,a=t&255;return{r,g:s,b:a,a:1}}function CT(n){const[e,t,r,s]=n.replace(/[^0-9,./]/g,"").split(/[/,]/).map(Number);return{r:e,g:t,b:r,a:s||1}}function PT(n){const e=/^hsla?\(\s*(\d+)\s*,\s*(\d+%)\s*,\s*(\d+%)\s*(,\s*(0?\.\d+|\d+(\.\d+)?))?\s*\)$/i,t=n.match(e);if(!t)return{r:0,g:0,b:0,a:1};const r=parseInt(t[1],10),s=parseInt(t[2],10)/100,a=parseInt(t[3],10)/100,l=t[5]?parseFloat(t[5]):void 0,u=(1-Math.abs(2*a-1))*s,c=r/60,f=u*(1-Math.abs(c%2-1)),h=a-u/2;let m,g,y;return c>=0&&c<1?(m=u,g=f,y=0):c>=1&&c<2?(m=f,g=u,y=0):c>=2&&c<3?(m=0,g=u,y=f):c>=3&&c<4?(m=0,g=f,y=u):c>=4&&c<5?(m=f,g=0,y=u):(m=u,g=0,y=f),{r:Math.round((m+h)*255),g:Math.round((g+h)*255),b:Math.round((y+h)*255),a:l||1}}function Sy(n){return ST(n)?ET(n):n.startsWith("rgb")?CT(n):n.startsWith("hsl")?PT(n):{r:0,g:0,b:0,a:1}}function Hc(n,e){if(n.startsWith("var("))return`color-mix(in srgb, ${n}, black ${e*100}%)`;const{r:t,g:r,b:s,a}=Sy(n),l=1-e,u=c=>Math.round(c*l);return`rgba(${u(t)}, ${u(r)}, ${u(s)}, ${a})`}function Ul(n,e){return typeof n.primaryShade=="number"?n.primaryShade:e==="dark"?n.primaryShade.dark:n.primaryShade.light}function Bp(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function kT(n){const e=n.match(/oklch\((.*?)%\s/);return e?parseFloat(e[1]):null}function RT(n){if(n.startsWith("oklch("))return(kT(n)||0)/100;const{r:e,g:t,b:r}=Sy(n),s=e/255,a=t/255,l=r/255,u=Bp(s),c=Bp(a),f=Bp(l);return .2126*u+.7152*c+.0722*f}function hl(n,e=.179){return n.startsWith("var(")?!1:RT(n)>e}function fu({color:n,theme:e,colorScheme:t}){if(typeof n!="string")throw new Error(`[@mantine/core] Failed to parse color. Expected color to be a string, instead got ${typeof n}`);if(n==="bright")return{color:n,value:t==="dark"?e.white:e.black,shade:void 0,isThemeColor:!1,isLight:hl(t==="dark"?e.white:e.black,e.luminanceThreshold),variable:"--mantine-color-bright"};if(n==="dimmed")return{color:n,value:t==="dark"?e.colors.dark[2]:e.colors.gray[7],shade:void 0,isThemeColor:!1,isLight:hl(t==="dark"?e.colors.dark[2]:e.colors.gray[6],e.luminanceThreshold),variable:"--mantine-color-dimmed"};if(n==="white"||n==="black")return{color:n,value:n==="white"?e.white:e.black,shade:void 0,isThemeColor:!1,isLight:hl(n==="white"?e.white:e.black,e.luminanceThreshold),variable:`--mantine-color-${n}`};const[r,s]=n.split("."),a=s?Number(s):void 0,l=r in e.colors;if(l){const u=a!==void 0?e.colors[r][a]:e.colors[r][Ul(e,t||"light")];return{color:r,value:u,shade:a,isThemeColor:l,isLight:hl(u,e.luminanceThreshold),variable:s?`--mantine-color-${r}-${a}`:`--mantine-color-${r}-filled`}}return{color:n,value:n,isThemeColor:l,isLight:hl(n,e.luminanceThreshold),shade:a,variable:void 0}}function zl(n,e){const t=fu({color:n||e.primaryColor,theme:e});return t.variable?`var(${t.variable})`:n}function Tg(n,e){const t={from:(n==null?void 0:n.from)||e.defaultGradient.from,to:(n==null?void 0:n.to)||e.defaultGradient.to,deg:(n==null?void 0:n.deg)||e.defaultGradient.deg||0},r=zl(t.from,e),s=zl(t.to,e);return`linear-gradient(${t.deg}deg, ${r} 0%, ${s} 100%)`}function Ur(n,e){if(typeof n!="string"||e>1||e<0)return"rgba(0, 0, 0, 1)";if(n.startsWith("var(")){const a=(1-e)*100;return`color-mix(in srgb, ${n}, transparent ${a}%)`}if(n.startsWith("oklch"))return n.includes("/")?n.replace(/\/\s*[\d.]+\s*\)/,`/ ${e})`):n.replace(")",` / ${e})`);const{r:t,g:r,b:s}=Sy(n);return`rgba(${t}, ${r}, ${s}, ${e})`}const Ti=Ur,OT=({color:n,theme:e,variant:t,gradient:r,autoContrast:s})=>{const a=fu({color:n,theme:e}),l=typeof s=="boolean"?s:e.autoContrast;if(t==="filled"){const u=l&&a.isLight?"var(--mantine-color-black)":"var(--mantine-color-white)";return a.isThemeColor?a.shade===void 0?{background:`var(--mantine-color-${n}-filled)`,hover:`var(--mantine-color-${n}-filled-hover)`,color:u,border:`${ee(1)} solid transparent`}:{background:`var(--mantine-color-${a.color}-${a.shade})`,hover:`var(--mantine-color-${a.color}-${a.shade===9?8:a.shade+1})`,color:u,border:`${ee(1)} solid transparent`}:{background:n,hover:Hc(n,.1),color:u,border:`${ee(1)} solid transparent`}}if(t==="light"){if(a.isThemeColor){if(a.shade===void 0)return{background:`var(--mantine-color-${n}-light)`,hover:`var(--mantine-color-${n}-light-hover)`,color:`var(--mantine-color-${n}-light-color)`,border:`${ee(1)} solid transparent`};const u=e.colors[a.color][a.shade];return{background:Ur(u,.1),hover:Ur(u,.12),color:`var(--mantine-color-${a.color}-${Math.min(a.shade,6)})`,border:`${ee(1)} solid transparent`}}return{background:Ur(n,.1),hover:Ur(n,.12),color:n,border:`${ee(1)} solid transparent`}}if(t==="outline")return a.isThemeColor?a.shade===void 0?{background:"transparent",hover:`var(--mantine-color-${n}-outline-hover)`,color:`var(--mantine-color-${n}-outline)`,border:`${ee(1)} solid var(--mantine-color-${n}-outline)`}:{background:"transparent",hover:Ur(e.colors[a.color][a.shade],.05),color:`var(--mantine-color-${a.color}-${a.shade})`,border:`${ee(1)} solid var(--mantine-color-${a.color}-${a.shade})`}:{background:"transparent",hover:Ur(n,.05),color:n,border:`${ee(1)} solid ${n}`};if(t==="subtle"){if(a.isThemeColor){if(a.shade===void 0)return{background:"transparent",hover:`var(--mantine-color-${n}-light-hover)`,color:`var(--mantine-color-${n}-light-color)`,border:`${ee(1)} solid transparent`};const u=e.colors[a.color][a.shade];return{background:"transparent",hover:Ur(u,.12),color:`var(--mantine-color-${a.color}-${Math.min(a.shade,6)})`,border:`${ee(1)} solid transparent`}}return{background:"transparent",hover:Ur(n,.12),color:n,border:`${ee(1)} solid transparent`}}return t==="transparent"?a.isThemeColor?a.shade===void 0?{background:"transparent",hover:"transparent",color:`var(--mantine-color-${n}-light-color)`,border:`${ee(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:`var(--mantine-color-${a.color}-${Math.min(a.shade,6)})`,border:`${ee(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:n,border:`${ee(1)} solid transparent`}:t==="white"?a.isThemeColor?a.shade===void 0?{background:"var(--mantine-color-white)",hover:Hc(e.white,.01),color:`var(--mantine-color-${n}-filled)`,border:`${ee(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:Hc(e.white,.01),color:`var(--mantine-color-${a.color}-${a.shade})`,border:`${ee(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:Hc(e.white,.01),color:n,border:`${ee(1)} solid transparent`}:t==="gradient"?{background:Tg(r,e),hover:Tg(r,e),color:"var(--mantine-color-white)",border:"none"}:t==="default"?{background:"var(--mantine-color-default)",hover:"var(--mantine-color-default-hover)",color:"var(--mantine-color-default-color)",border:`${ee(1)} solid var(--mantine-color-default-border)`}:{}},TT={dark:["#C9C9C9","#b8b8b8","#828282","#696969","#424242","#3b3b3b","#2e2e2e","#242424","#1f1f1f","#141414"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]},b0="-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",Ey={scale:1,fontSmoothing:!0,focusRing:"auto",white:"#fff",black:"#000",colors:TT,primaryShade:{light:6,dark:8},primaryColor:"blue",variantColorResolver:OT,autoContrast:!1,luminanceThreshold:.3,fontFamily:b0,fontFamilyMonospace:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace",respectReducedMotion:!1,cursorType:"default",defaultGradient:{from:"blue",to:"cyan",deg:45},defaultRadius:"sm",activeClassName:"mantine-active",focusClassName:"",headings:{fontFamily:b0,fontWeight:"700",textWrap:"wrap",sizes:{h1:{fontSize:ee(34),lineHeight:"1.3"},h2:{fontSize:ee(26),lineHeight:"1.35"},h3:{fontSize:ee(22),lineHeight:"1.4"},h4:{fontSize:ee(18),lineHeight:"1.45"},h5:{fontSize:ee(16),lineHeight:"1.5"},h6:{fontSize:ee(14),lineHeight:"1.5"}}},fontSizes:{xs:ee(12),sm:ee(14),md:ee(16),lg:ee(18),xl:ee(20)},lineHeights:{xs:"1.4",sm:"1.45",md:"1.55",lg:"1.6",xl:"1.65"},radius:{xs:ee(2),sm:ee(4),md:ee(8),lg:ee(16),xl:ee(32)},spacing:{xs:ee(10),sm:ee(12),md:ee(16),lg:ee(20),xl:ee(32)},breakpoints:{xs:"36em",sm:"48em",md:"62em",lg:"75em",xl:"88em"},shadows:{xs:`0 ${ee(1)} ${ee(3)} rgba(0, 0, 0, 0.05), 0 ${ee(1)} ${ee(2)} rgba(0, 0, 0, 0.1)`,sm:`0 ${ee(1)} ${ee(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${ee(10)} ${ee(15)} ${ee(-5)}, rgba(0, 0, 0, 0.04) 0 ${ee(7)} ${ee(7)} ${ee(-5)}`,md:`0 ${ee(1)} ${ee(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${ee(20)} ${ee(25)} ${ee(-5)}, rgba(0, 0, 0, 0.04) 0 ${ee(10)} ${ee(10)} ${ee(-5)}`,lg:`0 ${ee(1)} ${ee(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${ee(28)} ${ee(23)} ${ee(-7)}, rgba(0, 0, 0, 0.04) 0 ${ee(12)} ${ee(12)} ${ee(-7)}`,xl:`0 ${ee(1)} ${ee(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${ee(36)} ${ee(28)} ${ee(-7)}, rgba(0, 0, 0, 0.04) 0 ${ee(17)} ${ee(17)} ${ee(-7)}`},other:{},components:{}};function v0(n){return n==="auto"||n==="dark"||n==="light"}function AT({key:n="mantine-color-scheme-value"}={}){let e;return{get:t=>{if(typeof window>"u")return t;try{const r=window.localStorage.getItem(n);return v0(r)?r:t}catch{return t}},set:t=>{try{window.localStorage.setItem(n,t)}catch(r){console.warn("[@mantine/core] Local storage color scheme manager was unable to save color scheme.",r)}},subscribe:t=>{e=r=>{r.storageArea===window.localStorage&&r.key===n&&v0(r.newValue)&&t(r.newValue)},window.addEventListener("storage",e)},unsubscribe:()=>{window.removeEventListener("storage",e)},clear:()=>{window.localStorage.removeItem(n)}}}const $T="[@mantine/core] MantineProvider: Invalid theme.primaryColor, it accepts only key of theme.colors, learn more – https://mantine.dev/theming/colors/#primary-color",x0="[@mantine/core] MantineProvider: Invalid theme.primaryShade, it accepts only 0-9 integers or an object { light: 0-9, dark: 0-9 }";function Hp(n){return n<0||n>9?!1:parseInt(n.toString(),10)===n}function S0(n){if(!(n.primaryColor in n.colors))throw new Error($T);if(typeof n.primaryShade=="object"&&(!Hp(n.primaryShade.dark)||!Hp(n.primaryShade.light)))throw new Error(x0);if(typeof n.primaryShade=="number"&&!Hp(n.primaryShade))throw new Error(x0)}function IT(n,e){var r;if(!e)return S0(n),n;const t=vy(n,e);return e.fontFamily&&!((r=e.headings)!=null&&r.fontFamily)&&(t.headings.fontFamily=e.fontFamily),S0(t),t}const Cy=k.createContext(null),NT=()=>k.useContext(Cy)||Ey;function as(){const n=k.useContext(Cy);if(!n)throw new Error("@mantine/core: MantineProvider was not found in component tree, make sure you have it in your app");return n}function V1({theme:n,children:e,inherit:t=!0}){const r=NT(),s=k.useMemo(()=>IT(t?r:Ey,n),[n,r,t]);return O.jsx(Cy.Provider,{value:s,children:e})}V1.displayName="@mantine/core/MantineThemeProvider";function jT(){const n=as(),e=xy(),t=qr(n.breakpoints).reduce((r,s)=>{const a=n.breakpoints[s].includes("px"),l=BO(n.breakpoints[s]),u=a?`${l-.1}px`:y0(l-.1),c=a?`${l}px`:y0(l);return`${r}@media (max-width: ${u}) {.mantine-visible-from-${s} {display: none !important;}}@media (min-width: ${c}) {.mantine-hidden-from-${s} {display: none !important;}}`},"");return O.jsx("style",{"data-mantine-styles":"classes",nonce:e==null?void 0:e(),dangerouslySetInnerHTML:{__html:t}})}function Wp(n){return Object.entries(n).map(([e,t])=>`${e}: ${t};`).join("")}function pl(n,e){return(Array.isArray(n)?n:[n]).reduce((r,s)=>`${s}{${r}}`,e)}function LT(n,e){const t=Wp(n.variables),r=t?pl(e,t):"",s=Wp(n.dark),a=Wp(n.light),l=s?pl(e===":host"?`${e}([data-mantine-color-scheme="dark"])`:`${e}[data-mantine-color-scheme="dark"]`,s):"",u=a?pl(e===":host"?`${e}([data-mantine-color-scheme="light"])`:`${e}[data-mantine-color-scheme="light"]`,a):"";return`${r}${l}${u}`}function MT({color:n,theme:e,autoContrast:t}){return e.autoContrast&&fu({color:n||e.primaryColor,theme:e}).isLight?"var(--mantine-color-black)":"var(--mantine-color-white)"}function E0(n,e){return MT({color:n.colors[n.primaryColor][Ul(n,e)],theme:n,autoContrast:null})}function Wc({theme:n,color:e,colorScheme:t,name:r=e,withColorValues:s=!0}){if(!n.colors[e])return{};if(t==="light"){const u=Ul(n,"light"),c={[`--mantine-color-${r}-text`]:`var(--mantine-color-${r}-filled)`,[`--mantine-color-${r}-filled`]:`var(--mantine-color-${r}-${u})`,[`--mantine-color-${r}-filled-hover`]:`var(--mantine-color-${r}-${u===9?8:u+1})`,[`--mantine-color-${r}-light`]:Ti(n.colors[e][u],.1),[`--mantine-color-${r}-light-hover`]:Ti(n.colors[e][u],.12),[`--mantine-color-${r}-light-color`]:`var(--mantine-color-${r}-${u})`,[`--mantine-color-${r}-outline`]:`var(--mantine-color-${r}-${u})`,[`--mantine-color-${r}-outline-hover`]:Ti(n.colors[e][u],.05)};return s?{[`--mantine-color-${r}-0`]:n.colors[e][0],[`--mantine-color-${r}-1`]:n.colors[e][1],[`--mantine-color-${r}-2`]:n.colors[e][2],[`--mantine-color-${r}-3`]:n.colors[e][3],[`--mantine-color-${r}-4`]:n.colors[e][4],[`--mantine-color-${r}-5`]:n.colors[e][5],[`--mantine-color-${r}-6`]:n.colors[e][6],[`--mantine-color-${r}-7`]:n.colors[e][7],[`--mantine-color-${r}-8`]:n.colors[e][8],[`--mantine-color-${r}-9`]:n.colors[e][9],...c}:c}const a=Ul(n,"dark"),l={[`--mantine-color-${r}-text`]:`var(--mantine-color-${r}-4)`,[`--mantine-color-${r}-filled`]:`var(--mantine-color-${r}-${a})`,[`--mantine-color-${r}-filled-hover`]:`var(--mantine-color-${r}-${a===9?8:a+1})`,[`--mantine-color-${r}-light`]:Ti(n.colors[e][Math.max(0,a-2)],.15),[`--mantine-color-${r}-light-hover`]:Ti(n.colors[e][Math.max(0,a-2)],.2),[`--mantine-color-${r}-light-color`]:`var(--mantine-color-${r}-${Math.max(a-5,0)})`,[`--mantine-color-${r}-outline`]:`var(--mantine-color-${r}-${Math.max(a-4,0)})`,[`--mantine-color-${r}-outline-hover`]:Ti(n.colors[e][Math.max(a-4,0)],.05)};return s?{[`--mantine-color-${r}-0`]:n.colors[e][0],[`--mantine-color-${r}-1`]:n.colors[e][1],[`--mantine-color-${r}-2`]:n.colors[e][2],[`--mantine-color-${r}-3`]:n.colors[e][3],[`--mantine-color-${r}-4`]:n.colors[e][4],[`--mantine-color-${r}-5`]:n.colors[e][5],[`--mantine-color-${r}-6`]:n.colors[e][6],[`--mantine-color-${r}-7`]:n.colors[e][7],[`--mantine-color-${r}-8`]:n.colors[e][8],[`--mantine-color-${r}-9`]:n.colors[e][9],...l}:l}function DT(n){return!!n&&typeof n=="object"&&"mantine-virtual-color"in n}function Ai(n,e,t){qr(e).forEach(r=>Object.assign(n,{[`--mantine-${t}-${r}`]:e[r]}))}const q1=n=>{const e=Ul(n,"light"),t=n.defaultRadius in n.radius?n.radius[n.defaultRadius]:ee(n.defaultRadius),r={variables:{"--mantine-scale":n.scale.toString(),"--mantine-cursor-type":n.cursorType,"--mantine-color-scheme":"light dark","--mantine-webkit-font-smoothing":n.fontSmoothing?"antialiased":"unset","--mantine-moz-font-smoothing":n.fontSmoothing?"grayscale":"unset","--mantine-color-white":n.white,"--mantine-color-black":n.black,"--mantine-line-height":n.lineHeights.md,"--mantine-font-family":n.fontFamily,"--mantine-font-family-monospace":n.fontFamilyMonospace,"--mantine-font-family-headings":n.headings.fontFamily,"--mantine-heading-font-weight":n.headings.fontWeight,"--mantine-heading-text-wrap":n.headings.textWrap,"--mantine-radius-default":t,"--mantine-primary-color-filled":`var(--mantine-color-${n.primaryColor}-filled)`,"--mantine-primary-color-filled-hover":`var(--mantine-color-${n.primaryColor}-filled-hover)`,"--mantine-primary-color-light":`var(--mantine-color-${n.primaryColor}-light)`,"--mantine-primary-color-light-hover":`var(--mantine-color-${n.primaryColor}-light-hover)`,"--mantine-primary-color-light-color":`var(--mantine-color-${n.primaryColor}-light-color)`},light:{"--mantine-primary-color-contrast":E0(n,"light"),"--mantine-color-bright":"var(--mantine-color-black)","--mantine-color-text":n.black,"--mantine-color-body":n.white,"--mantine-color-error":"var(--mantine-color-red-6)","--mantine-color-placeholder":"var(--mantine-color-gray-5)","--mantine-color-anchor":`var(--mantine-color-${n.primaryColor}-${e})`,"--mantine-color-default":"var(--mantine-color-white)","--mantine-color-default-hover":"var(--mantine-color-gray-0)","--mantine-color-default-color":"var(--mantine-color-black)","--mantine-color-default-border":"var(--mantine-color-gray-4)","--mantine-color-dimmed":"var(--mantine-color-gray-6)"},dark:{"--mantine-primary-color-contrast":E0(n,"dark"),"--mantine-color-bright":"var(--mantine-color-white)","--mantine-color-text":"var(--mantine-color-dark-0)","--mantine-color-body":"var(--mantine-color-dark-7)","--mantine-color-error":"var(--mantine-color-red-8)","--mantine-color-placeholder":"var(--mantine-color-dark-3)","--mantine-color-anchor":`var(--mantine-color-${n.primaryColor}-4)`,"--mantine-color-default":"var(--mantine-color-dark-6)","--mantine-color-default-hover":"var(--mantine-color-dark-5)","--mantine-color-default-color":"var(--mantine-color-white)","--mantine-color-default-border":"var(--mantine-color-dark-4)","--mantine-color-dimmed":"var(--mantine-color-dark-2)"}};Ai(r.variables,n.breakpoints,"breakpoint"),Ai(r.variables,n.spacing,"spacing"),Ai(r.variables,n.fontSizes,"font-size"),Ai(r.variables,n.lineHeights,"line-height"),Ai(r.variables,n.shadows,"shadow"),Ai(r.variables,n.radius,"radius"),n.colors[n.primaryColor].forEach((a,l)=>{r.variables[`--mantine-primary-color-${l}`]=`var(--mantine-color-${n.primaryColor}-${l})`}),qr(n.colors).forEach(a=>{const l=n.colors[a];if(DT(l)){Object.assign(r.light,Wc({theme:n,name:l.name,color:l.light,colorScheme:"light",withColorValues:!0})),Object.assign(r.dark,Wc({theme:n,name:l.name,color:l.dark,colorScheme:"dark",withColorValues:!0}));return}l.forEach((u,c)=>{r.variables[`--mantine-color-${a}-${c}`]=u}),Object.assign(r.light,Wc({theme:n,color:a,colorScheme:"light",withColorValues:!1})),Object.assign(r.dark,Wc({theme:n,color:a,colorScheme:"dark",withColorValues:!1}))});const s=n.headings.sizes;return qr(s).forEach(a=>{r.variables[`--mantine-${a}-font-size`]=s[a].fontSize,r.variables[`--mantine-${a}-line-height`]=s[a].lineHeight,r.variables[`--mantine-${a}-font-weight`]=s[a].fontWeight||n.headings.fontWeight}),r};function FT({theme:n,generator:e}){const t=q1(n),r=e==null?void 0:e(n);return r?vy(t,r):t}const Vp=q1(Ey);function UT(n){const e={variables:{},light:{},dark:{}};return qr(n.variables).forEach(t=>{Vp.variables[t]!==n.variables[t]&&(e.variables[t]=n.variables[t])}),qr(n.light).forEach(t=>{Vp.light[t]!==n.light[t]&&(e.light[t]=n.light[t])}),qr(n.dark).forEach(t=>{Vp.dark[t]!==n.dark[t]&&(e.dark[t]=n.dark[t])}),e}function zT(n){return`
  ${n}[data-mantine-color-scheme="dark"] { --mantine-color-scheme: dark; }
  ${n}[data-mantine-color-scheme="light"] { --mantine-color-scheme: light; }
`}function Z1({cssVariablesSelector:n,deduplicateCssVariables:e}){const t=as(),r=xy(),s=yT(),a=FT({theme:t,generator:s}),l=n===":root"&&e,u=l?UT(a):a,c=LT(u,n);return c?O.jsx("style",{"data-mantine-styles":!0,nonce:r==null?void 0:r(),dangerouslySetInnerHTML:{__html:`${c}${l?"":zT(n)}`}}):null}Z1.displayName="@mantine/CssVariables";function BT(){const n=console.error;console.error=(...e)=>{e.length>1&&typeof e[0]=="string"&&e[0].toLowerCase().includes("extra attributes from the server")&&typeof e[1]=="string"&&e[1].toLowerCase().includes("data-mantine-color-scheme")||n(...e)}}function $i(n,e){var s,a;const t=typeof window<"u"&&"matchMedia"in window&&((s=window.matchMedia("(prefers-color-scheme: dark)"))==null?void 0:s.matches),r=n!=="auto"?n:t?"dark":"light";(a=e())==null||a.setAttribute("data-mantine-color-scheme",r)}function HT({manager:n,defaultColorScheme:e,getRootElement:t,forceColorScheme:r}){const s=k.useRef(null),[a,l]=k.useState(()=>n.get(e)),u=r||a,c=k.useCallback(h=>{r||($i(h,t),l(h),n.set(h))},[n.set,u,r]),f=k.useCallback(()=>{l(e),$i(e,t),n.clear()},[n.clear,e]);return k.useEffect(()=>(n.subscribe(c),n.unsubscribe),[n.subscribe,n.unsubscribe]),du(()=>{$i(n.get(e),t)},[]),k.useEffect(()=>{var m;if(r)return $i(r,t),()=>{};r===void 0&&$i(a,t),typeof window<"u"&&"matchMedia"in window&&(s.current=window.matchMedia("(prefers-color-scheme: dark)"));const h=g=>{a==="auto"&&$i(g.matches?"dark":"light",t)};return(m=s.current)==null||m.addEventListener("change",h),()=>{var g;return(g=s.current)==null?void 0:g.removeEventListener("change",h)}},[a,r]),{colorScheme:u,setColorScheme:c,clearColorScheme:f}}function WT({respectReducedMotion:n,getRootElement:e}){du(()=>{var t;n&&((t=e())==null||t.setAttribute("data-respect-reduced-motion","true"))},[n])}BT();function G1({theme:n,children:e,getStyleNonce:t,withStaticClasses:r=!0,withGlobalClasses:s=!0,deduplicateCssVariables:a=!0,withCssVariables:l=!0,cssVariablesSelector:u=":root",classNamesPrefix:c="mantine",colorSchemeManager:f=AT(),defaultColorScheme:h="light",getRootElement:m=()=>document.documentElement,cssVariablesResolver:g,forceColorScheme:y,stylesTransform:w}){const{colorScheme:v,setColorScheme:x,clearColorScheme:E}=HT({defaultColorScheme:h,forceColorScheme:y,manager:f,getRootElement:m});return WT({respectReducedMotion:(n==null?void 0:n.respectReducedMotion)||!1,getRootElement:m}),O.jsx(W1.Provider,{value:{colorScheme:v,setColorScheme:x,clearColorScheme:E,getRootElement:m,classNamesPrefix:c,getStyleNonce:t,cssVariablesResolver:g,cssVariablesSelector:u,withStaticClasses:r,stylesTransform:w},children:O.jsxs(V1,{theme:n,children:[l&&O.jsx(Z1,{cssVariablesSelector:u,deduplicateCssVariables:a}),s&&O.jsx(jT,{}),e]})})}G1.displayName="@mantine/core/MantineProvider";function hu({classNames:n,styles:e,props:t,stylesCtx:r}){const s=as();return{resolvedClassNames:rf({theme:s,classNames:n,props:t,stylesCtx:r||void 0}),resolvedStyles:Pd({theme:s,styles:e,props:t,stylesCtx:r||void 0})}}const VT={always:"mantine-focus-always",auto:"mantine-focus-auto",never:"mantine-focus-never"};function qT({theme:n,options:e,unstyled:t}){return ss((e==null?void 0:e.focusable)&&!t&&(n.focusClassName||VT[n.focusRing]),(e==null?void 0:e.active)&&!t&&n.activeClassName)}function ZT({selector:n,stylesCtx:e,options:t,props:r,theme:s}){return rf({theme:s,classNames:t==null?void 0:t.classNames,props:(t==null?void 0:t.props)||r,stylesCtx:e})[n]}function C0({selector:n,stylesCtx:e,theme:t,classNames:r,props:s}){return rf({theme:t,classNames:r,props:s,stylesCtx:e})[n]}function GT({rootSelector:n,selector:e,className:t}){return n===e?t:void 0}function JT({selector:n,classes:e,unstyled:t}){return t?void 0:e[n]}function KT({themeName:n,classNamesPrefix:e,selector:t,withStaticClass:r}){return r===!1?[]:n.map(s=>`${e}-${s}-${t}`)}function XT({themeName:n,theme:e,selector:t,props:r,stylesCtx:s}){return n.map(a=>{var l,u;return(u=rf({theme:e,classNames:(l=e.components[a])==null?void 0:l.classNames,props:r,stylesCtx:s}))==null?void 0:u[t]})}function YT({options:n,classes:e,selector:t,unstyled:r}){return n!=null&&n.variant&&!r?e[`${t}--${n.variant}`]:void 0}function QT({theme:n,options:e,themeName:t,selector:r,classNamesPrefix:s,classNames:a,classes:l,unstyled:u,className:c,rootSelector:f,props:h,stylesCtx:m,withStaticClasses:g,headless:y,transformedStyles:w}){return ss(qT({theme:n,options:e,unstyled:u||y}),XT({theme:n,themeName:t,selector:r,props:h,stylesCtx:m}),YT({options:e,classes:l,selector:r,unstyled:u}),C0({selector:r,stylesCtx:m,theme:n,classNames:a,props:h}),C0({selector:r,stylesCtx:m,theme:n,classNames:w,props:h}),ZT({selector:r,stylesCtx:m,options:e,props:h,theme:n}),GT({rootSelector:f,selector:r,className:c}),JT({selector:r,classes:l,unstyled:u||y}),g&&!y&&KT({themeName:t,classNamesPrefix:s,selector:r,withStaticClass:e==null?void 0:e.withStaticClass}),e==null?void 0:e.className)}function eA({theme:n,themeName:e,props:t,stylesCtx:r,selector:s}){return e.map(a=>{var l;return Pd({theme:n,styles:(l=n.components[a])==null?void 0:l.styles,props:t,stylesCtx:r})[s]}).reduce((a,l)=>({...a,...l}),{})}function Ag({style:n,theme:e}){return Array.isArray(n)?[...n].reduce((t,r)=>({...t,...Ag({style:r,theme:e})}),{}):typeof n=="function"?n(e):n??{}}function tA(n){return n.reduce((e,t)=>(t&&Object.keys(t).forEach(r=>{e[r]={...e[r],...tf(t[r])}}),e),{})}function nA({vars:n,varsResolver:e,theme:t,props:r,stylesCtx:s,selector:a,themeName:l,headless:u}){var c;return(c=tA([u?{}:e==null?void 0:e(t,r,s),...l.map(f=>{var h,m,g;return(g=(m=(h=t.components)==null?void 0:h[f])==null?void 0:m.vars)==null?void 0:g.call(m,t,r,s)}),n==null?void 0:n(t,r,s)]))==null?void 0:c[a]}function rA({theme:n,themeName:e,selector:t,options:r,props:s,stylesCtx:a,rootSelector:l,styles:u,style:c,vars:f,varsResolver:h,headless:m,withStylesTransform:g}){return{...!g&&eA({theme:n,themeName:e,props:s,stylesCtx:a,selector:t}),...!g&&Pd({theme:n,styles:u,props:s,stylesCtx:a})[t],...!g&&Pd({theme:n,styles:r==null?void 0:r.styles,props:(r==null?void 0:r.props)||s,stylesCtx:a})[t],...nA({theme:n,props:s,stylesCtx:a,vars:f,varsResolver:h,selector:t,themeName:e,headless:m}),...l===t?Ag({style:c,theme:n}):null,...Ag({style:r==null?void 0:r.style,theme:n})}}function sA({props:n,stylesCtx:e,themeName:t}){var l;const r=as(),s=(l=xT())==null?void 0:l();return{getTransformedStyles:u=>s?[...u.map(f=>s(f,{props:n,theme:r,ctx:e})),...t.map(f=>{var h;return s((h=r.components[f])==null?void 0:h.styles,{props:n,theme:r,ctx:e})})].filter(Boolean):[],withStylesTransform:!!s}}function Xe({name:n,classes:e,props:t,stylesCtx:r,className:s,style:a,rootSelector:l="root",unstyled:u,classNames:c,styles:f,vars:h,varsResolver:m}){const g=as(),y=_T(),w=wT(),v=bT(),x=(Array.isArray(n)?n:[n]).filter(S=>S),{withStylesTransform:E,getTransformedStyles:P}=sA({props:t,stylesCtx:r,themeName:x});return(S,R)=>({className:QT({theme:g,options:R,themeName:x,selector:S,classNamesPrefix:y,classNames:c,classes:e,unstyled:u,className:s,rootSelector:l,props:t,stylesCtx:r,withStaticClasses:w,headless:v,transformedStyles:P([R==null?void 0:R.styles,f])}),style:rA({theme:g,themeName:x,selector:S,options:R,props:t,stylesCtx:r,rootSelector:l,styles:f,style:a,vars:h,varsResolver:m,headless:v,withStylesTransform:E})})}function ge(n,e,t){var l;const r=as(),s=(l=r.components[n])==null?void 0:l.defaultProps,a=typeof s=="function"?s(r):s;return{...e,...a,...tf(t)}}function qp(n){return qr(n).reduce((e,t)=>n[t]!==void 0?`${e}${UO(t)}:${n[t]};`:e,"").trim()}function aA({selector:n,styles:e,media:t,container:r}){const s=e?qp(e):"",a=Array.isArray(t)?t.map(u=>`@media${u.query}{${n}{${qp(u.styles)}}}`):[],l=Array.isArray(r)?r.map(u=>`@container ${u.query}{${n}{${qp(u.styles)}}}`):[];return`${s?`${n}{${s}}`:""}${a.join("")}${l.join("")}`.trim()}function J1(n){const e=xy();return O.jsx("style",{"data-mantine-styles":"inline",nonce:e==null?void 0:e(),dangerouslySetInnerHTML:{__html:aA(n)}})}function sf(n){const{m:e,mx:t,my:r,mt:s,mb:a,ml:l,mr:u,me:c,ms:f,p:h,px:m,py:g,pt:y,pb:w,pl:v,pr:x,pe:E,ps:P,bd:S,bg:R,c:$,opacity:I,ff:D,fz:F,fw:K,lts:Y,ta:ie,lh:de,fs:ue,tt:V,td:G,w:q,miw:J,maw:j,h:B,mih:W,mah:T,bgsz:M,bgp:X,bgr:ae,bga:Q,pos:le,top:Re,left:Ee,bottom:be,right:je,inset:ct,display:qt,flex:Un,hiddenFrom:Ir,visibleFrom:ls,lightHidden:Ot,darkHidden:pt,sx:nr,...et}=n;return{styleProps:tf({m:e,mx:t,my:r,mt:s,mb:a,ml:l,mr:u,me:c,ms:f,p:h,px:m,py:g,pt:y,pb:w,pl:v,pr:x,pe:E,ps:P,bd:S,bg:R,c:$,opacity:I,ff:D,fz:F,fw:K,lts:Y,ta:ie,lh:de,fs:ue,tt:V,td:G,w:q,miw:J,maw:j,h:B,mih:W,mah:T,bgsz:M,bgp:X,bgr:ae,bga:Q,pos:le,top:Re,left:Ee,bottom:be,right:je,inset:ct,display:qt,flex:Un,hiddenFrom:Ir,visibleFrom:ls,lightHidden:Ot,darkHidden:pt,sx:nr}),rest:et}}const iA={m:{type:"spacing",property:"margin"},mt:{type:"spacing",property:"marginTop"},mb:{type:"spacing",property:"marginBottom"},ml:{type:"spacing",property:"marginLeft"},mr:{type:"spacing",property:"marginRight"},ms:{type:"spacing",property:"marginInlineStart"},me:{type:"spacing",property:"marginInlineEnd"},mx:{type:"spacing",property:"marginInline"},my:{type:"spacing",property:"marginBlock"},p:{type:"spacing",property:"padding"},pt:{type:"spacing",property:"paddingTop"},pb:{type:"spacing",property:"paddingBottom"},pl:{type:"spacing",property:"paddingLeft"},pr:{type:"spacing",property:"paddingRight"},ps:{type:"spacing",property:"paddingInlineStart"},pe:{type:"spacing",property:"paddingInlineEnd"},px:{type:"spacing",property:"paddingInline"},py:{type:"spacing",property:"paddingBlock"},bd:{type:"border",property:"border"},bg:{type:"color",property:"background"},c:{type:"textColor",property:"color"},opacity:{type:"identity",property:"opacity"},ff:{type:"fontFamily",property:"fontFamily"},fz:{type:"fontSize",property:"fontSize"},fw:{type:"identity",property:"fontWeight"},lts:{type:"size",property:"letterSpacing"},ta:{type:"identity",property:"textAlign"},lh:{type:"lineHeight",property:"lineHeight"},fs:{type:"identity",property:"fontStyle"},tt:{type:"identity",property:"textTransform"},td:{type:"identity",property:"textDecoration"},w:{type:"spacing",property:"width"},miw:{type:"spacing",property:"minWidth"},maw:{type:"spacing",property:"maxWidth"},h:{type:"spacing",property:"height"},mih:{type:"spacing",property:"minHeight"},mah:{type:"spacing",property:"maxHeight"},bgsz:{type:"size",property:"backgroundSize"},bgp:{type:"identity",property:"backgroundPosition"},bgr:{type:"identity",property:"backgroundRepeat"},bga:{type:"identity",property:"backgroundAttachment"},pos:{type:"identity",property:"position"},top:{type:"size",property:"top"},left:{type:"size",property:"left"},bottom:{type:"size",property:"bottom"},right:{type:"size",property:"right"},inset:{type:"size",property:"inset"},display:{type:"identity",property:"display"},flex:{type:"identity",property:"flex"}};function Py(n,e){const t=fu({color:n,theme:e});return t.color==="dimmed"?"var(--mantine-color-dimmed)":t.color==="bright"?"var(--mantine-color-bright)":t.variable?`var(${t.variable})`:t.color}function oA(n,e){const t=fu({color:n,theme:e});return t.isThemeColor&&t.shade===void 0?`var(--mantine-color-${t.color}-text)`:Py(n,e)}function lA(n,e){if(typeof n=="number")return ee(n);if(typeof n=="string"){const[t,r,...s]=n.split(" ").filter(l=>l.trim()!=="");let a=`${ee(t)}`;return r&&(a+=` ${r}`),s.length>0&&(a+=` ${Py(s.join(" "),e)}`),a.trim()}return n}const P0={text:"var(--mantine-font-family)",mono:"var(--mantine-font-family-monospace)",monospace:"var(--mantine-font-family-monospace)",heading:"var(--mantine-font-family-headings)",headings:"var(--mantine-font-family-headings)"};function uA(n){return typeof n=="string"&&n in P0?P0[n]:n}const cA=["h1","h2","h3","h4","h5","h6"];function dA(n,e){return typeof n=="string"&&n in e.fontSizes?`var(--mantine-font-size-${n})`:typeof n=="string"&&cA.includes(n)?`var(--mantine-${n}-font-size)`:typeof n=="number"||typeof n=="string"?ee(n):n}function fA(n){return n}const hA=["h1","h2","h3","h4","h5","h6"];function pA(n,e){return typeof n=="string"&&n in e.lineHeights?`var(--mantine-line-height-${n})`:typeof n=="string"&&hA.includes(n)?`var(--mantine-${n}-line-height)`:n}function mA(n){return typeof n=="number"?ee(n):n}function gA(n,e){if(typeof n=="number")return ee(n);if(typeof n=="string"){const t=n.replace("-","");if(!(t in e.spacing))return ee(n);const r=`--mantine-spacing-${t}`;return n.startsWith("-")?`calc(var(${r}) * -1)`:`var(${r})`}return n}const Zp={color:Py,textColor:oA,fontSize:dA,spacing:gA,identity:fA,size:mA,lineHeight:pA,fontFamily:uA,border:lA};function k0(n){return n.replace("(min-width: ","").replace("em)","")}function yA({media:n,...e}){const r=Object.keys(n).sort((s,a)=>Number(k0(s))-Number(k0(a))).map(s=>({query:s,styles:n[s]}));return{...e,media:r}}function _A(n){if(typeof n!="object"||n===null)return!1;const e=Object.keys(n);return!(e.length===1&&e[0]==="base")}function wA(n){return typeof n=="object"&&n!==null?"base"in n?n.base:void 0:n}function bA(n){return typeof n=="object"&&n!==null?qr(n).filter(e=>e!=="base"):[]}function vA(n,e){return typeof n=="object"&&n!==null&&e in n?n[e]:n}function K1({styleProps:n,data:e,theme:t}){return yA(qr(n).reduce((r,s)=>{if(s==="hiddenFrom"||s==="visibleFrom"||s==="sx")return r;const a=e[s],l=Array.isArray(a.property)?a.property:[a.property],u=wA(n[s]);if(!_A(n[s]))return l.forEach(f=>{r.inlineStyles[f]=Zp[a.type](u,t)}),r;r.hasResponsiveStyles=!0;const c=bA(n[s]);return l.forEach(f=>{u&&(r.styles[f]=Zp[a.type](u,t)),c.forEach(h=>{const m=`(min-width: ${t.breakpoints[h]})`;r.media[m]={...r.media[m],[f]:Zp[a.type](vA(n[s],h),t)}})}),r},{hasResponsiveStyles:!1,styles:{},inlineStyles:{},media:{}}))}function X1(){return`__m__-${k.useId().replace(/:/g,"")}`}function Y1(n,e){return Array.isArray(n)?[...n].reduce((t,r)=>({...t,...Y1(r,e)}),{}):typeof n=="function"?n(e):n??{}}function Q1(n){return n.startsWith("data-")?n:`data-${n}`}function xA(n){return Object.keys(n).reduce((e,t)=>{const r=n[t];return r===void 0||r===""||r===!1||r===null||(e[Q1(t)]=n[t]),e},{})}function eE(n){return n?typeof n=="string"?{[Q1(n)]:!0}:Array.isArray(n)?[...n].reduce((e,t)=>({...e,...eE(t)}),{}):xA(n):null}function $g(n,e){return Array.isArray(n)?[...n].reduce((t,r)=>({...t,...$g(r,e)}),{}):typeof n=="function"?n(e):n??{}}function SA({theme:n,style:e,vars:t,styleProps:r}){const s=$g(e,n),a=$g(t,n);return{...s,...a,...r}}const tE=k.forwardRef(({component:n,style:e,__vars:t,className:r,variant:s,mod:a,size:l,hiddenFrom:u,visibleFrom:c,lightHidden:f,darkHidden:h,renderRoot:m,__size:g,...y},w)=>{var F;const v=as(),x=n||"div",{styleProps:E,rest:P}=sf(y),S=vT(),R=(F=S==null?void 0:S())==null?void 0:F(E.sx),$=X1(),I=K1({styleProps:E,theme:v,data:iA}),D={ref:w,style:SA({theme:v,style:e,vars:t,styleProps:I.inlineStyles}),className:ss(r,R,{[$]:I.hasResponsiveStyles,"mantine-light-hidden":f,"mantine-dark-hidden":h,[`mantine-hidden-from-${u}`]:u,[`mantine-visible-from-${c}`]:c}),"data-variant":s,"data-size":$1(l)?void 0:l||void 0,size:g,...eE(a),...P};return O.jsxs(O.Fragment,{children:[I.hasResponsiveStyles&&O.jsx(J1,{selector:`.${$}`,styles:I.styles,media:I.media}),typeof m=="function"?m(D):O.jsx(x,{...D})]})});tE.displayName="@mantine/core/Box";const ke=tE;function nE(n){return n}function EA(n){const e=n;return t=>{const r=k.forwardRef((s,a)=>O.jsx(e,{...t,...s,ref:a}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r}}function Ue(n){const e=k.forwardRef(n);return e.extend=nE,e.withProps=t=>{const r=k.forwardRef((s,a)=>O.jsx(e,{...t,...s,ref:a}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r},e}function Yn(n){const e=k.forwardRef(n);return e.withProps=t=>{const r=k.forwardRef((s,a)=>O.jsx(e,{...t,...s,ref:a}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r},e.extend=nE,e}const CA=k.createContext({dir:"ltr",toggleDirection:()=>{},setDirection:()=>{}});function ky(){return k.useContext(CA)}var af=T1();const PA=ti(af);function kA(n){if(!n||typeof n=="string")return 0;const e=n/36;return Math.round((4+15*e**.25+e/5)*10)}function Gp(n){return n!=null&&n.current?n.current.scrollHeight:"auto"}const ml=typeof window<"u"&&window.requestAnimationFrame;function RA({transitionDuration:n,transitionTimingFunction:e="ease",onTransitionEnd:t=()=>{},opened:r}){const s=k.useRef(null),a=0,l={display:"none",height:0,overflow:"hidden"},[u,c]=k.useState(r?{}:l),f=w=>{af.flushSync(()=>c(w))},h=w=>{f(v=>({...v,...w}))};function m(w){const v=n||kA(w);return{transition:`height ${v}ms ${e}, opacity ${v}ms ${e}`}}Wa(()=>{typeof ml=="function"&&ml(r?()=>{h({willChange:"height",display:"block",overflow:"hidden"}),ml(()=>{const w=Gp(s);h({...m(w),height:w})})}:()=>{const w=Gp(s);h({...m(w),willChange:"height",height:w}),ml(()=>h({height:a,overflow:"hidden"}))})},[r]);const g=w=>{if(!(w.target!==s.current||w.propertyName!=="height"))if(r){const v=Gp(s);v===u.height?f({}):h({height:v}),t()}else u.height===a&&(f(l),t())};function y({style:w={},refKey:v="ref",...x}={}){const E=x[v];return{"aria-hidden":!r,...x,[v]:U1(s,E),onTransitionEnd:g,style:{boxSizing:"border-box",...w,...u}}}return y}const OA={transitionDuration:200,transitionTimingFunction:"ease",animateOpacity:!0},rE=Ue((n,e)=>{const{children:t,in:r,transitionDuration:s,transitionTimingFunction:a,style:l,onTransitionEnd:u,animateOpacity:c,...f}=ge("Collapse",OA,n),h=as(),m=z1(),y=(h.respectReducedMotion?m:!1)?0:s,w=RA({opened:r,transitionDuration:y,transitionTimingFunction:a,onTransitionEnd:u});return y===0?r?O.jsx(ke,{...f,children:t}):null:O.jsx(ke,{...w({style:{opacity:r||!c?1:0,transition:c?`opacity ${y}ms ${a}`:"none",...Y1(l,h)},ref:e,...f}),children:t})});rE.displayName="@mantine/core/Collapse";const[TA,Qn]=ni("ScrollArea.Root component was not found in tree");function Yi(n,e){const t=ja(e);du(()=>{let r=0;if(n){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(t)});return s.observe(n),()=>{window.cancelAnimationFrame(r),s.unobserve(n)}}},[n,t])}const AA=k.forwardRef((n,e)=>{const{style:t,...r}=n,s=Qn(),[a,l]=k.useState(0),[u,c]=k.useState(0),f=!!(a&&u);return Yi(s.scrollbarX,()=>{var m;const h=((m=s.scrollbarX)==null?void 0:m.offsetHeight)||0;s.onCornerHeightChange(h),c(h)}),Yi(s.scrollbarY,()=>{var m;const h=((m=s.scrollbarY)==null?void 0:m.offsetWidth)||0;s.onCornerWidthChange(h),l(h)}),f?O.jsx("div",{...r,ref:e,style:{...t,width:a,height:u}}):null}),$A=k.forwardRef((n,e)=>{const t=Qn(),r=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&r?O.jsx(AA,{...n,ref:e}):null}),IA={scrollHideDelay:1e3,type:"hover"},sE=k.forwardRef((n,e)=>{const t=ge("ScrollAreaRoot",IA,n),{type:r,scrollHideDelay:s,scrollbars:a,...l}=t,[u,c]=k.useState(null),[f,h]=k.useState(null),[m,g]=k.useState(null),[y,w]=k.useState(null),[v,x]=k.useState(null),[E,P]=k.useState(0),[S,R]=k.useState(0),[$,I]=k.useState(!1),[D,F]=k.useState(!1),K=Cn(e,Y=>c(Y));return O.jsx(TA,{value:{type:r,scrollHideDelay:s,scrollArea:u,viewport:f,onViewportChange:h,content:m,onContentChange:g,scrollbarX:y,onScrollbarXChange:w,scrollbarXEnabled:$,onScrollbarXEnabledChange:I,scrollbarY:v,onScrollbarYChange:x,scrollbarYEnabled:D,onScrollbarYEnabledChange:F,onCornerWidthChange:P,onCornerHeightChange:R},children:O.jsx(ke,{...l,ref:K,__vars:{"--sa-corner-width":a!=="xy"?"0px":`${E}px`,"--sa-corner-height":a!=="xy"?"0px":`${S}px`}})})});sE.displayName="@mantine/core/ScrollAreaRoot";function aE(n,e){const t=n/e;return Number.isNaN(t)?0:t}function of(n){const e=aE(n.viewport,n.content),t=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,r=(n.scrollbar.size-t)*e;return Math.max(r,18)}function iE(n,e){return t=>{if(n[0]===n[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(n[1]-n[0]);return e[0]+r*(t-n[0])}}function NA(n,[e,t]){return Math.min(t,Math.max(e,n))}function R0(n,e,t="ltr"){const r=of(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,a=e.scrollbar.size-s,l=e.content-e.viewport,u=a-r,c=t==="ltr"?[0,l]:[l*-1,0],f=NA(n,c);return iE([0,l],[0,u])(f)}function jA(n,e,t,r="ltr"){const s=of(t),a=s/2,l=e||a,u=s-l,c=t.scrollbar.paddingStart+l,f=t.scrollbar.size-t.scrollbar.paddingEnd-u,h=t.content-t.viewport,m=r==="ltr"?[0,h]:[h*-1,0];return iE([c,f],m)(n)}function oE(n,e){return n>0&&n<e}function kd(n){return n?parseInt(n,10):0}function Ua(n,e,{checkForDefaultPrevented:t=!0}={}){return r=>{n==null||n(r),(t===!1||!r.defaultPrevented)&&(e==null||e(r))}}const[LA,lE]=ni("ScrollAreaScrollbar was not found in tree"),uE=k.forwardRef((n,e)=>{const{sizes:t,hasThumb:r,onThumbChange:s,onThumbPointerUp:a,onThumbPointerDown:l,onThumbPositionChange:u,onDragScroll:c,onWheelScroll:f,onResize:h,...m}=n,g=Qn(),[y,w]=k.useState(null),v=Cn(e,F=>w(F)),x=k.useRef(null),E=k.useRef(""),{viewport:P}=g,S=t.content-t.viewport,R=ja(f),$=ja(u),I=nf(h,10),D=F=>{if(x.current){const K=F.clientX-x.current.left,Y=F.clientY-x.current.top;c({x:K,y:Y})}};return k.useEffect(()=>{const F=K=>{const Y=K.target;(y==null?void 0:y.contains(Y))&&R(K,S)};return document.addEventListener("wheel",F,{passive:!1}),()=>document.removeEventListener("wheel",F,{passive:!1})},[P,y,S,R]),k.useEffect($,[t,$]),Yi(y,I),Yi(g.content,I),O.jsx(LA,{value:{scrollbar:y,hasThumb:r,onThumbChange:ja(s),onThumbPointerUp:ja(a),onThumbPositionChange:$,onThumbPointerDown:ja(l)},children:O.jsx("div",{...m,ref:v,"data-mantine-scrollbar":!0,style:{position:"absolute",...m.style},onPointerDown:Ua(n.onPointerDown,F=>{F.preventDefault(),F.button===0&&(F.target.setPointerCapture(F.pointerId),x.current=y.getBoundingClientRect(),E.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",D(F))}),onPointerMove:Ua(n.onPointerMove,D),onPointerUp:Ua(n.onPointerUp,F=>{F.preventDefault();const K=F.target;K.hasPointerCapture(F.pointerId)&&K.releasePointerCapture(F.pointerId),document.body.style.webkitUserSelect=E.current,x.current=null})})})}),cE=k.forwardRef((n,e)=>{const{sizes:t,onSizesChange:r,style:s,...a}=n,l=Qn(),[u,c]=k.useState(),f=k.useRef(null),h=Cn(e,f,l.onScrollbarXChange);return k.useEffect(()=>{f.current&&c(getComputedStyle(f.current))},[f]),O.jsx(uE,{"data-orientation":"horizontal",...a,ref:h,sizes:t,style:{...s,"--sa-thumb-width":`${of(t)}px`},onThumbPointerDown:m=>n.onThumbPointerDown(m.x),onDragScroll:m=>n.onDragScroll(m.x),onWheelScroll:(m,g)=>{if(l.viewport){const y=l.viewport.scrollLeft+m.deltaX;n.onWheelScroll(y),oE(y,g)&&m.preventDefault()}},onResize:()=>{f.current&&l.viewport&&u&&r({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:f.current.clientWidth,paddingStart:kd(u.paddingLeft),paddingEnd:kd(u.paddingRight)}})}})});cE.displayName="@mantine/core/ScrollAreaScrollbarX";const dE=k.forwardRef((n,e)=>{const{sizes:t,onSizesChange:r,style:s,...a}=n,l=Qn(),[u,c]=k.useState(),f=k.useRef(null),h=Cn(e,f,l.onScrollbarYChange);return k.useEffect(()=>{f.current&&c(window.getComputedStyle(f.current))},[]),O.jsx(uE,{...a,"data-orientation":"vertical",ref:h,sizes:t,style:{"--sa-thumb-height":`${of(t)}px`,...s},onThumbPointerDown:m=>n.onThumbPointerDown(m.y),onDragScroll:m=>n.onDragScroll(m.y),onWheelScroll:(m,g)=>{if(l.viewport){const y=l.viewport.scrollTop+m.deltaY;n.onWheelScroll(y),oE(y,g)&&m.preventDefault()}},onResize:()=>{f.current&&l.viewport&&u&&r({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:f.current.clientHeight,paddingStart:kd(u.paddingTop),paddingEnd:kd(u.paddingBottom)}})}})});dE.displayName="@mantine/core/ScrollAreaScrollbarY";const lf=k.forwardRef((n,e)=>{const{orientation:t="vertical",...r}=n,{dir:s}=ky(),a=Qn(),l=k.useRef(null),u=k.useRef(0),[c,f]=k.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=aE(c.viewport,c.content),m={...r,sizes:c,onSizesChange:f,hasThumb:h>0&&h<1,onThumbChange:y=>{l.current=y},onThumbPointerUp:()=>{u.current=0},onThumbPointerDown:y=>{u.current=y}},g=(y,w)=>jA(y,u.current,c,w);return t==="horizontal"?O.jsx(cE,{...m,ref:e,onThumbPositionChange:()=>{if(a.viewport&&l.current){const y=a.viewport.scrollLeft,w=R0(y,c,s);l.current.style.transform=`translate3d(${w}px, 0, 0)`}},onWheelScroll:y=>{a.viewport&&(a.viewport.scrollLeft=y)},onDragScroll:y=>{a.viewport&&(a.viewport.scrollLeft=g(y,s))}}):t==="vertical"?O.jsx(dE,{...m,ref:e,onThumbPositionChange:()=>{if(a.viewport&&l.current){const y=a.viewport.scrollTop,w=R0(y,c);c.scrollbar.size===0?l.current.style.setProperty("--thumb-opacity","0"):l.current.style.setProperty("--thumb-opacity","1"),l.current.style.transform=`translate3d(0, ${w}px, 0)`}},onWheelScroll:y=>{a.viewport&&(a.viewport.scrollTop=y)},onDragScroll:y=>{a.viewport&&(a.viewport.scrollTop=g(y))}}):null});lf.displayName="@mantine/core/ScrollAreaScrollbarVisible";const Ry=k.forwardRef((n,e)=>{const t=Qn(),{forceMount:r,...s}=n,[a,l]=k.useState(!1),u=n.orientation==="horizontal",c=nf(()=>{if(t.viewport){const f=t.viewport.offsetWidth<t.viewport.scrollWidth,h=t.viewport.offsetHeight<t.viewport.scrollHeight;l(u?f:h)}},10);return Yi(t.viewport,c),Yi(t.content,c),r||a?O.jsx(lf,{"data-state":a?"visible":"hidden",...s,ref:e}):null});Ry.displayName="@mantine/core/ScrollAreaScrollbarAuto";const fE=k.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=Qn(),[a,l]=k.useState(!1);return k.useEffect(()=>{const{scrollArea:u}=s;let c=0;if(u){const f=()=>{window.clearTimeout(c),l(!0)},h=()=>{c=window.setTimeout(()=>l(!1),s.scrollHideDelay)};return u.addEventListener("pointerenter",f),u.addEventListener("pointerleave",h),()=>{window.clearTimeout(c),u.removeEventListener("pointerenter",f),u.removeEventListener("pointerleave",h)}}},[s.scrollArea,s.scrollHideDelay]),t||a?O.jsx(Ry,{"data-state":a?"visible":"hidden",...r,ref:e}):null});fE.displayName="@mantine/core/ScrollAreaScrollbarHover";const MA=k.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=Qn(),a=n.orientation==="horizontal",[l,u]=k.useState("hidden"),c=nf(()=>u("idle"),100);return k.useEffect(()=>{if(l==="idle"){const f=window.setTimeout(()=>u("hidden"),s.scrollHideDelay);return()=>window.clearTimeout(f)}},[l,s.scrollHideDelay]),k.useEffect(()=>{const{viewport:f}=s,h=a?"scrollLeft":"scrollTop";if(f){let m=f[h];const g=()=>{const y=f[h];m!==y&&(u("scrolling"),c()),m=y};return f.addEventListener("scroll",g),()=>f.removeEventListener("scroll",g)}},[s.viewport,a,c]),t||l!=="hidden"?O.jsx(lf,{"data-state":l==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:Ua(n.onPointerEnter,()=>u("interacting")),onPointerLeave:Ua(n.onPointerLeave,()=>u("idle"))}):null}),Ig=k.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=Qn(),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:l}=s,u=n.orientation==="horizontal";return k.useEffect(()=>(u?a(!0):l(!0),()=>{u?a(!1):l(!1)}),[u,a,l]),s.type==="hover"?O.jsx(fE,{...r,ref:e,forceMount:t}):s.type==="scroll"?O.jsx(MA,{...r,ref:e,forceMount:t}):s.type==="auto"?O.jsx(Ry,{...r,ref:e,forceMount:t}):s.type==="always"?O.jsx(lf,{...r,ref:e}):null});Ig.displayName="@mantine/core/ScrollAreaScrollbar";function DA(n,e=()=>{}){let t={left:n.scrollLeft,top:n.scrollTop},r=0;return function s(){const a={left:n.scrollLeft,top:n.scrollTop},l=t.left!==a.left,u=t.top!==a.top;(l||u)&&e(),t=a,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)}const hE=k.forwardRef((n,e)=>{const{style:t,...r}=n,s=Qn(),a=lE(),{onThumbPositionChange:l}=a,u=Cn(e,h=>a.onThumbChange(h)),c=k.useRef(void 0),f=nf(()=>{c.current&&(c.current(),c.current=void 0)},100);return k.useEffect(()=>{const{viewport:h}=s;if(h){const m=()=>{if(f(),!c.current){const g=DA(h,l);c.current=g,l()}};return l(),h.addEventListener("scroll",m),()=>h.removeEventListener("scroll",m)}},[s.viewport,f,l]),O.jsx("div",{"data-state":a.hasThumb?"visible":"hidden",...r,ref:u,style:{width:"var(--sa-thumb-width)",height:"var(--sa-thumb-height)",...t},onPointerDownCapture:Ua(n.onPointerDownCapture,h=>{const g=h.target.getBoundingClientRect(),y=h.clientX-g.left,w=h.clientY-g.top;a.onThumbPointerDown({x:y,y:w})}),onPointerUp:Ua(n.onPointerUp,a.onThumbPointerUp)})});hE.displayName="@mantine/core/ScrollAreaThumb";const Ng=k.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=lE();return t||s.hasThumb?O.jsx(hE,{ref:e,...r}):null});Ng.displayName="@mantine/core/ScrollAreaThumb";const pE=k.forwardRef(({children:n,style:e,...t},r)=>{const s=Qn(),a=Cn(r,s.onViewportChange);return O.jsx(ke,{...t,ref:a,style:{overflowX:s.scrollbarXEnabled?"scroll":"hidden",overflowY:s.scrollbarYEnabled?"scroll":"hidden",...e},children:O.jsx("div",{style:{minWidth:"100%",display:"table"},ref:s.onContentChange,children:n})})});pE.displayName="@mantine/core/ScrollAreaViewport";var Oy={root:"m_d57069b5",viewport:"m_c0783ff9",viewportInner:"m_f8f631dd",scrollbar:"m_c44ba933",thumb:"m_d8b5e363",corner:"m_21657268"};const mE={scrollHideDelay:1e3,type:"hover",scrollbars:"xy"},FA=(n,{scrollbarSize:e})=>({root:{"--scrollarea-scrollbar-size":ee(e)}}),qa=Ue((n,e)=>{const t=ge("ScrollArea",mE,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,scrollbarSize:c,vars:f,type:h,scrollHideDelay:m,viewportProps:g,viewportRef:y,onScrollPositionChange:w,children:v,offsetScrollbars:x,scrollbars:E,onBottomReached:P,onTopReached:S,...R}=t,[$,I]=k.useState(!1),D=Xe({name:"ScrollArea",props:t,classes:Oy,className:s,style:a,classNames:r,styles:l,unstyled:u,vars:f,varsResolver:FA});return O.jsxs(sE,{type:h==="never"?"always":h,scrollHideDelay:m,ref:e,scrollbars:E,...D("root"),...R,children:[O.jsx(pE,{...g,...D("viewport",{style:g==null?void 0:g.style}),ref:y,"data-offset-scrollbars":x===!0?"xy":x||void 0,"data-scrollbars":E||void 0,onScroll:F=>{var de;(de=g==null?void 0:g.onScroll)==null||de.call(g,F),w==null||w({x:F.currentTarget.scrollLeft,y:F.currentTarget.scrollTop});const{scrollTop:K,scrollHeight:Y,clientHeight:ie}=F.currentTarget;K-(Y-ie)>=0&&(P==null||P()),K===0&&(S==null||S())},children:v}),(E==="xy"||E==="x")&&O.jsx(Ig,{...D("scrollbar"),orientation:"horizontal","data-hidden":h==="never"||void 0,forceMount:!0,onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),children:O.jsx(Ng,{...D("thumb")})}),(E==="xy"||E==="y")&&O.jsx(Ig,{...D("scrollbar"),orientation:"vertical","data-hidden":h==="never"||void 0,forceMount:!0,onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),children:O.jsx(Ng,{...D("thumb")})}),O.jsx($A,{...D("corner"),"data-hovered":$||void 0,"data-hidden":h==="never"||void 0})]})});qa.displayName="@mantine/core/ScrollArea";const Ty=Ue((n,e)=>{const{children:t,classNames:r,styles:s,scrollbarSize:a,scrollHideDelay:l,type:u,dir:c,offsetScrollbars:f,viewportRef:h,onScrollPositionChange:m,unstyled:g,variant:y,viewportProps:w,scrollbars:v,style:x,vars:E,onBottomReached:P,onTopReached:S,...R}=ge("ScrollAreaAutosize",mE,n);return O.jsx(ke,{...R,ref:e,style:[{display:"flex",overflow:"auto"},x],children:O.jsx(ke,{style:{display:"flex",flexDirection:"column",flex:1},children:O.jsx(qa,{classNames:r,styles:s,scrollHideDelay:l,scrollbarSize:a,type:u,dir:c,offsetScrollbars:f,viewportRef:h,onScrollPositionChange:m,unstyled:g,variant:y,viewportProps:w,vars:E,scrollbars:v,onBottomReached:P,onTopReached:S,children:t})})})});qa.classes=Oy;Ty.displayName="@mantine/core/ScrollAreaAutosize";Ty.classes=Oy;qa.Autosize=Ty;var gE={root:"m_87cf2631"};const UA={__staticSelector:"UnstyledButton"},uo=Yn((n,e)=>{const t=ge("UnstyledButton",UA,n),{className:r,component:s="button",__staticSelector:a,unstyled:l,classNames:u,styles:c,style:f,...h}=t,m=Xe({name:a,props:t,classes:gE,className:r,style:f,classNames:u,styles:c,unstyled:l});return O.jsx(ke,{...m("root",{focusable:!0}),component:s,ref:e,type:s==="button"?"button":void 0,...h})});uo.classes=gE;uo.displayName="@mantine/core/UnstyledButton";var yE={root:"m_515a97f8"};const zA={},Ay=Ue((n,e)=>{const t=ge("VisuallyHidden",zA,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,vars:c,...f}=t,h=Xe({name:"VisuallyHidden",classes:yE,props:t,className:s,style:a,classNames:r,styles:l,unstyled:u});return O.jsx(ke,{component:"span",ref:e,...h("root"),...f})});Ay.classes=yE;Ay.displayName="@mantine/core/VisuallyHidden";var _E={root:"m_1b7284a3"};const BA={},HA=(n,{radius:e,shadow:t})=>({root:{"--paper-radius":e===void 0?void 0:rs(e),"--paper-shadow":L1(t)}}),$y=Yn((n,e)=>{const t=ge("Paper",BA,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,withBorder:c,vars:f,radius:h,shadow:m,variant:g,mod:y,...w}=t,v=Xe({name:"Paper",props:t,classes:_E,className:s,style:a,classNames:r,styles:l,unstyled:u,vars:f,varsResolver:HA});return O.jsx(ke,{ref:e,mod:[{"data-with-border":c},y],...v("root"),variant:g,...w})});$y.classes=_E;$y.displayName="@mantine/core/Paper";function uf(){return typeof window<"u"}function co(n){return wE(n)?(n.nodeName||"").toLowerCase():"#document"}function Mn(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function is(n){var e;return(e=(wE(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function wE(n){return uf()?n instanceof Node||n instanceof Mn(n).Node:!1}function cn(n){return uf()?n instanceof Element||n instanceof Mn(n).Element:!1}function Xr(n){return uf()?n instanceof HTMLElement||n instanceof Mn(n).HTMLElement:!1}function O0(n){return!uf()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Mn(n).ShadowRoot}function pu(n){const{overflow:e,overflowX:t,overflowY:r,display:s}=Cr(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(s)}function WA(n){return["table","td","th"].includes(co(n))}function cf(n){return[":popover-open",":modal"].some(e=>{try{return n.matches(e)}catch{return!1}})}function Iy(n){const e=Ny(),t=cn(n)?Cr(n):n;return["transform","translate","scale","rotate","perspective"].some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function VA(n){let e=ua(n);for(;Xr(e)&&!Qi(e);){if(Iy(e))return e;if(cf(e))return null;e=ua(e)}return null}function Ny(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Qi(n){return["html","body","#document"].includes(co(n))}function Cr(n){return Mn(n).getComputedStyle(n)}function df(n){return cn(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function ua(n){if(co(n)==="html")return n;const e=n.assignedSlot||n.parentNode||O0(n)&&n.host||is(n);return O0(e)?e.host:e}function bE(n){const e=ua(n);return Qi(e)?n.ownerDocument?n.ownerDocument.body:n.body:Xr(e)&&pu(e)?e:bE(e)}function Bl(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=bE(n),a=s===((r=n.ownerDocument)==null?void 0:r.body),l=Mn(s);if(a){const u=jg(l);return e.concat(l,l.visualViewport||[],pu(s)?s:[],u&&t?Bl(u):[])}return e.concat(s,Bl(s,[],t))}function jg(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}const Pr=Math.min,Yt=Math.max,Rd=Math.round,Vc=Math.floor,Zr=n=>({x:n,y:n}),qA={left:"right",right:"left",bottom:"top",top:"bottom"},ZA={start:"end",end:"start"};function Lg(n,e,t){return Yt(n,Pr(e,t))}function Rs(n,e){return typeof n=="function"?n(e):n}function kr(n){return n.split("-")[0]}function fo(n){return n.split("-")[1]}function jy(n){return n==="x"?"y":"x"}function Ly(n){return n==="y"?"height":"width"}function Os(n){return["top","bottom"].includes(kr(n))?"y":"x"}function My(n){return jy(Os(n))}function GA(n,e,t){t===void 0&&(t=!1);const r=fo(n),s=My(n),a=Ly(s);let l=s==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[a]>e.floating[a]&&(l=Od(l)),[l,Od(l)]}function JA(n){const e=Od(n);return[Mg(n),e,Mg(e)]}function Mg(n){return n.replace(/start|end/g,e=>ZA[e])}function KA(n,e,t){const r=["left","right"],s=["right","left"],a=["top","bottom"],l=["bottom","top"];switch(n){case"top":case"bottom":return t?e?s:r:e?r:s;case"left":case"right":return e?a:l;default:return[]}}function XA(n,e,t,r){const s=fo(n);let a=KA(kr(n),t==="start",r);return s&&(a=a.map(l=>l+"-"+s),e&&(a=a.concat(a.map(Mg)))),a}function Od(n){return n.replace(/left|right|bottom|top/g,e=>qA[e])}function YA(n){return{top:0,right:0,bottom:0,left:0,...n}}function Dy(n){return typeof n!="number"?YA(n):{top:n,right:n,bottom:n,left:n}}function eo(n){const{x:e,y:t,width:r,height:s}=n;return{width:r,height:s,top:t,left:e,right:e+r,bottom:t+s,x:e,y:t}}function T0(n,e,t){let{reference:r,floating:s}=n;const a=Os(e),l=My(e),u=Ly(l),c=kr(e),f=a==="y",h=r.x+r.width/2-s.width/2,m=r.y+r.height/2-s.height/2,g=r[u]/2-s[u]/2;let y;switch(c){case"top":y={x:h,y:r.y-s.height};break;case"bottom":y={x:h,y:r.y+r.height};break;case"right":y={x:r.x+r.width,y:m};break;case"left":y={x:r.x-s.width,y:m};break;default:y={x:r.x,y:r.y}}switch(fo(e)){case"start":y[l]-=g*(t&&f?-1:1);break;case"end":y[l]+=g*(t&&f?-1:1);break}return y}const QA=async(n,e,t)=>{const{placement:r="bottom",strategy:s="absolute",middleware:a=[],platform:l}=t,u=a.filter(Boolean),c=await(l.isRTL==null?void 0:l.isRTL(e));let f=await l.getElementRects({reference:n,floating:e,strategy:s}),{x:h,y:m}=T0(f,r,c),g=r,y={},w=0;for(let v=0;v<u.length;v++){const{name:x,fn:E}=u[v],{x:P,y:S,data:R,reset:$}=await E({x:h,y:m,initialPlacement:r,placement:g,strategy:s,middlewareData:y,rects:f,platform:l,elements:{reference:n,floating:e}});h=P??h,m=S??m,y={...y,[x]:{...y[x],...R}},$&&w<=50&&(w++,typeof $=="object"&&($.placement&&(g=$.placement),$.rects&&(f=$.rects===!0?await l.getElementRects({reference:n,floating:e,strategy:s}):$.rects),{x:h,y:m}=T0(f,g,c)),v=-1)}return{x:h,y:m,placement:g,strategy:s,middlewareData:y}};async function Fy(n,e){var t;e===void 0&&(e={});const{x:r,y:s,platform:a,rects:l,elements:u,strategy:c}=n,{boundary:f="clippingAncestors",rootBoundary:h="viewport",elementContext:m="floating",altBoundary:g=!1,padding:y=0}=Rs(e,n),w=Dy(y),x=u[g?m==="floating"?"reference":"floating":m],E=eo(await a.getClippingRect({element:(t=await(a.isElement==null?void 0:a.isElement(x)))==null||t?x:x.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(u.floating)),boundary:f,rootBoundary:h,strategy:c})),P=m==="floating"?{x:r,y:s,width:l.floating.width,height:l.floating.height}:l.reference,S=await(a.getOffsetParent==null?void 0:a.getOffsetParent(u.floating)),R=await(a.isElement==null?void 0:a.isElement(S))?await(a.getScale==null?void 0:a.getScale(S))||{x:1,y:1}:{x:1,y:1},$=eo(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:P,offsetParent:S,strategy:c}):P);return{top:(E.top-$.top+w.top)/R.y,bottom:($.bottom-E.bottom+w.bottom)/R.y,left:(E.left-$.left+w.left)/R.x,right:($.right-E.right+w.right)/R.x}}const e$=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:r,placement:s,rects:a,platform:l,elements:u,middlewareData:c}=e,{element:f,padding:h=0}=Rs(n,e)||{};if(f==null)return{};const m=Dy(h),g={x:t,y:r},y=My(s),w=Ly(y),v=await l.getDimensions(f),x=y==="y",E=x?"top":"left",P=x?"bottom":"right",S=x?"clientHeight":"clientWidth",R=a.reference[w]+a.reference[y]-g[y]-a.floating[w],$=g[y]-a.reference[y],I=await(l.getOffsetParent==null?void 0:l.getOffsetParent(f));let D=I?I[S]:0;(!D||!await(l.isElement==null?void 0:l.isElement(I)))&&(D=u.floating[S]||a.floating[w]);const F=R/2-$/2,K=D/2-v[w]/2-1,Y=Pr(m[E],K),ie=Pr(m[P],K),de=Y,ue=D-v[w]-ie,V=D/2-v[w]/2+F,G=Lg(de,V,ue),q=!c.arrow&&fo(s)!=null&&V!==G&&a.reference[w]/2-(V<de?Y:ie)-v[w]/2<0,J=q?V<de?V-de:V-ue:0;return{[y]:g[y]+J,data:{[y]:G,centerOffset:V-G-J,...q&&{alignmentOffset:J}},reset:q}}}),t$=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:s,middlewareData:a,rects:l,initialPlacement:u,platform:c,elements:f}=e,{mainAxis:h=!0,crossAxis:m=!0,fallbackPlacements:g,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:v=!0,...x}=Rs(n,e);if((t=a.arrow)!=null&&t.alignmentOffset)return{};const E=kr(s),P=Os(u),S=kr(u)===u,R=await(c.isRTL==null?void 0:c.isRTL(f.floating)),$=g||(S||!v?[Od(u)]:JA(u)),I=w!=="none";!g&&I&&$.push(...XA(u,v,w,R));const D=[u,...$],F=await Fy(e,x),K=[];let Y=((r=a.flip)==null?void 0:r.overflows)||[];if(h&&K.push(F[E]),m){const V=GA(s,l,R);K.push(F[V[0]],F[V[1]])}if(Y=[...Y,{placement:s,overflows:K}],!K.every(V=>V<=0)){var ie,de;const V=(((ie=a.flip)==null?void 0:ie.index)||0)+1,G=D[V];if(G)return{data:{index:V,overflows:Y},reset:{placement:G}};let q=(de=Y.filter(J=>J.overflows[0]<=0).sort((J,j)=>J.overflows[1]-j.overflows[1])[0])==null?void 0:de.placement;if(!q)switch(y){case"bestFit":{var ue;const J=(ue=Y.filter(j=>{if(I){const B=Os(j.placement);return B===P||B==="y"}return!0}).map(j=>[j.placement,j.overflows.filter(B=>B>0).reduce((B,W)=>B+W,0)]).sort((j,B)=>j[1]-B[1])[0])==null?void 0:ue[0];J&&(q=J);break}case"initialPlacement":q=u;break}if(s!==q)return{reset:{placement:q}}}return{}}}};function vE(n){const e=Pr(...n.map(a=>a.left)),t=Pr(...n.map(a=>a.top)),r=Yt(...n.map(a=>a.right)),s=Yt(...n.map(a=>a.bottom));return{x:e,y:t,width:r-e,height:s-t}}function n$(n){const e=n.slice().sort((s,a)=>s.y-a.y),t=[];let r=null;for(let s=0;s<e.length;s++){const a=e[s];!r||a.y-r.y>r.height/2?t.push([a]):t[t.length-1].push(a),r=a}return t.map(s=>eo(vE(s)))}const r$=function(n){return n===void 0&&(n={}),{name:"inline",options:n,async fn(e){const{placement:t,elements:r,rects:s,platform:a,strategy:l}=e,{padding:u=2,x:c,y:f}=Rs(n,e),h=Array.from(await(a.getClientRects==null?void 0:a.getClientRects(r.reference))||[]),m=n$(h),g=eo(vE(h)),y=Dy(u);function w(){if(m.length===2&&m[0].left>m[1].right&&c!=null&&f!=null)return m.find(x=>c>x.left-y.left&&c<x.right+y.right&&f>x.top-y.top&&f<x.bottom+y.bottom)||g;if(m.length>=2){if(Os(t)==="y"){const Y=m[0],ie=m[m.length-1],de=kr(t)==="top",ue=Y.top,V=ie.bottom,G=de?Y.left:ie.left,q=de?Y.right:ie.right,J=q-G,j=V-ue;return{top:ue,bottom:V,left:G,right:q,width:J,height:j,x:G,y:ue}}const x=kr(t)==="left",E=Yt(...m.map(Y=>Y.right)),P=Pr(...m.map(Y=>Y.left)),S=m.filter(Y=>x?Y.left===P:Y.right===E),R=S[0].top,$=S[S.length-1].bottom,I=P,D=E,F=D-I,K=$-R;return{top:R,bottom:$,left:I,right:D,width:F,height:K,x:I,y:R}}return g}const v=await a.getElementRects({reference:{getBoundingClientRect:w},floating:r.floating,strategy:l});return s.reference.x!==v.reference.x||s.reference.y!==v.reference.y||s.reference.width!==v.reference.width||s.reference.height!==v.reference.height?{reset:{rects:v}}:{}}}};async function s$(n,e){const{placement:t,platform:r,elements:s}=n,a=await(r.isRTL==null?void 0:r.isRTL(s.floating)),l=kr(t),u=fo(t),c=Os(t)==="y",f=["left","top"].includes(l)?-1:1,h=a&&c?-1:1,m=Rs(e,n);let{mainAxis:g,crossAxis:y,alignmentAxis:w}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return u&&typeof w=="number"&&(y=u==="end"?w*-1:w),c?{x:y*h,y:g*f}:{x:g*f,y:y*h}}const a$=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:s,y:a,placement:l,middlewareData:u}=e,c=await s$(e,n);return l===((t=u.offset)==null?void 0:t.placement)&&(r=u.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:a+c.y,data:{...c,placement:l}}}}},i$=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:s}=e,{mainAxis:a=!0,crossAxis:l=!1,limiter:u={fn:x=>{let{x:E,y:P}=x;return{x:E,y:P}}},...c}=Rs(n,e),f={x:t,y:r},h=await Fy(e,c),m=Os(kr(s)),g=jy(m);let y=f[g],w=f[m];if(a){const x=g==="y"?"top":"left",E=g==="y"?"bottom":"right",P=y+h[x],S=y-h[E];y=Lg(P,y,S)}if(l){const x=m==="y"?"top":"left",E=m==="y"?"bottom":"right",P=w+h[x],S=w-h[E];w=Lg(P,w,S)}const v=u.fn({...e,[g]:y,[m]:w});return{...v,data:{x:v.x-t,y:v.y-r,enabled:{[g]:a,[m]:l}}}}}},o$=function(n){return n===void 0&&(n={}),{options:n,fn(e){const{x:t,y:r,placement:s,rects:a,middlewareData:l}=e,{offset:u=0,mainAxis:c=!0,crossAxis:f=!0}=Rs(n,e),h={x:t,y:r},m=Os(s),g=jy(m);let y=h[g],w=h[m];const v=Rs(u,e),x=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(c){const S=g==="y"?"height":"width",R=a.reference[g]-a.floating[S]+x.mainAxis,$=a.reference[g]+a.reference[S]-x.mainAxis;y<R?y=R:y>$&&(y=$)}if(f){var E,P;const S=g==="y"?"width":"height",R=["top","left"].includes(kr(s)),$=a.reference[m]-a.floating[S]+(R&&((E=l.offset)==null?void 0:E[m])||0)+(R?0:x.crossAxis),I=a.reference[m]+a.reference[S]+(R?0:((P=l.offset)==null?void 0:P[m])||0)-(R?x.crossAxis:0);w<$?w=$:w>I&&(w=I)}return{[g]:y,[m]:w}}}},l$=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){var t,r;const{placement:s,rects:a,platform:l,elements:u}=e,{apply:c=()=>{},...f}=Rs(n,e),h=await Fy(e,f),m=kr(s),g=fo(s),y=Os(s)==="y",{width:w,height:v}=a.floating;let x,E;m==="top"||m==="bottom"?(x=m,E=g===(await(l.isRTL==null?void 0:l.isRTL(u.floating))?"start":"end")?"left":"right"):(E=m,x=g==="end"?"top":"bottom");const P=v-h.top-h.bottom,S=w-h.left-h.right,R=Pr(v-h[x],P),$=Pr(w-h[E],S),I=!e.middlewareData.shift;let D=R,F=$;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(F=S),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(D=P),I&&!g){const Y=Yt(h.left,0),ie=Yt(h.right,0),de=Yt(h.top,0),ue=Yt(h.bottom,0);y?F=w-2*(Y!==0||ie!==0?Y+ie:Yt(h.left,h.right)):D=v-2*(de!==0||ue!==0?de+ue:Yt(h.top,h.bottom))}await c({...e,availableWidth:F,availableHeight:D});const K=await l.getDimensions(u.floating);return w!==K.width||v!==K.height?{reset:{rects:!0}}:{}}}};function xE(n){const e=Cr(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=Xr(n),a=s?n.offsetWidth:t,l=s?n.offsetHeight:r,u=Rd(t)!==a||Rd(r)!==l;return u&&(t=a,r=l),{width:t,height:r,$:u}}function Uy(n){return cn(n)?n:n.contextElement}function Zi(n){const e=Uy(n);if(!Xr(e))return Zr(1);const t=e.getBoundingClientRect(),{width:r,height:s,$:a}=xE(e);let l=(a?Rd(t.width):t.width)/r,u=(a?Rd(t.height):t.height)/s;return(!l||!Number.isFinite(l))&&(l=1),(!u||!Number.isFinite(u))&&(u=1),{x:l,y:u}}const u$=Zr(0);function SE(n){const e=Mn(n);return!Ny()||!e.visualViewport?u$:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function c$(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==Mn(n)?!1:e}function Za(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=n.getBoundingClientRect(),a=Uy(n);let l=Zr(1);e&&(r?cn(r)&&(l=Zi(r)):l=Zi(n));const u=c$(a,t,r)?SE(a):Zr(0);let c=(s.left+u.x)/l.x,f=(s.top+u.y)/l.y,h=s.width/l.x,m=s.height/l.y;if(a){const g=Mn(a),y=r&&cn(r)?Mn(r):r;let w=g,v=jg(w);for(;v&&r&&y!==w;){const x=Zi(v),E=v.getBoundingClientRect(),P=Cr(v),S=E.left+(v.clientLeft+parseFloat(P.paddingLeft))*x.x,R=E.top+(v.clientTop+parseFloat(P.paddingTop))*x.y;c*=x.x,f*=x.y,h*=x.x,m*=x.y,c+=S,f+=R,w=Mn(v),v=jg(w)}}return eo({width:h,height:m,x:c,y:f})}function zy(n,e){const t=df(n).scrollLeft;return e?e.left+t:Za(is(n)).left+t}function EE(n,e,t){t===void 0&&(t=!1);const r=n.getBoundingClientRect(),s=r.left+e.scrollLeft-(t?0:zy(n,r)),a=r.top+e.scrollTop;return{x:s,y:a}}function d$(n){let{elements:e,rect:t,offsetParent:r,strategy:s}=n;const a=s==="fixed",l=is(r),u=e?cf(e.floating):!1;if(r===l||u&&a)return t;let c={scrollLeft:0,scrollTop:0},f=Zr(1);const h=Zr(0),m=Xr(r);if((m||!m&&!a)&&((co(r)!=="body"||pu(l))&&(c=df(r)),Xr(r))){const y=Za(r);f=Zi(r),h.x=y.x+r.clientLeft,h.y=y.y+r.clientTop}const g=l&&!m&&!a?EE(l,c,!0):Zr(0);return{width:t.width*f.x,height:t.height*f.y,x:t.x*f.x-c.scrollLeft*f.x+h.x+g.x,y:t.y*f.y-c.scrollTop*f.y+h.y+g.y}}function f$(n){return Array.from(n.getClientRects())}function h$(n){const e=is(n),t=df(n),r=n.ownerDocument.body,s=Yt(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),a=Yt(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let l=-t.scrollLeft+zy(n);const u=-t.scrollTop;return Cr(r).direction==="rtl"&&(l+=Yt(e.clientWidth,r.clientWidth)-s),{width:s,height:a,x:l,y:u}}function p$(n,e){const t=Mn(n),r=is(n),s=t.visualViewport;let a=r.clientWidth,l=r.clientHeight,u=0,c=0;if(s){a=s.width,l=s.height;const f=Ny();(!f||f&&e==="fixed")&&(u=s.offsetLeft,c=s.offsetTop)}return{width:a,height:l,x:u,y:c}}function m$(n,e){const t=Za(n,!0,e==="fixed"),r=t.top+n.clientTop,s=t.left+n.clientLeft,a=Xr(n)?Zi(n):Zr(1),l=n.clientWidth*a.x,u=n.clientHeight*a.y,c=s*a.x,f=r*a.y;return{width:l,height:u,x:c,y:f}}function A0(n,e,t){let r;if(e==="viewport")r=p$(n,t);else if(e==="document")r=h$(is(n));else if(cn(e))r=m$(e,t);else{const s=SE(n);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return eo(r)}function CE(n,e){const t=ua(n);return t===e||!cn(t)||Qi(t)?!1:Cr(t).position==="fixed"||CE(t,e)}function g$(n,e){const t=e.get(n);if(t)return t;let r=Bl(n,[],!1).filter(u=>cn(u)&&co(u)!=="body"),s=null;const a=Cr(n).position==="fixed";let l=a?ua(n):n;for(;cn(l)&&!Qi(l);){const u=Cr(l),c=Iy(l);!c&&u.position==="fixed"&&(s=null),(a?!c&&!s:!c&&u.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||pu(l)&&!c&&CE(n,l))?r=r.filter(h=>h!==l):s=u,l=ua(l)}return e.set(n,r),r}function y$(n){let{element:e,boundary:t,rootBoundary:r,strategy:s}=n;const l=[...t==="clippingAncestors"?cf(e)?[]:g$(e,this._c):[].concat(t),r],u=l[0],c=l.reduce((f,h)=>{const m=A0(e,h,s);return f.top=Yt(m.top,f.top),f.right=Pr(m.right,f.right),f.bottom=Pr(m.bottom,f.bottom),f.left=Yt(m.left,f.left),f},A0(e,u,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function _$(n){const{width:e,height:t}=xE(n);return{width:e,height:t}}function w$(n,e,t){const r=Xr(e),s=is(e),a=t==="fixed",l=Za(n,!0,a,e);let u={scrollLeft:0,scrollTop:0};const c=Zr(0);if(r||!r&&!a)if((co(e)!=="body"||pu(s))&&(u=df(e)),r){const g=Za(e,!0,a,e);c.x=g.x+e.clientLeft,c.y=g.y+e.clientTop}else s&&(c.x=zy(s));const f=s&&!r&&!a?EE(s,u):Zr(0),h=l.left+u.scrollLeft-c.x-f.x,m=l.top+u.scrollTop-c.y-f.y;return{x:h,y:m,width:l.width,height:l.height}}function Jp(n){return Cr(n).position==="static"}function $0(n,e){if(!Xr(n)||Cr(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return is(n)===t&&(t=t.ownerDocument.body),t}function PE(n,e){const t=Mn(n);if(cf(n))return t;if(!Xr(n)){let s=ua(n);for(;s&&!Qi(s);){if(cn(s)&&!Jp(s))return s;s=ua(s)}return t}let r=$0(n,e);for(;r&&WA(r)&&Jp(r);)r=$0(r,e);return r&&Qi(r)&&Jp(r)&&!Iy(r)?t:r||VA(n)||t}const b$=async function(n){const e=this.getOffsetParent||PE,t=this.getDimensions,r=await t(n.floating);return{reference:w$(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function v$(n){return Cr(n).direction==="rtl"}const x$={convertOffsetParentRelativeRectToViewportRelativeRect:d$,getDocumentElement:is,getClippingRect:y$,getOffsetParent:PE,getElementRects:b$,getClientRects:f$,getDimensions:_$,getScale:Zi,isElement:cn,isRTL:v$};function kE(n,e){return n.x===e.x&&n.y===e.y&&n.width===e.width&&n.height===e.height}function S$(n,e){let t=null,r;const s=is(n);function a(){var u;clearTimeout(r),(u=t)==null||u.disconnect(),t=null}function l(u,c){u===void 0&&(u=!1),c===void 0&&(c=1),a();const f=n.getBoundingClientRect(),{left:h,top:m,width:g,height:y}=f;if(u||e(),!g||!y)return;const w=Vc(m),v=Vc(s.clientWidth-(h+g)),x=Vc(s.clientHeight-(m+y)),E=Vc(h),S={rootMargin:-w+"px "+-v+"px "+-x+"px "+-E+"px",threshold:Yt(0,Pr(1,c))||1};let R=!0;function $(I){const D=I[0].intersectionRatio;if(D!==c){if(!R)return l();D?l(!1,D):r=setTimeout(()=>{l(!1,1e-7)},1e3)}D===1&&!kE(f,n.getBoundingClientRect())&&l(),R=!1}try{t=new IntersectionObserver($,{...S,root:s.ownerDocument})}catch{t=new IntersectionObserver($,S)}t.observe(n)}return l(!0),a}function E$(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:l=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,f=Uy(n),h=s||a?[...f?Bl(f):[],...Bl(e)]:[];h.forEach(E=>{s&&E.addEventListener("scroll",t,{passive:!0}),a&&E.addEventListener("resize",t)});const m=f&&u?S$(f,t):null;let g=-1,y=null;l&&(y=new ResizeObserver(E=>{let[P]=E;P&&P.target===f&&y&&(y.unobserve(e),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var S;(S=y)==null||S.observe(e)})),t()}),f&&!c&&y.observe(f),y.observe(e));let w,v=c?Za(n):null;c&&x();function x(){const E=Za(n);v&&!kE(v,E)&&t(),v=E,w=requestAnimationFrame(x)}return t(),()=>{var E;h.forEach(P=>{s&&P.removeEventListener("scroll",t),a&&P.removeEventListener("resize",t)}),m==null||m(),(E=y)==null||E.disconnect(),y=null,c&&cancelAnimationFrame(w)}}const C$=a$,P$=i$,k$=t$,R$=l$,I0=e$,O$=r$,T$=o$,A$=(n,e,t)=>{const r=new Map,s={platform:x$,...t},a={...s.platform,_c:r};return QA(n,e,{...s,platform:a})};var pd=typeof document<"u"?k.useLayoutEffect:k.useEffect;function Td(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,s;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!Td(n[r],e[r]))return!1;return!0}if(s=Object.keys(n),t=s.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=t;r--!==0;){const a=s[r];if(!(a==="_owner"&&n.$$typeof)&&!Td(n[a],e[a]))return!1}return!0}return n!==n&&e!==e}function RE(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function N0(n,e){const t=RE(n);return Math.round(e*t)/t}function Kp(n){const e=k.useRef(n);return pd(()=>{e.current=n}),e}function $$(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:s,elements:{reference:a,floating:l}={},transform:u=!0,whileElementsMounted:c,open:f}=n,[h,m]=k.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[g,y]=k.useState(r);Td(g,r)||y(r);const[w,v]=k.useState(null),[x,E]=k.useState(null),P=k.useCallback(j=>{j!==I.current&&(I.current=j,v(j))},[]),S=k.useCallback(j=>{j!==D.current&&(D.current=j,E(j))},[]),R=a||w,$=l||x,I=k.useRef(null),D=k.useRef(null),F=k.useRef(h),K=c!=null,Y=Kp(c),ie=Kp(s),de=Kp(f),ue=k.useCallback(()=>{if(!I.current||!D.current)return;const j={placement:e,strategy:t,middleware:g};ie.current&&(j.platform=ie.current),A$(I.current,D.current,j).then(B=>{const W={...B,isPositioned:de.current!==!1};V.current&&!Td(F.current,W)&&(F.current=W,af.flushSync(()=>{m(W)}))})},[g,e,t,ie,de]);pd(()=>{f===!1&&F.current.isPositioned&&(F.current.isPositioned=!1,m(j=>({...j,isPositioned:!1})))},[f]);const V=k.useRef(!1);pd(()=>(V.current=!0,()=>{V.current=!1}),[]),pd(()=>{if(R&&(I.current=R),$&&(D.current=$),R&&$){if(Y.current)return Y.current(R,$,ue);ue()}},[R,$,ue,Y,K]);const G=k.useMemo(()=>({reference:I,floating:D,setReference:P,setFloating:S}),[P,S]),q=k.useMemo(()=>({reference:R,floating:$}),[R,$]),J=k.useMemo(()=>{const j={position:t,left:0,top:0};if(!q.floating)return j;const B=N0(q.floating,h.x),W=N0(q.floating,h.y);return u?{...j,transform:"translate("+B+"px, "+W+"px)",...RE(q.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:B,top:W}},[t,u,q.floating,h.x,h.y]);return k.useMemo(()=>({...h,update:ue,refs:G,elements:q,floatingStyles:J}),[h,ue,G,q,J])}const I$=n=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:n,fn(t){const{element:r,padding:s}=typeof n=="function"?n(t):n;return r&&e(r)?r.current!=null?I0({element:r.current,padding:s}).fn(t):{}:r?I0({element:r,padding:s}).fn(t):{}}}},N$=(n,e)=>({...C$(n),options:[n,e]}),j$=(n,e)=>({...P$(n),options:[n,e]}),j0=(n,e)=>({...T$(n),options:[n,e]}),L0=(n,e)=>({...k$(n),options:[n,e]}),L$=(n,e)=>({...R$(n),options:[n,e]}),M0=(n,e)=>({...O$(n),options:[n,e]}),M$=(n,e)=>({...I$(n),options:[n,e]}),OE={...NO},D$=OE.useInsertionEffect,F$=D$||(n=>n());function U$(n){const e=k.useRef(()=>{});return F$(()=>{e.current=n}),k.useCallback(function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.current==null?void 0:e.current(...r)},[])}var Dg=typeof document<"u"?k.useLayoutEffect:k.useEffect;let D0=!1,z$=0;const F0=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+z$++;function B$(){const[n,e]=k.useState(()=>D0?F0():void 0);return Dg(()=>{n==null&&e(F0())},[]),k.useEffect(()=>{D0=!0},[]),n}const H$=OE.useId,W$=H$||B$;function V$(){const n=new Map;return{emit(e,t){var r;(r=n.get(e))==null||r.forEach(s=>s(t))},on(e,t){n.set(e,[...n.get(e)||[],t])},off(e,t){var r;n.set(e,((r=n.get(e))==null?void 0:r.filter(s=>s!==t))||[])}}}const q$=k.createContext(null),Z$=k.createContext(null),G$=()=>{var n;return((n=k.useContext(q$))==null?void 0:n.id)||null},J$=()=>k.useContext(Z$);function K$(n){const{open:e=!1,onOpenChange:t,elements:r}=n,s=W$(),a=k.useRef({}),[l]=k.useState(()=>V$()),u=G$()!=null,[c,f]=k.useState(r.reference),h=U$((y,w,v)=>{a.current.openEvent=y?w:void 0,l.emit("openchange",{open:y,event:w,reason:v,nested:u}),t==null||t(y,w,v)}),m=k.useMemo(()=>({setPositionReference:f}),[]),g=k.useMemo(()=>({reference:c||r.reference||null,floating:r.floating||null,domReference:r.reference}),[c,r.reference,r.floating]);return k.useMemo(()=>({dataRef:a,open:e,onOpenChange:h,elements:g,events:l,floatingId:s,refs:m}),[e,h,g,l,s,m])}function X$(n){n===void 0&&(n={});const{nodeId:e}=n,t=K$({...n,elements:{reference:null,floating:null,...n.elements}}),r=n.rootContext||t,s=r.elements,[a,l]=k.useState(null),[u,c]=k.useState(null),h=(s==null?void 0:s.domReference)||a,m=k.useRef(null),g=J$();Dg(()=>{h&&(m.current=h)},[h]);const y=$$({...n,elements:{...s,...u&&{reference:u}}}),w=k.useCallback(S=>{const R=cn(S)?{getBoundingClientRect:()=>S.getBoundingClientRect(),contextElement:S}:S;c(R),y.refs.setReference(R)},[y.refs]),v=k.useCallback(S=>{(cn(S)||S===null)&&(m.current=S,l(S)),(cn(y.refs.reference.current)||y.refs.reference.current===null||S!==null&&!cn(S))&&y.refs.setReference(S)},[y.refs]),x=k.useMemo(()=>({...y.refs,setReference:v,setPositionReference:w,domReference:m}),[y.refs,v,w]),E=k.useMemo(()=>({...y.elements,domReference:h}),[y.elements,h]),P=k.useMemo(()=>({...y,...r,refs:x,elements:E,nodeId:e}),[y,x,E,e,r]);return Dg(()=>{r.dataRef.current.floatingContext=P;const S=g==null?void 0:g.nodesRef.current.find(R=>R.id===e);S&&(S.context=P)}),k.useMemo(()=>({...y,context:P,refs:x,elements:E}),[y,x,E,P])}function Y$(n,e){if(n==="rtl"&&(e.includes("right")||e.includes("left"))){const[t,r]=e.split("-"),s=t==="right"?"left":"right";return r===void 0?s:`${s}-${r}`}return e}function U0(n,e,t,r){return n==="center"||r==="center"?{top:e}:n==="end"?{bottom:t}:n==="start"?{top:t}:{}}function z0(n,e,t,r,s){return n==="center"||r==="center"?{left:e}:n==="end"?{[s==="ltr"?"right":"left"]:t}:n==="start"?{[s==="ltr"?"left":"right"]:t}:{}}const Q$={bottom:"borderTopLeftRadius",left:"borderTopRightRadius",right:"borderBottomLeftRadius",top:"borderBottomRightRadius"};function eI({position:n,arrowSize:e,arrowOffset:t,arrowRadius:r,arrowPosition:s,arrowX:a,arrowY:l,dir:u}){const[c,f="center"]=n.split("-"),h={width:e,height:e,transform:"rotate(45deg)",position:"absolute",[Q$[c]]:r},m=-e/2;return c==="left"?{...h,...U0(f,l,t,s),right:m,borderLeftColor:"transparent",borderBottomColor:"transparent",clipPath:"polygon(100% 0, 0 0, 100% 100%)"}:c==="right"?{...h,...U0(f,l,t,s),left:m,borderRightColor:"transparent",borderTopColor:"transparent",clipPath:"polygon(0 100%, 0 0, 100% 100%)"}:c==="top"?{...h,...z0(f,a,t,s,u),bottom:m,borderTopColor:"transparent",borderLeftColor:"transparent",clipPath:"polygon(0 100%, 100% 100%, 100% 0)"}:c==="bottom"?{...h,...z0(f,a,t,s,u),top:m,borderBottomColor:"transparent",borderRightColor:"transparent",clipPath:"polygon(0 100%, 0 0, 100% 0)"}:{}}const TE=k.forwardRef(({position:n,arrowSize:e,arrowOffset:t,arrowRadius:r,arrowPosition:s,visible:a,arrowX:l,arrowY:u,style:c,...f},h)=>{const{dir:m}=ky();return a?O.jsx("div",{...f,ref:h,style:{...c,...eI({position:n,arrowSize:e,arrowOffset:t,arrowRadius:r,arrowPosition:s,dir:m,arrowX:l,arrowY:u})}}):null});TE.displayName="@mantine/core/FloatingArrow";var AE={root:"m_9814e45f"};const tI={zIndex:N1("modal")},nI=(n,{gradient:e,color:t,backgroundOpacity:r,blur:s,radius:a,zIndex:l})=>({root:{"--overlay-bg":e||(t!==void 0||r!==void 0)&&Ur(t||"#000",r??.6)||void 0,"--overlay-filter":s?`blur(${ee(s)})`:void 0,"--overlay-radius":a===void 0?void 0:rs(a),"--overlay-z-index":l==null?void 0:l.toString()}}),By=Yn((n,e)=>{const t=ge("Overlay",tI,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,vars:c,fixed:f,center:h,children:m,radius:g,zIndex:y,gradient:w,blur:v,color:x,backgroundOpacity:E,mod:P,...S}=t,R=Xe({name:"Overlay",props:t,classes:AE,className:s,style:a,classNames:r,styles:l,unstyled:u,vars:c,varsResolver:nI});return O.jsx(ke,{ref:e,...R("root"),mod:[{center:h,fixed:f},P],...S,children:m})});By.classes=AE;By.displayName="@mantine/core/Overlay";function rI(n){const e=document.createElement("div");return e.setAttribute("data-portal","true"),typeof n.className=="string"&&e.classList.add(...n.className.split(" ").filter(Boolean)),typeof n.style=="object"&&Object.assign(e.style,n.style),typeof n.id=="string"&&e.setAttribute("id",n.id),e}const sI={},$E=k.forwardRef((n,e)=>{const{children:t,target:r,...s}=ge("Portal",sI,n),[a,l]=k.useState(!1),u=k.useRef(null);return du(()=>(l(!0),u.current=r?typeof r=="string"?document.querySelector(r):r:rI(s),Cd(e,u.current),!r&&u.current&&document.body.appendChild(u.current),()=>{!r&&u.current&&document.body.removeChild(u.current)}),[r]),!a||!u.current?null:af.createPortal(O.jsx(O.Fragment,{children:t}),u.current)});$E.displayName="@mantine/core/Portal";function Hy({withinPortal:n=!0,children:e,...t}){return n?O.jsx($E,{...t,children:e}):O.jsx(O.Fragment,{children:e})}Hy.displayName="@mantine/core/OptionalPortal";const gl=n=>({in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:`scale(.9) translateY(${n==="bottom"?10:-10}px)`},transitionProperty:"transform, opacity"}),qc={fade:{in:{opacity:1},out:{opacity:0},transitionProperty:"opacity"},"fade-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(30px)"},transitionProperty:"opacity, transform"},"fade-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-30px)"},transitionProperty:"opacity, transform"},"fade-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(30px)"},transitionProperty:"opacity, transform"},"fade-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-30px)"},transitionProperty:"opacity, transform"},scale:{in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-y":{in:{opacity:1,transform:"scaleY(1)"},out:{opacity:0,transform:"scaleY(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-x":{in:{opacity:1,transform:"scaleX(1)"},out:{opacity:0,transform:"scaleX(0)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"skew-up":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(-20px) skew(-10deg, -5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"skew-down":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(20px) skew(-10deg, -5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-left":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(-5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-right":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-100%)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(100%)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"slide-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(100%)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"slide-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-100%)"},common:{transformOrigin:"right"},transitionProperty:"transform, opacity"},pop:{...gl("bottom"),common:{transformOrigin:"center center"}},"pop-bottom-left":{...gl("bottom"),common:{transformOrigin:"bottom left"}},"pop-bottom-right":{...gl("bottom"),common:{transformOrigin:"bottom right"}},"pop-top-left":{...gl("top"),common:{transformOrigin:"top left"}},"pop-top-right":{...gl("top"),common:{transformOrigin:"top right"}}},B0={entering:"in",entered:"in",exiting:"out",exited:"out","pre-exiting":"out","pre-entering":"out"};function aI({transition:n,state:e,duration:t,timingFunction:r}){const s={transitionDuration:`${t}ms`,transitionTimingFunction:r};return typeof n=="string"?n in qc?{transitionProperty:qc[n].transitionProperty,...s,...qc[n].common,...qc[n][B0[e]]}:{}:{transitionProperty:n.transitionProperty,...s,...n.common,...n[B0[e]]}}function iI({duration:n,exitDuration:e,timingFunction:t,mounted:r,onEnter:s,onExit:a,onEntered:l,onExited:u,enterDelay:c,exitDelay:f}){const h=as(),m=z1(),g=h.respectReducedMotion?m:!1,[y,w]=k.useState(g?0:n),[v,x]=k.useState(r?"entered":"exited"),E=k.useRef(-1),P=k.useRef(-1),S=k.useRef(-1),R=I=>{const D=I?s:a,F=I?l:u;window.clearTimeout(E.current);const K=g?0:I?n:e;w(K),K===0?(typeof D=="function"&&D(),typeof F=="function"&&F(),x(I?"entered":"exited")):S.current=requestAnimationFrame(()=>{PA.flushSync(()=>{x(I?"pre-entering":"pre-exiting")}),S.current=requestAnimationFrame(()=>{typeof D=="function"&&D(),x(I?"entering":"exiting"),E.current=window.setTimeout(()=>{typeof F=="function"&&F(),x(I?"entered":"exited")},K)})})},$=I=>{if(window.clearTimeout(P.current),typeof(I?c:f)!="number"){R(I);return}P.current=window.setTimeout(()=>{R(I)},I?c:f)};return Wa(()=>{$(r)},[r]),k.useEffect(()=>()=>{window.clearTimeout(E.current),cancelAnimationFrame(S.current)},[]),{transitionDuration:y,transitionStatus:v,transitionTimingFunction:t||"ease"}}function mu({keepMounted:n,transition:e="fade",duration:t=250,exitDuration:r=t,mounted:s,children:a,timingFunction:l="ease",onExit:u,onEntered:c,onEnter:f,onExited:h,enterDelay:m,exitDelay:g}){const{transitionDuration:y,transitionStatus:w,transitionTimingFunction:v}=iI({mounted:s,exitDuration:r,duration:t,timingFunction:l,onExit:u,onEntered:c,onEnter:f,onExited:h,enterDelay:m,exitDelay:g});return y===0?s?O.jsx(O.Fragment,{children:a({})}):n?a({display:"none"}):null:w==="exited"?n?a({display:"none"}):null:O.jsx(O.Fragment,{children:a(aI({transition:e,duration:y,state:w,timingFunction:v}))})}mu.displayName="@mantine/core/Transition";const[oI,IE]=ni("Popover component was not found in the tree");function Wy({children:n,active:e=!0,refProp:t="ref",innerRef:r}){const s=uT(e),a=Cn(s,r);return cu(n)?k.cloneElement(n,{[t]:a}):n}function NE(n){return O.jsx(Ay,{tabIndex:-1,"data-autofocus":!0,...n})}Wy.displayName="@mantine/core/FocusTrap";NE.displayName="@mantine/core/FocusTrapInitialFocus";Wy.InitialFocus=NE;var jE={dropdown:"m_38a85659",arrow:"m_a31dc6c1",overlay:"m_3d7bc908"};const lI={},Vy=Ue((n,e)=>{var x,E,P,S;const t=ge("PopoverDropdown",lI,n),{className:r,style:s,vars:a,children:l,onKeyDownCapture:u,variant:c,classNames:f,styles:h,...m}=t,g=IE(),y=rT({opened:g.opened,shouldReturnFocus:g.returnFocus}),w=g.withRoles?{"aria-labelledby":g.getTargetId(),id:g.getDropdownId(),role:"dialog",tabIndex:-1}:{},v=Cn(e,g.floating);return g.disabled?null:O.jsx(Hy,{...g.portalProps,withinPortal:g.withinPortal,children:O.jsx(mu,{mounted:g.opened,...g.transitionProps,transition:((x=g.transitionProps)==null?void 0:x.transition)||"fade",duration:((E=g.transitionProps)==null?void 0:E.duration)??150,keepMounted:g.keepMounted,exitDuration:typeof((P=g.transitionProps)==null?void 0:P.exitDuration)=="number"?g.transitionProps.exitDuration:(S=g.transitionProps)==null?void 0:S.duration,children:R=>O.jsx(Wy,{active:g.trapFocus&&g.opened,innerRef:v,children:O.jsxs(ke,{...w,...m,variant:c,onKeyDownCapture:JO(g.onClose,{active:g.closeOnEscape,onTrigger:y,onKeyDown:u}),"data-position":g.placement,"data-fixed":g.floatingStrategy==="fixed"||void 0,...g.getStyles("dropdown",{className:r,props:t,classNames:f,styles:h,style:[{...R,zIndex:g.zIndex,top:g.y??0,left:g.x??0,width:g.width==="target"?void 0:ee(g.width)},g.resolvedStyles.dropdown,h==null?void 0:h.dropdown,s]}),children:[l,O.jsx(TE,{ref:g.arrowRef,arrowX:g.arrowX,arrowY:g.arrowY,visible:g.withArrow,position:g.placement,arrowSize:g.arrowSize,arrowRadius:g.arrowRadius,arrowOffset:g.arrowOffset,arrowPosition:g.arrowPosition,...g.getStyles("arrow",{props:t,classNames:f,styles:h})})]})})})})});Vy.classes=jE;Vy.displayName="@mantine/core/PopoverDropdown";const uI={refProp:"ref",popupType:"dialog"},LE=Ue((n,e)=>{const{children:t,refProp:r,popupType:s,...a}=ge("PopoverTarget",uI,n);if(!cu(t))throw new Error("Popover.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const l=a,u=IE(),c=Cn(u.reference,B1(t),e),f=u.withRoles?{"aria-haspopup":s,"aria-expanded":u.opened,"aria-controls":u.getDropdownId(),id:u.getTargetId()}:{};return k.cloneElement(t,{...l,...f,...u.targetProps,className:ss(u.targetProps.className,l.className,t.props.className),[r]:c,...u.controlled?null:{onClick:u.onToggle}})});LE.displayName="@mantine/core/PopoverTarget";function cI({opened:n,floating:e,position:t,positionDependencies:r}){const[s,a]=k.useState(0);k.useEffect(()=>{if(e.refs.reference.current&&e.refs.floating.current&&n)return E$(e.refs.reference.current,e.refs.floating.current,e.update)},[e.refs.reference.current,e.refs.floating.current,n,s,t]),Wa(()=>{e.update()},r),Wa(()=>{a(l=>l+1)},[n])}function dI(n){if(n===void 0)return{shift:!0,flip:!0};const e={...n};return n.shift===void 0&&(e.shift=!0),n.flip===void 0&&(e.flip=!0),e}function fI(n,e){const t=dI(n.middlewares),r=[N$(n.offset)];return t.shift&&r.push(j$(typeof t.shift=="boolean"?{limiter:j0(),padding:5}:{limiter:j0(),padding:5,...t.shift})),t.flip&&r.push(typeof t.flip=="boolean"?L0():L0(t.flip)),t.inline&&r.push(typeof t.inline=="boolean"?M0():M0(t.inline)),r.push(M$({element:n.arrowRef,padding:n.arrowOffset})),(t.size||n.width==="target")&&r.push(L$({...typeof t.size=="boolean"?{}:t.size,apply({rects:s,availableWidth:a,availableHeight:l,...u}){var h;const f=((h=e().refs.floating.current)==null?void 0:h.style)??{};t.size&&(typeof t.size=="object"&&t.size.apply?t.size.apply({rects:s,availableWidth:a,availableHeight:l,...u}):Object.assign(f,{maxWidth:`${a}px`,maxHeight:`${l}px`})),n.width==="target"&&Object.assign(f,{width:`${s.reference.width}px`})}})),r}function hI(n){const[e,t]=Va({value:n.opened,defaultValue:n.defaultOpened,finalValue:!1,onChange:n.onChange}),r=k.useRef(e),s=()=>{e&&t(!1)},a=()=>t(!e),l=X$({strategy:n.strategy,placement:n.position,middleware:fI(n,()=>l)});return cI({opened:e,position:n.position,positionDependencies:n.positionDependencies||[],floating:l}),Wa(()=>{var u;(u=n.onPositionChange)==null||u.call(n,l.placement)},[l.placement]),Wa(()=>{var u,c;e!==r.current&&(e?(c=n.onOpen)==null||c.call(n):(u=n.onClose)==null||u.call(n)),r.current=e},[e,n.onClose,n.onOpen]),{floating:l,controlled:typeof n.opened=="boolean",opened:e,onClose:s,onToggle:a}}const pI={position:"bottom",offset:8,positionDependencies:[],transitionProps:{transition:"fade",duration:150},middlewares:{flip:!0,shift:!0,inline:!1},arrowSize:7,arrowOffset:5,arrowRadius:0,arrowPosition:"side",closeOnClickOutside:!0,withinPortal:!0,closeOnEscape:!0,trapFocus:!1,withRoles:!0,returnFocus:!1,withOverlay:!1,clickOutsideEvents:["mousedown","touchstart"],zIndex:N1("popover"),__staticSelector:"Popover",width:"max-content"},mI=(n,{radius:e,shadow:t})=>({dropdown:{"--popover-radius":e===void 0?void 0:rs(e),"--popover-shadow":L1(t)}});function ya(n){var Mt,zn,us,Pn,xt,Is;const e=ge("Popover",pI,n),{children:t,position:r,offset:s,onPositionChange:a,positionDependencies:l,opened:u,transitionProps:c,onExitTransitionEnd:f,onEnterTransitionEnd:h,width:m,middlewares:g,withArrow:y,arrowSize:w,arrowOffset:v,arrowRadius:x,arrowPosition:E,unstyled:P,classNames:S,styles:R,closeOnClickOutside:$,withinPortal:I,portalProps:D,closeOnEscape:F,clickOutsideEvents:K,trapFocus:Y,onClose:ie,onOpen:de,onChange:ue,zIndex:V,radius:G,shadow:q,id:J,defaultOpened:j,__staticSelector:B,withRoles:W,disabled:T,returnFocus:M,variant:X,keepMounted:ae,vars:Q,floatingStrategy:le,withOverlay:Re,overlayProps:Ee,...be}=e,je=Xe({name:B,props:e,classes:jE,classNames:S,styles:R,unstyled:P,rootSelector:"dropdown",vars:Q,varsResolver:mI}),{resolvedStyles:ct}=hu({classNames:S,styles:R,props:e}),qt=k.useRef(null),[Un,Ir]=k.useState(null),[ls,Ot]=k.useState(null),{dir:pt}=ky(),nr=lo(J),et=hI({middlewares:g,width:m,position:Y$(pt,r),offset:typeof s=="number"?s+(y?w/2:0):s,arrowRef:qt,arrowOffset:v,onPositionChange:a,positionDependencies:l,opened:u,defaultOpened:j,onChange:ue,onOpen:de,onClose:ie,strategy:le});QO(()=>$&&et.onClose(),K,[Un,ls]);const rr=k.useCallback(dt=>{Ir(dt),et.floating.refs.setReference(dt)},[et.floating.refs.setReference]),vt=k.useCallback(dt=>{Ot(dt),et.floating.refs.setFloating(dt)},[et.floating.refs.setFloating]),$s=k.useCallback(()=>{var dt;(dt=c==null?void 0:c.onExited)==null||dt.call(c),f==null||f()},[c==null?void 0:c.onExited,f]),ai=k.useCallback(()=>{var dt;(dt=c==null?void 0:c.onEntered)==null||dt.call(c),h==null||h()},[c==null?void 0:c.onEntered,h]);return O.jsxs(oI,{value:{returnFocus:M,disabled:T,controlled:et.controlled,reference:rr,floating:vt,x:et.floating.x,y:et.floating.y,arrowX:(us=(zn=(Mt=et.floating)==null?void 0:Mt.middlewareData)==null?void 0:zn.arrow)==null?void 0:us.x,arrowY:(Is=(xt=(Pn=et.floating)==null?void 0:Pn.middlewareData)==null?void 0:xt.arrow)==null?void 0:Is.y,opened:et.opened,arrowRef:qt,transitionProps:{...c,onExited:$s,onEntered:ai},width:m,withArrow:y,arrowSize:w,arrowOffset:v,arrowRadius:x,arrowPosition:E,placement:et.floating.placement,trapFocus:Y,withinPortal:I,portalProps:D,zIndex:V,radius:G,shadow:q,closeOnEscape:F,onClose:et.onClose,onToggle:et.onToggle,getTargetId:()=>`${nr}-target`,getDropdownId:()=>`${nr}-dropdown`,withRoles:W,targetProps:be,__staticSelector:B,classNames:S,styles:R,unstyled:P,variant:X,keepMounted:ae,getStyles:je,resolvedStyles:ct,floatingStrategy:le},children:[t,Re&&O.jsx(mu,{transition:"fade",mounted:et.opened,duration:(c==null?void 0:c.duration)||250,exitDuration:(c==null?void 0:c.exitDuration)||250,children:dt=>O.jsx(Hy,{withinPortal:I,children:O.jsx(By,{...Ee,...je("overlay",{className:Ee==null?void 0:Ee.className,style:[dt,Ee==null?void 0:Ee.style]})})})})]})}ya.Target=LE;ya.Dropdown=Vy;ya.displayName="@mantine/core/Popover";ya.extend=n=>n;var _r={root:"m_5ae2e3c",barsLoader:"m_7a2bd4cd",bar:"m_870bb79","bars-loader-animation":"m_5d2b3b9d",dotsLoader:"m_4e3f22d7",dot:"m_870c4af","loader-dots-animation":"m_aac34a1",ovalLoader:"m_b34414df","oval-loader-animation":"m_f8e89c4b"};const ME=k.forwardRef(({className:n,...e},t)=>O.jsxs(ke,{component:"span",className:ss(_r.barsLoader,n),...e,ref:t,children:[O.jsx("span",{className:_r.bar}),O.jsx("span",{className:_r.bar}),O.jsx("span",{className:_r.bar})]}));ME.displayName="@mantine/core/Bars";const DE=k.forwardRef(({className:n,...e},t)=>O.jsxs(ke,{component:"span",className:ss(_r.dotsLoader,n),...e,ref:t,children:[O.jsx("span",{className:_r.dot}),O.jsx("span",{className:_r.dot}),O.jsx("span",{className:_r.dot})]}));DE.displayName="@mantine/core/Dots";const FE=k.forwardRef(({className:n,...e},t)=>O.jsx(ke,{component:"span",className:ss(_r.ovalLoader,n),...e,ref:t}));FE.displayName="@mantine/core/Oval";const UE={bars:ME,oval:FE,dots:DE},gI={loaders:UE,type:"oval"},yI=(n,{size:e,color:t})=>({root:{"--loader-size":_t(e,"loader-size"),"--loader-color":t?zl(t,n):void 0}}),Ga=Ue((n,e)=>{const t=ge("Loader",gI,n),{size:r,color:s,type:a,vars:l,className:u,style:c,classNames:f,styles:h,unstyled:m,loaders:g,variant:y,children:w,...v}=t,x=Xe({name:"Loader",props:t,classes:_r,className:u,style:c,classNames:f,styles:h,unstyled:m,vars:l,varsResolver:yI});return w?O.jsx(ke,{...x("root"),ref:e,...v,children:w}):O.jsx(ke,{...x("root"),ref:e,component:g[a],variant:y,size:r,...v})});Ga.defaultLoaders=UE;Ga.classes=_r;Ga.displayName="@mantine/core/Loader";var ho={root:"m_8d3f4000",icon:"m_8d3afb97",loader:"m_302b9fb1",group:"m_1a0f1b21",groupSection:"m_437b6484"};const H0={orientation:"horizontal"},_I=(n,{borderWidth:e})=>({group:{"--ai-border-width":ee(e)}}),qy=Ue((n,e)=>{const t=ge("ActionIconGroup",H0,n),{className:r,style:s,classNames:a,styles:l,unstyled:u,orientation:c,vars:f,borderWidth:h,variant:m,mod:g,...y}=ge("ActionIconGroup",H0,n),w=Xe({name:"ActionIconGroup",props:t,classes:ho,className:r,style:s,classNames:a,styles:l,unstyled:u,vars:f,varsResolver:_I,rootSelector:"group"});return O.jsx(ke,{...w("group"),ref:e,variant:m,mod:[{"data-orientation":c},g],role:"group",...y})});qy.classes=ho;qy.displayName="@mantine/core/ActionIconGroup";const W0={},wI=(n,{radius:e,color:t,gradient:r,variant:s,autoContrast:a,size:l})=>{const u=n.variantColorResolver({color:t||n.primaryColor,theme:n,gradient:r,variant:s||"filled",autoContrast:a});return{groupSection:{"--section-height":_t(l,"section-height"),"--section-padding-x":_t(l,"section-padding-x"),"--section-fz":dn(l),"--section-radius":e===void 0?void 0:rs(e),"--section-bg":t||s?u.background:void 0,"--section-color":u.color,"--section-bd":t||s?u.border:void 0}}},Zy=Ue((n,e)=>{const t=ge("ActionIconGroupSection",W0,n),{className:r,style:s,classNames:a,styles:l,unstyled:u,vars:c,variant:f,gradient:h,radius:m,autoContrast:g,...y}=ge("ActionIconGroupSection",W0,n),w=Xe({name:"ActionIconGroupSection",props:t,classes:ho,className:r,style:s,classNames:a,styles:l,unstyled:u,vars:c,varsResolver:wI,rootSelector:"groupSection"});return O.jsx(ke,{...w("groupSection"),ref:e,variant:f,...y})});Zy.classes=ho;Zy.displayName="@mantine/core/ActionIconGroupSection";const bI={},vI=(n,{size:e,radius:t,variant:r,gradient:s,color:a,autoContrast:l})=>{const u=n.variantColorResolver({color:a||n.primaryColor,theme:n,gradient:s,variant:r||"filled",autoContrast:l});return{root:{"--ai-size":_t(e,"ai-size"),"--ai-radius":t===void 0?void 0:rs(t),"--ai-bg":a||r?u.background:void 0,"--ai-hover":a||r?u.hover:void 0,"--ai-hover-color":a||r?u.hoverColor:void 0,"--ai-color":u.color,"--ai-bd":a||r?u.border:void 0}}},gu=Yn((n,e)=>{const t=ge("ActionIcon",bI,n),{className:r,unstyled:s,variant:a,classNames:l,styles:u,style:c,loading:f,loaderProps:h,size:m,color:g,radius:y,__staticSelector:w,gradient:v,vars:x,children:E,disabled:P,"data-disabled":S,autoContrast:R,mod:$,...I}=t,D=Xe({name:["ActionIcon",w],props:t,className:r,style:c,classes:ho,classNames:l,styles:u,unstyled:s,vars:x,varsResolver:vI});return O.jsxs(uo,{...D("root",{active:!P&&!f&&!S}),...I,unstyled:s,variant:a,size:m,disabled:P||f,ref:e,mod:[{loading:f,disabled:P||S},$],children:[O.jsx(mu,{mounted:!!f,transition:"slide-down",duration:150,children:F=>O.jsx(ke,{component:"span",...D("loader",{style:F}),"aria-hidden":!0,children:O.jsx(Ga,{color:"var(--ai-color)",size:"calc(var(--ai-size) * 0.55)",...h})})}),O.jsx(ke,{component:"span",mod:{loading:f},...D("icon"),children:E})]})});gu.classes=ho;gu.displayName="@mantine/core/ActionIcon";gu.Group=qy;gu.GroupSection=Zy;const zE=k.forwardRef(({size:n="var(--cb-icon-size, 70%)",style:e,...t},r)=>O.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...e,width:n,height:n},ref:r,...t,children:O.jsx("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}));zE.displayName="@mantine/core/CloseIcon";var BE={root:"m_86a44da5","root--subtle":"m_220c80f2"};const xI={variant:"subtle"},SI=(n,{size:e,radius:t,iconSize:r})=>({root:{"--cb-size":_t(e,"cb-size"),"--cb-radius":t===void 0?void 0:rs(t),"--cb-icon-size":ee(r)}}),ff=Yn((n,e)=>{const t=ge("CloseButton",xI,n),{iconSize:r,children:s,vars:a,radius:l,className:u,classNames:c,style:f,styles:h,unstyled:m,"data-disabled":g,disabled:y,variant:w,icon:v,mod:x,__staticSelector:E,...P}=t,S=Xe({name:E||"CloseButton",props:t,className:u,style:f,classes:BE,classNames:c,styles:h,unstyled:m,vars:a,varsResolver:SI});return O.jsxs(uo,{ref:e,...P,unstyled:m,variant:w,disabled:y,mod:[{disabled:y||g},x],...S("root",{variant:w,active:!y&&!g}),children:[v||O.jsx(zE,{}),s]})});ff.classes=BE;ff.displayName="@mantine/core/CloseButton";const[EI,CI]=I1({size:"sm"}),PI={},HE=Ue((n,e)=>{const t=ge("InputClearButton",PI,n),{size:r,variant:s,vars:a,classNames:l,styles:u,...c}=t,f=CI(),{resolvedClassNames:h,resolvedStyles:m}=hu({classNames:l,styles:u,props:t});return O.jsx(ff,{variant:s||"transparent",ref:e,size:r||(f==null?void 0:f.size)||"sm",classNames:h,styles:m,__staticSelector:"InputClearButton",...c})});HE.displayName="@mantine/core/InputClearButton";const[kI,hf]=I1({offsetBottom:!1,offsetTop:!1,describedBy:void 0,getStyles:null,inputId:void 0,labelId:void 0});var er={wrapper:"m_6c018570",input:"m_8fb7ebe7",section:"m_82577fc2",placeholder:"m_88bacfd0",root:"m_46b77525",label:"m_8fdc1311",required:"m_78a94662",error:"m_8f816625",description:"m_fe47ce59"};const V0={},RI=(n,{size:e})=>({description:{"--input-description-size":e===void 0?void 0:`calc(${dn(e)} - ${ee(2)})`}}),pf=Ue((n,e)=>{const t=ge("InputDescription",V0,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,vars:c,size:f,__staticSelector:h,__inheritStyles:m=!0,variant:g,...y}=ge("InputDescription",V0,t),w=hf(),v=Xe({name:["InputWrapper",h],props:t,classes:er,className:s,style:a,classNames:r,styles:l,unstyled:u,rootSelector:"description",vars:c,varsResolver:RI}),x=m&&(w==null?void 0:w.getStyles)||v;return O.jsx(ke,{component:"p",ref:e,variant:g,size:f,...x("description",w!=null&&w.getStyles?{className:s,style:a}:void 0),...y})});pf.classes=er;pf.displayName="@mantine/core/InputDescription";const OI={},TI=(n,{size:e})=>({error:{"--input-error-size":e===void 0?void 0:`calc(${dn(e)} - ${ee(2)})`}}),mf=Ue((n,e)=>{const t=ge("InputError",OI,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,vars:c,size:f,__staticSelector:h,__inheritStyles:m=!0,variant:g,...y}=t,w=Xe({name:["InputWrapper",h],props:t,classes:er,className:s,style:a,classNames:r,styles:l,unstyled:u,rootSelector:"error",vars:c,varsResolver:TI}),v=hf(),x=m&&(v==null?void 0:v.getStyles)||w;return O.jsx(ke,{component:"p",ref:e,variant:g,size:f,...x("error",v!=null&&v.getStyles?{className:s,style:a}:void 0),...y})});mf.classes=er;mf.displayName="@mantine/core/InputError";const q0={labelElement:"label"},AI=(n,{size:e})=>({label:{"--input-label-size":dn(e),"--input-asterisk-color":void 0}}),gf=Ue((n,e)=>{const t=ge("InputLabel",q0,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,vars:c,labelElement:f,size:h,required:m,htmlFor:g,onMouseDown:y,children:w,__staticSelector:v,variant:x,mod:E,...P}=ge("InputLabel",q0,t),S=Xe({name:["InputWrapper",v],props:t,classes:er,className:s,style:a,classNames:r,styles:l,unstyled:u,rootSelector:"label",vars:c,varsResolver:AI}),R=hf(),$=(R==null?void 0:R.getStyles)||S;return O.jsxs(ke,{...$("label",R!=null&&R.getStyles?{className:s,style:a}:void 0),component:f,variant:x,size:h,ref:e,htmlFor:f==="label"?g:void 0,mod:[{required:m},E],onMouseDown:I=>{y==null||y(I),!I.defaultPrevented&&I.detail>1&&I.preventDefault()},...P,children:[w,m&&O.jsx("span",{...$("required"),"aria-hidden":!0,children:" *"})]})});gf.classes=er;gf.displayName="@mantine/core/InputLabel";const Z0={},Gy=Ue((n,e)=>{const t=ge("InputPlaceholder",Z0,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,vars:c,__staticSelector:f,variant:h,error:m,mod:g,...y}=ge("InputPlaceholder",Z0,t),w=Xe({name:["InputPlaceholder",f],props:t,classes:er,className:s,style:a,classNames:r,styles:l,unstyled:u,rootSelector:"placeholder"});return O.jsx(ke,{...w("placeholder"),mod:[{error:!!m},g],component:"span",variant:h,ref:e,...y})});Gy.classes=er;Gy.displayName="@mantine/core/InputPlaceholder";function $I(n,{hasDescription:e,hasError:t}){const r=n.findIndex(c=>c==="input"),s=n.slice(0,r),a=n.slice(r+1),l=e&&s.includes("description")||t&&s.includes("error");return{offsetBottom:e&&a.includes("description")||t&&a.includes("error"),offsetTop:l}}const II={labelElement:"label",inputContainer:n=>n,inputWrapperOrder:["label","description","input","error"]},NI=(n,{size:e})=>({label:{"--input-label-size":dn(e),"--input-asterisk-color":void 0},error:{"--input-error-size":e===void 0?void 0:`calc(${dn(e)} - ${ee(2)})`},description:{"--input-description-size":e===void 0?void 0:`calc(${dn(e)} - ${ee(2)})`}}),Jy=Ue((n,e)=>{const t=ge("InputWrapper",II,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,vars:c,size:f,variant:h,__staticSelector:m,inputContainer:g,inputWrapperOrder:y,label:w,error:v,description:x,labelProps:E,descriptionProps:P,errorProps:S,labelElement:R,children:$,withAsterisk:I,id:D,required:F,__stylesApiProps:K,mod:Y,...ie}=t,de=Xe({name:["InputWrapper",m],props:K||t,classes:er,className:s,style:a,classNames:r,styles:l,unstyled:u,vars:c,varsResolver:NI}),ue={size:f,variant:h,__staticSelector:m},V=lo(D),G=typeof I=="boolean"?I:F,q=(S==null?void 0:S.id)||`${V}-error`,J=(P==null?void 0:P.id)||`${V}-description`,j=V,B=!!v&&typeof v!="boolean",W=!!x,T=`${B?q:""} ${W?J:""}`,M=T.trim().length>0?T.trim():void 0,X=(E==null?void 0:E.id)||`${V}-label`,ae=w&&O.jsx(gf,{labelElement:R,id:X,htmlFor:j,required:G,...ue,...E,children:w},"label"),Q=W&&O.jsx(pf,{...P,...ue,size:(P==null?void 0:P.size)||ue.size,id:(P==null?void 0:P.id)||J,children:x},"description"),le=O.jsx(k.Fragment,{children:g($)},"input"),Re=B&&k.createElement(mf,{...S,...ue,size:(S==null?void 0:S.size)||ue.size,key:"error",id:(S==null?void 0:S.id)||q},v),Ee=y.map(be=>{switch(be){case"label":return ae;case"input":return le;case"description":return Q;case"error":return Re;default:return null}});return O.jsx(kI,{value:{getStyles:de,describedBy:M,inputId:j,labelId:X,...$I(y,{hasDescription:W,hasError:B})},children:O.jsx(ke,{ref:e,variant:h,size:f,mod:[{error:!!v},Y],...de("root"),...ie,children:Ee})})});Jy.classes=er;Jy.displayName="@mantine/core/InputWrapper";const jI={variant:"default",leftSectionPointerEvents:"none",rightSectionPointerEvents:"none",withAria:!0,withErrorStyles:!0},LI=(n,e,t)=>({wrapper:{"--input-margin-top":t.offsetTop?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-margin-bottom":t.offsetBottom?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-height":_t(e.size,"input-height"),"--input-fz":dn(e.size),"--input-radius":e.radius===void 0?void 0:rs(e.radius),"--input-left-section-width":e.leftSectionWidth!==void 0?ee(e.leftSectionWidth):void 0,"--input-right-section-width":e.rightSectionWidth!==void 0?ee(e.rightSectionWidth):void 0,"--input-padding-y":e.multiline?_t(e.size,"input-padding-y"):void 0,"--input-left-section-pointer-events":e.leftSectionPointerEvents,"--input-right-section-pointer-events":e.rightSectionPointerEvents}}),Ht=Yn((n,e)=>{const t=ge("Input",jI,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,required:c,__staticSelector:f,__stylesApiProps:h,size:m,wrapperProps:g,error:y,disabled:w,leftSection:v,leftSectionProps:x,leftSectionWidth:E,rightSection:P,rightSectionProps:S,rightSectionWidth:R,rightSectionPointerEvents:$,leftSectionPointerEvents:I,variant:D,vars:F,pointer:K,multiline:Y,radius:ie,id:de,withAria:ue,withErrorStyles:V,mod:G,inputSize:q,__clearSection:J,__clearable:j,__defaultRightSection:B,...W}=t,{styleProps:T,rest:M}=sf(W),X=hf(),ae={offsetBottom:X==null?void 0:X.offsetBottom,offsetTop:X==null?void 0:X.offsetTop},Q=Xe({name:["Input",f],props:h||t,classes:er,className:s,style:a,classNames:r,styles:l,unstyled:u,stylesCtx:ae,rootSelector:"wrapper",vars:F,varsResolver:LI}),le=ue?{required:c,disabled:w,"aria-invalid":!!y,"aria-describedby":X==null?void 0:X.describedBy,id:(X==null?void 0:X.inputId)||de}:{},Re=P||j&&J||B;return O.jsx(EI,{value:{size:m||"sm"},children:O.jsxs(ke,{...Q("wrapper"),...T,...g,mod:[{error:!!y&&V,pointer:K,disabled:w,multiline:Y,"data-with-right-section":!!P,"data-with-left-section":!!v},G],variant:D,size:m,children:[v&&O.jsx("div",{...x,"data-position":"left",...Q("section",{className:x==null?void 0:x.className,style:x==null?void 0:x.style}),children:v}),O.jsx(ke,{component:"input",...M,...le,ref:e,required:c,mod:{disabled:w,error:!!y&&V},variant:D,__size:q,...Q("input")}),Re&&O.jsx("div",{...S,"data-position":"right",...Q("section",{className:S==null?void 0:S.className,style:S==null?void 0:S.style}),children:Re})]})})});Ht.classes=er;Ht.Wrapper=Jy;Ht.Label=gf;Ht.Error=mf;Ht.Description=pf;Ht.Placeholder=Gy;Ht.ClearButton=HE;Ht.displayName="@mantine/core/Input";function MI(n,e,t){const r=ge(n,e,t),{label:s,description:a,error:l,required:u,classNames:c,styles:f,className:h,unstyled:m,__staticSelector:g,__stylesApiProps:y,errorProps:w,labelProps:v,descriptionProps:x,wrapperProps:E,id:P,size:S,style:R,inputContainer:$,inputWrapperOrder:I,withAsterisk:D,variant:F,vars:K,mod:Y,...ie}=r,{styleProps:de,rest:ue}=sf(ie),V={label:s,description:a,error:l,required:u,classNames:c,className:h,__staticSelector:g,__stylesApiProps:y||r,errorProps:w,labelProps:v,descriptionProps:x,unstyled:m,styles:f,size:S,style:R,inputContainer:$,inputWrapperOrder:I,withAsterisk:D,variant:F,id:P,mod:Y,...E};return{...ue,classNames:c,styles:f,unstyled:m,wrapperProps:{...V,...de},inputProps:{required:u,classNames:c,styles:f,unstyled:m,size:S,__staticSelector:g,__stylesApiProps:y||r,error:l,variant:F,id:P}}}const DI={__staticSelector:"InputBase",withAria:!0},Tr=Yn((n,e)=>{const{inputProps:t,wrapperProps:r,...s}=MI("InputBase",DI,n);return O.jsx(Ht.Wrapper,{...r,children:O.jsx(Ht,{...t,...s,ref:e})})});Tr.classes={...Ht.classes,...Ht.Wrapper.classes};Tr.displayName="@mantine/core/InputBase";const FI={gap:{type:"spacing",property:"gap"},rowGap:{type:"spacing",property:"rowGap"},columnGap:{type:"spacing",property:"columnGap"},align:{type:"identity",property:"alignItems"},justify:{type:"identity",property:"justifyContent"},wrap:{type:"identity",property:"flexWrap"},direction:{type:"identity",property:"flexDirection"}};var WE={root:"m_8bffd616"};const UI={},Kn=Yn((n,e)=>{const t=ge("Flex",UI,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,vars:c,gap:f,rowGap:h,columnGap:m,align:g,justify:y,wrap:w,direction:v,...x}=t,E=Xe({name:"Flex",classes:WE,props:t,className:s,style:a,classNames:r,styles:l,unstyled:u,vars:c}),P=as(),S=X1(),R=K1({styleProps:{gap:f,rowGap:h,columnGap:m,align:g,justify:y,wrap:w,direction:v},theme:P,data:FI});return O.jsxs(O.Fragment,{children:[R.hasResponsiveStyles&&O.jsx(J1,{selector:`.${S}`,styles:R.styles,media:R.media}),O.jsx(ke,{ref:e,...E("root",{className:S,style:tf(R.inlineStyles)}),...x})]})});Kn.classes=WE;Kn.displayName="@mantine/core/Flex";const[zI,Ky]=ni("Accordion component was not found in the tree");function Xy({style:n,size:e=16,...t}){return O.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...n,width:ee(e),height:ee(e),display:"block"},...t,children:O.jsx("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}Xy.displayName="@mantine/core/AccordionChevron";const[BI,VE]=ni("Accordion.Item component was not found in the tree");var yu={root:"m_9bdbb667",panel:"m_df78851f",content:"m_4ba554d4",itemTitle:"m_8fa820a0",control:"m_4ba585b8","control--default":"m_6939a5e9","control--contained":"m_4271d21b",label:"m_df3ffa0f",chevron:"m_3f35ae96",icon:"m_9bd771fe",item:"m_9bd7b098","item--default":"m_fe19b709","item--contained":"m_1f921b3b","item--filled":"m_2cdf939a","item--separated":"m_9f59b069"};const HI={},Yy=Ue((n,e)=>{const{classNames:t,className:r,style:s,styles:a,vars:l,chevron:u,icon:c,onClick:f,onKeyDown:h,children:m,disabled:g,mod:y,...w}=ge("AccordionControl",HI,n),{value:v}=VE(),x=Ky(),E=x.isItemActive(v),P=typeof x.order=="number",S=`h${x.order}`,R=O.jsxs(uo,{...w,...x.getStyles("control",{className:r,classNames:t,style:s,styles:a,variant:x.variant}),unstyled:x.unstyled,mod:["accordion-control",{active:E,"chevron-position":x.chevronPosition,disabled:g},y],ref:e,onClick:$=>{f==null||f($),x.onChange(v)},type:"button",disabled:g,"aria-expanded":E,"aria-controls":x.getRegionId(v),id:x.getControlId(v),onKeyDown:qO({siblingSelector:"[data-accordion-control]",parentSelector:"[data-accordion]",activateOnFocus:!1,loop:x.loop,orientation:"vertical",onKeyDown:h}),children:[O.jsx(ke,{component:"span",mod:{rotate:!x.disableChevronRotation&&E,position:x.chevronPosition},...x.getStyles("chevron",{classNames:t,styles:a}),children:u||x.chevron}),O.jsx("span",{...x.getStyles("label",{classNames:t,styles:a}),children:m}),c&&O.jsx(ke,{component:"span",mod:{"chevron-position":x.chevronPosition},...x.getStyles("icon",{classNames:t,styles:a}),children:c})]});return P?O.jsx(S,{...x.getStyles("itemTitle",{classNames:t,styles:a}),children:R}):R});Yy.displayName="@mantine/core/AccordionControl";Yy.classes=yu;const WI={},Qy=Ue((n,e)=>{const{classNames:t,className:r,style:s,styles:a,vars:l,value:u,mod:c,...f}=ge("AccordionItem",WI,n),h=Ky();return O.jsx(BI,{value:{value:u},children:O.jsx(ke,{ref:e,mod:[{active:h.isItemActive(u)},c],...h.getStyles("item",{className:r,classNames:t,styles:a,style:s,variant:h.variant}),...f})})});Qy.displayName="@mantine/core/AccordionItem";Qy.classes=yu;const VI={},e_=Ue((n,e)=>{const{classNames:t,className:r,style:s,styles:a,vars:l,children:u,...c}=ge("AccordionPanel",VI,n),{value:f}=VE(),h=Ky();return O.jsx(rE,{ref:e,...h.getStyles("panel",{className:r,classNames:t,style:s,styles:a}),...c,in:h.isItemActive(f),transitionDuration:h.transitionDuration??200,role:"region",id:h.getRegionId(f),"aria-labelledby":h.getControlId(f),children:O.jsx("div",{...h.getStyles("content",{classNames:t,styles:a}),children:u})})});e_.displayName="@mantine/core/AccordionPanel";e_.classes=yu;const qI={multiple:!1,disableChevronRotation:!1,chevronPosition:"right",variant:"default",chevron:O.jsx(Xy,{})},ZI=(n,{transitionDuration:e,chevronSize:t,radius:r})=>({root:{"--accordion-transition-duration":e===void 0?void 0:`${e}ms`,"--accordion-chevron-size":t===void 0?void 0:ee(t),"--accordion-radius":r===void 0?void 0:rs(r)}});function yt(n){const e=ge("Accordion",qI,n),{classNames:t,className:r,style:s,styles:a,unstyled:l,vars:u,children:c,multiple:f,value:h,defaultValue:m,onChange:g,id:y,loop:w,transitionDuration:v,disableChevronRotation:x,chevronPosition:E,chevronSize:P,order:S,chevron:R,variant:$,radius:I,...D}=e,F=lo(y),[K,Y]=Va({value:h,defaultValue:m,finalValue:f?[]:null,onChange:g}),ie=V=>Array.isArray(K)?K.includes(V):V===K,de=V=>{const G=Array.isArray(K)?K.includes(V)?K.filter(q=>q!==V):[...K,V]:V===K?null:V;Y(G)},ue=Xe({name:"Accordion",classes:yu,props:e,className:r,style:s,classNames:t,styles:a,unstyled:l,vars:u,varsResolver:ZI});return O.jsx(zI,{value:{isItemActive:ie,onChange:de,getControlId:_0(`${F}-control`,"Accordion.Item component was rendered with invalid value or without value"),getRegionId:_0(`${F}-panel`,"Accordion.Item component was rendered with invalid value or without value"),transitionDuration:v,disableChevronRotation:x,chevronPosition:E,order:S,chevron:R,loop:w,getStyles:ue,variant:$,unstyled:l},children:O.jsx(ke,{...ue("root"),id:F,...D,variant:$,"data-accordion":!0,children:c})})}const GI=n=>n;yt.extend=GI;yt.withProps=EA(yt);yt.classes=yu;yt.displayName="@mantine/core/Accordion";yt.Item=Qy;yt.Panel=e_;yt.Control=Yy;yt.Chevron=Xy;var qE={root:"m_b6d8b162"};function JI(n){if(n==="start")return"start";if(n==="end"||n)return"end"}const KI={inherit:!1},XI=(n,{variant:e,lineClamp:t,gradient:r,size:s,color:a})=>({root:{"--text-fz":dn(s),"--text-lh":KO(s),"--text-gradient":e==="gradient"?Tg(r,n):void 0,"--text-line-clamp":typeof t=="number"?t.toString():void 0,"--text-color":a?zl(a,n):void 0}}),t_=Yn((n,e)=>{const t=ge("Text",KI,n),{lineClamp:r,truncate:s,inline:a,inherit:l,gradient:u,span:c,__staticSelector:f,vars:h,className:m,style:g,classNames:y,styles:w,unstyled:v,variant:x,mod:E,size:P,...S}=t,R=Xe({name:["Text",f],props:t,classes:qE,className:m,style:g,classNames:y,styles:w,unstyled:v,vars:h,varsResolver:XI});return O.jsx(ke,{...R("root",{focusable:!0}),ref:e,component:c?"span":"p",variant:x,mod:[{"data-truncate":JI(s),"data-line-clamp":typeof r=="number","data-inline":a,"data-inherit":l},E],size:P,...S})});t_.classes=qE;t_.displayName="@mantine/core/Text";function ZE(n){return typeof n=="string"?{value:n,label:n}:"value"in n&&!("label"in n)?{value:n.value,label:n.value,disabled:n.disabled}:typeof n=="number"?{value:n.toString(),label:n.toString()}:"group"in n?{group:n.group,items:n.items.map(e=>ZE(e))}:n}function YI(n){return n?n.map(e=>ZE(e)):[]}function GE(n){return n.reduce((e,t)=>"group"in t?{...e,...GE(t.items)}:(e[t.value]=t,e),{})}var En={dropdown:"m_88b62a41",search:"m_985517d8",options:"m_b2821a6e",option:"m_92253aa5",empty:"m_2530cd1d",header:"m_858f94bd",footer:"m_82b967cb",group:"m_254f3e4f",groupLabel:"m_2bb2e9e5",chevron:"m_2943220b",optionsDropdownOption:"m_390b5f4",optionsDropdownCheckIcon:"m_8ee53fc2"};const QI={error:null},eN=(n,{size:e,color:t})=>({chevron:{"--combobox-chevron-size":_t(e,"combobox-chevron-size"),"--combobox-chevron-color":t?zl(t,n):void 0}}),n_=Ue((n,e)=>{const t=ge("ComboboxChevron",QI,n),{size:r,error:s,style:a,className:l,classNames:u,styles:c,unstyled:f,vars:h,mod:m,...g}=t,y=Xe({name:"ComboboxChevron",classes:En,props:t,style:a,className:l,classNames:u,styles:c,unstyled:f,vars:h,varsResolver:eN,rootSelector:"chevron"});return O.jsx(ke,{component:"svg",...g,...y("chevron"),size:r,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",mod:["combobox-chevron",{error:s},m],ref:e,children:O.jsx("path",{d:"M4.93179 5.43179C4.75605 5.60753 4.75605 5.89245 4.93179 6.06819C5.10753 6.24392 5.39245 6.24392 5.56819 6.06819L7.49999 4.13638L9.43179 6.06819C9.60753 6.24392 9.89245 6.24392 10.0682 6.06819C10.2439 5.89245 10.2439 5.60753 10.0682 5.43179L7.81819 3.18179C7.73379 3.0974 7.61933 3.04999 7.49999 3.04999C7.38064 3.04999 7.26618 3.0974 7.18179 3.18179L4.93179 5.43179ZM10.0682 9.56819C10.2439 9.39245 10.2439 9.10753 10.0682 8.93179C9.89245 8.75606 9.60753 8.75606 9.43179 8.93179L7.49999 10.8636L5.56819 8.93179C5.39245 8.75606 5.10753 8.75606 4.93179 8.93179C4.75605 9.10753 4.75605 9.39245 4.93179 9.56819L7.18179 11.8182C7.35753 11.9939 7.64245 11.9939 7.81819 11.8182L10.0682 9.56819Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})});n_.classes=En;n_.displayName="@mantine/core/ComboboxChevron";const[tN,tr]=ni("Combobox component was not found in tree"),JE=k.forwardRef(({size:n,onMouseDown:e,onClick:t,onClear:r,...s},a)=>O.jsx(Ht.ClearButton,{ref:a,tabIndex:-1,"aria-hidden":!0,...s,onMouseDown:l=>{l.preventDefault(),e==null||e(l)},onClick:l=>{r(),t==null||t(l)}}));JE.displayName="@mantine/core/ComboboxClearButton";const nN={},r_=Ue((n,e)=>{const{classNames:t,styles:r,className:s,style:a,hidden:l,...u}=ge("ComboboxDropdown",nN,n),c=tr();return O.jsx(ya.Dropdown,{...u,ref:e,role:"presentation","data-hidden":l||void 0,...c.getStyles("dropdown",{className:s,style:a,classNames:t,styles:r})})});r_.classes=En;r_.displayName="@mantine/core/ComboboxDropdown";const rN={refProp:"ref"},KE=Ue((n,e)=>{const{children:t,refProp:r}=ge("ComboboxDropdownTarget",rN,n);if(tr(),!cu(t))throw new Error("Combobox.DropdownTarget component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");return O.jsx(ya.Target,{ref:e,refProp:r,children:t})});KE.displayName="@mantine/core/ComboboxDropdownTarget";const sN={},s_=Ue((n,e)=>{const{classNames:t,className:r,style:s,styles:a,vars:l,...u}=ge("ComboboxEmpty",sN,n),c=tr();return O.jsx(ke,{ref:e,...c.getStyles("empty",{className:r,classNames:t,styles:a,style:s}),...u})});s_.classes=En;s_.displayName="@mantine/core/ComboboxEmpty";function a_({onKeyDown:n,withKeyboardNavigation:e,withAriaAttributes:t,withExpandedAttribute:r,targetType:s,autoComplete:a}){const l=tr(),[u,c]=k.useState(null),f=m=>{if(n==null||n(m),!l.readOnly&&e){if(m.nativeEvent.isComposing)return;if(m.nativeEvent.code==="ArrowDown"&&(m.preventDefault(),l.store.dropdownOpened?c(l.store.selectNextOption()):(l.store.openDropdown("keyboard"),c(l.store.selectActiveOption()),l.store.updateSelectedOptionIndex("selected",{scrollIntoView:!0}))),m.nativeEvent.code==="ArrowUp"&&(m.preventDefault(),l.store.dropdownOpened?c(l.store.selectPreviousOption()):(l.store.openDropdown("keyboard"),c(l.store.selectActiveOption()),l.store.updateSelectedOptionIndex("selected",{scrollIntoView:!0}))),m.nativeEvent.code==="Enter"||m.nativeEvent.code==="NumpadEnter"){if(m.nativeEvent.keyCode===229)return;const g=l.store.getSelectedOptionIndex();l.store.dropdownOpened&&g!==-1?(m.preventDefault(),l.store.clickSelectedOption()):s==="button"&&(m.preventDefault(),l.store.openDropdown("keyboard"))}m.key==="Escape"&&l.store.closeDropdown("keyboard"),m.nativeEvent.code==="Space"&&s==="button"&&(m.preventDefault(),l.store.toggleDropdown("keyboard"))}};return{...t?{"aria-haspopup":"listbox","aria-expanded":r&&!!(l.store.listId&&l.store.dropdownOpened)||void 0,"aria-controls":l.store.dropdownOpened?l.store.listId:void 0,"aria-activedescendant":l.store.dropdownOpened&&u||void 0,autoComplete:a,"data-expanded":l.store.dropdownOpened||void 0,"data-mantine-stop-propagation":l.store.dropdownOpened||void 0}:{},onKeyDown:f}}const aN={refProp:"ref",targetType:"input",withKeyboardNavigation:!0,withAriaAttributes:!0,withExpandedAttribute:!1,autoComplete:"off"},XE=Ue((n,e)=>{const{children:t,refProp:r,withKeyboardNavigation:s,withAriaAttributes:a,withExpandedAttribute:l,targetType:u,autoComplete:c,...f}=ge("ComboboxEventsTarget",aN,n);if(!cu(t))throw new Error("Combobox.EventsTarget component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const h=tr(),m=a_({targetType:u,withAriaAttributes:a,withKeyboardNavigation:s,withExpandedAttribute:l,onKeyDown:t.props.onKeyDown,autoComplete:c});return k.cloneElement(t,{...m,...f,[r]:Cn(e,h.store.targetRef,B1(t))})});XE.displayName="@mantine/core/ComboboxEventsTarget";const iN={},i_=Ue((n,e)=>{const{classNames:t,className:r,style:s,styles:a,vars:l,...u}=ge("ComboboxFooter",iN,n),c=tr();return O.jsx(ke,{ref:e,...c.getStyles("footer",{className:r,classNames:t,style:s,styles:a}),...u,onMouseDown:f=>{f.preventDefault()}})});i_.classes=En;i_.displayName="@mantine/core/ComboboxFooter";const oN={},o_=Ue((n,e)=>{const{classNames:t,className:r,style:s,styles:a,vars:l,children:u,label:c,...f}=ge("ComboboxGroup",oN,n),h=tr();return O.jsxs(ke,{ref:e,...h.getStyles("group",{className:r,classNames:t,style:s,styles:a}),...f,children:[c&&O.jsx("div",{...h.getStyles("groupLabel",{classNames:t,styles:a}),children:c}),u]})});o_.classes=En;o_.displayName="@mantine/core/ComboboxGroup";const lN={},l_=Ue((n,e)=>{const{classNames:t,className:r,style:s,styles:a,vars:l,...u}=ge("ComboboxHeader",lN,n),c=tr();return O.jsx(ke,{ref:e,...c.getStyles("header",{className:r,classNames:t,style:s,styles:a}),...u,onMouseDown:f=>{f.preventDefault()}})});l_.classes=En;l_.displayName="@mantine/core/ComboboxHeader";function YE({value:n,valuesDivider:e=",",...t}){return O.jsx("input",{type:"hidden",value:Array.isArray(n)?n.join(e):n||"",...t})}YE.displayName="@mantine/core/ComboboxHiddenInput";const uN={},u_=Ue((n,e)=>{const t=ge("ComboboxOption",uN,n),{classNames:r,className:s,style:a,styles:l,vars:u,onClick:c,id:f,active:h,onMouseDown:m,onMouseOver:g,disabled:y,selected:w,mod:v,...x}=t,E=tr(),P=k.useId(),S=f||P;return O.jsx(ke,{...E.getStyles("option",{className:s,classNames:r,styles:l,style:a}),...x,ref:e,id:S,mod:["combobox-option",{"combobox-active":h,"combobox-disabled":y,"combobox-selected":w},v],role:"option",onClick:R=>{var $;y?R.preventDefault():(($=E.onOptionSubmit)==null||$.call(E,t.value,t),c==null||c(R))},onMouseDown:R=>{R.preventDefault(),m==null||m(R)},onMouseOver:R=>{E.resetSelectionOnOptionHover&&E.store.resetSelectedOption(),g==null||g(R)}})});u_.classes=En;u_.displayName="@mantine/core/ComboboxOption";const cN={},c_=Ue((n,e)=>{const t=ge("ComboboxOptions",cN,n),{classNames:r,className:s,style:a,styles:l,id:u,onMouseDown:c,labelledBy:f,...h}=t,m=tr(),g=lo(u);return k.useEffect(()=>{m.store.setListId(g)},[g]),O.jsx(ke,{ref:e,...m.getStyles("options",{className:s,style:a,classNames:r,styles:l}),...h,id:g,role:"listbox","aria-labelledby":f,onMouseDown:y=>{y.preventDefault(),c==null||c(y)}})});c_.classes=En;c_.displayName="@mantine/core/ComboboxOptions";const dN={withAriaAttributes:!0,withKeyboardNavigation:!0},d_=Ue((n,e)=>{const t=ge("ComboboxSearch",dN,n),{classNames:r,styles:s,unstyled:a,vars:l,withAriaAttributes:u,onKeyDown:c,withKeyboardNavigation:f,size:h,...m}=t,g=tr(),y=g.getStyles("search"),w=a_({targetType:"input",withAriaAttributes:u,withKeyboardNavigation:f,withExpandedAttribute:!1,onKeyDown:c,autoComplete:"off"});return O.jsx(Ht,{ref:Cn(e,g.store.searchRef),classNames:[{input:y.className},r],styles:[{input:y.style},s],size:h||g.size,...w,...m,__staticSelector:"Combobox"})});d_.classes=En;d_.displayName="@mantine/core/ComboboxSearch";const fN={refProp:"ref",targetType:"input",withKeyboardNavigation:!0,withAriaAttributes:!0,withExpandedAttribute:!1,autoComplete:"off"},QE=Ue((n,e)=>{const{children:t,refProp:r,withKeyboardNavigation:s,withAriaAttributes:a,withExpandedAttribute:l,targetType:u,autoComplete:c,...f}=ge("ComboboxTarget",fN,n);if(!cu(t))throw new Error("Combobox.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const h=tr(),m=a_({targetType:u,withAriaAttributes:a,withKeyboardNavigation:s,withExpandedAttribute:l,onKeyDown:t.props.onKeyDown,autoComplete:c}),g=k.cloneElement(t,{...m,...f});return O.jsx(ya.Target,{ref:Cn(e,h.store.targetRef),children:g})});QE.displayName="@mantine/core/ComboboxTarget";function hN(n,e,t){for(let r=n-1;r>=0;r-=1)if(!e[r].hasAttribute("data-combobox-disabled"))return r;if(t){for(let r=e.length-1;r>-1;r-=1)if(!e[r].hasAttribute("data-combobox-disabled"))return r}return n}function pN(n,e,t){for(let r=n+1;r<e.length;r+=1)if(!e[r].hasAttribute("data-combobox-disabled"))return r;if(t){for(let r=0;r<e.length;r+=1)if(!e[r].hasAttribute("data-combobox-disabled"))return r}return n}function mN(n){for(let e=0;e<n.length;e+=1)if(!n[e].hasAttribute("data-combobox-disabled"))return e;return-1}function eC({defaultOpened:n,opened:e,onOpenedChange:t,onDropdownClose:r,onDropdownOpen:s,loop:a=!0,scrollBehavior:l="instant"}={}){const[u,c]=Va({value:e,defaultValue:n,finalValue:!1,onChange:t}),f=k.useRef(null),h=k.useRef(-1),m=k.useRef(null),g=k.useRef(null),y=k.useRef(-1),w=k.useRef(-1),v=k.useRef(-1),x=k.useCallback((q="unknown")=>{u||(c(!0),s==null||s(q))},[c,s,u]),E=k.useCallback((q="unknown")=>{u&&(c(!1),r==null||r(q))},[c,r,u]),P=k.useCallback((q="unknown")=>{u?E(q):x(q)},[E,x,u]),S=k.useCallback(()=>{const q=document.querySelector(`#${f.current} [data-combobox-selected]`);q==null||q.removeAttribute("data-combobox-selected"),q==null||q.removeAttribute("aria-selected")},[]),R=k.useCallback(q=>{const J=document.getElementById(f.current),j=J==null?void 0:J.querySelectorAll("[data-combobox-option]");if(!j)return null;const B=q>=j.length?0:q<0?j.length-1:q;return h.current=B,j!=null&&j[B]&&!j[B].hasAttribute("data-combobox-disabled")?(S(),j[B].setAttribute("data-combobox-selected","true"),j[B].setAttribute("aria-selected","true"),j[B].scrollIntoView({block:"nearest",behavior:l}),j[B].id):null},[l,S]),$=k.useCallback(()=>{const q=document.querySelector(`#${f.current} [data-combobox-active]`);if(q){const J=document.querySelectorAll(`#${f.current} [data-combobox-option]`),j=Array.from(J).findIndex(B=>B===q);return R(j)}return R(0)},[R]),I=k.useCallback(()=>R(pN(h.current,document.querySelectorAll(`#${f.current} [data-combobox-option]`),a)),[R,a]),D=k.useCallback(()=>R(hN(h.current,document.querySelectorAll(`#${f.current} [data-combobox-option]`),a)),[R,a]),F=k.useCallback(()=>R(mN(document.querySelectorAll(`#${f.current} [data-combobox-option]`))),[R]),K=k.useCallback((q="selected",J)=>{v.current=window.setTimeout(()=>{var W;const j=document.querySelectorAll(`#${f.current} [data-combobox-option]`),B=Array.from(j).findIndex(T=>T.hasAttribute(`data-combobox-${q}`));h.current=B,J!=null&&J.scrollIntoView&&((W=j[B])==null||W.scrollIntoView({block:"nearest",behavior:l}))},0)},[]),Y=k.useCallback(()=>{h.current=-1,S()},[S]),ie=k.useCallback(()=>{const q=document.querySelectorAll(`#${f.current} [data-combobox-option]`),J=q==null?void 0:q[h.current];J==null||J.click()},[]),de=k.useCallback(q=>{f.current=q},[]),ue=k.useCallback(()=>{y.current=window.setTimeout(()=>m.current.focus(),0)},[]),V=k.useCallback(()=>{w.current=window.setTimeout(()=>g.current.focus(),0)},[]),G=k.useCallback(()=>h.current,[]);return k.useEffect(()=>()=>{window.clearTimeout(y.current),window.clearTimeout(w.current),window.clearTimeout(v.current)},[]),{dropdownOpened:u,openDropdown:x,closeDropdown:E,toggleDropdown:P,selectedOptionIndex:h.current,getSelectedOptionIndex:G,selectOption:R,selectFirstOption:F,selectActiveOption:$,selectNextOption:I,selectPreviousOption:D,resetSelectedOption:Y,updateSelectedOptionIndex:K,listId:f.current,setListId:de,clickSelectedOption:ie,searchRef:m,focusSearchInput:ue,targetRef:g,focusTarget:V}}const gN={keepMounted:!0,withinPortal:!0,resetSelectionOnOptionHover:!1,width:"target",transitionProps:{transition:"fade",duration:0}},yN=(n,{size:e,dropdownPadding:t})=>({options:{"--combobox-option-fz":dn(e),"--combobox-option-padding":_t(e,"combobox-option-padding")},dropdown:{"--combobox-padding":t===void 0?void 0:ee(t),"--combobox-option-fz":dn(e),"--combobox-option-padding":_t(e,"combobox-option-padding")}});function Qe(n){const e=ge("Combobox",gN,n),{classNames:t,styles:r,unstyled:s,children:a,store:l,vars:u,onOptionSubmit:c,onClose:f,size:h,dropdownPadding:m,resetSelectionOnOptionHover:g,__staticSelector:y,readOnly:w,...v}=e,x=eC(),E=l||x,P=Xe({name:y||"Combobox",classes:En,props:e,classNames:t,styles:r,unstyled:s,vars:u,varsResolver:yN}),S=()=>{f==null||f(),E.closeDropdown()};return O.jsx(tN,{value:{getStyles:P,store:E,onOptionSubmit:c,size:h,resetSelectionOnOptionHover:g,readOnly:w},children:O.jsx(ya,{opened:E.dropdownOpened,...v,onChange:R=>!R&&S(),withRoles:!1,unstyled:s,children:a})})}const _N=n=>n;Qe.extend=_N;Qe.classes=En;Qe.displayName="@mantine/core/Combobox";Qe.Target=QE;Qe.Dropdown=r_;Qe.Options=c_;Qe.Option=u_;Qe.Search=d_;Qe.Empty=s_;Qe.Chevron=n_;Qe.Footer=i_;Qe.Header=l_;Qe.EventsTarget=XE;Qe.DropdownTarget=KE;Qe.Group=o_;Qe.ClearButton=JE;Qe.HiddenInput=YE;function wN({size:n,style:e,...t}){const r=n!==void 0?{width:ee(n),height:ee(n),...e}:e;return O.jsx("svg",{viewBox:"0 0 10 7",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:r,"aria-hidden":!0,...t,children:O.jsx("path",{d:"M4 4.586L1.707 2.293A1 1 0 1 0 .293 3.707l3 3a.997.997 0 0 0 1.414 0l5-5A1 1 0 1 0 8.293.293L4 4.586z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function Hl(n){return"group"in n}function tC({options:n,search:e,limit:t}){const r=e.trim().toLowerCase(),s=[];for(let a=0;a<n.length;a+=1){const l=n[a];if(s.length===t)return s;Hl(l)&&s.push({group:l.group,items:tC({options:l.items,search:e,limit:t-s.length})}),Hl(l)||l.label.toLowerCase().includes(r)&&s.push(l)}return s}function bN(n){if(n.length===0)return!0;for(const e of n)if(!("group"in e)||e.items.length>0)return!1;return!0}function nC(n,e=new Set){if(Array.isArray(n))for(const t of n)if(Hl(t))nC(t.items,e);else{if(typeof t.value>"u")throw new Error("[@mantine/core] Each option must have value property");if(typeof t.value!="string")throw new Error(`[@mantine/core] Option value must be a string, other data formats are not supported, got ${typeof t.value}`);if(e.has(t.value))throw new Error(`[@mantine/core] Duplicate options are not supported. Option with value "${t.value}" was provided more than once`);e.add(t.value)}}function vN(n,e){return Array.isArray(n)?n.includes(e):n===e}function rC({data:n,withCheckIcon:e,value:t,checkIconPosition:r,unstyled:s,renderOption:a}){if(!Hl(n)){const u=vN(t,n.value),c=e&&u&&O.jsx(wN,{className:En.optionsDropdownCheckIcon}),f=O.jsxs(O.Fragment,{children:[r==="left"&&c,O.jsx("span",{children:n.label}),r==="right"&&c]});return O.jsx(Qe.Option,{value:n.value,disabled:n.disabled,className:ss({[En.optionsDropdownOption]:!s}),"data-reverse":r==="right"||void 0,"data-checked":u||void 0,"aria-selected":u,active:u,children:typeof a=="function"?a({option:n,checked:u}):f})}const l=n.items.map(u=>O.jsx(rC,{data:u,value:t,unstyled:s,withCheckIcon:e,checkIconPosition:r,renderOption:a},u.value));return O.jsx(Qe.Group,{label:n.group,children:l})}function xN({data:n,hidden:e,hiddenWhenEmpty:t,filter:r,search:s,limit:a,maxDropdownHeight:l,withScrollArea:u=!0,filterOptions:c=!0,withCheckIcon:f=!1,value:h,checkIconPosition:m,nothingFoundMessage:g,unstyled:y,labelId:w,renderOption:v,scrollAreaProps:x,"aria-label":E}){nC(n);const S=typeof s=="string"?(r||tC)({options:n,search:c?s:"",limit:a??1/0}):n,R=bN(S),$=S.map(I=>O.jsx(rC,{data:I,withCheckIcon:f,value:h,checkIconPosition:m,unstyled:y,renderOption:v},Hl(I)?I.group:I.value));return O.jsx(Qe.Dropdown,{hidden:e||t&&R,children:O.jsxs(Qe.Options,{labelledBy:w,"aria-label":E,children:[u?O.jsx(qa.Autosize,{mah:l??220,type:"scroll",scrollbarSize:"var(--combobox-padding)",offsetScrollbars:"y",...x,children:$}):$,R&&g&&O.jsx(Qe.Empty,{children:g})]})})}var po={root:"m_77c9d27d",inner:"m_80f1301b",label:"m_811560b9",section:"m_a74036a",loader:"m_a25b86ee",group:"m_80d6d844",groupSection:"m_70be2a01"};const G0={orientation:"horizontal"},SN=(n,{borderWidth:e})=>({group:{"--button-border-width":ee(e)}}),f_=Ue((n,e)=>{const t=ge("ButtonGroup",G0,n),{className:r,style:s,classNames:a,styles:l,unstyled:u,orientation:c,vars:f,borderWidth:h,variant:m,mod:g,...y}=ge("ButtonGroup",G0,n),w=Xe({name:"ButtonGroup",props:t,classes:po,className:r,style:s,classNames:a,styles:l,unstyled:u,vars:f,varsResolver:SN,rootSelector:"group"});return O.jsx(ke,{...w("group"),ref:e,variant:m,mod:[{"data-orientation":c},g],role:"group",...y})});f_.classes=po;f_.displayName="@mantine/core/ButtonGroup";const J0={},EN=(n,{radius:e,color:t,gradient:r,variant:s,autoContrast:a,size:l})=>{const u=n.variantColorResolver({color:t||n.primaryColor,theme:n,gradient:r,variant:s||"filled",autoContrast:a});return{groupSection:{"--section-height":_t(l,"section-height"),"--section-padding-x":_t(l,"section-padding-x"),"--section-fz":l!=null&&l.includes("compact")?dn(l.replace("compact-","")):dn(l),"--section-radius":e===void 0?void 0:rs(e),"--section-bg":t||s?u.background:void 0,"--section-color":u.color,"--section-bd":t||s?u.border:void 0}}},h_=Ue((n,e)=>{const t=ge("ButtonGroupSection",J0,n),{className:r,style:s,classNames:a,styles:l,unstyled:u,vars:c,variant:f,gradient:h,radius:m,autoContrast:g,...y}=ge("ButtonGroupSection",J0,n),w=Xe({name:"ButtonGroupSection",props:t,classes:po,className:r,style:s,classNames:a,styles:l,unstyled:u,vars:c,varsResolver:EN,rootSelector:"groupSection"});return O.jsx(ke,{...w("groupSection"),ref:e,variant:f,...y})});h_.classes=po;h_.displayName="@mantine/core/ButtonGroupSection";const CN={in:{opacity:1,transform:`translate(-50%, calc(-50% + ${ee(1)}))`},out:{opacity:0,transform:"translate(-50%, -200%)"},common:{transformOrigin:"center"},transitionProperty:"transform, opacity"},PN={},kN=(n,{radius:e,color:t,gradient:r,variant:s,size:a,justify:l,autoContrast:u})=>{const c=n.variantColorResolver({color:t||n.primaryColor,theme:n,gradient:r,variant:s||"filled",autoContrast:u});return{root:{"--button-justify":l,"--button-height":_t(a,"button-height"),"--button-padding-x":_t(a,"button-padding-x"),"--button-fz":a!=null&&a.includes("compact")?dn(a.replace("compact-","")):dn(a),"--button-radius":e===void 0?void 0:rs(e),"--button-bg":t||s?c.background:void 0,"--button-hover":t||s?c.hover:void 0,"--button-color":c.color,"--button-bd":t||s?c.border:void 0,"--button-hover-color":t||s?c.hoverColor:void 0}}},ia=Yn((n,e)=>{const t=ge("Button",PN,n),{style:r,vars:s,className:a,color:l,disabled:u,children:c,leftSection:f,rightSection:h,fullWidth:m,variant:g,radius:y,loading:w,loaderProps:v,gradient:x,classNames:E,styles:P,unstyled:S,"data-disabled":R,autoContrast:$,mod:I,...D}=t,F=Xe({name:"Button",props:t,classes:po,className:a,style:r,classNames:E,styles:P,unstyled:S,vars:s,varsResolver:kN}),K=!!f,Y=!!h;return O.jsxs(uo,{ref:e,...F("root",{active:!u&&!w&&!R}),unstyled:S,variant:g,disabled:u||w,mod:[{disabled:u||R,loading:w,block:m,"with-left-section":K,"with-right-section":Y},I],...D,children:[O.jsx(mu,{mounted:!!w,transition:CN,duration:150,children:ie=>O.jsx(ke,{component:"span",...F("loader",{style:ie}),"aria-hidden":!0,children:O.jsx(Ga,{color:"var(--button-color)",size:"calc(var(--button-height) / 1.8)",...v})})}),O.jsxs("span",{...F("inner"),children:[f&&O.jsx(ke,{component:"span",...F("section"),mod:{position:"left"},children:f}),O.jsx(ke,{component:"span",mod:{loading:w},...F("label"),children:c}),h&&O.jsx(ke,{component:"span",...F("section"),mod:{position:"right"},children:h})]})]})});ia.classes=po;ia.displayName="@mantine/core/Button";ia.Group=f_;ia.GroupSection=h_;const[RN,ON]=ni("Card component was not found in tree");var p_={root:"m_e615b15f",section:"m_599a2148"};const TN={},yf=Yn((n,e)=>{const t=ge("CardSection",TN,n),{classNames:r,className:s,style:a,styles:l,vars:u,withBorder:c,inheritPadding:f,mod:h,...m}=t,g=ON();return O.jsx(ke,{ref:e,mod:[{"with-border":c,"inherit-padding":f},h],...g.getStyles("section",{className:s,style:a,styles:l,classNames:r}),...m})});yf.classes=p_;yf.displayName="@mantine/core/CardSection";const AN={},$N=(n,{padding:e})=>({root:{"--card-padding":j1(e)}}),_f=Yn((n,e)=>{const t=ge("Card",AN,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,vars:c,children:f,padding:h,...m}=t,g=Xe({name:"Card",props:t,classes:p_,className:s,style:a,classNames:r,styles:l,unstyled:u,vars:c,varsResolver:$N}),y=k.Children.toArray(f),w=y.map((v,x)=>typeof v=="object"&&v&&"type"in v&&v.type===yf?k.cloneElement(v,{"data-first-section":x===0||void 0,"data-last-section":x===y.length-1||void 0}):v);return O.jsx(RN,{value:{getStyles:g},children:O.jsx($y,{ref:e,unstyled:u,...g("root"),...m,children:w})})});_f.classes=p_;_f.displayName="@mantine/core/Card";_f.Section=yf;const IN={multiple:!1},sC=k.forwardRef((n,e)=>{const{onChange:t,children:r,multiple:s,accept:a,name:l,form:u,resetRef:c,disabled:f,capture:h,inputProps:m,...g}=ge("FileButton",IN,n),y=k.useRef(null),w=()=>{var E;!f&&((E=y.current)==null||E.click())},v=E=>{t(s?Array.from(E.currentTarget.files):E.currentTarget.files[0]||null)};return Cd(c,()=>{y.current&&(y.current.value="")}),O.jsxs(O.Fragment,{children:[r({onClick:w,...g}),O.jsx("input",{style:{display:"none"},type:"file",accept:a,multiple:s,onChange:v,ref:Cn(e,y),name:l,form:u,capture:h,...m})]})});sC.displayName="@mantine/core/FileButton";const NN=({value:n})=>O.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Array.isArray(n)?n.map(e=>e.name).join(", "):n==null?void 0:n.name}),jN={valueComponent:NN},m_=Ue((n,e)=>{const t=ge("FileInput",jN,n),{unstyled:r,vars:s,onChange:a,value:l,defaultValue:u,multiple:c,accept:f,name:h,form:m,valueComponent:g,clearable:y,clearButtonProps:w,readOnly:v,capture:x,fileInputProps:E,rightSection:P,size:S,placeholder:R,component:$,resetRef:I,classNames:D,styles:F,...K}=t,Y=k.useRef(null),{resolvedClassNames:ie,resolvedStyles:de}=hu({classNames:D,styles:F,props:t}),[ue,V]=Va({value:l,defaultValue:u,onChange:a,finalValue:c?[]:null}),G=Array.isArray(ue)?ue.length!==0:ue!==null,q=P||(y&&G&&!v?O.jsx(ff,{...w,variant:"subtle",onClick:()=>V(c?[]:null),size:S,unstyled:r}):null);k.useEffect(()=>{var j;(Array.isArray(ue)&&ue.length===0||ue===null)&&((j=Y.current)==null||j.call(Y))},[ue]);const J=g;return O.jsx(sC,{onChange:V,multiple:c,accept:f,name:h,form:m,resetRef:Cn(Y,I),disabled:v,capture:x,inputProps:E,children:j=>O.jsx(Tr,{component:$||"button",ref:e,rightSection:q,...j,...K,__staticSelector:"FileInput",multiline:!0,type:"button",pointer:!0,__stylesApiProps:t,unstyled:r,size:S,classNames:D,styles:F,children:G?O.jsx(J,{value:ue}):O.jsx(Ht.Placeholder,{__staticSelector:"FileInput",classNames:ie,styles:de,children:R})})})});m_.classes=Tr.classes;m_.displayName="@mantine/core/FileInput";const LN=m_;function Fg(){return Fg=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Fg.apply(null,arguments)}function MN(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}var DN=k.useLayoutEffect,FN=function(e){var t=Ha.useRef(e);return DN(function(){t.current=e}),t},K0=function(e,t){if(typeof e=="function"){e(t);return}e.current=t},UN=function(e,t){var r=Ha.useRef();return Ha.useCallback(function(s){e.current=s,r.current&&K0(r.current,null),r.current=t,t&&K0(t,s)},[t])},X0={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},zN=function(e){Object.keys(X0).forEach(function(t){e.style.setProperty(t,X0[t],"important")})},Y0=zN,an=null,Q0=function(e,t){var r=e.scrollHeight;return t.sizingStyle.boxSizing==="border-box"?r+t.borderSize:r-t.paddingSize};function BN(n,e,t,r){t===void 0&&(t=1),r===void 0&&(r=1/0),an||(an=document.createElement("textarea"),an.setAttribute("tabindex","-1"),an.setAttribute("aria-hidden","true"),Y0(an)),an.parentNode===null&&document.body.appendChild(an);var s=n.paddingSize,a=n.borderSize,l=n.sizingStyle,u=l.boxSizing;Object.keys(l).forEach(function(g){var y=g;an.style[y]=l[y]}),Y0(an),an.value=e;var c=Q0(an,n);an.value=e,c=Q0(an,n),an.value="x";var f=an.scrollHeight-s,h=f*t;u==="border-box"&&(h=h+s+a),c=Math.max(h,c);var m=f*r;return u==="border-box"&&(m=m+s+a),c=Math.min(m,c),[c,f]}var ex=function(){},HN=function(e,t){return e.reduce(function(r,s){return r[s]=t[s],r},{})},WN=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],VN=!!document.documentElement.currentStyle,qN=function(e){var t=window.getComputedStyle(e);if(t===null)return null;var r=HN(WN,t),s=r.boxSizing;if(s==="")return null;VN&&s==="border-box"&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px");var a=parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),l=parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth);return{sizingStyle:r,paddingSize:a,borderSize:l}},ZN=qN;function aC(n,e,t){var r=FN(t);k.useLayoutEffect(function(){var s=function(l){return r.current(l)};if(n)return n.addEventListener(e,s),function(){return n.removeEventListener(e,s)}},[])}var GN=function(e){aC(window,"resize",e)},JN=function(e){aC(document.fonts,"loadingdone",e)},KN=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],XN=function(e,t){var r=e.cacheMeasurements,s=e.maxRows,a=e.minRows,l=e.onChange,u=l===void 0?ex:l,c=e.onHeightChange,f=c===void 0?ex:c,h=MN(e,KN),m=h.value!==void 0,g=k.useRef(null),y=UN(g,t),w=k.useRef(0),v=k.useRef(),x=function(){var S=g.current,R=r&&v.current?v.current:ZN(S);if(R){v.current=R;var $=BN(R,S.value||S.placeholder||"x",a,s),I=$[0],D=$[1];w.current!==I&&(w.current=I,S.style.setProperty("height",I+"px","important"),f(I,{rowHeight:D}))}},E=function(S){m||x(),u(S)};return k.useLayoutEffect(x),GN(x),JN(x),k.createElement("textarea",Fg({},h,{onChange:E,ref:y}))},YN=k.forwardRef(XN);const QN={},Gr=Ue((n,e)=>{const{autosize:t,maxRows:r,minRows:s,__staticSelector:a,resize:l,...u}=ge("Textarea",QN,n),c=t&&pT()!=="test",f=c?{maxRows:r,minRows:s}:{};return O.jsx(Tr,{component:c?YN:"textarea",ref:e,...u,__staticSelector:a||"Textarea",multiline:!0,"data-no-overflow":t&&r===void 0||void 0,__vars:{"--input-resize":l},...f})});Gr.classes=Tr.classes;Gr.displayName="@mantine/core/Textarea";const ej=({reveal:n})=>O.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"var(--psi-icon-size)",height:"var(--psi-icon-size)"},children:O.jsx("path",{d:n?"M13.3536 2.35355C13.5488 2.15829 13.5488 1.84171 13.3536 1.64645C13.1583 1.45118 12.8417 1.45118 12.6464 1.64645L10.6828 3.61012C9.70652 3.21671 8.63759 3 7.5 3C4.30786 3 1.65639 4.70638 0.0760002 7.23501C-0.0253338 7.39715 -0.0253334 7.60288 0.0760014 7.76501C0.902945 9.08812 2.02314 10.1861 3.36061 10.9323L1.64645 12.6464C1.45118 12.8417 1.45118 13.1583 1.64645 13.3536C1.84171 13.5488 2.15829 13.5488 2.35355 13.3536L4.31723 11.3899C5.29348 11.7833 6.36241 12 7.5 12C10.6921 12 13.3436 10.2936 14.924 7.76501C15.0253 7.60288 15.0253 7.39715 14.924 7.23501C14.0971 5.9119 12.9769 4.81391 11.6394 4.06771L13.3536 2.35355ZM9.90428 4.38861C9.15332 4.1361 8.34759 4 7.5 4C4.80285 4 2.52952 5.37816 1.09622 7.50001C1.87284 8.6497 2.89609 9.58106 4.09974 10.1931L9.90428 4.38861ZM5.09572 10.6114L10.9003 4.80685C12.1039 5.41894 13.1272 6.35031 13.9038 7.50001C12.4705 9.62183 10.1971 11 7.5 11C6.65241 11 5.84668 10.8639 5.09572 10.6114Z":"M7.5 11C4.80285 11 2.52952 9.62184 1.09622 7.50001C2.52952 5.37816 4.80285 4 7.5 4C10.1971 4 12.4705 5.37816 13.9038 7.50001C12.4705 9.62183 10.1971 11 7.5 11ZM7.5 3C4.30786 3 1.65639 4.70638 0.0760002 7.23501C-0.0253338 7.39715 -0.0253334 7.60288 0.0760014 7.76501C1.65639 10.2936 4.30786 12 7.5 12C10.6921 12 13.3436 10.2936 14.924 7.76501C15.0253 7.60288 15.0253 7.39715 14.924 7.23501C13.3436 4.70638 10.6921 3 7.5 3ZM7.5 9.5C8.60457 9.5 9.5 8.60457 9.5 7.5C9.5 6.39543 8.60457 5.5 7.5 5.5C6.39543 5.5 5.5 6.39543 5.5 7.5C5.5 8.60457 6.39543 9.5 7.5 9.5Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})});var Ug={root:"m_f61ca620",input:"m_ccf8da4c",innerInput:"m_f2d85dd2",visibilityToggle:"m_b1072d44"};const tj={visibilityToggleIcon:ej},nj=(n,{size:e})=>({root:{"--psi-icon-size":_t(e,"psi-icon-size"),"--psi-button-size":_t(e,"psi-button-size")}}),g_=Ue((n,e)=>{const t=ge("PasswordInput",tj,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,vars:c,required:f,error:h,leftSection:m,disabled:g,id:y,variant:w,inputContainer:v,description:x,label:E,size:P,errorProps:S,descriptionProps:R,labelProps:$,withAsterisk:I,inputWrapperOrder:D,wrapperProps:F,radius:K,rightSection:Y,rightSectionWidth:ie,rightSectionPointerEvents:de,leftSectionWidth:ue,visible:V,defaultVisible:G,onVisibilityChange:q,visibilityToggleIcon:J,visibilityToggleButtonProps:j,rightSectionProps:B,leftSectionProps:W,leftSectionPointerEvents:T,withErrorStyles:M,mod:X,...ae}=t,Q=lo(y),[le,Re]=Va({value:V,defaultValue:G,finalValue:!1,onChange:q}),Ee=()=>Re(!le),be=Xe({name:"PasswordInput",classes:Ug,props:t,className:s,style:a,classNames:r,styles:l,unstyled:u,vars:c,varsResolver:nj}),{resolvedClassNames:je,resolvedStyles:ct}=hu({classNames:r,styles:l,props:t}),{styleProps:qt,rest:Un}=sf(ae),Ir=J,ls=O.jsx(gu,{...be("visibilityToggle"),disabled:g,radius:K,"aria-hidden":!j,tabIndex:-1,...j,variant:(j==null?void 0:j.variant)??"subtle",color:"gray",unstyled:u,onTouchEnd:Ot=>{var pt;Ot.preventDefault(),(pt=j==null?void 0:j.onTouchEnd)==null||pt.call(j,Ot),Ee()},onMouseDown:Ot=>{var pt;Ot.preventDefault(),(pt=j==null?void 0:j.onMouseDown)==null||pt.call(j,Ot),Ee()},onKeyDown:Ot=>{var pt;(pt=j==null?void 0:j.onKeyDown)==null||pt.call(j,Ot),Ot.key===" "&&(Ot.preventDefault(),Ee())},children:O.jsx(Ir,{reveal:le})});return O.jsx(Ht.Wrapper,{required:f,id:Q,label:E,error:h,description:x,size:P,classNames:je,styles:ct,__staticSelector:"PasswordInput",errorProps:S,descriptionProps:R,unstyled:u,withAsterisk:I,inputWrapperOrder:D,inputContainer:v,variant:w,labelProps:{...$,htmlFor:Q},mod:X,...be("root"),...qt,...F,children:O.jsx(Ht,{component:"div",error:h,leftSection:m,size:P,classNames:{...je,input:ss(Ug.input,je.input)},styles:ct,radius:K,disabled:g,__staticSelector:"PasswordInput",rightSectionWidth:ie,rightSection:Y??ls,variant:w,unstyled:u,leftSectionWidth:ue,rightSectionPointerEvents:de||"all",rightSectionProps:B,leftSectionProps:W,leftSectionPointerEvents:T,withAria:!1,withErrorStyles:M,children:O.jsx("input",{required:f,"data-invalid":!!h||void 0,"data-with-left-section":!!m||void 0,...be("innerInput"),disabled:g,id:Q,ref:e,...Un,autoComplete:Un.autoComplete||"off",type:le?"text":"password"})})})});g_.classes={...Tr.classes,...Ug};g_.displayName="@mantine/core/PasswordInput";const rj={searchable:!1,withCheckIcon:!0,allowDeselect:!0,checkIconPosition:"left"},$l=Ue((n,e)=>{const t=ge("Select",rj,n),{classNames:r,styles:s,unstyled:a,vars:l,dropdownOpened:u,defaultDropdownOpened:c,onDropdownClose:f,onDropdownOpen:h,onFocus:m,onBlur:g,onClick:y,onChange:w,data:v,value:x,defaultValue:E,selectFirstOptionOnChange:P,onOptionSubmit:S,comboboxProps:R,readOnly:$,disabled:I,filter:D,limit:F,withScrollArea:K,maxDropdownHeight:Y,size:ie,searchable:de,rightSection:ue,checkIconPosition:V,withCheckIcon:G,nothingFoundMessage:q,name:J,form:j,searchValue:B,defaultSearchValue:W,onSearchChange:T,allowDeselect:M,error:X,rightSectionPointerEvents:ae,id:Q,clearable:le,clearButtonProps:Re,hiddenInputProps:Ee,renderOption:be,onClear:je,autoComplete:ct,scrollAreaProps:qt,__defaultRightSection:Un,__clearSection:Ir,__clearable:ls,chevronColor:Ot,...pt}=t,nr=k.useMemo(()=>YI(v),[v]),et=k.useMemo(()=>GE(nr),[nr]),rr=lo(Q),[vt,$s,ai]=Va({value:x,defaultValue:E,finalValue:null,onChange:w}),Mt=typeof vt=="string"?et[vt]:void 0,zn=fT(Mt),[us,Pn]=Va({value:B,defaultValue:W,finalValue:Mt?Mt.label:"",onChange:T}),xt=eC({opened:u,defaultOpened:c,onDropdownOpen:()=>{h==null||h(),xt.updateSelectedOptionIndex("active",{scrollIntoView:!0})},onDropdownClose:()=>{f==null||f(),xt.resetSelectedOption()}}),{resolvedClassNames:Is,resolvedStyles:dt}=hu({props:t,styles:s,classNames:r});k.useEffect(()=>{P&&xt.selectFirstOption()},[P,vt]),k.useEffect(()=>{x===null&&Pn(""),typeof x=="string"&&Mt&&((zn==null?void 0:zn.value)!==Mt.value||(zn==null?void 0:zn.label)!==Mt.label)&&Pn(Mt.label)},[x,Mt]);const wa=O.jsx(Qe.ClearButton,{...Re,onClear:()=>{$s(null,null),Pn(""),je==null||je()}}),Nu=le&&!!vt&&!I&&!$;return O.jsxs(O.Fragment,{children:[O.jsxs(Qe,{store:xt,__staticSelector:"Select",classNames:Is,styles:dt,unstyled:a,readOnly:$,onOptionSubmit:nn=>{S==null||S(nn);const Bn=M&&et[nn].value===vt?null:et[nn],Oo=Bn?Bn.value:null;Oo!==vt&&$s(Oo,Bn),!ai&&Pn(typeof Oo=="string"&&(Bn==null?void 0:Bn.label)||""),xt.closeDropdown()},size:ie,...R,children:[O.jsx(Qe.Target,{targetType:de?"input":"button",autoComplete:ct,children:O.jsx(Tr,{id:rr,ref:e,__defaultRightSection:O.jsx(Qe.Chevron,{size:ie,error:X,unstyled:a,color:Ot}),__clearSection:wa,__clearable:Nu,rightSection:ue,rightSectionPointerEvents:ae||(Nu?"all":"none"),...pt,size:ie,__staticSelector:"Select",disabled:I,readOnly:$||!de,value:us,onChange:nn=>{Pn(nn.currentTarget.value),xt.openDropdown(),P&&xt.selectFirstOption()},onFocus:nn=>{de&&xt.openDropdown(),m==null||m(nn)},onBlur:nn=>{var Bn;de&&xt.closeDropdown(),Pn(vt!=null&&((Bn=et[vt])==null?void 0:Bn.label)||""),g==null||g(nn)},onClick:nn=>{de?xt.openDropdown():xt.toggleDropdown(),y==null||y(nn)},classNames:Is,styles:dt,unstyled:a,pointer:!de,error:X})}),O.jsx(xN,{data:nr,hidden:$||I,filter:D,search:us,limit:F,hiddenWhenEmpty:!q,withScrollArea:K,maxDropdownHeight:Y,filterOptions:de&&(Mt==null?void 0:Mt.label)!==us,value:vt,checkIconPosition:V,withCheckIcon:G,nothingFoundMessage:q,unstyled:a,labelId:pt.label?`${rr}-label`:void 0,"aria-label":pt.label?void 0:pt["aria-label"],renderOption:be,scrollAreaProps:qt})]}),O.jsx(Qe.HiddenInput,{value:vt,name:J,form:j,disabled:I,...Ee})]})});$l.classes={...Tr.classes,...Qe.classes};$l.displayName="@mantine/core/Select";var iC={root:"m_6d731127"};const sj={gap:"md",align:"stretch",justify:"flex-start"},aj=(n,{gap:e,align:t,justify:r})=>({root:{"--stack-gap":j1(e),"--stack-align":t,"--stack-justify":r}}),Ad=Ue((n,e)=>{const t=ge("Stack",sj,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,vars:c,align:f,justify:h,gap:m,variant:g,...y}=t,w=Xe({name:"Stack",props:t,classes:iC,className:s,style:a,classNames:r,styles:l,unstyled:u,vars:c,varsResolver:aj});return O.jsx(ke,{ref:e,...w("root"),variant:g,...y})});Ad.classes=iC;Ad.displayName="@mantine/core/Stack";const ij={},wr=Ue((n,e)=>{const t=ge("TextInput",ij,n);return O.jsx(Tr,{component:"input",ref:e,...t,__staticSelector:"TextInput"})});wr.classes=Tr.classes;wr.displayName="@mantine/core/TextInput";const oj=["h1","h2","h3","h4","h5","h6"],lj=["xs","sm","md","lg","xl"];function uj(n,e){const t=e!==void 0?e:`h${n}`;return oj.includes(t)?{fontSize:`var(--mantine-${t}-font-size)`,fontWeight:`var(--mantine-${t}-font-weight)`,lineHeight:`var(--mantine-${t}-line-height)`}:lj.includes(t)?{fontSize:`var(--mantine-font-size-${t})`,fontWeight:`var(--mantine-h${n}-font-weight)`,lineHeight:`var(--mantine-h${n}-line-height)`}:{fontSize:ee(t),fontWeight:`var(--mantine-h${n}-font-weight)`,lineHeight:`var(--mantine-h${n}-line-height)`}}var oC={root:"m_8a5d1357"};const cj={order:1},dj=(n,{order:e,size:t,lineClamp:r,textWrap:s})=>{const a=uj(e,t);return{root:{"--title-fw":a.fontWeight,"--title-lh":a.lineHeight,"--title-fz":a.fontSize,"--title-line-clamp":typeof r=="number"?r.toString():void 0,"--title-text-wrap":s}}},Es=Ue((n,e)=>{const t=ge("Title",cj,n),{classNames:r,className:s,style:a,styles:l,unstyled:u,order:c,vars:f,size:h,variant:m,lineClamp:g,textWrap:y,mod:w,...v}=t,x=Xe({name:"Title",props:t,classes:oC,className:s,style:a,classNames:r,styles:l,unstyled:u,vars:f,varsResolver:dj});return[1,2,3,4,5,6].includes(c)?O.jsx(ke,{...x("root"),component:`h${c}`,variant:m,ref:e,mod:[{order:c,"data-line-clamp":typeof g=="number"},w],size:h,...v}):null});Es.classes=oC;Es.displayName="@mantine/core/Title";var yl={},tx;function fj(){if(tx)return yl;tx=1,Object.defineProperty(yl,"__esModule",{value:!0}),yl.parse=l,yl.serialize=f;const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,s=Object.prototype.toString,a=(()=>{const g=function(){};return g.prototype=Object.create(null),g})();function l(g,y){const w=new a,v=g.length;if(v<2)return w;const x=(y==null?void 0:y.decode)||h;let E=0;do{const P=g.indexOf("=",E);if(P===-1)break;const S=g.indexOf(";",E),R=S===-1?v:S;if(P>R){E=g.lastIndexOf(";",P-1)+1;continue}const $=u(g,E,P),I=c(g,P,$),D=g.slice($,I);if(w[D]===void 0){let F=u(g,P+1,R),K=c(g,R,F);const Y=x(g.slice(F,K));w[D]=Y}E=R+1}while(E<v);return w}function u(g,y,w){do{const v=g.charCodeAt(y);if(v!==32&&v!==9)return y}while(++y<w);return w}function c(g,y,w){for(;y>w;){const v=g.charCodeAt(--y);if(v!==32&&v!==9)return y+1}return w}function f(g,y,w){const v=(w==null?void 0:w.encode)||encodeURIComponent;if(!n.test(g))throw new TypeError(`argument name is invalid: ${g}`);const x=v(y);if(!e.test(x))throw new TypeError(`argument val is invalid: ${y}`);let E=g+"="+x;if(!w)return E;if(w.maxAge!==void 0){if(!Number.isInteger(w.maxAge))throw new TypeError(`option maxAge is invalid: ${w.maxAge}`);E+="; Max-Age="+w.maxAge}if(w.domain){if(!t.test(w.domain))throw new TypeError(`option domain is invalid: ${w.domain}`);E+="; Domain="+w.domain}if(w.path){if(!r.test(w.path))throw new TypeError(`option path is invalid: ${w.path}`);E+="; Path="+w.path}if(w.expires){if(!m(w.expires)||!Number.isFinite(w.expires.valueOf()))throw new TypeError(`option expires is invalid: ${w.expires}`);E+="; Expires="+w.expires.toUTCString()}if(w.httpOnly&&(E+="; HttpOnly"),w.secure&&(E+="; Secure"),w.partitioned&&(E+="; Partitioned"),w.priority)switch(typeof w.priority=="string"?w.priority.toLowerCase():void 0){case"low":E+="; Priority=Low";break;case"medium":E+="; Priority=Medium";break;case"high":E+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${w.priority}`)}if(w.sameSite)switch(typeof w.sameSite=="string"?w.sameSite.toLowerCase():w.sameSite){case!0:case"strict":E+="; SameSite=Strict";break;case"lax":E+="; SameSite=Lax";break;case"none":E+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${w.sameSite}`)}return E}function h(g){if(g.indexOf("%")===-1)return g;try{return decodeURIComponent(g)}catch{return g}}function m(g){return s.call(g)==="[object Date]"}return yl}fj();/**
 * react-router v7.1.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var nx="popstate";function hj(n={}){function e(r,s){let{pathname:a,search:l,hash:u}=r.location;return zg("",{pathname:a,search:l,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:Wl(s)}return mj(e,t,null,n)}function ut(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Yr(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function pj(){return Math.random().toString(36).substring(2,10)}function rx(n,e){return{usr:n.state,key:n.key,idx:e}}function zg(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?mo(e):e,state:t,key:e&&e.key||r||pj()}}function Wl({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function mo(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function mj(n,e,t,r={}){let{window:s=document.defaultView,v5Compat:a=!1}=r,l=s.history,u="POP",c=null,f=h();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function h(){return(l.state||{idx:null}).idx}function m(){u="POP";let x=h(),E=x==null?null:x-f;f=x,c&&c({action:u,location:v.location,delta:E})}function g(x,E){u="PUSH";let P=zg(v.location,x,E);f=h()+1;let S=rx(P,f),R=v.createHref(P);try{l.pushState(S,"",R)}catch($){if($ instanceof DOMException&&$.name==="DataCloneError")throw $;s.location.assign(R)}a&&c&&c({action:u,location:v.location,delta:1})}function y(x,E){u="REPLACE";let P=zg(v.location,x,E);f=h();let S=rx(P,f),R=v.createHref(P);l.replaceState(S,"",R),a&&c&&c({action:u,location:v.location,delta:0})}function w(x){let E=s.location.origin!=="null"?s.location.origin:s.location.href,P=typeof x=="string"?x:Wl(x);return P=P.replace(/ $/,"%20"),ut(E,`No window.location.(origin|href) available to create URL for href: ${P}`),new URL(P,E)}let v={get action(){return u},get location(){return n(s,l)},listen(x){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(nx,m),c=x,()=>{s.removeEventListener(nx,m),c=null}},createHref(x){return e(s,x)},createURL:w,encodeLocation(x){let E=w(x);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:g,replace:y,go(x){return l.go(x)}};return v}function lC(n,e,t="/"){return gj(n,e,t,!1)}function gj(n,e,t,r){let s=typeof e=="string"?mo(e):e,a=ca(s.pathname||"/",t);if(a==null)return null;let l=uC(n);yj(l);let u=null;for(let c=0;u==null&&c<l.length;++c){let f=Rj(a);u=Pj(l[c],f,r)}return u}function uC(n,e=[],t=[],r=""){let s=(a,l,u)=>{let c={relativePath:u===void 0?a.path||"":u,caseSensitive:a.caseSensitive===!0,childrenIndex:l,route:a};c.relativePath.startsWith("/")&&(ut(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length));let f=Ps([r,c.relativePath]),h=t.concat(c);a.children&&a.children.length>0&&(ut(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),uC(a.children,e,h,f)),!(a.path==null&&!a.index)&&e.push({path:f,score:Ej(f,a.index),routesMeta:h})};return n.forEach((a,l)=>{var u;if(a.path===""||!((u=a.path)!=null&&u.includes("?")))s(a,l);else for(let c of cC(a.path))s(a,l,c)}),e}function cC(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let l=cC(r.join("/")),u=[];return u.push(...l.map(c=>c===""?a:[a,c].join("/"))),s&&u.push(...l),u.map(c=>n.startsWith("/")&&c===""?"/":c)}function yj(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Cj(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var _j=/^:[\w-]+$/,wj=3,bj=2,vj=1,xj=10,Sj=-2,sx=n=>n==="*";function Ej(n,e){let t=n.split("/"),r=t.length;return t.some(sx)&&(r+=Sj),e&&(r+=bj),t.filter(s=>!sx(s)).reduce((s,a)=>s+(_j.test(a)?wj:a===""?vj:xj),r)}function Cj(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function Pj(n,e,t=!1){let{routesMeta:r}=n,s={},a="/",l=[];for(let u=0;u<r.length;++u){let c=r[u],f=u===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",m=$d({path:c.relativePath,caseSensitive:c.caseSensitive,end:f},h),g=c.route;if(!m&&f&&t&&!r[r.length-1].route.index&&(m=$d({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!m)return null;Object.assign(s,m.params),l.push({params:s,pathname:Ps([a,m.pathname]),pathnameBase:$j(Ps([a,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(a=Ps([a,m.pathnameBase]))}return l}function $d(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=kj(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let a=s[0],l=a.replace(/(.)\/+$/,"$1"),u=s.slice(1);return{params:r.reduce((f,{paramName:h,isOptional:m},g)=>{if(h==="*"){let w=u[g]||"";l=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const y=u[g];return m&&!y?f[h]=void 0:f[h]=(y||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:l,pattern:n}}function kj(n,e=!1,t=!0){Yr(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,u,c)=>(r.push({paramName:u,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function Rj(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Yr(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function ca(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function Oj(n,e="/"){let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?mo(n):n;return{pathname:t?t.startsWith("/")?t:Tj(t,e):e,search:Ij(r),hash:Nj(s)}}function Tj(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Xp(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Aj(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function dC(n){let e=Aj(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function fC(n,e,t,r=!1){let s;typeof n=="string"?s=mo(n):(s={...n},ut(!s.pathname||!s.pathname.includes("?"),Xp("?","pathname","search",s)),ut(!s.pathname||!s.pathname.includes("#"),Xp("#","pathname","hash",s)),ut(!s.search||!s.search.includes("#"),Xp("#","search","hash",s)));let a=n===""||s.pathname==="",l=a?"/":s.pathname,u;if(l==null)u=t;else{let m=e.length-1;if(!r&&l.startsWith("..")){let g=l.split("/");for(;g[0]==="..";)g.shift(),m-=1;s.pathname=g.join("/")}u=m>=0?e[m]:"/"}let c=Oj(s,u),f=l&&l!=="/"&&l.endsWith("/"),h=(a||l===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(f||h)&&(c.pathname+="/"),c}var Ps=n=>n.join("/").replace(/\/\/+/g,"/"),$j=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Ij=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Nj=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function jj(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var hC=["POST","PUT","PATCH","DELETE"];new Set(hC);var Lj=["GET",...hC];new Set(Lj);var go=k.createContext(null);go.displayName="DataRouter";var wf=k.createContext(null);wf.displayName="DataRouterState";var pC=k.createContext({isTransitioning:!1});pC.displayName="ViewTransition";var Mj=k.createContext(new Map);Mj.displayName="Fetchers";var Dj=k.createContext(null);Dj.displayName="Await";var os=k.createContext(null);os.displayName="Navigation";var _u=k.createContext(null);_u.displayName="Location";var As=k.createContext({outlet:null,matches:[],isDataRoute:!1});As.displayName="Route";var y_=k.createContext(null);y_.displayName="RouteError";function Fj(n,{relative:e}={}){ut(wu(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=k.useContext(os),{hash:s,pathname:a,search:l}=bu(n,{relative:e}),u=a;return t!=="/"&&(u=a==="/"?t:Ps([t,a])),r.createHref({pathname:u,search:l,hash:s})}function wu(){return k.useContext(_u)!=null}function si(){return ut(wu(),"useLocation() may be used only in the context of a <Router> component."),k.useContext(_u).location}var mC="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function gC(n){k.useContext(os).static||k.useLayoutEffect(n)}function Uj(){let{isDataRoute:n}=k.useContext(As);return n?Qj():zj()}function zj(){ut(wu(),"useNavigate() may be used only in the context of a <Router> component.");let n=k.useContext(go),{basename:e,navigator:t}=k.useContext(os),{matches:r}=k.useContext(As),{pathname:s}=si(),a=JSON.stringify(dC(r)),l=k.useRef(!1);return gC(()=>{l.current=!0}),k.useCallback((c,f={})=>{if(Yr(l.current,mC),!l.current)return;if(typeof c=="number"){t.go(c);return}let h=fC(c,JSON.parse(a),s,f.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ps([e,h.pathname])),(f.replace?t.replace:t.push)(h,f.state,f)},[e,t,a,s,n])}k.createContext(null);function bu(n,{relative:e}={}){let{matches:t}=k.useContext(As),{pathname:r}=si(),s=JSON.stringify(dC(t));return k.useMemo(()=>fC(n,JSON.parse(s),r,e==="path"),[n,s,r,e])}function Bj(n,e){return yC(n,e)}function yC(n,e,t,r){var P;ut(wu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s,static:a}=k.useContext(os),{matches:l}=k.useContext(As),u=l[l.length-1],c=u?u.params:{},f=u?u.pathname:"/",h=u?u.pathnameBase:"/",m=u&&u.route;{let S=m&&m.path||"";_C(f,!m||S.endsWith("*")||S.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${S}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${S}"> to <Route path="${S==="/"?"*":`${S}/*`}">.`)}let g=si(),y;if(e){let S=typeof e=="string"?mo(e):e;ut(h==="/"||((P=S.pathname)==null?void 0:P.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${S.pathname}" was given in the \`location\` prop.`),y=S}else y=g;let w=y.pathname||"/",v=w;if(h!=="/"){let S=h.replace(/^\//,"").split("/");v="/"+w.replace(/^\//,"").split("/").slice(S.length).join("/")}let x=!a&&t&&t.matches&&t.matches.length>0?t.matches:lC(n,{pathname:v});Yr(m||x!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),Yr(x==null||x[x.length-1].route.element!==void 0||x[x.length-1].route.Component!==void 0||x[x.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=Zj(x&&x.map(S=>Object.assign({},S,{params:Object.assign({},c,S.params),pathname:Ps([h,s.encodeLocation?s.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?h:Ps([h,s.encodeLocation?s.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),l,t,r);return e&&E?k.createElement(_u.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},E):E}function Hj(){let n=Yj(),e=jj(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",n),l=k.createElement(k.Fragment,null,k.createElement("p",null,"💿 Hey developer 👋"),k.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",k.createElement("code",{style:a},"ErrorBoundary")," or"," ",k.createElement("code",{style:a},"errorElement")," prop on your route.")),k.createElement(k.Fragment,null,k.createElement("h2",null,"Unexpected Application Error!"),k.createElement("h3",{style:{fontStyle:"italic"}},e),t?k.createElement("pre",{style:s},t):null,l)}var Wj=k.createElement(Hj,null),Vj=class extends k.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?k.createElement(As.Provider,{value:this.props.routeContext},k.createElement(y_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function qj({routeContext:n,match:e,children:t}){let r=k.useContext(go);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),k.createElement(As.Provider,{value:n},t)}function Zj(n,e=[],t=null,r=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let s=n,a=t==null?void 0:t.errors;if(a!=null){let c=s.findIndex(f=>f.route.id&&(a==null?void 0:a[f.route.id])!==void 0);ut(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),s=s.slice(0,Math.min(s.length,c+1))}let l=!1,u=-1;if(t)for(let c=0;c<s.length;c++){let f=s[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=c),f.route.id){let{loaderData:h,errors:m}=t,g=f.route.loader&&!h.hasOwnProperty(f.route.id)&&(!m||m[f.route.id]===void 0);if(f.route.lazy||g){l=!0,u>=0?s=s.slice(0,u+1):s=[s[0]];break}}}return s.reduceRight((c,f,h)=>{let m,g=!1,y=null,w=null;t&&(m=a&&f.route.id?a[f.route.id]:void 0,y=f.route.errorElement||Wj,l&&(u<0&&h===0?(_C("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,w=null):u===h&&(g=!0,w=f.route.hydrateFallbackElement||null)));let v=e.concat(s.slice(0,h+1)),x=()=>{let E;return m?E=y:g?E=w:f.route.Component?E=k.createElement(f.route.Component,null):f.route.element?E=f.route.element:E=c,k.createElement(qj,{match:f,routeContext:{outlet:c,matches:v,isDataRoute:t!=null},children:E})};return t&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?k.createElement(Vj,{location:t.location,revalidation:t.revalidation,component:y,error:m,children:x(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):x()},null)}function __(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Gj(n){let e=k.useContext(go);return ut(e,__(n)),e}function Jj(n){let e=k.useContext(wf);return ut(e,__(n)),e}function Kj(n){let e=k.useContext(As);return ut(e,__(n)),e}function w_(n){let e=Kj(n),t=e.matches[e.matches.length-1];return ut(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Xj(){return w_("useRouteId")}function Yj(){var r;let n=k.useContext(y_),e=Jj("useRouteError"),t=w_("useRouteError");return n!==void 0?n:(r=e.errors)==null?void 0:r[t]}function Qj(){let{router:n}=Gj("useNavigate"),e=w_("useNavigate"),t=k.useRef(!1);return gC(()=>{t.current=!0}),k.useCallback(async(s,a={})=>{Yr(t.current,mC),t.current&&(typeof s=="number"?n.navigate(s):await n.navigate(s,{fromRouteId:e,...a}))},[n,e])}var ax={};function _C(n,e,t){!e&&!ax[n]&&(ax[n]=!0,Yr(!1,t))}k.memo(eL);function eL({routes:n,future:e,state:t}){return yC(n,void 0,t,e)}function wC(n){ut(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function tL({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:s,static:a=!1}){ut(!wu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=n.replace(/^\/*/,"/"),u=k.useMemo(()=>({basename:l,navigator:s,static:a,future:{}}),[l,s,a]);typeof t=="string"&&(t=mo(t));let{pathname:c="/",search:f="",hash:h="",state:m=null,key:g="default"}=t,y=k.useMemo(()=>{let w=ca(c,l);return w==null?null:{location:{pathname:w,search:f,hash:h,state:m,key:g},navigationType:r}},[l,c,f,h,m,g,r]);return Yr(y!=null,`<Router basename="${l}"> is not able to match the URL "${c}${f}${h}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:k.createElement(os.Provider,{value:u},k.createElement(_u.Provider,{children:e,value:y}))}function nL({children:n,location:e}){return Bj(Bg(n),e)}function Bg(n,e=[]){let t=[];return k.Children.forEach(n,(r,s)=>{if(!k.isValidElement(r))return;let a=[...e,s];if(r.type===k.Fragment){t.push.apply(t,Bg(r.props.children,a));return}ut(r.type===wC,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ut(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=Bg(r.props.children,a)),t.push(l)}),t}var md="get",gd="application/x-www-form-urlencoded";function bf(n){return n!=null&&typeof n.tagName=="string"}function rL(n){return bf(n)&&n.tagName.toLowerCase()==="button"}function sL(n){return bf(n)&&n.tagName.toLowerCase()==="form"}function aL(n){return bf(n)&&n.tagName.toLowerCase()==="input"}function iL(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function oL(n,e){return n.button===0&&(!e||e==="_self")&&!iL(n)}var Zc=null;function lL(){if(Zc===null)try{new FormData(document.createElement("form"),0),Zc=!1}catch{Zc=!0}return Zc}var uL=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Yp(n){return n!=null&&!uL.has(n)?(Yr(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${gd}"`),null):n}function cL(n,e){let t,r,s,a,l;if(sL(n)){let u=n.getAttribute("action");r=u?ca(u,e):null,t=n.getAttribute("method")||md,s=Yp(n.getAttribute("enctype"))||gd,a=new FormData(n)}else if(rL(n)||aL(n)&&(n.type==="submit"||n.type==="image")){let u=n.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=n.getAttribute("formaction")||u.getAttribute("action");if(r=c?ca(c,e):null,t=n.getAttribute("formmethod")||u.getAttribute("method")||md,s=Yp(n.getAttribute("formenctype"))||Yp(u.getAttribute("enctype"))||gd,a=new FormData(u,n),!lL()){let{name:f,type:h,value:m}=n;if(h==="image"){let g=f?`${f}.`:"";a.append(`${g}x`,"0"),a.append(`${g}y`,"0")}else f&&a.append(f,m)}}else{if(bf(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=md,r=null,s=gd,l=n}return a&&s==="text/plain"&&(l=a,a=void 0),{action:r,method:t.toLowerCase(),encType:s,formData:a,body:l}}function b_(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}async function dL(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function fL(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function hL(n,e,t){let r=await Promise.all(n.map(async s=>{let a=e.routes[s.route.id];if(a){let l=await dL(a,t);return l.links?l.links():[]}return[]}));return yL(r.flat(1).filter(fL).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function ix(n,e,t,r,s,a){let l=(c,f)=>t[f]?c.route.id!==t[f].route.id:!0,u=(c,f)=>{var h;return t[f].pathname!==c.pathname||((h=t[f].route.path)==null?void 0:h.endsWith("*"))&&t[f].params["*"]!==c.params["*"]};return a==="assets"?e.filter((c,f)=>l(c,f)||u(c,f)):a==="data"?e.filter((c,f)=>{var m;let h=r.routes[c.route.id];if(!h||!h.hasLoader)return!1;if(l(c,f)||u(c,f))return!0;if(c.route.shouldRevalidate){let g=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((m=t[0])==null?void 0:m.params)||{},nextUrl:new URL(n,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function pL(n,e){return mL(n.map(t=>{let r=e.routes[t.route.id];if(!r)return[];let s=[r.module];return r.imports&&(s=s.concat(r.imports)),s}).flat(1))}function mL(n){return[...new Set(n)]}function gL(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function yL(n,e){let t=new Set;return new Set(e),n.reduce((r,s)=>{let a=JSON.stringify(gL(s));return t.has(a)||(t.add(a),r.push({key:a,link:s})),r},[])}function _L(n){let e=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function wL(){let n=k.useContext(go);return b_(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function bL(){let n=k.useContext(wf);return b_(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var v_=k.createContext(void 0);v_.displayName="FrameworkContext";function bC(){let n=k.useContext(v_);return b_(n,"You must render this element inside a <HydratedRouter> element"),n}function vL(n,e){let t=k.useContext(v_),[r,s]=k.useState(!1),[a,l]=k.useState(!1),{onFocus:u,onBlur:c,onMouseEnter:f,onMouseLeave:h,onTouchStart:m}=e,g=k.useRef(null);k.useEffect(()=>{if(n==="render"&&l(!0),n==="viewport"){let v=E=>{E.forEach(P=>{l(P.isIntersecting)})},x=new IntersectionObserver(v,{threshold:.5});return g.current&&x.observe(g.current),()=>{x.disconnect()}}},[n]),k.useEffect(()=>{if(r){let v=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(v)}}},[r]);let y=()=>{s(!0)},w=()=>{s(!1),l(!1)};return t?n!=="intent"?[a,g,{}]:[a,g,{onFocus:_l(u,y),onBlur:_l(c,w),onMouseEnter:_l(f,y),onMouseLeave:_l(h,w),onTouchStart:_l(m,y)}]:[!1,g,{}]}function _l(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function xL({page:n,...e}){let{router:t}=wL(),r=k.useMemo(()=>lC(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?k.createElement(EL,{page:n,matches:r,...e}):null}function SL(n){let{manifest:e,routeModules:t}=bC(),[r,s]=k.useState([]);return k.useEffect(()=>{let a=!1;return hL(n,e,t).then(l=>{a||s(l)}),()=>{a=!0}},[n,e,t]),r}function EL({page:n,matches:e,...t}){let r=si(),{manifest:s,routeModules:a}=bC(),{loaderData:l,matches:u}=bL(),c=k.useMemo(()=>ix(n,e,u,s,r,"data"),[n,e,u,s,r]),f=k.useMemo(()=>ix(n,e,u,s,r,"assets"),[n,e,u,s,r]),h=k.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let y=new Set,w=!1;if(e.forEach(x=>{var P;let E=s.routes[x.route.id];!E||!E.hasLoader||(!c.some(S=>S.route.id===x.route.id)&&x.route.id in l&&((P=a[x.route.id])!=null&&P.shouldRevalidate)||E.hasClientLoader?w=!0:y.add(x.route.id))}),y.size===0)return[];let v=_L(n);return w&&y.size>0&&v.searchParams.set("_routes",e.filter(x=>y.has(x.route.id)).map(x=>x.route.id).join(",")),[v.pathname+v.search]},[l,r,s,c,e,n,a]),m=k.useMemo(()=>pL(f,s),[f,s]),g=SL(f);return k.createElement(k.Fragment,null,h.map(y=>k.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...t})),m.map(y=>k.createElement("link",{key:y,rel:"modulepreload",href:y,...t})),g.map(({key:y,link:w})=>k.createElement("link",{key:y,...w})))}function CL(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var vC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{vC&&(window.__reactRouterVersion="7.1.5")}catch{}function PL({basename:n,children:e,window:t}){let r=k.useRef();r.current==null&&(r.current=hj({window:t,v5Compat:!0}));let s=r.current,[a,l]=k.useState({action:s.action,location:s.location}),u=k.useCallback(c=>{k.startTransition(()=>l(c))},[l]);return k.useLayoutEffect(()=>s.listen(u),[s,u]),k.createElement(tL,{basename:n,children:e,location:a.location,navigationType:a.action,navigator:s})}var xC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,SC=k.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:s,reloadDocument:a,replace:l,state:u,target:c,to:f,preventScrollReset:h,viewTransition:m,...g},y){let{basename:w}=k.useContext(os),v=typeof f=="string"&&xC.test(f),x,E=!1;if(typeof f=="string"&&v&&(x=f,vC))try{let K=new URL(window.location.href),Y=f.startsWith("//")?new URL(K.protocol+f):new URL(f),ie=ca(Y.pathname,w);Y.origin===K.origin&&ie!=null?f=ie+Y.search+Y.hash:E=!0}catch{Yr(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let P=Fj(f,{relative:s}),[S,R,$]=vL(r,g),I=TL(f,{replace:l,state:u,target:c,preventScrollReset:h,relative:s,viewTransition:m});function D(K){e&&e(K),K.defaultPrevented||I(K)}let F=k.createElement("a",{...g,...$,href:x||P,onClick:E||a?e:D,ref:CL(y,R),target:c,"data-discover":!v&&t==="render"?"true":void 0});return S&&!v?k.createElement(k.Fragment,null,F,k.createElement(xL,{page:P})):F});SC.displayName="Link";var kL=k.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:s=!1,style:a,to:l,viewTransition:u,children:c,...f},h){let m=bu(l,{relative:f.relative}),g=si(),y=k.useContext(wf),{navigator:w,basename:v}=k.useContext(os),x=y!=null&&jL(m)&&u===!0,E=w.encodeLocation?w.encodeLocation(m).pathname:m.pathname,P=g.pathname,S=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;t||(P=P.toLowerCase(),S=S?S.toLowerCase():null,E=E.toLowerCase()),S&&v&&(S=ca(S,v)||S);const R=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let $=P===E||!s&&P.startsWith(E)&&P.charAt(R)==="/",I=S!=null&&(S===E||!s&&S.startsWith(E)&&S.charAt(E.length)==="/"),D={isActive:$,isPending:I,isTransitioning:x},F=$?e:void 0,K;typeof r=="function"?K=r(D):K=[r,$?"active":null,I?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let Y=typeof a=="function"?a(D):a;return k.createElement(SC,{...f,"aria-current":F,className:K,ref:h,style:Y,to:l,viewTransition:u},typeof c=="function"?c(D):c)});kL.displayName="NavLink";var RL=k.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:s,state:a,method:l=md,action:u,onSubmit:c,relative:f,preventScrollReset:h,viewTransition:m,...g},y)=>{let w=IL(),v=NL(u,{relative:f}),x=l.toLowerCase()==="get"?"get":"post",E=typeof u=="string"&&xC.test(u),P=S=>{if(c&&c(S),S.defaultPrevented)return;S.preventDefault();let R=S.nativeEvent.submitter,$=(R==null?void 0:R.getAttribute("formmethod"))||l;w(R||S.currentTarget,{fetcherKey:e,method:$,navigate:t,replace:s,state:a,relative:f,preventScrollReset:h,viewTransition:m})};return k.createElement("form",{ref:y,method:x,action:v,onSubmit:r?c:P,...g,"data-discover":!E&&n==="render"?"true":void 0})});RL.displayName="Form";function OL(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function EC(n){let e=k.useContext(go);return ut(e,OL(n)),e}function TL(n,{target:e,replace:t,state:r,preventScrollReset:s,relative:a,viewTransition:l}={}){let u=Uj(),c=si(),f=bu(n,{relative:a});return k.useCallback(h=>{if(oL(h,e)){h.preventDefault();let m=t!==void 0?t:Wl(c)===Wl(f);u(n,{replace:m,state:r,preventScrollReset:s,relative:a,viewTransition:l})}},[c,u,f,t,r,e,n,s,a,l])}var AL=0,$L=()=>`__${String(++AL)}__`;function IL(){let{router:n}=EC("useSubmit"),{basename:e}=k.useContext(os),t=Xj();return k.useCallback(async(r,s={})=>{let{action:a,method:l,encType:u,formData:c,body:f}=cL(r,e);if(s.navigate===!1){let h=s.fetcherKey||$L();await n.fetch(h,t,s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:f,formMethod:s.method||l,formEncType:s.encType||u,flushSync:s.flushSync})}else await n.navigate(s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:f,formMethod:s.method||l,formEncType:s.encType||u,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[n,e,t])}function NL(n,{relative:e}={}){let{basename:t}=k.useContext(os),r=k.useContext(As);ut(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),a={...bu(n||".",{relative:e})},l=si();if(n==null){a.search=l.search;let u=new URLSearchParams(a.search),c=u.getAll("index");if(c.some(h=>h==="")){u.delete("index"),c.filter(m=>m).forEach(m=>u.append("index",m));let h=u.toString();a.search=h?`?${h}`:""}}return(!n||n===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:Ps([t,a.pathname])),Wl(a)}function jL(n,e={}){let t=k.useContext(pC);ut(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=EC("useViewTransitionState"),s=bu(n,{relative:e.relative});if(!t.isTransitioning)return!1;let a=ca(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=ca(t.nextLocation.pathname,r)||t.nextLocation.pathname;return $d(s.pathname,l)!=null||$d(s.pathname,a)!=null}new TextEncoder;function ox(n,e=x_){n=n.trim();const t=/```(json)?(.*)```/s.exec(n);return e(t?t[2]:n)}function x_(n){if(typeof n>"u")return null;try{return JSON.parse(n)}catch{}let e="";const t=[];let r=!1,s=!1;for(let a of n){if(r)a==='"'&&!s?r=!1:a===`
`&&!s?a="\\n":a==="\\"?s=!s:s=!1;else if(a==='"')r=!0,s=!1;else if(a==="{")t.push("}");else if(a==="[")t.push("]");else if(a==="}"||a==="]")if(t&&t[t.length-1]===a)t.pop();else return null;e+=a}r&&(e+='"');for(let a=t.length-1;a>=0;a-=1)e+=t[a];try{return JSON.parse(e)}catch{return null}}var Qp,lx;function LL(){return lx||(lx=1,Qp=function(n,e){if(typeof n!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,n.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()}),Qp}var ML=LL();const DL=ti(ML);var Gc={exports:{}},ux;function FL(){if(ux)return Gc.exports;ux=1;const n=/[\p{Lu}]/u,e=/[\p{Ll}]/u,t=/^[\p{Lu}](?![\p{Lu}])/gu,r=/([\p{Alpha}\p{N}_]|$)/u,s=/[_.\- ]+/,a=new RegExp("^"+s.source),l=new RegExp(s.source+r.source,"gu"),u=new RegExp("\\d+"+r.source,"gu"),c=(g,y,w)=>{let v=!1,x=!1,E=!1;for(let P=0;P<g.length;P++){const S=g[P];v&&n.test(S)?(g=g.slice(0,P)+"-"+g.slice(P),v=!1,E=x,x=!0,P++):x&&E&&e.test(S)?(g=g.slice(0,P-1)+"-"+g.slice(P-1),E=x,x=!1,v=!0):(v=y(S)===S&&w(S)!==S,E=x,x=w(S)===S&&y(S)!==S)}return g},f=(g,y)=>(t.lastIndex=0,g.replace(t,w=>y(w))),h=(g,y)=>(l.lastIndex=0,u.lastIndex=0,g.replace(l,(w,v)=>y(v)).replace(u,w=>y(w))),m=(g,y)=>{if(!(typeof g=="string"||Array.isArray(g)))throw new TypeError("Expected the input to be `string | string[]`");if(y={pascalCase:!1,preserveConsecutiveUppercase:!1,...y},Array.isArray(g)?g=g.map(E=>E.trim()).filter(E=>E.length).join("-"):g=g.trim(),g.length===0)return"";const w=y.locale===!1?E=>E.toLowerCase():E=>E.toLocaleLowerCase(y.locale),v=y.locale===!1?E=>E.toUpperCase():E=>E.toLocaleUpperCase(y.locale);return g.length===1?y.pascalCase?v(g):w(g):(g!==w(g)&&(g=c(g,w,v)),g=g.replace(a,""),y.preserveConsecutiveUppercase?g=f(g,w):g=w(g),y.pascalCase&&(g=v(g.charAt(0))+g.slice(1)),h(g,v))};return Gc.exports=m,Gc.exports.default=m,Gc.exports}FL();function UL(n,e){return(e==null?void 0:e[n])||DL(n)}function zL(n,e,t){const r={};for(const s in n)Object.hasOwn(n,s)&&(r[e(s,t)]=n[s]);return r}function cx(n){return Array.isArray(n)?[...n]:{...n}}function BL(n,e){const t=cx(n);for(const[r,s]of Object.entries(e)){const[a,...l]=r.split(".").reverse();let u=t;for(const c of l.reverse()){if(u[c]===void 0)break;u[c]=cx(u[c]),u=u[c]}u[a]!==void 0&&(u[a]={lc:1,type:"secret",id:[s]})}return t}function CC(n){const e=Object.getPrototypeOf(n);return typeof n.lc_name=="function"&&(typeof e.lc_name!="function"||n.lc_name()!==e.lc_name())?n.lc_name():n.name}class Ja{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,CC(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_serializable_keys!==void 0?this.lc_kwargs=Object.fromEntries(Object.entries(e||{}).filter(([r])=>{var s;return(s=this.lc_serializable_keys)==null?void 0:s.includes(r)})):this.lc_kwargs=e??{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof Ja||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},t={},r=Object.keys(this.lc_kwargs).reduce((s,a)=>(s[a]=a in this?this[a]:this.lc_kwargs[a],s),{});for(let s=Object.getPrototypeOf(this);s;s=Object.getPrototypeOf(s))Object.assign(e,Reflect.get(s,"lc_aliases",this)),Object.assign(t,Reflect.get(s,"lc_secrets",this)),Object.assign(r,Reflect.get(s,"lc_attributes",this));return Object.keys(t).forEach(s=>{let a=this,l=r;const[u,...c]=s.split(".").reverse();for(const f of c.reverse()){if(!(f in a)||a[f]===void 0)return;(!(f in l)||l[f]===void 0)&&(typeof a[f]=="object"&&a[f]!=null?l[f]={}:Array.isArray(a[f])&&(l[f]=[])),a=a[f],l=l[f]}u in a&&a[u]!==void 0&&(l[u]=l[u]||a[u])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:zL(Object.keys(t).length?BL(r,t):r,UL,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}function yo(n,e){return typeof n=="string"?n===""?e:typeof e=="string"?n+e:[{type:"text",text:n},...e]:Array.isArray(e)?vf(n,e)??[...n,...e]:e===""?n:[...n,{type:"text",text:e}]}function HL(n,e){return n==="error"||e==="error"?"error":"success"}function WL(n,e){function t(r,s){if(typeof r!="object"||r===null||r===void 0)return r;if(s>=e)return Array.isArray(r)?"[Array]":"[Object]";if(Array.isArray(r))return r.map(l=>t(l,s+1));const a={};for(const l of Object.keys(r))a[l]=t(r[l],s+1);return a}return JSON.stringify(t(n,0),null,2)}class _o extends Ja{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:Array.isArray(this.content)?this.content.map(e=>typeof e=="string"?e:e.type==="text"?e.text:"").join(""):""}getType(){return this._getType()}constructor(e,t){typeof e=="string"&&(e={content:e,additional_kwargs:t,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const t=WL(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${t}`}}function fn(n,e){const t={...n};for(const[r,s]of Object.entries(e))if(t[r]==null)t[r]=s;else{if(s==null)continue;if(typeof t[r]!=typeof s||Array.isArray(t[r])!==Array.isArray(s))throw new Error(`field[${r}] already exists in the message chunk, but with a different type.`);if(typeof t[r]=="string"){if(r==="type")continue;t[r]+=s}else if(typeof t[r]=="object"&&!Array.isArray(t[r]))t[r]=fn(t[r],s);else if(Array.isArray(t[r]))t[r]=vf(t[r],s);else{if(t[r]===s)continue;console.warn(`field[${r}] already exists in this message chunk and value has unsupported type.`)}}return t}function vf(n,e){if(!(n===void 0&&e===void 0)){if(n===void 0||e===void 0)return n||e;{const t=[...n];for(const r of e)if(typeof r=="object"&&"index"in r&&typeof r.index=="number"){const s=t.findIndex(a=>a.index===r.index);s!==-1?t[s]=fn(t[s],r):t.push(r)}else{if(typeof r=="object"&&"text"in r&&r.text==="")continue;t.push(r)}return t}}}function VL(n,e){if(!n&&!e)throw new Error("Cannot merge two undefined objects.");if(!n||!e)return n||e;if(typeof n!=typeof e)throw new Error(`Cannot merge objects of different types.
Left ${typeof n}
Right ${typeof e}`);if(typeof n=="string"&&typeof e=="string")return n+e;if(Array.isArray(n)&&Array.isArray(e))return vf(n,e);if(typeof n=="object"&&typeof e=="object")return fn(n,e);if(n===e)return n;throw new Error(`Can not merge objects of different types.
Left ${n}
Right ${e}`)}class wo extends _o{}function qL(n){return typeof n.role=="string"}function xf(n){return typeof(n==null?void 0:n._getType)=="function"}function ZL(n){return xf(n)&&typeof n.concat=="function"}class GL extends _o{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,t,r){typeof e=="string"&&(e={content:e,name:r,tool_call_id:t}),super(e),Object.defineProperty(this,"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}class S_ extends wo{constructor(e){super(e),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}static lc_name(){return"ToolMessageChunk"}_getType(){return"tool"}concat(e){return new S_({content:yo(this.content,e.content),additional_kwargs:fn(this.additional_kwargs,e.additional_kwargs),response_metadata:fn(this.response_metadata,e.response_metadata),artifact:VL(this.artifact,e.artifact),tool_call_id:this.tool_call_id,id:this.id??e.id,status:HL(this.status,e.status)})}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function JL(n){const e=[],t=[];for(const r of n)if(r.function){const s=r.function.name;try{const a=JSON.parse(r.function.arguments),l={name:s||"",args:a||{},id:r.id};e.push(l)}catch{t.push({name:s,args:r.function.arguments,id:r.id,error:"Malformed args."})}}else continue;return[e,t]}class Ka extends _o{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,t){var s;let r;if(typeof e=="string")r={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:t??{}};else{r=e;const a=(s=r.additional_kwargs)==null?void 0:s.tool_calls,l=r.tool_calls;a!=null&&a.length>0&&(l===void 0||l.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(a!=null&&l===void 0){const[u,c]=JL(a);r.tool_calls=u??[],r.invalid_tool_calls=c??[]}else r.tool_calls=r.tool_calls??[],r.invalid_tool_calls=r.invalid_tool_calls??[]}catch{r.tool_calls=[],r.invalid_tool_calls=[]}}super(r),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r!="string"&&(this.tool_calls=r.tool_calls??this.tool_calls,this.invalid_tool_calls=r.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=r.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}function vu(n){return n._getType()==="ai"}function dx(n){return n._getType()==="ai"}class Qr extends wo{constructor(e){let t;if(typeof e=="string")t={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)t={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{const r=[],s=[];for(const a of e.tool_call_chunks){let l={};try{if(l=x_(a.args||"{}"),l===null||typeof l!="object"||Array.isArray(l))throw new Error("Malformed tool call chunk args.");r.push({name:a.name??"",args:l,id:a.id,type:"tool_call"})}catch{s.push({name:a.name,args:a.args,id:a.id,error:"Malformed args.",type:"invalid_tool_call"})}}t={...e,tool_calls:r,invalid_tool_calls:s,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(t),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=t.tool_call_chunks??this.tool_call_chunks,this.tool_calls=t.tool_calls??this.tool_calls,this.invalid_tool_calls=t.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=t.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){var r,s,a,l,u,c,f,h,m,g,y,w,v,x,E,P,S,R,$,I,D,F,K,Y,ie,de,ue,V,G,q,J,j,B,W,T,M,X,ae,Q,le;const t={content:yo(this.content,e.content),additional_kwargs:fn(this.additional_kwargs,e.additional_kwargs),response_metadata:fn(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const Re=vf(this.tool_call_chunks,e.tool_call_chunks);Re!==void 0&&Re.length>0&&(t.tool_call_chunks=Re)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){const Re={...(((s=(r=this.usage_metadata)==null?void 0:r.input_token_details)==null?void 0:s.audio)!==void 0||((l=(a=e.usage_metadata)==null?void 0:a.input_token_details)==null?void 0:l.audio)!==void 0)&&{audio:(((c=(u=this.usage_metadata)==null?void 0:u.input_token_details)==null?void 0:c.audio)??0)+(((h=(f=e.usage_metadata)==null?void 0:f.input_token_details)==null?void 0:h.audio)??0)},...(((g=(m=this.usage_metadata)==null?void 0:m.input_token_details)==null?void 0:g.cache_read)!==void 0||((w=(y=e.usage_metadata)==null?void 0:y.input_token_details)==null?void 0:w.cache_read)!==void 0)&&{cache_read:(((x=(v=this.usage_metadata)==null?void 0:v.input_token_details)==null?void 0:x.cache_read)??0)+(((P=(E=e.usage_metadata)==null?void 0:E.input_token_details)==null?void 0:P.cache_read)??0)},...(((R=(S=this.usage_metadata)==null?void 0:S.input_token_details)==null?void 0:R.cache_creation)!==void 0||((I=($=e.usage_metadata)==null?void 0:$.input_token_details)==null?void 0:I.cache_creation)!==void 0)&&{cache_creation:(((F=(D=this.usage_metadata)==null?void 0:D.input_token_details)==null?void 0:F.cache_creation)??0)+(((Y=(K=e.usage_metadata)==null?void 0:K.input_token_details)==null?void 0:Y.cache_creation)??0)}},Ee={...(((de=(ie=this.usage_metadata)==null?void 0:ie.output_token_details)==null?void 0:de.audio)!==void 0||((V=(ue=e.usage_metadata)==null?void 0:ue.output_token_details)==null?void 0:V.audio)!==void 0)&&{audio:(((q=(G=this.usage_metadata)==null?void 0:G.output_token_details)==null?void 0:q.audio)??0)+(((j=(J=e.usage_metadata)==null?void 0:J.output_token_details)==null?void 0:j.audio)??0)},...(((W=(B=this.usage_metadata)==null?void 0:B.output_token_details)==null?void 0:W.reasoning)!==void 0||((M=(T=e.usage_metadata)==null?void 0:T.output_token_details)==null?void 0:M.reasoning)!==void 0)&&{reasoning:(((ae=(X=this.usage_metadata)==null?void 0:X.output_token_details)==null?void 0:ae.reasoning)??0)+(((le=(Q=e.usage_metadata)==null?void 0:Q.output_token_details)==null?void 0:le.reasoning)??0)}},be=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},je=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},ct={input_tokens:be.input_tokens+je.input_tokens,output_tokens:be.output_tokens+je.output_tokens,total_tokens:be.total_tokens+je.total_tokens,...Object.keys(Re).length>0&&{input_token_details:Re},...Object.keys(Ee).length>0&&{output_token_details:Ee}};t.usage_metadata=ct}return new Qr(t)}}class xu extends _o{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return xu}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}}class Sf extends wo{static lc_name(){return"ChatMessageChunk"}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new Sf({content:yo(this.content,e.content),additional_kwargs:fn(this.additional_kwargs,e.additional_kwargs),response_metadata:fn(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}class Ef extends wo{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new Ef({content:yo(this.content,e.content),additional_kwargs:fn(this.additional_kwargs,e.additional_kwargs),response_metadata:fn(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}}class to extends _o{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class Cf extends wo{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(e){return new Cf({content:yo(this.content,e.content),additional_kwargs:fn(this.additional_kwargs,e.additional_kwargs),response_metadata:fn(this.response_metadata,e.response_metadata),id:this.id??e.id})}}class Hg extends _o{static lc_name(){return"SystemMessage"}_getType(){return"system"}}class Vl extends wo{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(e){return new Vl({content:yo(this.content,e.content),additional_kwargs:fn(this.additional_kwargs,e.additional_kwargs),response_metadata:fn(this.response_metadata,e.response_metadata),id:this.id??e.id})}}function PC(n,e){return n.lc_error_code=e,n.message=`${n.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,n}function kC(n){return!!(n&&typeof n=="object"&&"type"in n&&n.type==="tool_call")}class KL extends Error{constructor(e,t){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=t}}function XL(n){return kC(n)?n:typeof n.id=="string"&&n.type==="function"&&typeof n.function=="object"&&n.function!==null&&"arguments"in n.function&&typeof n.function.arguments=="string"&&"name"in n.function&&typeof n.function.name=="string"?{id:n.id,args:JSON.parse(n.function.arguments),name:n.function.name,type:"tool_call"}:n}function YL(n){return typeof n=="object"&&n!=null&&n.lc===1&&Array.isArray(n.id)&&n.kwargs!=null&&typeof n.kwargs=="object"}function em(n){let e,t;if(YL(n)){const r=n.id.at(-1);r==="HumanMessage"||r==="HumanMessageChunk"?e="user":r==="AIMessage"||r==="AIMessageChunk"?e="assistant":r==="SystemMessage"||r==="SystemMessageChunk"?e="system":r==="FunctionMessage"||r==="FunctionMessageChunk"?e="function":r==="ToolMessage"||r==="ToolMessageChunk"?e="tool":e="unknown",t=n.kwargs}else{const{type:r,...s}=n;e=r,t=s}if(e==="human"||e==="user")return new to(t);if(e==="ai"||e==="assistant"){const{tool_calls:r,...s}=t;if(!Array.isArray(r))return new Ka(t);const a=r.map(XL);return new Ka({...s,tool_calls:a})}else{if(e==="system")return new Hg(t);if(e==="developer")return new Hg({...t,additional_kwargs:{...t.additional_kwargs,__openai_role__:"developer"}});if(e==="tool"&&"tool_call_id"in t)return new GL({...t,content:t.content,tool_call_id:t.tool_call_id,name:t.name});throw PC(new Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(n,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function Sl(n){if(typeof n=="string")return new to(n);if(xf(n))return n;if(Array.isArray(n)){const[e,t]=n;return em({type:e,content:t})}else if(qL(n)){const{role:e,...t}=n;return em({...t,type:e})}else return em(n)}function RC(n,e="Human",t="AI"){const r=[];for(const s of n){let a;if(s._getType()==="human")a=e;else if(s._getType()==="ai")a=t;else if(s._getType()==="system")a="System";else if(s._getType()==="function")a="Function";else if(s._getType()==="tool")a="Tool";else if(s._getType()==="generic")a=s.role;else throw new Error(`Got unsupported message type: ${s._getType()}`);const l=s.name?`${s.name}, `:"",u=typeof s.content=="string"?s.content:JSON.stringify(s.content,null,2);r.push(`${a}: ${l}${u}`)}return r.join(`
`)}function QL(n){var t;const e=n._getType();if(e==="human")return new Cf({...n});if(e==="ai"){let r={...n};return"tool_calls"in r&&(r={...r,tool_call_chunks:(t=r.tool_calls)==null?void 0:t.map(s=>({...s,type:"tool_call_chunk",index:void 0,args:JSON.stringify(s.args)}))}),new Qr({...r})}else{if(e==="system")return new Vl({...n});if(e==="function")return new Ef({...n});if(xu.isInstance(n))return new Sf({...n});throw new Error("Unknown message type.")}}var Be;(function(n){n.assertEqual=s=>s;function e(s){}n.assertIs=e;function t(s){throw new Error}n.assertNever=t,n.arrayToEnum=s=>{const a={};for(const l of s)a[l]=l;return a},n.getValidEnumValues=s=>{const a=n.objectKeys(s).filter(u=>typeof s[s[u]]!="number"),l={};for(const u of a)l[u]=s[u];return n.objectValues(l)},n.objectValues=s=>n.objectKeys(s).map(function(a){return s[a]}),n.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const l in s)Object.prototype.hasOwnProperty.call(s,l)&&a.push(l);return a},n.find=(s,a)=>{for(const l of s)if(a(l))return l},n.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,a=" | "){return s.map(l=>typeof l=="string"?`'${l}'`:l).join(a)}n.joinValues=r,n.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(Be||(Be={}));var Wg;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(Wg||(Wg={}));const he=Be.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),xs=n=>{switch(typeof n){case"undefined":return he.undefined;case"string":return he.string;case"number":return isNaN(n)?he.nan:he.number;case"boolean":return he.boolean;case"function":return he.function;case"bigint":return he.bigint;case"symbol":return he.symbol;case"object":return Array.isArray(n)?he.array:n===null?he.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?he.promise:typeof Map<"u"&&n instanceof Map?he.map:typeof Set<"u"&&n instanceof Set?he.set:typeof Date<"u"&&n instanceof Date?he.date:he.object;default:return he.unknown}},se=Be.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),e2=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:");class Dn extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(a){return a.message},r={_errors:[]},s=a=>{for(const l of a.issues)if(l.code==="invalid_union")l.unionErrors.map(s);else if(l.code==="invalid_return_type")s(l.returnTypeError);else if(l.code==="invalid_arguments")s(l.argumentsError);else if(l.path.length===0)r._errors.push(t(l));else{let u=r,c=0;for(;c<l.path.length;){const f=l.path[c];c===l.path.length-1?(u[f]=u[f]||{_errors:[]},u[f]._errors.push(t(l))):u[f]=u[f]||{_errors:[]},u=u[f],c++}}};return s(this),r}static assert(e){if(!(e instanceof Dn))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Be.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}Dn.create=n=>new Dn(n);const no=(n,e)=>{let t;switch(n.code){case se.invalid_type:n.received===he.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case se.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,Be.jsonStringifyReplacer)}`;break;case se.unrecognized_keys:t=`Unrecognized key(s) in object: ${Be.joinValues(n.keys,", ")}`;break;case se.invalid_union:t="Invalid input";break;case se.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Be.joinValues(n.options)}`;break;case se.invalid_enum_value:t=`Invalid enum value. Expected ${Be.joinValues(n.options)}, received '${n.received}'`;break;case se.invalid_arguments:t="Invalid function arguments";break;case se.invalid_return_type:t="Invalid function return type";break;case se.invalid_date:t="Invalid date";break;case se.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:Be.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case se.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case se.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case se.custom:t="Invalid input";break;case se.invalid_intersection_types:t="Intersection results could not be merged";break;case se.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case se.not_finite:t="Number must be finite";break;default:t=e.defaultError,Be.assertNever(n)}return{message:t}};let OC=no;function t2(n){OC=n}function Id(){return OC}const Nd=n=>{const{data:e,path:t,errorMaps:r,issueData:s}=n,a=[...t,...s.path||[]],l={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let u="";const c=r.filter(f=>!!f).slice().reverse();for(const f of c)u=f(l,{data:e,defaultError:u}).message;return{...s,path:a,message:u}},n2=[];function ce(n,e){const t=Id(),r=Nd({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===no?void 0:no].filter(s=>!!s)});n.common.issues.push(r)}class tn{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const s of t){if(s.status==="aborted")return Te;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const s of t){const a=await s.key,l=await s.value;r.push({key:a,value:l})}return tn.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const s of t){const{key:a,value:l}=s;if(a.status==="aborted"||l.status==="aborted")return Te;a.status==="dirty"&&e.dirty(),l.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof l.value<"u"||s.alwaysSet)&&(r[a.value]=l.value)}return{status:e.value,value:r}}}const Te=Object.freeze({status:"aborted"}),Bi=n=>({status:"dirty",value:n}),hn=n=>({status:"valid",value:n}),Vg=n=>n.status==="aborted",qg=n=>n.status==="dirty",Xa=n=>n.status==="valid",ql=n=>typeof Promise<"u"&&n instanceof Promise;function jd(n,e,t,r){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(n)}function TC(n,e,t,r,s){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,t),t}var we;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(we||(we={}));var El,Cl;class es{constructor(e,t,r,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const fx=(n,e)=>{if(Xa(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Dn(n.common.issues);return this._error=t,this._error}}};function $e(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:s}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(l,u)=>{var c,f;const{message:h}=n;return l.code==="invalid_enum_value"?{message:h??u.defaultError}:typeof u.data>"u"?{message:(c=h??r)!==null&&c!==void 0?c:u.defaultError}:l.code!=="invalid_type"?{message:u.defaultError}:{message:(f=h??t)!==null&&f!==void 0?f:u.defaultError}},description:s}}class Me{get description(){return this._def.description}_getType(e){return xs(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:xs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new tn,ctx:{common:e.parent.common,data:e.data,parsedType:xs(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(ql(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const s={common:{issues:[],async:(r=t==null?void 0:t.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:xs(e)},a=this._parseSync({data:e,path:s.path,parent:s});return fx(s,a)}"~validate"(e){var t,r;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:xs(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:s});return Xa(a)?{value:a.value}:{issues:s.common.issues}}catch(a){!((r=(t=a==null?void 0:a.message)===null||t===void 0?void 0:t.toLowerCase())===null||r===void 0)&&r.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:s}).then(a=>Xa(a)?{value:a.value}:{issues:s.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:xs(e)},s=this._parse({data:e,path:r.path,parent:r}),a=await(ql(s)?s:Promise.resolve(s));return fx(r,a)}refine(e,t){const r=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,a)=>{const l=e(s),u=()=>a.addIssue({code:se.custom,...r(s)});return typeof Promise<"u"&&l instanceof Promise?l.then(c=>c?!0:(u(),!1)):l?!0:(u(),!1)})}refinement(e,t){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof t=="function"?t(r,s):t),!1))}_refinement(e){return new Rr({schema:this,typeName:Z.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Sr.create(this,this._def)}nullable(){return pa.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return xr.create(this)}promise(){return so.create(this,this._def)}or(e){return Kl.create([this,e],this._def)}and(e){return Xl.create(this,e,this._def)}transform(e){return new Rr({...$e(this._def),schema:this,typeName:Z.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new nu({...$e(this._def),innerType:this,defaultValue:t,typeName:Z.ZodDefault})}brand(){return new E_({typeName:Z.ZodBranded,type:this,...$e(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new ru({...$e(this._def),innerType:this,catchValue:t,typeName:Z.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Su.create(this,e)}readonly(){return su.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const r2=/^c[^\s-]{8,}$/i,s2=/^[0-9a-z]+$/,a2=/^[0-9A-HJKMNP-TV-Z]{26}$/i,i2=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,o2=/^[a-z0-9_-]{21}$/i,l2=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,u2=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,c2=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,d2="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let tm;const f2=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,h2=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,p2=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,m2=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,g2=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,y2=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,AC="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",_2=new RegExp(`^${AC}$`);function $C(n){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`),e}function w2(n){return new RegExp(`^${$C(n)}$`)}function IC(n){let e=`${AC}T${$C(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function b2(n,e){return!!((e==="v4"||!e)&&f2.test(n)||(e==="v6"||!e)&&p2.test(n))}function v2(n,e){if(!l2.test(n))return!1;try{const[t]=n.split("."),r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||!s.typ||!s.alg||e&&s.alg!==e)}catch{return!1}}function x2(n,e){return!!((e==="v4"||!e)&&h2.test(n)||(e==="v6"||!e)&&m2.test(n))}class br extends Me{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==he.string){const a=this._getOrReturnCtx(e);return ce(a,{code:se.invalid_type,expected:he.string,received:a.parsedType}),Te}const r=new tn;let s;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(s=this._getOrReturnCtx(e,s),ce(s,{code:se.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")e.data.length>a.value&&(s=this._getOrReturnCtx(e,s),ce(s,{code:se.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const l=e.data.length>a.value,u=e.data.length<a.value;(l||u)&&(s=this._getOrReturnCtx(e,s),l?ce(s,{code:se.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):u&&ce(s,{code:se.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")c2.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"email",code:se.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")tm||(tm=new RegExp(d2,"u")),tm.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"emoji",code:se.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")i2.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"uuid",code:se.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")o2.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"nanoid",code:se.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")r2.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"cuid",code:se.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")s2.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"cuid2",code:se.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")a2.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"ulid",code:se.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),ce(s,{validation:"url",code:se.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"regex",code:se.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(e,s),ce(s,{code:se.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(s=this._getOrReturnCtx(e,s),ce(s,{code:se.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(s=this._getOrReturnCtx(e,s),ce(s,{code:se.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?IC(a).test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{code:se.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?_2.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{code:se.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?w2(a).test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{code:se.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?u2.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"duration",code:se.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?b2(e.data,a.version)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"ip",code:se.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?v2(e.data,a.alg)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"jwt",code:se.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?x2(e.data,a.version)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"cidr",code:se.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?g2.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"base64",code:se.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?y2.test(e.data)||(s=this._getOrReturnCtx(e,s),ce(s,{validation:"base64url",code:se.invalid_string,message:a.message}),r.dirty()):Be.assertNever(a);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(s=>e.test(s),{validation:t,code:se.invalid_string,...we.errToObj(r)})}_addCheck(e){return new br({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...we.errToObj(e)})}url(e){return this._addCheck({kind:"url",...we.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...we.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...we.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...we.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...we.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...we.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...we.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...we.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...we.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...we.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...we.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...we.errToObj(e)})}datetime(e){var t,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,local:(r=e==null?void 0:e.local)!==null&&r!==void 0?r:!1,...we.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...we.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...we.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...we.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...we.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...we.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...we.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...we.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...we.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...we.errToObj(t)})}nonempty(e){return this.min(1,we.errToObj(e))}trim(){return new br({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new br({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new br({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}br.create=n=>{var e;return new br({checks:[],typeName:Z.ZodString,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...$e(n)})};function S2(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=t>r?t:r,a=parseInt(n.toFixed(s).replace(".","")),l=parseInt(e.toFixed(s).replace(".",""));return a%l/Math.pow(10,s)}class da extends Me{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==he.number){const a=this._getOrReturnCtx(e);return ce(a,{code:se.invalid_type,expected:he.number,received:a.parsedType}),Te}let r;const s=new tn;for(const a of this._def.checks)a.kind==="int"?Be.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),ce(r,{code:se.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),ce(r,{code:se.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),ce(r,{code:se.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?S2(e.data,a.value)!==0&&(r=this._getOrReturnCtx(e,r),ce(r,{code:se.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),ce(r,{code:se.not_finite,message:a.message}),s.dirty()):Be.assertNever(a);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,we.toString(t))}gt(e,t){return this.setLimit("min",e,!1,we.toString(t))}lte(e,t){return this.setLimit("max",e,!0,we.toString(t))}lt(e,t){return this.setLimit("max",e,!1,we.toString(t))}setLimit(e,t,r,s){return new da({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:we.toString(s)}]})}_addCheck(e){return new da({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:we.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:we.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:we.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:we.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:we.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:we.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:we.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:we.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:we.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Be.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}da.create=n=>new da({checks:[],typeName:Z.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...$e(n)});class fa extends Me{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==he.bigint)return this._getInvalidInput(e);let r;const s=new tn;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),ce(r,{code:se.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),ce(r,{code:se.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),ce(r,{code:se.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):Be.assertNever(a);return{status:s.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return ce(t,{code:se.invalid_type,expected:he.bigint,received:t.parsedType}),Te}gte(e,t){return this.setLimit("min",e,!0,we.toString(t))}gt(e,t){return this.setLimit("min",e,!1,we.toString(t))}lte(e,t){return this.setLimit("max",e,!0,we.toString(t))}lt(e,t){return this.setLimit("max",e,!1,we.toString(t))}setLimit(e,t,r,s){return new fa({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:we.toString(s)}]})}_addCheck(e){return new fa({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:we.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:we.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:we.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:we.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:we.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}fa.create=n=>{var e;return new fa({checks:[],typeName:Z.ZodBigInt,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...$e(n)})};class Zl extends Me{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==he.boolean){const r=this._getOrReturnCtx(e);return ce(r,{code:se.invalid_type,expected:he.boolean,received:r.parsedType}),Te}return hn(e.data)}}Zl.create=n=>new Zl({typeName:Z.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...$e(n)});class Ya extends Me{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==he.date){const a=this._getOrReturnCtx(e);return ce(a,{code:se.invalid_type,expected:he.date,received:a.parsedType}),Te}if(isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return ce(a,{code:se.invalid_date}),Te}const r=new tn;let s;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(s=this._getOrReturnCtx(e,s),ce(s,{code:se.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(s=this._getOrReturnCtx(e,s),ce(s,{code:se.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):Be.assertNever(a);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ya({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:we.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:we.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Ya.create=n=>new Ya({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:Z.ZodDate,...$e(n)});class Ld extends Me{_parse(e){if(this._getType(e)!==he.symbol){const r=this._getOrReturnCtx(e);return ce(r,{code:se.invalid_type,expected:he.symbol,received:r.parsedType}),Te}return hn(e.data)}}Ld.create=n=>new Ld({typeName:Z.ZodSymbol,...$e(n)});class Gl extends Me{_parse(e){if(this._getType(e)!==he.undefined){const r=this._getOrReturnCtx(e);return ce(r,{code:se.invalid_type,expected:he.undefined,received:r.parsedType}),Te}return hn(e.data)}}Gl.create=n=>new Gl({typeName:Z.ZodUndefined,...$e(n)});class Jl extends Me{_parse(e){if(this._getType(e)!==he.null){const r=this._getOrReturnCtx(e);return ce(r,{code:se.invalid_type,expected:he.null,received:r.parsedType}),Te}return hn(e.data)}}Jl.create=n=>new Jl({typeName:Z.ZodNull,...$e(n)});class ro extends Me{constructor(){super(...arguments),this._any=!0}_parse(e){return hn(e.data)}}ro.create=n=>new ro({typeName:Z.ZodAny,...$e(n)});class za extends Me{constructor(){super(...arguments),this._unknown=!0}_parse(e){return hn(e.data)}}za.create=n=>new za({typeName:Z.ZodUnknown,...$e(n)});class Ts extends Me{_parse(e){const t=this._getOrReturnCtx(e);return ce(t,{code:se.invalid_type,expected:he.never,received:t.parsedType}),Te}}Ts.create=n=>new Ts({typeName:Z.ZodNever,...$e(n)});class Md extends Me{_parse(e){if(this._getType(e)!==he.undefined){const r=this._getOrReturnCtx(e);return ce(r,{code:se.invalid_type,expected:he.void,received:r.parsedType}),Te}return hn(e.data)}}Md.create=n=>new Md({typeName:Z.ZodVoid,...$e(n)});class xr extends Me{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),s=this._def;if(t.parsedType!==he.array)return ce(t,{code:se.invalid_type,expected:he.array,received:t.parsedType}),Te;if(s.exactLength!==null){const l=t.data.length>s.exactLength.value,u=t.data.length<s.exactLength.value;(l||u)&&(ce(t,{code:l?se.too_big:se.too_small,minimum:u?s.exactLength.value:void 0,maximum:l?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(ce(t,{code:se.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(ce(t,{code:se.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((l,u)=>s.type._parseAsync(new es(t,l,t.path,u)))).then(l=>tn.mergeArray(r,l));const a=[...t.data].map((l,u)=>s.type._parseSync(new es(t,l,t.path,u)));return tn.mergeArray(r,a)}get element(){return this._def.type}min(e,t){return new xr({...this._def,minLength:{value:e,message:we.toString(t)}})}max(e,t){return new xr({...this._def,maxLength:{value:e,message:we.toString(t)}})}length(e,t){return new xr({...this._def,exactLength:{value:e,message:we.toString(t)}})}nonempty(e){return this.min(1,e)}}xr.create=(n,e)=>new xr({type:n,minLength:null,maxLength:null,exactLength:null,typeName:Z.ZodArray,...$e(e)});function Fi(n){if(n instanceof lt){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=Sr.create(Fi(r))}return new lt({...n._def,shape:()=>e})}else return n instanceof xr?new xr({...n._def,type:Fi(n.element)}):n instanceof Sr?Sr.create(Fi(n.unwrap())):n instanceof pa?pa.create(Fi(n.unwrap())):n instanceof ts?ts.create(n.items.map(e=>Fi(e))):n}class lt extends Me{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=Be.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==he.object){const f=this._getOrReturnCtx(e);return ce(f,{code:se.invalid_type,expected:he.object,received:f.parsedType}),Te}const{status:r,ctx:s}=this._processInputParams(e),{shape:a,keys:l}=this._getCached(),u=[];if(!(this._def.catchall instanceof Ts&&this._def.unknownKeys==="strip"))for(const f in s.data)l.includes(f)||u.push(f);const c=[];for(const f of l){const h=a[f],m=s.data[f];c.push({key:{status:"valid",value:f},value:h._parse(new es(s,m,s.path,f)),alwaysSet:f in s.data})}if(this._def.catchall instanceof Ts){const f=this._def.unknownKeys;if(f==="passthrough")for(const h of u)c.push({key:{status:"valid",value:h},value:{status:"valid",value:s.data[h]}});else if(f==="strict")u.length>0&&(ce(s,{code:se.unrecognized_keys,keys:u}),r.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const h of u){const m=s.data[h];c.push({key:{status:"valid",value:h},value:f._parse(new es(s,m,s.path,h)),alwaysSet:h in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const f=[];for(const h of c){const m=await h.key,g=await h.value;f.push({key:m,value:g,alwaysSet:h.alwaysSet})}return f}).then(f=>tn.mergeObjectSync(r,f)):tn.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return we.errToObj,new lt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{var s,a,l,u;const c=(l=(a=(s=this._def).errorMap)===null||a===void 0?void 0:a.call(s,t,r).message)!==null&&l!==void 0?l:r.defaultError;return t.code==="unrecognized_keys"?{message:(u=we.errToObj(e).message)!==null&&u!==void 0?u:c}:{message:c}}}:{}})}strip(){return new lt({...this._def,unknownKeys:"strip"})}passthrough(){return new lt({...this._def,unknownKeys:"passthrough"})}extend(e){return new lt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new lt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Z.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new lt({...this._def,catchall:e})}pick(e){const t={};return Be.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new lt({...this._def,shape:()=>t})}omit(e){const t={};return Be.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new lt({...this._def,shape:()=>t})}deepPartial(){return Fi(this)}partial(e){const t={};return Be.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?t[r]=s:t[r]=s.optional()}),new lt({...this._def,shape:()=>t})}required(e){const t={};return Be.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof Sr;)a=a._def.innerType;t[r]=a}}),new lt({...this._def,shape:()=>t})}keyof(){return NC(Be.objectKeys(this.shape))}}lt.create=(n,e)=>new lt({shape:()=>n,unknownKeys:"strip",catchall:Ts.create(),typeName:Z.ZodObject,...$e(e)});lt.strictCreate=(n,e)=>new lt({shape:()=>n,unknownKeys:"strict",catchall:Ts.create(),typeName:Z.ZodObject,...$e(e)});lt.lazycreate=(n,e)=>new lt({shape:n,unknownKeys:"strip",catchall:Ts.create(),typeName:Z.ZodObject,...$e(e)});class Kl extends Me{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function s(a){for(const u of a)if(u.result.status==="valid")return u.result;for(const u of a)if(u.result.status==="dirty")return t.common.issues.push(...u.ctx.common.issues),u.result;const l=a.map(u=>new Dn(u.ctx.common.issues));return ce(t,{code:se.invalid_union,unionErrors:l}),Te}if(t.common.async)return Promise.all(r.map(async a=>{const l={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:l}),ctx:l}})).then(s);{let a;const l=[];for(const c of r){const f={...t,common:{...t.common,issues:[]},parent:null},h=c._parseSync({data:t.data,path:t.path,parent:f});if(h.status==="valid")return h;h.status==="dirty"&&!a&&(a={result:h,ctx:f}),f.common.issues.length&&l.push(f.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;const u=l.map(c=>new Dn(c));return ce(t,{code:se.invalid_union,unionErrors:u}),Te}}get options(){return this._def.options}}Kl.create=(n,e)=>new Kl({options:n,typeName:Z.ZodUnion,...$e(e)});const bs=n=>n instanceof Ql?bs(n.schema):n instanceof Rr?bs(n.innerType()):n instanceof eu?[n.value]:n instanceof ha?n.options:n instanceof tu?Be.objectValues(n.enum):n instanceof nu?bs(n._def.innerType):n instanceof Gl?[void 0]:n instanceof Jl?[null]:n instanceof Sr?[void 0,...bs(n.unwrap())]:n instanceof pa?[null,...bs(n.unwrap())]:n instanceof E_||n instanceof su?bs(n.unwrap()):n instanceof ru?bs(n._def.innerType):[];class Pf extends Me{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==he.object)return ce(t,{code:se.invalid_type,expected:he.object,received:t.parsedType}),Te;const r=this.discriminator,s=t.data[r],a=this.optionsMap.get(s);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(ce(t,{code:se.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Te)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const s=new Map;for(const a of t){const l=bs(a.shape[e]);if(!l.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const u of l){if(s.has(u))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(u)}`);s.set(u,a)}}return new Pf({typeName:Z.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...$e(r)})}}function Zg(n,e){const t=xs(n),r=xs(e);if(n===e)return{valid:!0,data:n};if(t===he.object&&r===he.object){const s=Be.objectKeys(e),a=Be.objectKeys(n).filter(u=>s.indexOf(u)!==-1),l={...n,...e};for(const u of a){const c=Zg(n[u],e[u]);if(!c.valid)return{valid:!1};l[u]=c.data}return{valid:!0,data:l}}else if(t===he.array&&r===he.array){if(n.length!==e.length)return{valid:!1};const s=[];for(let a=0;a<n.length;a++){const l=n[a],u=e[a],c=Zg(l,u);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return t===he.date&&r===he.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class Xl extends Me{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=(a,l)=>{if(Vg(a)||Vg(l))return Te;const u=Zg(a.value,l.value);return u.valid?((qg(a)||qg(l))&&t.dirty(),{status:t.value,value:u.data}):(ce(r,{code:se.invalid_intersection_types}),Te)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,l])=>s(a,l)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Xl.create=(n,e,t)=>new Xl({left:n,right:e,typeName:Z.ZodIntersection,...$e(t)});class ts extends Me{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==he.array)return ce(r,{code:se.invalid_type,expected:he.array,received:r.parsedType}),Te;if(r.data.length<this._def.items.length)return ce(r,{code:se.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Te;!this._def.rest&&r.data.length>this._def.items.length&&(ce(r,{code:se.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...r.data].map((l,u)=>{const c=this._def.items[u]||this._def.rest;return c?c._parse(new es(r,l,r.path,u)):null}).filter(l=>!!l);return r.common.async?Promise.all(a).then(l=>tn.mergeArray(t,l)):tn.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new ts({...this._def,rest:e})}}ts.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ts({items:n,typeName:Z.ZodTuple,rest:null,...$e(e)})};class Yl extends Me{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==he.object)return ce(r,{code:se.invalid_type,expected:he.object,received:r.parsedType}),Te;const s=[],a=this._def.keyType,l=this._def.valueType;for(const u in r.data)s.push({key:a._parse(new es(r,u,r.path,u)),value:l._parse(new es(r,r.data[u],r.path,u)),alwaysSet:u in r.data});return r.common.async?tn.mergeObjectAsync(t,s):tn.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof Me?new Yl({keyType:e,valueType:t,typeName:Z.ZodRecord,...$e(r)}):new Yl({keyType:br.create(),valueType:e,typeName:Z.ZodRecord,...$e(t)})}}class Dd extends Me{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==he.map)return ce(r,{code:se.invalid_type,expected:he.map,received:r.parsedType}),Te;const s=this._def.keyType,a=this._def.valueType,l=[...r.data.entries()].map(([u,c],f)=>({key:s._parse(new es(r,u,r.path,[f,"key"])),value:a._parse(new es(r,c,r.path,[f,"value"]))}));if(r.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const c of l){const f=await c.key,h=await c.value;if(f.status==="aborted"||h.status==="aborted")return Te;(f.status==="dirty"||h.status==="dirty")&&t.dirty(),u.set(f.value,h.value)}return{status:t.value,value:u}})}else{const u=new Map;for(const c of l){const f=c.key,h=c.value;if(f.status==="aborted"||h.status==="aborted")return Te;(f.status==="dirty"||h.status==="dirty")&&t.dirty(),u.set(f.value,h.value)}return{status:t.value,value:u}}}}Dd.create=(n,e,t)=>new Dd({valueType:e,keyType:n,typeName:Z.ZodMap,...$e(t)});class Qa extends Me{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==he.set)return ce(r,{code:se.invalid_type,expected:he.set,received:r.parsedType}),Te;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(ce(r,{code:se.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(ce(r,{code:se.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const a=this._def.valueType;function l(c){const f=new Set;for(const h of c){if(h.status==="aborted")return Te;h.status==="dirty"&&t.dirty(),f.add(h.value)}return{status:t.value,value:f}}const u=[...r.data.values()].map((c,f)=>a._parse(new es(r,c,r.path,f)));return r.common.async?Promise.all(u).then(c=>l(c)):l(u)}min(e,t){return new Qa({...this._def,minSize:{value:e,message:we.toString(t)}})}max(e,t){return new Qa({...this._def,maxSize:{value:e,message:we.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Qa.create=(n,e)=>new Qa({valueType:n,minSize:null,maxSize:null,typeName:Z.ZodSet,...$e(e)});class Gi extends Me{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==he.function)return ce(t,{code:se.invalid_type,expected:he.function,received:t.parsedType}),Te;function r(u,c){return Nd({data:u,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Id(),no].filter(f=>!!f),issueData:{code:se.invalid_arguments,argumentsError:c}})}function s(u,c){return Nd({data:u,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Id(),no].filter(f=>!!f),issueData:{code:se.invalid_return_type,returnTypeError:c}})}const a={errorMap:t.common.contextualErrorMap},l=t.data;if(this._def.returns instanceof so){const u=this;return hn(async function(...c){const f=new Dn([]),h=await u._def.args.parseAsync(c,a).catch(y=>{throw f.addIssue(r(c,y)),f}),m=await Reflect.apply(l,this,h);return await u._def.returns._def.type.parseAsync(m,a).catch(y=>{throw f.addIssue(s(m,y)),f})})}else{const u=this;return hn(function(...c){const f=u._def.args.safeParse(c,a);if(!f.success)throw new Dn([r(c,f.error)]);const h=Reflect.apply(l,this,f.data),m=u._def.returns.safeParse(h,a);if(!m.success)throw new Dn([s(h,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Gi({...this._def,args:ts.create(e).rest(za.create())})}returns(e){return new Gi({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new Gi({args:e||ts.create([]).rest(za.create()),returns:t||za.create(),typeName:Z.ZodFunction,...$e(r)})}}class Ql extends Me{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Ql.create=(n,e)=>new Ql({getter:n,typeName:Z.ZodLazy,...$e(e)});class eu extends Me{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return ce(t,{received:t.data,code:se.invalid_literal,expected:this._def.value}),Te}return{status:"valid",value:e.data}}get value(){return this._def.value}}eu.create=(n,e)=>new eu({value:n,typeName:Z.ZodLiteral,...$e(e)});function NC(n,e){return new ha({values:n,typeName:Z.ZodEnum,...$e(e)})}class ha extends Me{constructor(){super(...arguments),El.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return ce(t,{expected:Be.joinValues(r),received:t.parsedType,code:se.invalid_type}),Te}if(jd(this,El)||TC(this,El,new Set(this._def.values)),!jd(this,El).has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return ce(t,{received:t.data,code:se.invalid_enum_value,options:r}),Te}return hn(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return ha.create(e,{...this._def,...t})}exclude(e,t=this._def){return ha.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}El=new WeakMap;ha.create=NC;class tu extends Me{constructor(){super(...arguments),Cl.set(this,void 0)}_parse(e){const t=Be.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==he.string&&r.parsedType!==he.number){const s=Be.objectValues(t);return ce(r,{expected:Be.joinValues(s),received:r.parsedType,code:se.invalid_type}),Te}if(jd(this,Cl)||TC(this,Cl,new Set(Be.getValidEnumValues(this._def.values))),!jd(this,Cl).has(e.data)){const s=Be.objectValues(t);return ce(r,{received:r.data,code:se.invalid_enum_value,options:s}),Te}return hn(e.data)}get enum(){return this._def.values}}Cl=new WeakMap;tu.create=(n,e)=>new tu({values:n,typeName:Z.ZodNativeEnum,...$e(e)});class so extends Me{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==he.promise&&t.common.async===!1)return ce(t,{code:se.invalid_type,expected:he.promise,received:t.parsedType}),Te;const r=t.parsedType===he.promise?t.data:Promise.resolve(t.data);return hn(r.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}so.create=(n,e)=>new so({type:n,typeName:Z.ZodPromise,...$e(e)});class Rr extends Me{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Z.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:l=>{ce(r,l),l.fatal?t.abort():t.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const l=s.transform(r.data,a);if(r.common.async)return Promise.resolve(l).then(async u=>{if(t.value==="aborted")return Te;const c=await this._def.schema._parseAsync({data:u,path:r.path,parent:r});return c.status==="aborted"?Te:c.status==="dirty"||t.value==="dirty"?Bi(c.value):c});{if(t.value==="aborted")return Te;const u=this._def.schema._parseSync({data:l,path:r.path,parent:r});return u.status==="aborted"?Te:u.status==="dirty"||t.value==="dirty"?Bi(u.value):u}}if(s.type==="refinement"){const l=u=>{const c=s.refinement(u,a);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(r.common.async===!1){const u=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return u.status==="aborted"?Te:(u.status==="dirty"&&t.dirty(),l(u.value),{status:t.value,value:u.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(u=>u.status==="aborted"?Te:(u.status==="dirty"&&t.dirty(),l(u.value).then(()=>({status:t.value,value:u.value}))))}if(s.type==="transform")if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Xa(l))return l;const u=s.transform(l.value,a);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:u}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>Xa(l)?Promise.resolve(s.transform(l.value,a)).then(u=>({status:t.value,value:u})):l);Be.assertNever(s)}}Rr.create=(n,e,t)=>new Rr({schema:n,typeName:Z.ZodEffects,effect:e,...$e(t)});Rr.createWithPreprocess=(n,e,t)=>new Rr({schema:e,effect:{type:"preprocess",transform:n},typeName:Z.ZodEffects,...$e(t)});class Sr extends Me{_parse(e){return this._getType(e)===he.undefined?hn(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Sr.create=(n,e)=>new Sr({innerType:n,typeName:Z.ZodOptional,...$e(e)});class pa extends Me{_parse(e){return this._getType(e)===he.null?hn(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}pa.create=(n,e)=>new pa({innerType:n,typeName:Z.ZodNullable,...$e(e)});class nu extends Me{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===he.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}nu.create=(n,e)=>new nu({innerType:n,typeName:Z.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...$e(e)});class ru extends Me{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return ql(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Dn(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Dn(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}ru.create=(n,e)=>new ru({innerType:n,typeName:Z.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...$e(e)});class Fd extends Me{_parse(e){if(this._getType(e)!==he.nan){const r=this._getOrReturnCtx(e);return ce(r,{code:se.invalid_type,expected:he.nan,received:r.parsedType}),Te}return{status:"valid",value:e.data}}}Fd.create=n=>new Fd({typeName:Z.ZodNaN,...$e(n)});const E2=Symbol("zod_brand");class E_ extends Me{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class Su extends Me{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Te:a.status==="dirty"?(t.dirty(),Bi(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Te:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,t){return new Su({in:e,out:t,typeName:Z.ZodPipeline})}}class su extends Me{_parse(e){const t=this._def.innerType._parse(e),r=s=>(Xa(s)&&(s.value=Object.freeze(s.value)),s);return ql(t)?t.then(s=>r(s)):r(t)}unwrap(){return this._def.innerType}}su.create=(n,e)=>new su({innerType:n,typeName:Z.ZodReadonly,...$e(e)});function jC(n,e={},t){return n?ro.create().superRefine((r,s)=>{var a,l;if(!n(r)){const u=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,c=(l=(a=u.fatal)!==null&&a!==void 0?a:t)!==null&&l!==void 0?l:!0,f=typeof u=="string"?{message:u}:u;s.addIssue({code:"custom",...f,fatal:c})}}):ro.create()}const C2={object:lt.lazycreate};var Z;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(Z||(Z={}));const P2=(n,e={message:`Input not instance of ${n.name}`})=>jC(t=>t instanceof n,e),LC=br.create,MC=da.create,k2=Fd.create,R2=fa.create,DC=Zl.create,O2=Ya.create,T2=Ld.create,A2=Gl.create,$2=Jl.create,I2=ro.create,N2=za.create,j2=Ts.create,L2=Md.create,M2=xr.create,D2=lt.create,F2=lt.strictCreate,U2=Kl.create,z2=Pf.create,B2=Xl.create,H2=ts.create,W2=Yl.create,V2=Dd.create,q2=Qa.create,Z2=Gi.create,G2=Ql.create,J2=eu.create,K2=ha.create,X2=tu.create,Y2=so.create,hx=Rr.create,Q2=Sr.create,e4=pa.create,t4=Rr.createWithPreprocess,n4=Su.create,r4=()=>LC().optional(),s4=()=>MC().optional(),a4=()=>DC().optional(),i4={string:n=>br.create({...n,coerce:!0}),number:n=>da.create({...n,coerce:!0}),boolean:n=>Zl.create({...n,coerce:!0}),bigint:n=>fa.create({...n,coerce:!0}),date:n=>Ya.create({...n,coerce:!0})},o4=Te;var Se=Object.freeze({__proto__:null,defaultErrorMap:no,setErrorMap:t2,getErrorMap:Id,makeIssue:Nd,EMPTY_PATH:n2,addIssueToContext:ce,ParseStatus:tn,INVALID:Te,DIRTY:Bi,OK:hn,isAborted:Vg,isDirty:qg,isValid:Xa,isAsync:ql,get util(){return Be},get objectUtil(){return Wg},ZodParsedType:he,getParsedType:xs,ZodType:Me,datetimeRegex:IC,ZodString:br,ZodNumber:da,ZodBigInt:fa,ZodBoolean:Zl,ZodDate:Ya,ZodSymbol:Ld,ZodUndefined:Gl,ZodNull:Jl,ZodAny:ro,ZodUnknown:za,ZodNever:Ts,ZodVoid:Md,ZodArray:xr,ZodObject:lt,ZodUnion:Kl,ZodDiscriminatedUnion:Pf,ZodIntersection:Xl,ZodTuple:ts,ZodRecord:Yl,ZodMap:Dd,ZodSet:Qa,ZodFunction:Gi,ZodLazy:Ql,ZodLiteral:eu,ZodEnum:ha,ZodNativeEnum:tu,ZodPromise:so,ZodEffects:Rr,ZodTransformer:Rr,ZodOptional:Sr,ZodNullable:pa,ZodDefault:nu,ZodCatch:ru,ZodNaN:Fd,BRAND:E2,ZodBranded:E_,ZodPipeline:Su,ZodReadonly:su,custom:jC,Schema:Me,ZodSchema:Me,late:C2,get ZodFirstPartyTypeKind(){return Z},coerce:i4,any:I2,array:M2,bigint:R2,boolean:DC,date:O2,discriminatedUnion:z2,effect:hx,enum:K2,function:Z2,instanceof:P2,intersection:B2,lazy:G2,literal:J2,map:V2,nan:k2,nativeEnum:X2,never:j2,null:$2,nullable:e4,number:MC,object:D2,oboolean:a4,onumber:s4,optional:Q2,ostring:r4,pipeline:n4,preprocess:t4,promise:Y2,record:W2,set:q2,strictObject:F2,string:LC,symbol:T2,transformer:hx,tuple:H2,undefined:A2,union:U2,unknown:N2,void:L2,NEVER:o4,ZodIssueCode:se,quotelessJson:e2,ZodError:Dn}),wl={exports:{}},nm={},rm,px;function l4(){if(px)return rm;px=1;function n(e,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return rm=n,n.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},n.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},n.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var s=this;return this._timer=setTimeout(function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout(function(){s._operationTimeoutCb(s._attempts)},s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)},r),this._options.unref&&this._timer.unref(),!0},n.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},n.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},n.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},n.prototype.start=n.prototype.try,n.prototype.errors=function(){return this._errors},n.prototype.attempts=function(){return this._attempts},n.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},t=null,r=0,s=0;s<this._errors.length;s++){var a=this._errors[s],l=a.message,u=(e[l]||0)+1;e[l]=u,u>=r&&(t=a,r=u)}return t},rm}var mx;function u4(){return mx||(mx=1,function(n){var e=l4();n.operation=function(t){var r=n.timeouts(t);return new e(r,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},n.timeouts=function(t){if(t instanceof Array)return[].concat(t);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var s in t)r[s]=t[s];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var a=[],l=0;l<r.retries;l++)a.push(this.createTimeout(l,r));return t&&t.forever&&!a.length&&a.push(this.createTimeout(l,r)),a.sort(function(u,c){return u-c}),a},n.createTimeout=function(t,r){var s=r.randomize?Math.random()+1:1,a=Math.round(s*Math.max(r.minTimeout,1)*Math.pow(r.factor,t));return a=Math.min(a,r.maxTimeout),a},n.wrap=function(t,r,s){if(r instanceof Array&&(s=r,r=null),!s){s=[];for(var a in t)typeof t[a]=="function"&&s.push(a)}for(var l=0;l<s.length;l++){var u=s[l],c=t[u];t[u]=(function(h){var m=n.operation(r),g=Array.prototype.slice.call(arguments,1),y=g.pop();g.push(function(w){m.retry(w)||(w&&(arguments[0]=m.mainError()),y.apply(this,arguments))}),m.attempt(function(){h.apply(t,g)})}).bind(t,c),t[u].options=r}}}(nm)),nm}var sm,gx;function c4(){return gx||(gx=1,sm=u4()),sm}var yx;function d4(){if(yx)return wl.exports;yx=1;const n=c4(),e=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class t extends Error{constructor(u){super(),u instanceof Error?(this.originalError=u,{message:u}=u):(this.originalError=new Error(u),this.originalError.stack=this.stack),this.name="AbortError",this.message=u}}const r=(l,u,c)=>{const f=c.retries-(u-1);return l.attemptNumber=u,l.retriesLeft=f,l},s=l=>e.includes(l),a=(l,u)=>new Promise((c,f)=>{u={onFailedAttempt:()=>{},retries:10,...u};const h=n.operation(u);h.attempt(async m=>{try{c(await l(m))}catch(g){if(!(g instanceof Error)){f(new TypeError(`Non-error was thrown: "${g}". You should only throw errors.`));return}if(g instanceof t)h.stop(),f(g.originalError);else if(g instanceof TypeError&&!s(g.message))h.stop(),f(g);else{r(g,m,u);try{await u.onFailedAttempt(g)}catch(y){f(y);return}h.retry(g)||f(h.mainError())}}})});return wl.exports=a,wl.exports.default=a,wl.exports.AbortError=t,wl.exports}var f4=d4();const Ud=ti(f4),h4=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function Il(n){return typeof n=="string"&&h4.test(n)}var Ut=[];for(var am=0;am<256;++am)Ut.push((am+256).toString(16).slice(1));function p4(n,e=0){return(Ut[n[e+0]]+Ut[n[e+1]]+Ut[n[e+2]]+Ut[n[e+3]]+"-"+Ut[n[e+4]]+Ut[n[e+5]]+"-"+Ut[n[e+6]]+Ut[n[e+7]]+"-"+Ut[n[e+8]]+Ut[n[e+9]]+"-"+Ut[n[e+10]]+Ut[n[e+11]]+Ut[n[e+12]]+Ut[n[e+13]]+Ut[n[e+14]]+Ut[n[e+15]]).toLowerCase()}var Jc,m4=new Uint8Array(16);function g4(){if(!Jc&&(Jc=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Jc))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Jc(m4)}var y4=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const _x={randomUUID:y4};function Qt(n,e,t){if(_x.randomUUID&&!n)return _x.randomUUID();n=n||{};var r=n.random||(n.rng||g4)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,p4(r)}var Kc={},im={exports:{}},wx;function _4(){return wx||(wx=1,function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function s(c,f,h){this.fn=c,this.context=f,this.once=h||!1}function a(c,f,h,m,g){if(typeof h!="function")throw new TypeError("The listener must be a function");var y=new s(h,m||c,g),w=t?t+f:f;return c._events[w]?c._events[w].fn?c._events[w]=[c._events[w],y]:c._events[w].push(y):(c._events[w]=y,c._eventsCount++),c}function l(c,f){--c._eventsCount===0?c._events=new r:delete c._events[f]}function u(){this._events=new r,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],h,m;if(this._eventsCount===0)return f;for(m in h=this._events)e.call(h,m)&&f.push(t?m.slice(1):m);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(h)):f},u.prototype.listeners=function(f){var h=t?t+f:f,m=this._events[h];if(!m)return[];if(m.fn)return[m.fn];for(var g=0,y=m.length,w=new Array(y);g<y;g++)w[g]=m[g].fn;return w},u.prototype.listenerCount=function(f){var h=t?t+f:f,m=this._events[h];return m?m.fn?1:m.length:0},u.prototype.emit=function(f,h,m,g,y,w){var v=t?t+f:f;if(!this._events[v])return!1;var x=this._events[v],E=arguments.length,P,S;if(x.fn){switch(x.once&&this.removeListener(f,x.fn,void 0,!0),E){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,h),!0;case 3:return x.fn.call(x.context,h,m),!0;case 4:return x.fn.call(x.context,h,m,g),!0;case 5:return x.fn.call(x.context,h,m,g,y),!0;case 6:return x.fn.call(x.context,h,m,g,y,w),!0}for(S=1,P=new Array(E-1);S<E;S++)P[S-1]=arguments[S];x.fn.apply(x.context,P)}else{var R=x.length,$;for(S=0;S<R;S++)switch(x[S].once&&this.removeListener(f,x[S].fn,void 0,!0),E){case 1:x[S].fn.call(x[S].context);break;case 2:x[S].fn.call(x[S].context,h);break;case 3:x[S].fn.call(x[S].context,h,m);break;case 4:x[S].fn.call(x[S].context,h,m,g);break;default:if(!P)for($=1,P=new Array(E-1);$<E;$++)P[$-1]=arguments[$];x[S].fn.apply(x[S].context,P)}}return!0},u.prototype.on=function(f,h,m){return a(this,f,h,m,!1)},u.prototype.once=function(f,h,m){return a(this,f,h,m,!0)},u.prototype.removeListener=function(f,h,m,g){var y=t?t+f:f;if(!this._events[y])return this;if(!h)return l(this,y),this;var w=this._events[y];if(w.fn)w.fn===h&&(!g||w.once)&&(!m||w.context===m)&&l(this,y);else{for(var v=0,x=[],E=w.length;v<E;v++)(w[v].fn!==h||g&&!w[v].once||m&&w[v].context!==m)&&x.push(w[v]);x.length?this._events[y]=x.length===1?x[0]:x:l(this,y)}return this},u.prototype.removeAllListeners=function(f){var h;return f?(h=t?t+f:f,this._events[h]&&l(this,h)):(this._events=new r,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=t,u.EventEmitter=u,n.exports=u}(im)),im.exports}var bl={exports:{}},om,bx;function w4(){return bx||(bx=1,om=(n,e)=>(e=e||(()=>{}),n.then(t=>new Promise(r=>{r(e())}).then(()=>t),t=>new Promise(r=>{r(e())}).then(()=>{throw t})))),om}var vx;function b4(){if(vx)return bl.exports;vx=1;const n=w4();class e extends Error{constructor(s){super(s),this.name="TimeoutError"}}const t=(r,s,a)=>new Promise((l,u)=>{if(typeof s!="number"||s<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(s===1/0){l(r);return}const c=setTimeout(()=>{if(typeof a=="function"){try{l(a())}catch(m){u(m)}return}const f=typeof a=="string"?a:`Promise timed out after ${s} milliseconds`,h=a instanceof Error?a:new e(f);typeof r.cancel=="function"&&r.cancel(),u(h)},s);n(r.then(l,u),()=>{clearTimeout(c)})});return bl.exports=t,bl.exports.default=t,bl.exports.TimeoutError=e,bl.exports}var Xc={},Yc={},xx;function v4(){if(xx)return Yc;xx=1,Object.defineProperty(Yc,"__esModule",{value:!0});function n(e,t,r){let s=0,a=e.length;for(;a>0;){const l=a/2|0;let u=s+l;r(e[u],t)<=0?(s=++u,a-=l+1):a=l}return s}return Yc.default=n,Yc}var Sx;function x4(){if(Sx)return Xc;Sx=1,Object.defineProperty(Xc,"__esModule",{value:!0});const n=v4();class e{constructor(){this._queue=[]}enqueue(r,s){s=Object.assign({priority:0},s);const a={priority:s.priority,run:r};if(this.size&&this._queue[this.size-1].priority>=s.priority){this._queue.push(a);return}const l=n.default(this._queue,a,(u,c)=>c.priority-u.priority);this._queue.splice(l,0,a)}dequeue(){const r=this._queue.shift();return r==null?void 0:r.run}filter(r){return this._queue.filter(s=>s.priority===r.priority).map(s=>s.run)}get size(){return this._queue.length}}return Xc.default=e,Xc}var Ex;function S4(){if(Ex)return Kc;Ex=1,Object.defineProperty(Kc,"__esModule",{value:!0});const n=_4(),e=b4(),t=x4(),r=()=>{},s=new e.TimeoutError;class a extends n{constructor(u){var c,f,h,m;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=r,this._resolveIdle=r,u=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:t.default},u),!(typeof u.intervalCap=="number"&&u.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(f=(c=u.intervalCap)===null||c===void 0?void 0:c.toString())!==null&&f!==void 0?f:""}\` (${typeof u.intervalCap})`);if(u.interval===void 0||!(Number.isFinite(u.interval)&&u.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(m=(h=u.interval)===null||h===void 0?void 0:h.toString())!==null&&m!==void 0?m:""}\` (${typeof u.interval})`);this._carryoverConcurrencyCount=u.carryoverConcurrencyCount,this._isIntervalIgnored=u.intervalCap===1/0||u.interval===0,this._intervalCap=u.intervalCap,this._interval=u.interval,this._queue=new u.queueClass,this._queueClass=u.queueClass,this.concurrency=u.concurrency,this._timeout=u.timeout,this._throwOnTimeout=u.throwOnTimeout===!0,this._isPaused=u.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=r,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=r,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const u=Date.now();if(this._intervalId===void 0){const c=this._intervalEnd-u;if(c<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},c)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const u=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const c=this._queue.dequeue();return c?(this.emit("active"),c(),u&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(u){if(!(typeof u=="number"&&u>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${u}\` (${typeof u})`);this._concurrency=u,this._processQueue()}async add(u,c={}){return new Promise((f,h)=>{const m=async()=>{this._pendingCount++,this._intervalCount++;try{const g=this._timeout===void 0&&c.timeout===void 0?u():e.default(Promise.resolve(u()),c.timeout===void 0?this._timeout:c.timeout,()=>{(c.throwOnTimeout===void 0?this._throwOnTimeout:c.throwOnTimeout)&&h(s)});f(await g)}catch(g){h(g)}this._next()};this._queue.enqueue(m,c),this._tryToStartAnother(),this.emit("add")})}async addAll(u,c){return Promise.all(u.map(async f=>this.add(f,c)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(u=>{const c=this._resolveEmpty;this._resolveEmpty=()=>{c(),u()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(u=>{const c=this._resolveIdle;this._resolveIdle=()=>{c(),u()}})}get size(){return this._queue.size}sizeBy(u){return this._queue.filter(u).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(u){this._timeout=u}}return Kc.default=a,Kc}var E4=S4();const ks=ti(E4),C4=(...n)=>fetch(...n),P4=Symbol.for("ls:fetch_implementation"),xe=n=>async(...e)=>{if(n||Hr("DEBUG")==="true"){const[r,s]=e;console.log(`→ ${(s==null?void 0:s.method)||"GET"} ${r}`)}const t=await(globalThis[P4]??C4)(...e);return(n||Hr("DEBUG")==="true")&&console.log(`← ${t.status} ${t.statusText} ${t.url}`),t},k4=[400,401,403,404,405,406,407,408],R4=[409];let Cx=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.debug=e.debug,"default"in ks?this.queue=new ks.default({concurrency:this.maxConcurrency}):this.queue=new ks({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e==null?void 0:e.onFailedResponseHook}call(e,...t){const r=this.onFailedResponseHook;return this.queue.add(()=>Ud(()=>e(...t).catch(s=>{throw s instanceof Error?s:new Error(s)}),{async onFailedAttempt(s){if(s.message.startsWith("Cancel")||s.message.startsWith("TimeoutError")||s.message.startsWith("AbortError")||(s==null?void 0:s.code)==="ECONNABORTED")throw s;const a=s==null?void 0:s.response,l=a==null?void 0:a.status;if(l){if(k4.includes(+l))throw s;if(R4.includes(+l))return;r&&await r(a)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((s,a)=>{var l;(l=e.signal)==null||l.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>xe(this.debug)(...e).then(t=>t.ok?t:Promise.reject(t)))}};function Px(n){return typeof(n==null?void 0:n._getType)=="function"}function kx(n){const e={type:n._getType(),data:{content:n.content}};return n!=null&&n.additional_kwargs&&Object.keys(n.additional_kwargs).length>0&&(e.data.additional_kwargs={...n.additional_kwargs}),e}function Ie(n,e){if(!Il(n)){const t=e!==void 0?`Invalid UUID for ${e}: ${n}`:`Invalid UUID: ${n}`;throw new Error(t)}return n}const Rx={};function FC(n){Rx[n]||(console.warn(n),Rx[n]=!0)}var Qc={exports:{}},lm,Ox;function kf(){if(Ox)return lm;Ox=1;const n="2.0.0",e=256,t=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,s=e-6;return lm={MAX_LENGTH:e,MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:s,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:n,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},lm}var um,Tx;function Rf(){if(Tx)return um;Tx=1;var n={};return um=typeof process=="object"&&n&&n.NODE_DEBUG&&/\bsemver\b/i.test(n.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{},um}var Ax;function Eu(){return Ax||(Ax=1,function(n,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:s}=kf(),a=Rf();e=n.exports={};const l=e.re=[],u=e.safeRe=[],c=e.src=[],f=e.safeSrc=[],h=e.t={};let m=0;const g="[a-zA-Z0-9-]",y=[["\\s",1],["\\d",s],[g,r]],w=x=>{for(const[E,P]of y)x=x.split(`${E}*`).join(`${E}{0,${P}}`).split(`${E}+`).join(`${E}{1,${P}}`);return x},v=(x,E,P)=>{const S=w(E),R=m++;a(x,R,E),h[x]=R,c[R]=E,f[R]=S,l[R]=new RegExp(E,P?"g":void 0),u[R]=new RegExp(S,P?"g":void 0)};v("NUMERICIDENTIFIER","0|[1-9]\\d*"),v("NUMERICIDENTIFIERLOOSE","\\d+"),v("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${g}*`),v("MAINVERSION",`(${c[h.NUMERICIDENTIFIER]})\\.(${c[h.NUMERICIDENTIFIER]})\\.(${c[h.NUMERICIDENTIFIER]})`),v("MAINVERSIONLOOSE",`(${c[h.NUMERICIDENTIFIERLOOSE]})\\.(${c[h.NUMERICIDENTIFIERLOOSE]})\\.(${c[h.NUMERICIDENTIFIERLOOSE]})`),v("PRERELEASEIDENTIFIER",`(?:${c[h.NUMERICIDENTIFIER]}|${c[h.NONNUMERICIDENTIFIER]})`),v("PRERELEASEIDENTIFIERLOOSE",`(?:${c[h.NUMERICIDENTIFIERLOOSE]}|${c[h.NONNUMERICIDENTIFIER]})`),v("PRERELEASE",`(?:-(${c[h.PRERELEASEIDENTIFIER]}(?:\\.${c[h.PRERELEASEIDENTIFIER]})*))`),v("PRERELEASELOOSE",`(?:-?(${c[h.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[h.PRERELEASEIDENTIFIERLOOSE]})*))`),v("BUILDIDENTIFIER",`${g}+`),v("BUILD",`(?:\\+(${c[h.BUILDIDENTIFIER]}(?:\\.${c[h.BUILDIDENTIFIER]})*))`),v("FULLPLAIN",`v?${c[h.MAINVERSION]}${c[h.PRERELEASE]}?${c[h.BUILD]}?`),v("FULL",`^${c[h.FULLPLAIN]}$`),v("LOOSEPLAIN",`[v=\\s]*${c[h.MAINVERSIONLOOSE]}${c[h.PRERELEASELOOSE]}?${c[h.BUILD]}?`),v("LOOSE",`^${c[h.LOOSEPLAIN]}$`),v("GTLT","((?:<|>)?=?)"),v("XRANGEIDENTIFIERLOOSE",`${c[h.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),v("XRANGEIDENTIFIER",`${c[h.NUMERICIDENTIFIER]}|x|X|\\*`),v("XRANGEPLAIN",`[v=\\s]*(${c[h.XRANGEIDENTIFIER]})(?:\\.(${c[h.XRANGEIDENTIFIER]})(?:\\.(${c[h.XRANGEIDENTIFIER]})(?:${c[h.PRERELEASE]})?${c[h.BUILD]}?)?)?`),v("XRANGEPLAINLOOSE",`[v=\\s]*(${c[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[h.XRANGEIDENTIFIERLOOSE]})(?:${c[h.PRERELEASELOOSE]})?${c[h.BUILD]}?)?)?`),v("XRANGE",`^${c[h.GTLT]}\\s*${c[h.XRANGEPLAIN]}$`),v("XRANGELOOSE",`^${c[h.GTLT]}\\s*${c[h.XRANGEPLAINLOOSE]}$`),v("COERCEPLAIN",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?`),v("COERCE",`${c[h.COERCEPLAIN]}(?:$|[^\\d])`),v("COERCEFULL",c[h.COERCEPLAIN]+`(?:${c[h.PRERELEASE]})?(?:${c[h.BUILD]})?(?:$|[^\\d])`),v("COERCERTL",c[h.COERCE],!0),v("COERCERTLFULL",c[h.COERCEFULL],!0),v("LONETILDE","(?:~>?)"),v("TILDETRIM",`(\\s*)${c[h.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",v("TILDE",`^${c[h.LONETILDE]}${c[h.XRANGEPLAIN]}$`),v("TILDELOOSE",`^${c[h.LONETILDE]}${c[h.XRANGEPLAINLOOSE]}$`),v("LONECARET","(?:\\^)"),v("CARETTRIM",`(\\s*)${c[h.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",v("CARET",`^${c[h.LONECARET]}${c[h.XRANGEPLAIN]}$`),v("CARETLOOSE",`^${c[h.LONECARET]}${c[h.XRANGEPLAINLOOSE]}$`),v("COMPARATORLOOSE",`^${c[h.GTLT]}\\s*(${c[h.LOOSEPLAIN]})$|^$`),v("COMPARATOR",`^${c[h.GTLT]}\\s*(${c[h.FULLPLAIN]})$|^$`),v("COMPARATORTRIM",`(\\s*)${c[h.GTLT]}\\s*(${c[h.LOOSEPLAIN]}|${c[h.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",v("HYPHENRANGE",`^\\s*(${c[h.XRANGEPLAIN]})\\s+-\\s+(${c[h.XRANGEPLAIN]})\\s*$`),v("HYPHENRANGELOOSE",`^\\s*(${c[h.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[h.XRANGEPLAINLOOSE]})\\s*$`),v("STAR","(<|>)?=?\\s*\\*"),v("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),v("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(Qc,Qc.exports)),Qc.exports}var cm,$x;function C_(){if($x)return cm;$x=1;const n=Object.freeze({loose:!0}),e=Object.freeze({});return cm=r=>r?typeof r!="object"?n:r:e,cm}var dm,Ix;function UC(){if(Ix)return dm;Ix=1;const n=/^[0-9]+$/,e=(r,s)=>{const a=n.test(r),l=n.test(s);return a&&l&&(r=+r,s=+s),r===s?0:a&&!l?-1:l&&!a?1:r<s?-1:1};return dm={compareIdentifiers:e,rcompareIdentifiers:(r,s)=>e(s,r)},dm}var fm,Nx;function pn(){if(Nx)return fm;Nx=1;const n=Rf(),{MAX_LENGTH:e,MAX_SAFE_INTEGER:t}=kf(),{safeRe:r,safeSrc:s,t:a}=Eu(),l=C_(),{compareIdentifiers:u}=UC();class c{constructor(h,m){if(m=l(m),h instanceof c){if(h.loose===!!m.loose&&h.includePrerelease===!!m.includePrerelease)return h;h=h.version}else if(typeof h!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof h}".`);if(h.length>e)throw new TypeError(`version is longer than ${e} characters`);n("SemVer",h,m),this.options=m,this.loose=!!m.loose,this.includePrerelease=!!m.includePrerelease;const g=h.trim().match(m.loose?r[a.LOOSE]:r[a.FULL]);if(!g)throw new TypeError(`Invalid Version: ${h}`);if(this.raw=h,this.major=+g[1],this.minor=+g[2],this.patch=+g[3],this.major>t||this.major<0)throw new TypeError("Invalid major version");if(this.minor>t||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>t||this.patch<0)throw new TypeError("Invalid patch version");g[4]?this.prerelease=g[4].split(".").map(y=>{if(/^[0-9]+$/.test(y)){const w=+y;if(w>=0&&w<t)return w}return y}):this.prerelease=[],this.build=g[5]?g[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(h){if(n("SemVer.compare",this.version,this.options,h),!(h instanceof c)){if(typeof h=="string"&&h===this.version)return 0;h=new c(h,this.options)}return h.version===this.version?0:this.compareMain(h)||this.comparePre(h)}compareMain(h){return h instanceof c||(h=new c(h,this.options)),u(this.major,h.major)||u(this.minor,h.minor)||u(this.patch,h.patch)}comparePre(h){if(h instanceof c||(h=new c(h,this.options)),this.prerelease.length&&!h.prerelease.length)return-1;if(!this.prerelease.length&&h.prerelease.length)return 1;if(!this.prerelease.length&&!h.prerelease.length)return 0;let m=0;do{const g=this.prerelease[m],y=h.prerelease[m];if(n("prerelease compare",m,g,y),g===void 0&&y===void 0)return 0;if(y===void 0)return 1;if(g===void 0)return-1;if(g===y)continue;return u(g,y)}while(++m)}compareBuild(h){h instanceof c||(h=new c(h,this.options));let m=0;do{const g=this.build[m],y=h.build[m];if(n("build compare",m,g,y),g===void 0&&y===void 0)return 0;if(y===void 0)return 1;if(g===void 0)return-1;if(g===y)continue;return u(g,y)}while(++m)}inc(h,m,g){if(h.startsWith("pre")){if(!m&&g===!1)throw new Error("invalid increment argument: identifier is empty");if(m){const y=new RegExp(`^${this.options.loose?s[a.PRERELEASELOOSE]:s[a.PRERELEASE]}$`),w=`-${m}`.match(y);if(!w||w[1]!==m)throw new Error(`invalid identifier: ${m}`)}}switch(h){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",m,g);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",m,g);break;case"prepatch":this.prerelease.length=0,this.inc("patch",m,g),this.inc("pre",m,g);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",m,g),this.inc("pre",m,g);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const y=Number(g)?1:0;if(this.prerelease.length===0)this.prerelease=[y];else{let w=this.prerelease.length;for(;--w>=0;)typeof this.prerelease[w]=="number"&&(this.prerelease[w]++,w=-2);if(w===-1){if(m===this.prerelease.join(".")&&g===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(y)}}if(m){let w=[m,y];g===!1&&(w=[m]),u(this.prerelease[0],m)===0?isNaN(this.prerelease[1])&&(this.prerelease=w):this.prerelease=w}break}default:throw new Error(`invalid increment argument: ${h}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return fm=c,fm}var hm,jx;function bo(){if(jx)return hm;jx=1;const n=pn();return hm=(t,r,s=!1)=>{if(t instanceof n)return t;try{return new n(t,r)}catch(a){if(!s)return null;throw a}},hm}var pm,Lx;function O4(){if(Lx)return pm;Lx=1;const n=bo();return pm=(t,r)=>{const s=n(t,r);return s?s.version:null},pm}var mm,Mx;function T4(){if(Mx)return mm;Mx=1;const n=bo();return mm=(t,r)=>{const s=n(t.trim().replace(/^[=v]+/,""),r);return s?s.version:null},mm}var gm,Dx;function A4(){if(Dx)return gm;Dx=1;const n=pn();return gm=(t,r,s,a,l)=>{typeof s=="string"&&(l=a,a=s,s=void 0);try{return new n(t instanceof n?t.version:t,s).inc(r,a,l).version}catch{return null}},gm}var ym,Fx;function $4(){if(Fx)return ym;Fx=1;const n=bo();return ym=(t,r)=>{const s=n(t,null,!0),a=n(r,null,!0),l=s.compare(a);if(l===0)return null;const u=l>0,c=u?s:a,f=u?a:s,h=!!c.prerelease.length;if(!!f.prerelease.length&&!h){if(!f.patch&&!f.minor)return"major";if(f.compareMain(c)===0)return f.minor&&!f.patch?"minor":"patch"}const g=h?"pre":"";return s.major!==a.major?g+"major":s.minor!==a.minor?g+"minor":s.patch!==a.patch?g+"patch":"prerelease"},ym}var _m,Ux;function I4(){if(Ux)return _m;Ux=1;const n=pn();return _m=(t,r)=>new n(t,r).major,_m}var wm,zx;function N4(){if(zx)return wm;zx=1;const n=pn();return wm=(t,r)=>new n(t,r).minor,wm}var bm,Bx;function j4(){if(Bx)return bm;Bx=1;const n=pn();return bm=(t,r)=>new n(t,r).patch,bm}var vm,Hx;function L4(){if(Hx)return vm;Hx=1;const n=bo();return vm=(t,r)=>{const s=n(t,r);return s&&s.prerelease.length?s.prerelease:null},vm}var xm,Wx;function Ar(){if(Wx)return xm;Wx=1;const n=pn();return xm=(t,r,s)=>new n(t,s).compare(new n(r,s)),xm}var Sm,Vx;function M4(){if(Vx)return Sm;Vx=1;const n=Ar();return Sm=(t,r,s)=>n(r,t,s),Sm}var Em,qx;function D4(){if(qx)return Em;qx=1;const n=Ar();return Em=(t,r)=>n(t,r,!0),Em}var Cm,Zx;function P_(){if(Zx)return Cm;Zx=1;const n=pn();return Cm=(t,r,s)=>{const a=new n(t,s),l=new n(r,s);return a.compare(l)||a.compareBuild(l)},Cm}var Pm,Gx;function F4(){if(Gx)return Pm;Gx=1;const n=P_();return Pm=(t,r)=>t.sort((s,a)=>n(s,a,r)),Pm}var km,Jx;function U4(){if(Jx)return km;Jx=1;const n=P_();return km=(t,r)=>t.sort((s,a)=>n(a,s,r)),km}var Rm,Kx;function Of(){if(Kx)return Rm;Kx=1;const n=Ar();return Rm=(t,r,s)=>n(t,r,s)>0,Rm}var Om,Xx;function k_(){if(Xx)return Om;Xx=1;const n=Ar();return Om=(t,r,s)=>n(t,r,s)<0,Om}var Tm,Yx;function zC(){if(Yx)return Tm;Yx=1;const n=Ar();return Tm=(t,r,s)=>n(t,r,s)===0,Tm}var Am,Qx;function BC(){if(Qx)return Am;Qx=1;const n=Ar();return Am=(t,r,s)=>n(t,r,s)!==0,Am}var $m,eS;function R_(){if(eS)return $m;eS=1;const n=Ar();return $m=(t,r,s)=>n(t,r,s)>=0,$m}var Im,tS;function O_(){if(tS)return Im;tS=1;const n=Ar();return Im=(t,r,s)=>n(t,r,s)<=0,Im}var Nm,nS;function HC(){if(nS)return Nm;nS=1;const n=zC(),e=BC(),t=Of(),r=R_(),s=k_(),a=O_();return Nm=(u,c,f,h)=>{switch(c){case"===":return typeof u=="object"&&(u=u.version),typeof f=="object"&&(f=f.version),u===f;case"!==":return typeof u=="object"&&(u=u.version),typeof f=="object"&&(f=f.version),u!==f;case"":case"=":case"==":return n(u,f,h);case"!=":return e(u,f,h);case">":return t(u,f,h);case">=":return r(u,f,h);case"<":return s(u,f,h);case"<=":return a(u,f,h);default:throw new TypeError(`Invalid operator: ${c}`)}},Nm}var jm,rS;function z4(){if(rS)return jm;rS=1;const n=pn(),e=bo(),{safeRe:t,t:r}=Eu();return jm=(a,l)=>{if(a instanceof n)return a;if(typeof a=="number"&&(a=String(a)),typeof a!="string")return null;l=l||{};let u=null;if(!l.rtl)u=a.match(l.includePrerelease?t[r.COERCEFULL]:t[r.COERCE]);else{const y=l.includePrerelease?t[r.COERCERTLFULL]:t[r.COERCERTL];let w;for(;(w=y.exec(a))&&(!u||u.index+u[0].length!==a.length);)(!u||w.index+w[0].length!==u.index+u[0].length)&&(u=w),y.lastIndex=w.index+w[1].length+w[2].length;y.lastIndex=-1}if(u===null)return null;const c=u[2],f=u[3]||"0",h=u[4]||"0",m=l.includePrerelease&&u[5]?`-${u[5]}`:"",g=l.includePrerelease&&u[6]?`+${u[6]}`:"";return e(`${c}.${f}.${h}${m}${g}`,l)},jm}var Lm,sS;function B4(){if(sS)return Lm;sS=1;class n{constructor(){this.max=1e3,this.map=new Map}get(t){const r=this.map.get(t);if(r!==void 0)return this.map.delete(t),this.map.set(t,r),r}delete(t){return this.map.delete(t)}set(t,r){if(!this.delete(t)&&r!==void 0){if(this.map.size>=this.max){const a=this.map.keys().next().value;this.delete(a)}this.map.set(t,r)}return this}}return Lm=n,Lm}var Mm,aS;function $r(){if(aS)return Mm;aS=1;const n=/\s+/g;class e{constructor(G,q){if(q=s(q),G instanceof e)return G.loose===!!q.loose&&G.includePrerelease===!!q.includePrerelease?G:new e(G.raw,q);if(G instanceof a)return this.raw=G.value,this.set=[[G]],this.formatted=void 0,this;if(this.options=q,this.loose=!!q.loose,this.includePrerelease=!!q.includePrerelease,this.raw=G.trim().replace(n," "),this.set=this.raw.split("||").map(J=>this.parseRange(J.trim())).filter(J=>J.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const J=this.set[0];if(this.set=this.set.filter(j=>!v(j[0])),this.set.length===0)this.set=[J];else if(this.set.length>1){for(const j of this.set)if(j.length===1&&x(j[0])){this.set=[j];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let G=0;G<this.set.length;G++){G>0&&(this.formatted+="||");const q=this.set[G];for(let J=0;J<q.length;J++)J>0&&(this.formatted+=" "),this.formatted+=q[J].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(G){const J=((this.options.includePrerelease&&y)|(this.options.loose&&w))+":"+G,j=r.get(J);if(j)return j;const B=this.options.loose,W=B?c[f.HYPHENRANGELOOSE]:c[f.HYPHENRANGE];G=G.replace(W,de(this.options.includePrerelease)),l("hyphen replace",G),G=G.replace(c[f.COMPARATORTRIM],h),l("comparator trim",G),G=G.replace(c[f.TILDETRIM],m),l("tilde trim",G),G=G.replace(c[f.CARETTRIM],g),l("caret trim",G);let T=G.split(" ").map(Q=>P(Q,this.options)).join(" ").split(/\s+/).map(Q=>ie(Q,this.options));B&&(T=T.filter(Q=>(l("loose invalid filter",Q,this.options),!!Q.match(c[f.COMPARATORLOOSE])))),l("range list",T);const M=new Map,X=T.map(Q=>new a(Q,this.options));for(const Q of X){if(v(Q))return[Q];M.set(Q.value,Q)}M.size>1&&M.has("")&&M.delete("");const ae=[...M.values()];return r.set(J,ae),ae}intersects(G,q){if(!(G instanceof e))throw new TypeError("a Range is required");return this.set.some(J=>E(J,q)&&G.set.some(j=>E(j,q)&&J.every(B=>j.every(W=>B.intersects(W,q)))))}test(G){if(!G)return!1;if(typeof G=="string")try{G=new u(G,this.options)}catch{return!1}for(let q=0;q<this.set.length;q++)if(ue(this.set[q],G,this.options))return!0;return!1}}Mm=e;const t=B4(),r=new t,s=C_(),a=Tf(),l=Rf(),u=pn(),{safeRe:c,t:f,comparatorTrimReplace:h,tildeTrimReplace:m,caretTrimReplace:g}=Eu(),{FLAG_INCLUDE_PRERELEASE:y,FLAG_LOOSE:w}=kf(),v=V=>V.value==="<0.0.0-0",x=V=>V.value==="",E=(V,G)=>{let q=!0;const J=V.slice();let j=J.pop();for(;q&&J.length;)q=J.every(B=>j.intersects(B,G)),j=J.pop();return q},P=(V,G)=>(l("comp",V,G),V=I(V,G),l("caret",V),V=R(V,G),l("tildes",V),V=F(V,G),l("xrange",V),V=Y(V,G),l("stars",V),V),S=V=>!V||V.toLowerCase()==="x"||V==="*",R=(V,G)=>V.trim().split(/\s+/).map(q=>$(q,G)).join(" "),$=(V,G)=>{const q=G.loose?c[f.TILDELOOSE]:c[f.TILDE];return V.replace(q,(J,j,B,W,T)=>{l("tilde",V,J,j,B,W,T);let M;return S(j)?M="":S(B)?M=`>=${j}.0.0 <${+j+1}.0.0-0`:S(W)?M=`>=${j}.${B}.0 <${j}.${+B+1}.0-0`:T?(l("replaceTilde pr",T),M=`>=${j}.${B}.${W}-${T} <${j}.${+B+1}.0-0`):M=`>=${j}.${B}.${W} <${j}.${+B+1}.0-0`,l("tilde return",M),M})},I=(V,G)=>V.trim().split(/\s+/).map(q=>D(q,G)).join(" "),D=(V,G)=>{l("caret",V,G);const q=G.loose?c[f.CARETLOOSE]:c[f.CARET],J=G.includePrerelease?"-0":"";return V.replace(q,(j,B,W,T,M)=>{l("caret",V,j,B,W,T,M);let X;return S(B)?X="":S(W)?X=`>=${B}.0.0${J} <${+B+1}.0.0-0`:S(T)?B==="0"?X=`>=${B}.${W}.0${J} <${B}.${+W+1}.0-0`:X=`>=${B}.${W}.0${J} <${+B+1}.0.0-0`:M?(l("replaceCaret pr",M),B==="0"?W==="0"?X=`>=${B}.${W}.${T}-${M} <${B}.${W}.${+T+1}-0`:X=`>=${B}.${W}.${T}-${M} <${B}.${+W+1}.0-0`:X=`>=${B}.${W}.${T}-${M} <${+B+1}.0.0-0`):(l("no pr"),B==="0"?W==="0"?X=`>=${B}.${W}.${T}${J} <${B}.${W}.${+T+1}-0`:X=`>=${B}.${W}.${T}${J} <${B}.${+W+1}.0-0`:X=`>=${B}.${W}.${T} <${+B+1}.0.0-0`),l("caret return",X),X})},F=(V,G)=>(l("replaceXRanges",V,G),V.split(/\s+/).map(q=>K(q,G)).join(" ")),K=(V,G)=>{V=V.trim();const q=G.loose?c[f.XRANGELOOSE]:c[f.XRANGE];return V.replace(q,(J,j,B,W,T,M)=>{l("xRange",V,J,j,B,W,T,M);const X=S(B),ae=X||S(W),Q=ae||S(T),le=Q;return j==="="&&le&&(j=""),M=G.includePrerelease?"-0":"",X?j===">"||j==="<"?J="<0.0.0-0":J="*":j&&le?(ae&&(W=0),T=0,j===">"?(j=">=",ae?(B=+B+1,W=0,T=0):(W=+W+1,T=0)):j==="<="&&(j="<",ae?B=+B+1:W=+W+1),j==="<"&&(M="-0"),J=`${j+B}.${W}.${T}${M}`):ae?J=`>=${B}.0.0${M} <${+B+1}.0.0-0`:Q&&(J=`>=${B}.${W}.0${M} <${B}.${+W+1}.0-0`),l("xRange return",J),J})},Y=(V,G)=>(l("replaceStars",V,G),V.trim().replace(c[f.STAR],"")),ie=(V,G)=>(l("replaceGTE0",V,G),V.trim().replace(c[G.includePrerelease?f.GTE0PRE:f.GTE0],"")),de=V=>(G,q,J,j,B,W,T,M,X,ae,Q,le)=>(S(J)?q="":S(j)?q=`>=${J}.0.0${V?"-0":""}`:S(B)?q=`>=${J}.${j}.0${V?"-0":""}`:W?q=`>=${q}`:q=`>=${q}${V?"-0":""}`,S(X)?M="":S(ae)?M=`<${+X+1}.0.0-0`:S(Q)?M=`<${X}.${+ae+1}.0-0`:le?M=`<=${X}.${ae}.${Q}-${le}`:V?M=`<${X}.${ae}.${+Q+1}-0`:M=`<=${M}`,`${q} ${M}`.trim()),ue=(V,G,q)=>{for(let J=0;J<V.length;J++)if(!V[J].test(G))return!1;if(G.prerelease.length&&!q.includePrerelease){for(let J=0;J<V.length;J++)if(l(V[J].semver),V[J].semver!==a.ANY&&V[J].semver.prerelease.length>0){const j=V[J].semver;if(j.major===G.major&&j.minor===G.minor&&j.patch===G.patch)return!0}return!1}return!0};return Mm}var Dm,iS;function Tf(){if(iS)return Dm;iS=1;const n=Symbol("SemVer ANY");class e{static get ANY(){return n}constructor(h,m){if(m=t(m),h instanceof e){if(h.loose===!!m.loose)return h;h=h.value}h=h.trim().split(/\s+/).join(" "),l("comparator",h,m),this.options=m,this.loose=!!m.loose,this.parse(h),this.semver===n?this.value="":this.value=this.operator+this.semver.version,l("comp",this)}parse(h){const m=this.options.loose?r[s.COMPARATORLOOSE]:r[s.COMPARATOR],g=h.match(m);if(!g)throw new TypeError(`Invalid comparator: ${h}`);this.operator=g[1]!==void 0?g[1]:"",this.operator==="="&&(this.operator=""),g[2]?this.semver=new u(g[2],this.options.loose):this.semver=n}toString(){return this.value}test(h){if(l("Comparator.test",h,this.options.loose),this.semver===n||h===n)return!0;if(typeof h=="string")try{h=new u(h,this.options)}catch{return!1}return a(h,this.operator,this.semver,this.options)}intersects(h,m){if(!(h instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new c(h.value,m).test(this.value):h.operator===""?h.value===""?!0:new c(this.value,m).test(h.semver):(m=t(m),m.includePrerelease&&(this.value==="<0.0.0-0"||h.value==="<0.0.0-0")||!m.includePrerelease&&(this.value.startsWith("<0.0.0")||h.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&h.operator.startsWith(">")||this.operator.startsWith("<")&&h.operator.startsWith("<")||this.semver.version===h.semver.version&&this.operator.includes("=")&&h.operator.includes("=")||a(this.semver,"<",h.semver,m)&&this.operator.startsWith(">")&&h.operator.startsWith("<")||a(this.semver,">",h.semver,m)&&this.operator.startsWith("<")&&h.operator.startsWith(">")))}}Dm=e;const t=C_(),{safeRe:r,t:s}=Eu(),a=HC(),l=Rf(),u=pn(),c=$r();return Dm}var Fm,oS;function Af(){if(oS)return Fm;oS=1;const n=$r();return Fm=(t,r,s)=>{try{r=new n(r,s)}catch{return!1}return r.test(t)},Fm}var Um,lS;function H4(){if(lS)return Um;lS=1;const n=$r();return Um=(t,r)=>new n(t,r).set.map(s=>s.map(a=>a.value).join(" ").trim().split(" ")),Um}var zm,uS;function W4(){if(uS)return zm;uS=1;const n=pn(),e=$r();return zm=(r,s,a)=>{let l=null,u=null,c=null;try{c=new e(s,a)}catch{return null}return r.forEach(f=>{c.test(f)&&(!l||u.compare(f)===-1)&&(l=f,u=new n(l,a))}),l},zm}var Bm,cS;function V4(){if(cS)return Bm;cS=1;const n=pn(),e=$r();return Bm=(r,s,a)=>{let l=null,u=null,c=null;try{c=new e(s,a)}catch{return null}return r.forEach(f=>{c.test(f)&&(!l||u.compare(f)===1)&&(l=f,u=new n(l,a))}),l},Bm}var Hm,dS;function q4(){if(dS)return Hm;dS=1;const n=pn(),e=$r(),t=Of();return Hm=(s,a)=>{s=new e(s,a);let l=new n("0.0.0");if(s.test(l)||(l=new n("0.0.0-0"),s.test(l)))return l;l=null;for(let u=0;u<s.set.length;++u){const c=s.set[u];let f=null;c.forEach(h=>{const m=new n(h.semver.version);switch(h.operator){case">":m.prerelease.length===0?m.patch++:m.prerelease.push(0),m.raw=m.format();case"":case">=":(!f||t(m,f))&&(f=m);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${h.operator}`)}}),f&&(!l||t(l,f))&&(l=f)}return l&&s.test(l)?l:null},Hm}var Wm,fS;function Z4(){if(fS)return Wm;fS=1;const n=$r();return Wm=(t,r)=>{try{return new n(t,r).range||"*"}catch{return null}},Wm}var Vm,hS;function T_(){if(hS)return Vm;hS=1;const n=pn(),e=Tf(),{ANY:t}=e,r=$r(),s=Af(),a=Of(),l=k_(),u=O_(),c=R_();return Vm=(h,m,g,y)=>{h=new n(h,y),m=new r(m,y);let w,v,x,E,P;switch(g){case">":w=a,v=u,x=l,E=">",P=">=";break;case"<":w=l,v=c,x=a,E="<",P="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(h,m,y))return!1;for(let S=0;S<m.set.length;++S){const R=m.set[S];let $=null,I=null;if(R.forEach(D=>{D.semver===t&&(D=new e(">=0.0.0")),$=$||D,I=I||D,w(D.semver,$.semver,y)?$=D:x(D.semver,I.semver,y)&&(I=D)}),$.operator===E||$.operator===P||(!I.operator||I.operator===E)&&v(h,I.semver))return!1;if(I.operator===P&&x(h,I.semver))return!1}return!0},Vm}var qm,pS;function G4(){if(pS)return qm;pS=1;const n=T_();return qm=(t,r,s)=>n(t,r,">",s),qm}var Zm,mS;function J4(){if(mS)return Zm;mS=1;const n=T_();return Zm=(t,r,s)=>n(t,r,"<",s),Zm}var Gm,gS;function K4(){if(gS)return Gm;gS=1;const n=$r();return Gm=(t,r,s)=>(t=new n(t,s),r=new n(r,s),t.intersects(r,s)),Gm}var Jm,yS;function X4(){if(yS)return Jm;yS=1;const n=Af(),e=Ar();return Jm=(t,r,s)=>{const a=[];let l=null,u=null;const c=t.sort((g,y)=>e(g,y,s));for(const g of c)n(g,r,s)?(u=g,l||(l=g)):(u&&a.push([l,u]),u=null,l=null);l&&a.push([l,null]);const f=[];for(const[g,y]of a)g===y?f.push(g):!y&&g===c[0]?f.push("*"):y?g===c[0]?f.push(`<=${y}`):f.push(`${g} - ${y}`):f.push(`>=${g}`);const h=f.join(" || "),m=typeof r.raw=="string"?r.raw:String(r);return h.length<m.length?h:r},Jm}var Km,_S;function Y4(){if(_S)return Km;_S=1;const n=$r(),e=Tf(),{ANY:t}=e,r=Af(),s=Ar(),a=(m,g,y={})=>{if(m===g)return!0;m=new n(m,y),g=new n(g,y);let w=!1;e:for(const v of m.set){for(const x of g.set){const E=c(v,x,y);if(w=w||E!==null,E)continue e}if(w)return!1}return!0},l=[new e(">=0.0.0-0")],u=[new e(">=0.0.0")],c=(m,g,y)=>{if(m===g)return!0;if(m.length===1&&m[0].semver===t){if(g.length===1&&g[0].semver===t)return!0;y.includePrerelease?m=l:m=u}if(g.length===1&&g[0].semver===t){if(y.includePrerelease)return!0;g=u}const w=new Set;let v,x;for(const F of m)F.operator===">"||F.operator===">="?v=f(v,F,y):F.operator==="<"||F.operator==="<="?x=h(x,F,y):w.add(F.semver);if(w.size>1)return null;let E;if(v&&x){if(E=s(v.semver,x.semver,y),E>0)return null;if(E===0&&(v.operator!==">="||x.operator!=="<="))return null}for(const F of w){if(v&&!r(F,String(v),y)||x&&!r(F,String(x),y))return null;for(const K of g)if(!r(F,String(K),y))return!1;return!0}let P,S,R,$,I=x&&!y.includePrerelease&&x.semver.prerelease.length?x.semver:!1,D=v&&!y.includePrerelease&&v.semver.prerelease.length?v.semver:!1;I&&I.prerelease.length===1&&x.operator==="<"&&I.prerelease[0]===0&&(I=!1);for(const F of g){if($=$||F.operator===">"||F.operator===">=",R=R||F.operator==="<"||F.operator==="<=",v){if(D&&F.semver.prerelease&&F.semver.prerelease.length&&F.semver.major===D.major&&F.semver.minor===D.minor&&F.semver.patch===D.patch&&(D=!1),F.operator===">"||F.operator===">="){if(P=f(v,F,y),P===F&&P!==v)return!1}else if(v.operator===">="&&!r(v.semver,String(F),y))return!1}if(x){if(I&&F.semver.prerelease&&F.semver.prerelease.length&&F.semver.major===I.major&&F.semver.minor===I.minor&&F.semver.patch===I.patch&&(I=!1),F.operator==="<"||F.operator==="<="){if(S=h(x,F,y),S===F&&S!==x)return!1}else if(x.operator==="<="&&!r(x.semver,String(F),y))return!1}if(!F.operator&&(x||v)&&E!==0)return!1}return!(v&&R&&!x&&E!==0||x&&$&&!v&&E!==0||D||I)},f=(m,g,y)=>{if(!m)return g;const w=s(m.semver,g.semver,y);return w>0?m:w<0||g.operator===">"&&m.operator===">="?g:m},h=(m,g,y)=>{if(!m)return g;const w=s(m.semver,g.semver,y);return w<0?m:w>0||g.operator==="<"&&m.operator==="<="?g:m};return Km=a,Km}var Xm,wS;function Q4(){if(wS)return Xm;wS=1;const n=Eu(),e=kf(),t=pn(),r=UC(),s=bo(),a=O4(),l=T4(),u=A4(),c=$4(),f=I4(),h=N4(),m=j4(),g=L4(),y=Ar(),w=M4(),v=D4(),x=P_(),E=F4(),P=U4(),S=Of(),R=k_(),$=zC(),I=BC(),D=R_(),F=O_(),K=HC(),Y=z4(),ie=Tf(),de=$r(),ue=Af(),V=H4(),G=W4(),q=V4(),J=q4(),j=Z4(),B=T_(),W=G4(),T=J4(),M=K4(),X=X4(),ae=Y4();return Xm={parse:s,valid:a,clean:l,inc:u,diff:c,major:f,minor:h,patch:m,prerelease:g,compare:y,rcompare:w,compareLoose:v,compareBuild:x,sort:E,rsort:P,gt:S,lt:R,eq:$,neq:I,gte:D,lte:F,cmp:K,coerce:Y,Comparator:ie,Range:de,satisfies:ue,toComparators:V,maxSatisfying:G,minSatisfying:q,minVersion:J,validRange:j,outside:B,gtr:W,ltr:T,intersects:M,simplifyRange:X,subset:ae,SemVer:t,re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:e.SEMVER_SPEC_VERSION,RELEASE_TYPES:e.RELEASE_TYPES,compareIdentifiers:r.compareIdentifiers,rcompareIdentifiers:r.rcompareIdentifiers},Xm}Q4();function ea(n){if(!n||n.split("/").length>2||n.startsWith("/")||n.endsWith("/")||n.split(":").length>2)throw new Error(`Invalid identifier format: ${n}`);const[e,t]=n.split(":"),r=t||"latest";if(e.includes("/")){const[s,a]=e.split("/",2);if(!s||!a)throw new Error(`Invalid identifier format: ${n}`);return[s,a,r]}else{if(!e)throw new Error(`Invalid identifier format: ${n}`);return["-",e,r]}}class e3 extends Error{constructor(e){super(e),this.name="LangSmithConflictError"}}async function Fe(n,e,t){let r;if(n.ok){t&&(r=await n.text());return}r=await n.text();const s=`Failed to ${e}. Received status [${n.status}]: ${n.statusText}. Server response: ${r}`;throw n.status===409?new e3(s):new Error(s)}var bS="[...]",t3={result:"[Circular]"},zd=[],Hi=[];const n3=new TextEncoder;function r3(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function ed(n){return n3.encode(n)}function $n(n,e,t,r){var s;try{const a=JSON.stringify(n,e,t);return ed(a)}catch(a){if(!((s=a.message)!=null&&s.includes("Converting circular structure to JSON")))return console.warn("[WARNING]: LangSmith received unserializable value."),ed("[Unserializable]");console.warn("[WARNING]: LangSmith received circular JSON. This will decrease tracer performance."),typeof r>"u"&&(r=r3()),Gg(n,"",0,[],void 0,0,r);let l;try{Hi.length===0?l=JSON.stringify(n,e,t):l=JSON.stringify(n,s3(e),t)}catch{return ed("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;zd.length!==0;){const u=zd.pop();u.length===4?Object.defineProperty(u[0],u[1],u[3]):u[0][u[1]]=u[2]}}return ed(l)}}function Ym(n,e,t,r){var s=Object.getOwnPropertyDescriptor(r,t);s.get!==void 0?s.configurable?(Object.defineProperty(r,t,{value:n}),zd.push([r,t,e,s])):Hi.push([e,t,n]):(r[t]=n,zd.push([r,t,e]))}function Gg(n,e,t,r,s,a,l){a+=1;var u;if(typeof n=="object"&&n!==null){for(u=0;u<r.length;u++)if(r[u]===n){Ym(t3,n,e,s);return}if(typeof l.depthLimit<"u"&&a>l.depthLimit){Ym(bS,n,e,s);return}if(typeof l.edgesLimit<"u"&&t+1>l.edgesLimit){Ym(bS,n,e,s);return}if(r.push(n),Array.isArray(n))for(u=0;u<n.length;u++)Gg(n[u],u,u,r,n,a,l);else{var c=Object.keys(n);for(u=0;u<c.length;u++){var f=c[u];Gg(n[f],f,u,r,n,a,l)}}r.pop()}}function s3(n){return n=typeof n<"u"?n:function(e,t){return t},function(e,t){if(Hi.length>0)for(var r=0;r<Hi.length;r++){var s=Hi[r];if(s[1]===e&&s[0]===t){t=s[2],Hi.splice(r,1);break}}return n.call(this,e,t)}}function vS(n){const e=qC(),t=y3(),r=n.extra??{},s=r.metadata;return n.extra={...r,runtime:{...e,...r==null?void 0:r.runtime},metadata:{...t,...t.revision_id||n.revision_id?{revision_id:n.revision_id??t.revision_id}:{},...s}},n}const a3=n=>{const e=(n==null?void 0:n.toString())??Hr("TRACING_SAMPLING_RATE");if(e===void 0)return;const t=parseFloat(e);if(t<0||t>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${t}`);return t},i3=n=>{const t=n.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return t==="localhost"||t==="127.0.0.1"||t==="::1"};async function o3(n){const e=[];for await(const t of n)e.push(t);return e}function Qm(n){if(n!==void 0)return n.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const l3=async n=>{if((n==null?void 0:n.status)===429){const e=parseInt(n.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(t=>setTimeout(t,e)),!0}return!1};function xS(n){return typeof n=="number"?Number(n.toFixed(4)):n}class u3{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let t;const r=new Promise(a=>{t=a}),s=$n(e.item).length;return this.items.push({action:e.action,payload:e.item,itemPromiseResolve:t,itemPromise:r,size:s}),this.sizeBytes+=s,r}pop(e){var s;if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const t=[];let r=0;for(;r+(((s=this.peek())==null?void 0:s.size)??0)<e&&this.items.length>0;){const a=this.items.shift();a&&(t.push(a),r+=a.size,this.sizeBytes-=a.size)}if(t.length===0&&this.items.length>0){const a=this.items.shift();t.push(a),r+=a.size,this.sizeBytes-=a.size}return[t.map(a=>({action:a.action,item:a.payload})),()=>t.forEach(a=>a.itemPromiseResolve())]}}const c3=20971520,d3=2500;class au{constructor(e={}){var r;Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new u3}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:oa("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:oa("LANGSMITH_DEBUG")==="true"});const t=au.getDefaultClientConfig();if(this.tracingSampleRate=a3(e.tracingSamplingRate),this.apiUrl=Qm(e.apiUrl??t.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=Qm(e.apiKey??t.apiKey),this.webUrl=Qm(e.webUrl??t.webUrl),(r=this.webUrl)!=null&&r.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??9e4,this.caller=new Cx({...e.callerOptions??{},debug:e.debug??this.debug}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.debug=e.debug??this.debug,this.batchIngestCaller=new Cx({maxRetries:2,maxConcurrency:this.traceBatchConcurrency,...e.callerOptions??{},onFailedResponseHook:l3,debug:e.debug??this.debug}),this.hideInputs=e.hideInputs??e.anonymizer??t.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??t.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{},this.manualFlushMode=e.manualFlushMode??this.manualFlushMode}static getDefaultClientConfig(){const e=Hr("API_KEY"),t=Hr("ENDPOINT")??"https://api.smith.langchain.com",r=Hr("HIDE_INPUTS")==="true",s=Hr("HIDE_OUTPUTS")==="true";return{apiUrl:t,apiKey:e,webUrl:void 0,hideInputs:r,hideOutputs:s}}getHostUrl(){return this.webUrl?this.webUrl:i3(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.endsWith("/api/v1")?(this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("beta")?(this.webUrl="https://beta.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${WC}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}prepareRunCreateOrUpdateInputs(e){const t={...e};return t.inputs!==void 0&&(t.inputs=this.processInputs(t.inputs)),t.outputs!==void 0&&(t.outputs=this.processOutputs(t.outputs)),t}async _getResponse(e,t){const r=(t==null?void 0:t.toString())??"",s=`${this.apiUrl}${e}?${r}`,a=await this.caller.call(xe(this.debug),s,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(a,`Failed to fetch ${e}`),a}async _get(e,t){return(await this._getResponse(e,t)).json()}async*_getPaginated(e,t=new URLSearchParams,r){let s=Number(t.get("offset"))||0;const a=Number(t.get("limit"))||100;for(;;){t.set("offset",String(s)),t.set("limit",String(a));const l=`${this.apiUrl}${e}?${t}`,u=await this.caller.call(xe(this.debug),l,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(u,`Failed to fetch ${e}`);const c=r?r(await u.json()):await u.json();if(c.length===0||(yield c,c.length<a))break;s+=c.length}}async*_getCursorPaginatedList(e,t=null,r="POST",s="runs"){const a=t?{...t}:{};for(;;){const u=await(await this.caller.call(xe(this.debug),`${this.apiUrl}${e}`,{method:r,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(a)})).json();if(!u||!u[s])break;yield u[s];const c=u.cursors;if(!c||!c.next)break;a.cursor=c.next}}_shouldSample(){return this.tracingSampleRate===void 0?!0:Math.random()<this.tracingSampleRate}_filterForSampling(e,t=!1){if(this.tracingSampleRate===void 0)return e;if(t){const r=[];for(const s of e)this.filteredPostUuids.has(s.id)?this.filteredPostUuids.delete(s.id):r.push(s);return r}else{const r=[];for(const s of e){const a=s.trace_id??s.id;this.filteredPostUuids.has(a)||(s.id===a?this._shouldSample()?r.push(s):this.filteredPostUuids.add(a):r.push(s))}return r}}async _getBatchSizeLimitBytes(){var t;const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??((t=e.batch_ingest_config)==null?void 0:t.size_limit_bytes)??c3}async _getMultiPartSupport(){var t;return((t=(await this._ensureServerInfo()).instance_flags)==null?void 0:t.dataset_examples_multipart_enabled)??!1}drainAutoBatchQueue(e){const t=[];for(;this.autoBatchQueue.items.length>0;){const[r,s]=this.autoBatchQueue.pop(e);if(!r.length){s();break}const a=this._processBatch(r,s).catch(console.error);t.push(a)}return Promise.all(t)}async _processBatch(e,t){var r;if(!e.length){t();return}try{const s={runCreates:e.filter(l=>l.action==="create").map(l=>l.item),runUpdates:e.filter(l=>l.action==="update").map(l=>l.item)},a=await this._ensureServerInfo();(r=a==null?void 0:a.batch_ingest_config)!=null&&r.use_multipart_endpoint?await this.multipartIngestRuns(s):await this.batchIngestRuns(s)}finally{t()}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.action==="create"&&(e.item=vS(e.item));const t=this.autoBatchQueue.push(e);if(this.manualFlushMode)return t;const r=await this._getBatchSizeLimitBytes();return this.autoBatchQueue.sizeBytes>r&&this.drainAutoBatchQueue(r),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue(r)},this.autoBatchAggregationDelayMs)),t}async _getServerInfo(){const e=await xe(this.debug)(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(d3),...this.fetchOptions});await Fe(e,"get server info");const t=await e.json();return this.debug&&console.log(`
=== LangSmith Server Configuration ===
`+JSON.stringify(t,null,2)+`
`),t}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch{console.warn("[WARNING]: LangSmith failed to fetch info on supported operations. Falling back to batch operations and default limits.")}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){const e=await this._getBatchSizeLimitBytes();await this.drainAutoBatchQueue(e)}async createRun(e){if(!this._filterForSampling([e]).length)return;const t={...this.headers,"Content-Type":"application/json"},r=e.project_name;delete e.project_name;const s=this.prepareRunCreateOrUpdateInputs({session_name:r,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&s.trace_id!==void 0&&s.dotted_order!==void 0){this.processRunOperation({action:"create",item:s}).catch(console.error);return}const a=vS(s),l=await this.caller.call(xe(this.debug),`${this.apiUrl}/runs`,{method:"POST",headers:t,body:$n(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(l,"create run",!0)}async batchIngestRuns({runCreates:e,runUpdates:t}){if(e===void 0&&t===void 0)return;let r=(e==null?void 0:e.map(u=>this.prepareRunCreateOrUpdateInputs(u)))??[],s=(t==null?void 0:t.map(u=>this.prepareRunCreateOrUpdateInputs(u)))??[];if(r.length>0&&s.length>0){const u=r.reduce((f,h)=>(h.id&&(f[h.id]=h),f),{}),c=[];for(const f of s)f.id!==void 0&&u[f.id]?u[f.id]={...u[f.id],...f}:c.push(f);r=Object.values(u),s=c}const a={post:r,patch:s};if(!a.post.length&&!a.patch.length)return;const l={post:[],patch:[]};for(const u of["post","patch"]){const c=u,f=a[c].reverse();let h=f.pop();for(;h!==void 0;)l[c].push(h),h=f.pop()}(l.post.length>0||l.patch.length>0)&&await this._postBatchIngestRuns($n(l))}async _postBatchIngestRuns(e){const t={...this.headers,"Content-Type":"application/json",Accept:"application/json"},r=await this.batchIngestCaller.call(xe(this.debug),`${this.apiUrl}/runs/batch`,{method:"POST",headers:t,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(r,"batch create run",!0)}async multipartIngestRuns({runCreates:e,runUpdates:t}){if(e===void 0&&t===void 0)return;const r={};let s=[];for(const h of e??[]){const m=this.prepareRunCreateOrUpdateInputs(h);m.id!==void 0&&m.attachments!==void 0&&(r[m.id]=m.attachments),delete m.attachments,s.push(m)}let a=[];for(const h of t??[])a.push(this.prepareRunCreateOrUpdateInputs(h));if(s.find(h=>h.trace_id===void 0||h.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(a.find(h=>h.trace_id===void 0||h.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(s.length>0&&a.length>0){const h=s.reduce((g,y)=>(y.id&&(g[y.id]=y),g),{}),m=[];for(const g of a)g.id!==void 0&&h[g.id]?h[g.id]={...h[g.id],...g}:m.push(g);s=Object.values(h),a=m}if(s.length===0&&a.length===0)return;const c=[],f=[];for(const[h,m]of[["post",s],["patch",a]])for(const g of m){const{inputs:y,outputs:w,events:v,attachments:x,...E}=g,P={inputs:y,outputs:w,events:v},S=$n(E);f.push({name:`${h}.${E.id}`,payload:new Blob([S],{type:`application/json; length=${S.length}`})});for(const[R,$]of Object.entries(P)){if($===void 0)continue;const I=$n($);f.push({name:`${h}.${E.id}.${R}`,payload:new Blob([I],{type:`application/json; length=${I.length}`})})}if(E.id!==void 0){const R=r[E.id];if(R){delete r[E.id];for(const[$,I]of Object.entries(R)){let D,F;if(Array.isArray(I)?[D,F]=I:(D=I.mimeType,F=I.data),$.includes(".")){console.warn(`Skipping attachment '${$}' for run ${E.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}f.push({name:`attachment.${E.id}.${$}`,payload:new Blob([F],{type:`${D}; length=${F.byteLength}`})})}}}c.push(`trace=${E.trace_id},id=${E.id}`)}await this._sendMultipartRequest(f,c.join("; "))}async _sendMultipartRequest(e,t){try{const r="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),s=[];for(const c of e)s.push(new Blob([`--${r}\r
`])),s.push(new Blob([`Content-Disposition: form-data; name="${c.name}"\r
`,`Content-Type: ${c.payload.type}\r
\r
`])),s.push(c.payload),s.push(new Blob([`\r
`]));s.push(new Blob([`--${r}--\r
`]));const l=await new Blob(s).arrayBuffer(),u=await this.batchIngestCaller.call(xe(this.debug),`${this.apiUrl}/runs/multipart`,{method:"POST",headers:{...this.headers,"Content-Type":`multipart/form-data; boundary=${r}`},body:l,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(u,"ingest multipart runs",!0)}catch(r){console.warn(`${r.message.trim()}

Context: ${t}`)}}async updateRun(e,t){Ie(e),t.inputs&&(t.inputs=this.processInputs(t.inputs)),t.outputs&&(t.outputs=this.processOutputs(t.outputs));const r={...t,id:e};if(!this._filterForSampling([r],!0).length)return;if(this.autoBatchTracing&&r.trace_id!==void 0&&r.dotted_order!==void 0){if(t.end_time!==void 0&&r.parent_run_id===void 0&&this.blockOnRootRunFinalization&&!this.manualFlushMode){await this.processRunOperation({action:"update",item:r}).catch(console.error);return}else this.processRunOperation({action:"update",item:r}).catch(console.error);return}const s={...this.headers,"Content-Type":"application/json"},a=await this.caller.call(xe(this.debug),`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:s,body:$n(t),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(a,"update run",!0)}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){Ie(e);let r=await this._get(`/runs/${e}`);return t&&r.child_run_ids&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:e,run:t,projectOpts:r}){if(t!==void 0){let s;t.session_id?s=t.session_id:r!=null&&r.projectName?s=(await this.readProject({projectName:r==null?void 0:r.projectName})).id:r!=null&&r.projectId?s=r==null?void 0:r.projectId:s=(await this.readProject({projectName:Hr("PROJECT")||"default"})).id;const a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/projects/p/${s}/r/${t.id}?poll=true`}else if(e!==void 0){const s=await this.readRun(e);if(!s.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${s.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const t=await o3(this.listRuns({id:e.child_run_ids})),r={},s={};t.sort((a,l)=>((a==null?void 0:a.dotted_order)??"").localeCompare((l==null?void 0:l.dotted_order)??""));for(const a of t){if(a.parent_run_id===null||a.parent_run_id===void 0)throw new Error(`Child run ${a.id} has no parent`);a.parent_run_id in r||(r[a.parent_run_id]=[]),r[a.parent_run_id].push(a),s[a.id]=a}e.child_runs=r[e.id]||[];for(const a in r)a!==e.id&&(s[a].child_runs=r[a]);return e}async*listRuns(e){const{projectId:t,projectName:r,parentRunId:s,traceId:a,referenceExampleId:l,startTime:u,executionOrder:c,isRoot:f,runType:h,error:m,id:g,query:y,filter:w,traceFilter:v,treeFilter:x,limit:E,select:P}=e;let S=[];if(t&&(S=Array.isArray(t)?t:[t]),r){const D=Array.isArray(r)?r:[r],F=await Promise.all(D.map(K=>this.readProject({projectName:K}).then(Y=>Y.id)));S.push(...F)}const R=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],$={session:S.length?S:null,run_type:h,reference_example:l,query:y,filter:w,trace_filter:v,tree_filter:x,execution_order:c,parent_run:s,start_time:u?u.toISOString():null,error:m,id:g,limit:E,trace:a,select:P||R,is_root:f};let I=0;for await(const D of this._getCursorPaginatedList("/runs/query",$))if(E){if(I>=E)break;if(D.length+I>E){yield*D.slice(0,E-I);break}I+=D.length,yield*D}else yield*D}async getRunStats({id:e,trace:t,parentRun:r,runType:s,projectNames:a,projectIds:l,referenceExampleIds:u,startTime:c,endTime:f,error:h,query:m,filter:g,traceFilter:y,treeFilter:w,isRoot:v,dataSourceType:x}){let E=l||[];a&&(E=[...l||[],...await Promise.all(a.map(I=>this.readProject({projectName:I}).then(D=>D.id)))]);const S=Object.fromEntries(Object.entries({id:e,trace:t,parent_run:r,run_type:s,session:E,reference_example:u,start_time:c,end_time:f,error:h,query:m,filter:g,trace_filter:y,tree_filter:w,is_root:v,data_source_type:x}).filter(([I,D])=>D!==void 0));return await(await this.caller.call(xe(this.debug),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(S),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async shareRun(e,{shareId:t}={}){const r={run_id:e,share_token:t||Qt()};Ie(e);const a=await(await this.caller.call(xe(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(a===null||!("share_token"in a))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${a.share_token}/r`}async unshareRun(e){Ie(e);const t=await this.caller.call(xe(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(t,"unshare run",!0)}async readRunSharedLink(e){Ie(e);const r=await(await this.caller.call(xe(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(r===null||!("share_token"in r)))return`${this.getHostUrl()}/public/${r.share_token}/r`}async listSharedRuns(e,{runIds:t}={}){const r=new URLSearchParams({share_token:e});if(t!==void 0)for(const l of t)r.append("id",l);return Ie(e),await(await this.caller.call(xe(this.debug),`${this.apiUrl}/public/${e}/runs${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id),Ie(e);const s=await(await this.caller.call(xe(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return s.url=`${this.getHostUrl()}/public/${s.share_token}/d`,s}async shareDataset(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id);const r={dataset_id:e};Ie(e);const a=await(await this.caller.call(xe(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return a.url=`${this.getHostUrl()}/public/${a.share_token}/d`,a}async unshareDataset(e){Ie(e);const t=await this.caller.call(xe(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(t,"unshare dataset",!0)}async readSharedDataset(e){return Ie(e),await(await this.caller.call(xe(this.debug),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async listSharedExamples(e,t){const r={};t!=null&&t.exampleIds&&(r.id=t.exampleIds);const s=new URLSearchParams;Object.entries(r).forEach(([u,c])=>{Array.isArray(c)?c.forEach(f=>s.append(u,f)):s.append(u,c)});const a=await this.caller.call(xe(this.debug),`${this.apiUrl}/public/${e}/examples?${s.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),l=await a.json();if(!a.ok)throw"detail"in l?new Error(`Failed to list shared examples.
Status: ${a.status}
Message: ${l.detail.join(`
`)}`):new Error(`Failed to list shared examples: ${a.status} ${a.statusText}`);return l.map(u=>({...u,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:t=null,metadata:r=null,upsert:s=!1,projectExtra:a=null,referenceDatasetId:l=null}){const u=s?"?upsert=true":"",c=`${this.apiUrl}/sessions${u}`,f=a||{};r&&(f.metadata=r);const h={name:e,extra:f,description:t};l!==null&&(h.reference_dataset_id=l);const m=await this.caller.call(xe(this.debug),c,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(h),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(m,"create project"),await m.json()}async updateProject(e,{name:t=null,description:r=null,metadata:s=null,projectExtra:a=null,endTime:l=null}){const u=`${this.apiUrl}/sessions/${e}`;let c=a;s&&(c={...c||{},metadata:s});const f={name:t,extra:c,description:r,end_time:l?new Date(l).toISOString():null},h=await this.caller.call(xe(this.debug),u,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(f),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(h,"update project"),await h.json()}async hasProject({projectId:e,projectName:t}){let r="/sessions";const s=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)Ie(e),r+=`/${e}`;else if(t!==void 0)s.append("name",t);else throw new Error("Must provide projectName or projectId");const a=await this.caller.call(xe(this.debug),`${this.apiUrl}${r}?${s}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const l=await a.json();return a.ok?Array.isArray(l)?l.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:t,includeStats:r}){let s="/sessions";const a=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)Ie(e),s+=`/${e}`;else if(t!==void 0)a.append("name",t);else throw new Error("Must provide projectName or projectId");r!==void 0&&a.append("include_stats",r.toString());const l=await this._get(s,a);let u;if(Array.isArray(l)){if(l.length===0)throw new Error(`Project[id=${e}, name=${t}] not found`);u=l[0]}else u=l;return u}async getProjectUrl({projectId:e,projectName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either projectName or projectId");const r=await this.readProject({projectId:e,projectName:t}),s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/projects/p/${r.id}`}async getDatasetUrl({datasetId:e,datasetName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");const r=await this.readDataset({datasetId:e,datasetName:t}),s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/datasets/${r.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const t of this._getPaginated("/sessions",e))return this._tenantId=t[0].tenant_id,t[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:t,nameContains:r,referenceDatasetId:s,referenceDatasetName:a,referenceFree:l,metadata:u}={}){const c=new URLSearchParams;if(e!==void 0)for(const f of e)c.append("id",f);if(t!==void 0&&c.append("name",t),r!==void 0&&c.append("name_contains",r),s!==void 0)c.append("reference_dataset",s);else if(a!==void 0){const f=await this.readDataset({datasetName:a});c.append("reference_dataset",f.id)}l!==void 0&&c.append("reference_free",l.toString()),u!==void 0&&c.append("metadata",JSON.stringify(u));for await(const f of this._getPaginated("/sessions",c))yield*f}async deleteProject({projectId:e,projectName:t}){let r;if(e===void 0&&t===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?r=(await this.readProject({projectName:t})).id:r=e,Ie(r);const s=await this.caller.call(xe(this.debug),`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(s,`delete session ${r} (${t})`,!0)}async uploadCsv({csvFile:e,fileName:t,inputKeys:r,outputKeys:s,description:a,dataType:l,name:u}){const c=`${this.apiUrl}/datasets/upload`,f=new FormData;f.append("file",e,t),r.forEach(g=>{f.append("input_keys",g)}),s.forEach(g=>{f.append("output_keys",g)}),a&&f.append("description",a),l&&f.append("data_type",l),u&&f.append("name",u);const h=await this.caller.call(xe(this.debug),c,{method:"POST",headers:this.headers,body:f,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(h,"upload CSV"),await h.json()}async createDataset(e,{description:t,dataType:r,inputsSchema:s,outputsSchema:a,metadata:l}={}){const u={name:e,description:t,extra:l?{metadata:l}:void 0};r&&(u.data_type=r),s&&(u.inputs_schema_definition=s),a&&(u.outputs_schema_definition=a);const c=await this.caller.call(xe(this.debug),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(c,"create dataset"),await c.json()}async readDataset({datasetId:e,datasetName:t}){let r="/datasets";const s=new URLSearchParams({limit:"1"});if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)Ie(e),r+=`/${e}`;else if(t!==void 0)s.append("name",t);else throw new Error("Must provide datasetName or datasetId");const a=await this._get(r,s);let l;if(Array.isArray(a)){if(a.length===0)throw new Error(`Dataset[id=${e}, name=${t}] not found`);l=a[0]}else l=a;return l}async hasDataset({datasetId:e,datasetName:t}){try{return await this.readDataset({datasetId:e,datasetName:t}),!0}catch(r){if(r instanceof Error&&r.message.toLocaleLowerCase().includes("not found"))return!1;throw r}}async diffDatasetVersions({datasetId:e,datasetName:t,fromVersion:r,toVersion:s}){let a=e;if(a===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");if(a!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");a===void 0&&(a=(await this.readDataset({datasetName:t})).id);const l=new URLSearchParams({from_version:typeof r=="string"?r:r.toISOString(),to_version:typeof s=="string"?s:s.toISOString()});return await this._get(`/datasets/${a}/versions/diff`,l)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:t}){const r="/datasets";if(e===void 0)if(t!==void 0)e=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide either datasetName or datasetId");return(await(await this._getResponse(`${r}/${e}/openai_ft`)).text()).trim().split(`
`).map(u=>JSON.parse(u))}async*listDatasets({limit:e=100,offset:t=0,datasetIds:r,datasetName:s,datasetNameContains:a,metadata:l}={}){const u="/datasets",c=new URLSearchParams({limit:e.toString(),offset:t.toString()});if(r!==void 0)for(const f of r)c.append("id",f);s!==void 0&&c.append("name",s),a!==void 0&&c.append("name_contains",a),l!==void 0&&c.append("metadata",JSON.stringify(l));for await(const f of this._getPaginated(u,c))yield*f}async updateDataset(e){const{datasetId:t,datasetName:r,...s}=e;if(!t&&!r)throw new Error("Must provide either datasetName or datasetId");const a=t??(await this.readDataset({datasetName:r})).id;Ie(a);const l=await this.caller.call(xe(this.debug),`${this.apiUrl}/datasets/${a}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(l,"update dataset"),await l.json()}async updateDatasetTag(e){const{datasetId:t,datasetName:r,asOf:s,tag:a}=e;if(!t&&!r)throw new Error("Must provide either datasetName or datasetId");const l=t??(await this.readDataset({datasetName:r})).id;Ie(l);const u=await this.caller.call(xe(this.debug),`${this.apiUrl}/datasets/${l}/tags`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({as_of:typeof s=="string"?s:s.toISOString(),tag:a}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(u,"update dataset tags")}async deleteDataset({datasetId:e,datasetName:t}){let r="/datasets",s=e;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(t!==void 0&&(s=(await this.readDataset({datasetName:t})).id),s!==void 0)Ie(s),r+=`/${s}`;else throw new Error("Must provide datasetName or datasetId");const a=await this.caller.call(xe(this.debug),this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(a,`delete ${r}`),await a.json()}async indexDataset({datasetId:e,datasetName:t,tag:r}){let s=e;if(!s&&!t)throw new Error("Must provide either datasetName or datasetId");if(s&&t)throw new Error("Must provide either datasetName or datasetId, not both");s||(s=(await this.readDataset({datasetName:t})).id),Ie(s);const a={tag:r},l=await this.caller.call(xe(this.debug),`${this.apiUrl}/datasets/${s}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(l,"index dataset"),await l.json()}async similarExamples(e,t,r,{filter:s}={}){const a={limit:r,inputs:e};s!==void 0&&(a.filter=s),Ie(t);const l=await this.caller.call(xe(this.debug),`${this.apiUrl}/datasets/${t}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(l,"fetch similar examples"),(await l.json()).examples}async createExample(e,t,r){var h;if(SS(e)&&(t!==void 0||r!==void 0))throw new Error("Cannot provide outputs or options when using ExampleCreate object");let s=t?r==null?void 0:r.datasetId:e.dataset_id;const a=t?r==null?void 0:r.datasetName:e.dataset_name;if(s===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");if(s!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");s===void 0&&(s=(await this.readDataset({datasetName:a})).id);const l=(t?r==null?void 0:r.createdAt:e.created_at)||new Date;let u;SS(e)?u=e:u={inputs:e,outputs:t,created_at:l==null?void 0:l.toISOString(),id:r==null?void 0:r.exampleId,metadata:r==null?void 0:r.metadata,split:r==null?void 0:r.split,source_run_id:r==null?void 0:r.sourceRunId,use_source_run_io:r==null?void 0:r.useSourceRunIO,use_source_run_attachments:r==null?void 0:r.useSourceRunAttachments,attachments:r==null?void 0:r.attachments};const c=await this._uploadExamplesMultipart(s,[u]);return await this.readExample(((h=c.example_ids)==null?void 0:h[0])??Qt())}async createExamples(e){if(Array.isArray(e)){if(e.length===0)return[];const P=e;let S=P[0].dataset_id;const R=P[0].dataset_name;if(S===void 0&&R===void 0)throw new Error("Must provide either datasetName or datasetId");if(S!==void 0&&R!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");S===void 0&&(S=(await this.readDataset({datasetName:R})).id);const $=await this._uploadExamplesMultipart(S,P);return await Promise.all($.example_ids.map(D=>this.readExample(D)))}const{inputs:t,outputs:r,metadata:s,splits:a,sourceRunIds:l,useSourceRunIOs:u,useSourceRunAttachments:c,attachments:f,exampleIds:h,datasetId:m,datasetName:g}=e;if(t===void 0)throw new Error("Must provide inputs when using legacy parameters");let y=m;const w=g;if(y===void 0&&w===void 0)throw new Error("Must provide either datasetName or datasetId");if(y!==void 0&&w!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");y===void 0&&(y=(await this.readDataset({datasetName:w})).id);const v=t.map((P,S)=>({dataset_id:y,inputs:P,outputs:r==null?void 0:r[S],metadata:s==null?void 0:s[S],split:a==null?void 0:a[S],id:h==null?void 0:h[S],attachments:f==null?void 0:f[S],source_run_id:l==null?void 0:l[S],use_source_run_io:u==null?void 0:u[S],use_source_run_attachments:c==null?void 0:c[S]})),x=await this._uploadExamplesMultipart(y,v);return await Promise.all(x.example_ids.map(P=>this.readExample(P)))}async createLLMExample(e,t,r){return this.createExample({input:e},{output:t},r)}async createChatExample(e,t,r){const s=e.map(l=>Px(l)?kx(l):l),a=Px(t)?kx(t):t;return this.createExample({input:s},{output:a},r)}async readExample(e){Ie(e);const t=`/examples/${e}`,r=await this._get(t),{attachment_urls:s,...a}=r,l=a;return s&&(l.attachments=Object.entries(s).reduce((u,[c,f])=>(u[c.slice(11)]={presigned_url:f.presigned_url,mime_type:f.mime_type},u),{})),l}async*listExamples({datasetId:e,datasetName:t,exampleIds:r,asOf:s,splits:a,inlineS3Urls:l,metadata:u,limit:c,offset:f,filter:h,includeAttachments:m}={}){let g;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)g=e;else if(t!==void 0)g=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide a datasetName or datasetId");const y=new URLSearchParams({dataset:g}),w=s?typeof s=="string"?s:s==null?void 0:s.toISOString():void 0;w&&y.append("as_of",w);const v=l??!0;if(y.append("inline_s3_urls",v.toString()),r!==void 0)for(const E of r)y.append("id",E);if(a!==void 0)for(const E of a)y.append("splits",E);if(u!==void 0){const E=JSON.stringify(u);y.append("metadata",E)}c!==void 0&&y.append("limit",c.toString()),f!==void 0&&y.append("offset",f.toString()),h!==void 0&&y.append("filter",h),m===!0&&["attachment_urls","outputs","metadata"].forEach(E=>y.append("select",E));let x=0;for await(const E of this._getPaginated("/examples",y)){for(const P of E){const{attachment_urls:S,...R}=P,$=R;S&&($.attachments=Object.entries(S).reduce((I,[D,F])=>(I[D.slice(11)]={presigned_url:F.presigned_url,mime_type:F.mime_type||void 0},I),{})),yield $,x++}if(c!==void 0&&x>=c)break}}async deleteExample(e){Ie(e);const t=`/examples/${e}`,r=await this.caller.call(xe(this.debug),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(r,`delete ${t}`),await r.json()}async updateExample(e,t){let r;t?r=e:r=e.id,Ie(r);let s;t?s={id:r,...t}:s=e;let a;return s.dataset_id!==void 0?a=s.dataset_id:a=(await this.readExample(r)).dataset_id,this._updateExamplesMultipart(a,[s])}async updateExamples(e){let t;return e[0].dataset_id===void 0?t=(await this.readExample(e[0].id)).dataset_id:t=e[0].dataset_id,this._updateExamplesMultipart(t,e)}async readDatasetVersion({datasetId:e,datasetName:t,asOf:r,tag:s}){let a;if(e?a=e:a=(await this.readDataset({datasetName:t})).id,Ie(a),r&&s||!r&&!s)throw new Error("Exactly one of asOf and tag must be specified.");const l=new URLSearchParams;r!==void 0&&l.append("as_of",typeof r=="string"?r:r.toISOString()),s!==void 0&&l.append("tag",s);const u=await this.caller.call(xe(this.debug),`${this.apiUrl}/datasets/${a}/version?${l.toString()}`,{method:"GET",headers:{...this.headers},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(u,"read dataset version"),await u.json()}async listDatasetSplits({datasetId:e,datasetName:t,asOf:r}){let s;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?s=(await this.readDataset({datasetName:t})).id:s=e,Ie(s);const a=new URLSearchParams,l=r?typeof r=="string"?r:r==null?void 0:r.toISOString():void 0;return l&&a.append("as_of",l),await this._get(`/datasets/${s}/splits`,a)}async updateDatasetSplits({datasetId:e,datasetName:t,splitName:r,exampleIds:s,remove:a=!1}){let l;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?l=(await this.readDataset({datasetName:t})).id:l=e,Ie(l);const u={split_name:r,examples:s.map(f=>(Ie(f),f)),remove:a},c=await this.caller.call(xe(this.debug),`${this.apiUrl}/datasets/${l}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(c,"update dataset splits",!0)}async evaluateRun(e,t,{sourceInfo:r,loadChildRuns:s,referenceExample:a}={loadChildRuns:!1}){FC("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let l;if(typeof e=="string")l=await this.readRun(e,{loadChildRuns:s});else if(typeof e=="object"&&"id"in e)l=e;else throw new Error(`Invalid run type: ${typeof e}`);l.reference_example_id!==null&&l.reference_example_id!==void 0&&(a=await this.readExample(l.reference_example_id));const u=await t.evaluateRun(l,a),[c,f]=await this._logEvaluationFeedback(u,l,r);return f[0]}async createFeedback(e,t,{score:r,value:s,correction:a,comment:l,sourceInfo:u,feedbackSourceType:c="api",sourceRunId:f,feedbackId:h,feedbackConfig:m,projectId:g,comparativeExperimentId:y}){var P;if(!e&&!g)throw new Error("One of runId or projectId must be provided");if(e&&g)throw new Error("Only one of runId or projectId can be provided");const w={type:c??"api",metadata:u??{}};f!==void 0&&(w==null?void 0:w.metadata)!==void 0&&!w.metadata.__run&&(w.metadata.__run={run_id:f}),(w==null?void 0:w.metadata)!==void 0&&((P=w.metadata.__run)==null?void 0:P.run_id)!==void 0&&Ie(w.metadata.__run.run_id);const v={id:h??Qt(),run_id:e,key:t,score:xS(r),value:s,correction:a,comment:l,feedback_source:w,comparative_experiment_id:y,feedbackConfig:m,session_id:g},x=`${this.apiUrl}/feedback`,E=await this.caller.call(xe(this.debug),x,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(v),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(E,"create feedback",!0),v}async updateFeedback(e,{score:t,value:r,correction:s,comment:a}){const l={};t!=null&&(l.score=xS(t)),r!=null&&(l.value=r),s!=null&&(l.correction=s),a!=null&&(l.comment=a),Ie(e);const u=await this.caller.call(xe(this.debug),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(u,"update feedback",!0)}async readFeedback(e){Ie(e);const t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){Ie(e);const t=`/feedback/${e}`,r=await this.caller.call(xe(this.debug),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(r,`delete ${t}`),await r.json()}async*listFeedback({runIds:e,feedbackKeys:t,feedbackSourceTypes:r}={}){const s=new URLSearchParams;if(e&&s.append("run",e.join(",")),t)for(const a of t)s.append("key",a);if(r)for(const a of r)s.append("source",a);for await(const a of this._getPaginated("/feedback",s))yield*a}async createPresignedFeedbackToken(e,t,{expiration:r,feedbackConfig:s}={}){const a={run_id:e,feedback_key:t,feedback_config:s};return r?typeof r=="string"?a.expires_at=r:(r!=null&&r.hours||r!=null&&r.minutes||r!=null&&r.days)&&(a.expires_in=r):a.expires_in={hours:3},await(await this.caller.call(xe(this.debug),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createComparativeExperiment({name:e,experimentIds:t,referenceDatasetId:r,createdAt:s,description:a,metadata:l,id:u}){var h;if(t.length===0)throw new Error("At least one experiment is required");if(r||(r=(await this.readProject({projectId:t[0]})).reference_dataset_id),!r==null)throw new Error("A reference dataset is required");const c={id:u,name:e,experiment_ids:t,reference_dataset_id:r,description:a,created_at:(h=s??new Date)==null?void 0:h.toISOString(),extra:{}};return l&&(c.extra.metadata=l),await(await this.caller.call(xe(this.debug),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){Ie(e);const t=new URLSearchParams({run_id:e});for await(const r of this._getPaginated("/feedback/tokens",t))yield*r}_selectEvalResults(e){let t;return"results"in e?t=e.results:Array.isArray(e)?t=e:t=[e],t}async _logEvaluationFeedback(e,t,r){const s=this._selectEvalResults(e),a=[];for(const l of s){let u=r||{};l.evaluatorInfo&&(u={...l.evaluatorInfo,...u});let c=null;l.targetRunId?c=l.targetRunId:t&&(c=t.id),a.push(await this.createFeedback(c,l.key,{score:l.score,value:l.value,comment:l.comment,correction:l.correction,sourceInfo:u,sourceRunId:l.sourceRunId,feedbackConfig:l.feedbackConfig,feedbackSourceType:"model"}))}return[s,a]}async logEvaluationFeedback(e,t,r){const[s]=await this._logEvaluationFeedback(e,t,r);return s}async*listAnnotationQueues(e={}){const{queueIds:t,name:r,nameContains:s,limit:a}=e,l=new URLSearchParams;t&&t.forEach((c,f)=>{Ie(c,`queueIds[${f}]`),l.append("ids",c)}),r&&l.append("name",r),s&&l.append("name_contains",s),l.append("limit",(a!==void 0?Math.min(a,100):100).toString());let u=0;for await(const c of this._getPaginated("/annotation-queues",l))if(yield*c,u++,a!==void 0&&u>=a)break}async createAnnotationQueue(e){const{name:t,description:r,queueId:s}=e,a={name:t,description:r,id:s||Qt()},l=await this.caller.call(xe(this.debug),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(a).filter(([c,f])=>f!==void 0))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(l,"create annotation queue"),await l.json()}async readAnnotationQueue(e){const t=await this.listAnnotationQueues({queueIds:[e]}).next();if(t.done)throw new Error(`Annotation queue with ID ${e} not found`);return t.value}async updateAnnotationQueue(e,t){const{name:r,description:s}=t,a=await this.caller.call(xe(this.debug),`${this.apiUrl}/annotation-queues/${Ie(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:r,description:s}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(a,"update annotation queue")}async deleteAnnotationQueue(e){const t=await this.caller.call(xe(this.debug),`${this.apiUrl}/annotation-queues/${Ie(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(t,"delete annotation queue")}async addRunsToAnnotationQueue(e,t){const r=await this.caller.call(xe(this.debug),`${this.apiUrl}/annotation-queues/${Ie(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t.map((s,a)=>Ie(s,`runIds[${a}]`).toString())),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(r,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,t){const r=`/annotation-queues/${Ie(e,"queueId")}/run`,s=await this.caller.call(xe(this.debug),`${this.apiUrl}${r}/${t}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(s,"get run from annotation queue"),await s.json()}async deleteRunFromAnnotationQueue(e,t){const r=await this.caller.call(xe(this.debug),`${this.apiUrl}/annotation-queues/${Ie(e,"queueId")}/runs/${Ie(t,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(r,"delete run from annotation queue")}async getSizeFromAnnotationQueue(e){const t=await this.caller.call(xe(this.debug),`${this.apiUrl}/annotation-queues/${Ie(e,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(t,"get size from annotation queue"),await t.json()}async _currentTenantIsOwner(e){const t=await this._getSettings();return e=="-"||t.tenant_handle===e}async _ownerConflictError(e,t){const r=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${r.tenant_handle}

      Requested tenant: ${t}`)}async _getLatestCommitHash(e){const t=await this.caller.call(xe(this.debug),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),r=await t.json();if(!t.ok){const s=typeof r.detail=="string"?r.detail:JSON.stringify(r.detail),a=new Error(`Error ${t.status}: ${t.statusText}
${s}`);throw a.statusCode=t.status,a}if(r.commits.length!==0)return r.commits[0].commit_hash}async _likeOrUnlikePrompt(e,t){const[r,s,a]=ea(e),l=await this.caller.call(xe(this.debug),`${this.apiUrl}/likes/${r}/${s}`,{method:"POST",body:JSON.stringify({like:t}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(l,`${t?"like":"unlike"} prompt`),await l.json()}async _getPromptUrl(e){const[t,r,s]=ea(e);if(await this._currentTenantIsOwner(t)){const a=await this._getSettings();return s!=="latest"?`${this.getHostUrl()}/prompts/${r}/${s.substring(0,8)}?organizationId=${a.id}`:`${this.getHostUrl()}/prompts/${r}?organizationId=${a.id}`}else return s!=="latest"?`${this.getHostUrl()}/hub/${t}/${r}/${s.substring(0,8)}`:`${this.getHostUrl()}/hub/${t}/${r}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const t of this._getPaginated(`/commits/${e}/`,new URLSearchParams,r=>r.commits))yield*t}async*listPrompts(e){const t=new URLSearchParams;t.append("sort_field",(e==null?void 0:e.sortField)??"updated_at"),t.append("sort_direction","desc"),t.append("is_archived",(!!(e!=null&&e.isArchived)).toString()),(e==null?void 0:e.isPublic)!==void 0&&t.append("is_public",e.isPublic.toString()),e!=null&&e.query&&t.append("query",e.query);for await(const r of this._getPaginated("/repos",t,s=>s.repos))yield*r}async getPrompt(e){const[t,r,s]=ea(e),a=await this.caller.call(xe(this.debug),`${this.apiUrl}/repos/${t}/${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(a.status===404)return null;await Fe(a,"get prompt");const l=await a.json();return l.repo?l.repo:null}async createPrompt(e,t){const r=await this._getSettings();if(t!=null&&t.isPublic&&!r.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle. 
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[s,a,l]=ea(e);if(!await this._currentTenantIsOwner(s))throw await this._ownerConflictError("create a prompt",s);const u={repo_handle:a,...(t==null?void 0:t.description)&&{description:t.description},...(t==null?void 0:t.readme)&&{readme:t.readme},...(t==null?void 0:t.tags)&&{tags:t.tags},is_public:!!(t!=null&&t.isPublic)},c=await this.caller.call(xe(this.debug),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(c,"create prompt");const{repo:f}=await c.json();return f}async createCommit(e,t,r){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[s,a,l]=ea(e),u=(r==null?void 0:r.parentCommitHash)==="latest"||!(r!=null&&r.parentCommitHash)?await this._getLatestCommitHash(`${s}/${a}`):r==null?void 0:r.parentCommitHash,c={manifest:JSON.parse(JSON.stringify(t)),parent_commit:u},f=await this.caller.call(xe(this.debug),`${this.apiUrl}/commits/${s}/${a}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(f,"create commit");const h=await f.json();return this._getPromptUrl(`${s}/${a}${h.commit_hash?`:${h.commit_hash}`:""}`)}async updateExamplesMultipart(e,t=[]){return this._updateExamplesMultipart(e,t)}async _updateExamplesMultipart(e,t=[]){var u;if(!await this._getMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const r=new FormData;for(const c of t){const f=c.id,h={...c.metadata&&{metadata:c.metadata},...c.split&&{split:c.split}},m=$n(h),g=new Blob([m],{type:"application/json"});if(r.append(f,g),c.inputs){const y=$n(c.inputs),w=new Blob([y],{type:"application/json"});r.append(`${f}.inputs`,w)}if(c.outputs){const y=$n(c.outputs),w=new Blob([y],{type:"application/json"});r.append(`${f}.outputs`,w)}if(c.attachments)for(const[y,w]of Object.entries(c.attachments)){let v,x;Array.isArray(w)?[v,x]=w:(v=w.mimeType,x=w.data);const E=new Blob([x],{type:`${v}; length=${x.byteLength}`});r.append(`${f}.attachment.${y}`,E)}if(c.attachments_operations){const y=$n(c.attachments_operations),w=new Blob([y],{type:"application/json"});r.append(`${f}.attachments_operations`,w)}}const s=e??((u=t[0])==null?void 0:u.dataset_id);return await(await this.caller.call(xe(this.debug),`${this.apiUrl}/v1/platform/datasets/${s}/examples`,{method:"PATCH",headers:this.headers,body:r})).json()}async uploadExamplesMultipart(e,t=[]){return this._uploadExamplesMultipart(e,t)}async _uploadExamplesMultipart(e,t=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const r=new FormData;for(const l of t){const u=(l.id??Qt()).toString(),c={created_at:l.created_at,...l.metadata&&{metadata:l.metadata},...l.split&&{split:l.split},...l.source_run_id&&{source_run_id:l.source_run_id},...l.use_source_run_io&&{use_source_run_io:l.use_source_run_io},...l.use_source_run_attachments&&{use_source_run_attachments:l.use_source_run_attachments}},f=$n(c),h=new Blob([f],{type:"application/json"});if(r.append(u,h),l.inputs){const m=$n(l.inputs),g=new Blob([m],{type:"application/json"});r.append(`${u}.inputs`,g)}if(l.outputs){const m=$n(l.outputs),g=new Blob([m],{type:"application/json"});r.append(`${u}.outputs`,g)}if(l.attachments)for(const[m,g]of Object.entries(l.attachments)){let y,w;Array.isArray(g)?[y,w]=g:(y=g.mimeType,w=g.data);const v=new Blob([w],{type:`${y}; length=${w.byteLength}`});r.append(`${u}.attachment.${m}`,v)}}const s=await this.caller.call(xe(this.debug),`${this.apiUrl}/v1/platform/datasets/${e}/examples`,{method:"POST",headers:this.headers,body:r});return await Fe(s,"upload examples"),await s.json()}async updatePrompt(e,t){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,s]=ea(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("update a prompt",r);const a={};if((t==null?void 0:t.description)!==void 0&&(a.description=t.description),(t==null?void 0:t.readme)!==void 0&&(a.readme=t.readme),(t==null?void 0:t.tags)!==void 0&&(a.tags=t.tags),(t==null?void 0:t.isPublic)!==void 0&&(a.is_public=t.isPublic),(t==null?void 0:t.isArchived)!==void 0&&(a.is_archived=t.isArchived),Object.keys(a).length===0)throw new Error("No valid update options provided");const l=await this.caller.call(xe(this.debug),`${this.apiUrl}/repos/${r}/${s}`,{method:"PATCH",body:JSON.stringify(a),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Fe(l,"update prompt"),l.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[t,r,s]=ea(e);if(!await this._currentTenantIsOwner(t))throw await this._ownerConflictError("delete a prompt",t);return await(await this.caller.call(xe(this.debug),`${this.apiUrl}/repos/${t}/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async pullPromptCommit(e,t){const[r,s,a]=ea(e),l=await this.caller.call(xe(this.debug),`${this.apiUrl}/commits/${r}/${s}/${a}${t!=null&&t.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Fe(l,"pull prompt commit");const u=await l.json();return{owner:r,repo:s,commit_hash:u.commit_hash,manifest:u.manifest,examples:u.examples}}async _pullPrompt(e,t){const r=await this.pullPromptCommit(e,{includeModel:t==null?void 0:t.includeModel});return JSON.stringify(r.manifest)}async pushPrompt(e,t){return await this.promptExists(e)?t&&Object.keys(t).some(s=>s!=="object")&&await this.updatePrompt(e,{description:t==null?void 0:t.description,readme:t==null?void 0:t.readme,tags:t==null?void 0:t.tags,isPublic:t==null?void 0:t.isPublic}):await this.createPrompt(e,{description:t==null?void 0:t.description,readme:t==null?void 0:t.readme,tags:t==null?void 0:t.tags,isPublic:t==null?void 0:t.isPublic}),t!=null&&t.object?await this.createCommit(e,t==null?void 0:t.object,{parentCommitHash:t==null?void 0:t.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,t={}){const{sourceApiUrl:r=this.apiUrl,datasetName:s}=t,[a,l]=this.parseTokenOrUrl(e,r),u=new au({apiUrl:a,apiKey:"placeholder"}),c=await u.readSharedDataset(l),f=s||c.name;try{if(await this.hasDataset({datasetId:f})){console.log(`Dataset ${f} already exists in your tenant. Skipping.`);return}}catch{}const h=await u.listSharedExamples(l),m=await this.createDataset(f,{description:c.description,dataType:c.data_type||"kv",inputsSchema:c.inputs_schema_definition??void 0,outputsSchema:c.outputs_schema_definition??void 0});try{await this.createExamples({inputs:h.map(g=>g.inputs),outputs:h.flatMap(g=>g.outputs?[g.outputs]:[]),datasetId:m.id})}catch(g){throw console.error(`An error occurred while creating dataset ${f}. You should delete it manually.`),g}}parseTokenOrUrl(e,t,r=2,s="dataset"){try{return Ie(e),[t,e]}catch{}try{const l=new URL(e).pathname.split("/").filter(u=>u!=="");if(l.length>=r){const u=l[l.length-r];return[t,u]}else throw new Error(`Invalid public ${s} URL: ${e}`)}catch{throw new Error(`Invalid public ${s} URL or token: ${e}`)}}awaitPendingTraceBatches(){return this.manualFlushMode?(console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve()):Promise.all([...this.autoBatchQueue.items.map(({itemPromise:e})=>e),this.batchIngestCaller.queue.onIdle()])}}function SS(n){return"dataset_id"in n||"dataset_name"in n}const WC="0.3.19";var Nl={};let _s;const f3=()=>typeof window<"u"&&typeof window.document<"u",h3=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",p3=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),VC=()=>typeof Deno<"u",m3=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!VC(),g3=()=>_s||(f3()?_s="browser":m3()?_s="node":h3()?_s="webworker":p3()?_s="jsdom":VC()?_s="deno":_s="other",_s);let eg;function qC(){if(eg===void 0){const n=g3(),e=w3();eg={library:"langsmith",runtime:n,sdk:"langsmith-js",sdk_version:WC,...e}}return eg}function y3(){const n=_3()||{},e={},t=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(const[r,s]of Object.entries(n))(r.startsWith("LANGCHAIN_")||r.startsWith("LANGSMITH_"))&&typeof s=="string"&&!t.includes(r)&&!r.toLowerCase().includes("key")&&!r.toLowerCase().includes("secret")&&!r.toLowerCase().includes("token")&&(r==="LANGCHAIN_REVISION_ID"?e.revision_id=s:e[r]=s);return e}function _3(){try{return typeof process<"u"&&Nl?Object.entries(Nl).reduce((n,[e,t])=>(n[e]=String(t),n),{}):void 0}catch{return}}function oa(n){try{return typeof process<"u"?Nl==null?void 0:Nl[n]:void 0}catch{return}}function Hr(n){return oa(`LANGSMITH_${n}`)||oa(`LANGCHAIN_${n}`)}let tg;function w3(){if(tg!==void 0)return tg;const n=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const t of n){const r=oa(t);r!==void 0&&(e[t]=r)}return tg=e,e}const b3=n=>!!["TRACING_V2","TRACING"].find(t=>Hr(t)==="true"),ng=Symbol.for("lc:context_variables");function v3(n){return n.replace(/[-:.]/g,"")}function x3(n,e,t=1){const r=t.toFixed(0).slice(0,3).padStart(3,"0");return v3(`${new Date(n).toISOString().slice(0,-1)}${r}Z`)+e}class Bd{constructor(e,t,r){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=t,this.project_name=r}static fromHeader(e){const t=e.split(",");let r={},s=[],a;for(const l of t){const[u,c]=l.split("="),f=decodeURIComponent(c);u==="langsmith-metadata"?r=JSON.parse(f):u==="langsmith-tags"?s=f.split(","):u==="langsmith-project"&&(a=f)}return new Bd(r,s,a)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),this.project_name&&e.push(`langsmith-project=${encodeURIComponent(this.project_name)}`),e.join(",")}}class jn{constructor(e){var u;if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),ZC(e)){Object.assign(this,{...e});return}const t=jn.getDefaultConfig(),{metadata:r,...s}=e,a=s.client??jn.getSharedClient(),l={...r,...(u=s==null?void 0:s.extra)==null?void 0:u.metadata};if(s.extra={...s.extra,metadata:l},Object.assign(this,{...t,...s,client:a}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.execution_order??(this.execution_order=1),this.child_execution_order??(this.child_execution_order=1),!this.dotted_order){const c=x3(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+c:this.dotted_order=c}}static getDefaultConfig(){return{id:Qt(),run_type:"chain",project_name:Hr("PROJECT")??oa("LANGCHAIN_SESSION")??"default",child_runs:[],api_url:oa("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:oa("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return jn.sharedClient||(jn.sharedClient=new au),jn.sharedClient}createChild(e){var c,f,h,m,g,y;const t=this.child_execution_order+1,r=new jn({...e,parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:t,child_execution_order:t});ng in this&&(r[ng]=this[ng]);const s=Symbol.for("lc:child_config"),a=((c=e.extra)==null?void 0:c[s])??this.extra[s];if(E3(a)){const w={...a},v=S3(w.callbacks)?(h=(f=w.callbacks).copy)==null?void 0:h.call(f):void 0;v&&(Object.assign(v,{_parentRunId:r.id}),(y=(g=(m=v.handlers)==null?void 0:m.find(GC))==null?void 0:g.updateFromRunTree)==null||y.call(g,r),w.callbacks=v),r.extra[s]=w}const l=new Set;let u=this;for(;u!=null&&!l.has(u.id);)l.add(u.id),u.child_execution_order=Math.max(u.child_execution_order,t),u=u.parent_run;return this.child_runs.push(r),r}async end(e,t,r=Date.now(),s){this.outputs=this.outputs??e,this.error=this.error??t,this.end_time=this.end_time??r,s&&Object.keys(s).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...s}}:{metadata:s})}_convertToCreate(e,t,r=!0){var c;const s=e.extra??{};if(s.runtime||(s.runtime={}),t)for(const[f,h]of Object.entries(t))s.runtime[f]||(s.runtime[f]=h);let a,l;return r?(l=(c=e.parent_run)==null?void 0:c.id,a=[]):(a=e.child_runs.map(f=>this._convertToCreate(f,t,r)),l=void 0),{id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:s,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:a,parent_run_id:l,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments}}async postRun(e=!0){try{const t=qC(),r=await this._convertToCreate(this,t,!0);if(await this.client.createRun(r),!e){FC("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const s of this.child_runs)await s.postRun(!1)}}catch(t){console.error(`Error in postRun for run ${this.id}:`,t)}}async patchRun(){var e;try{const t={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:(e=this.parent_run)==null?void 0:e.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments,session_name:this.project_name};await this.client.updateRun(this.id,t)}catch(t){console.error(`Error in patchRun for run ${this.id}`,t)}}toJSON(){return this._convertToCreate(this,void 0,!1)}addEvent(e){this.events||(this.events=[]),typeof e=="string"?this.events.push({name:"event",time:new Date().toISOString(),message:e}):this.events.push({...e,time:e.time??new Date().toISOString()})}static fromRunnableConfig(e,t){var f,h,m,g;const r=e==null?void 0:e.callbacks;let s,a,l,u=b3();if(r){const y=((f=r==null?void 0:r.getParentRunId)==null?void 0:f.call(r))??"",w=(h=r==null?void 0:r.handlers)==null?void 0:h.find(v=>(v==null?void 0:v.name)=="langchain_tracer");s=(m=w==null?void 0:w.getRun)==null?void 0:m.call(w,y),a=w==null?void 0:w.projectName,l=w==null?void 0:w.client,u=u||!!w}return s?new jn({name:s.name,id:s.id,trace_id:s.trace_id,dotted_order:s.dotted_order,client:l,tracingEnabled:u,project_name:a,tags:[...new Set(((s==null?void 0:s.tags)??[]).concat((e==null?void 0:e.tags)??[]))],extra:{metadata:{...(g=s==null?void 0:s.extra)==null?void 0:g.metadata,...e==null?void 0:e.metadata}}}).createChild(t):new jn({...t,client:l,tracingEnabled:u,project_name:a})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,t){var f;const r="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,s=r["langsmith-trace"];if(!s||typeof s!="string")return;const a=s.trim(),l=a.split(".").map(h=>{const[m,g]=h.split("Z");return{strTime:m,time:Date.parse(m+"Z"),uuid:g}}),u=l[0].uuid,c={...t,name:(t==null?void 0:t.name)??"parent",run_type:(t==null?void 0:t.run_type)??"chain",start_time:(t==null?void 0:t.start_time)??Date.now(),id:(f=l.at(-1))==null?void 0:f.uuid,trace_id:u,dotted_order:a};if(r.baggage&&typeof r.baggage=="string"){const h=Bd.fromHeader(r.baggage);c.metadata=h.metadata,c.tags=h.tags,c.project_name=h.project_name}return new jn(c)}toHeaders(e){var r;const t={"langsmith-trace":this.dotted_order,baggage:new Bd((r=this.extra)==null?void 0:r.metadata,this.tags,this.project_name).toHeader()};if(e)for(const[s,a]of Object.entries(t))e.set(s,a);return t}}Object.defineProperty(jn,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function ZC(n){return n!==void 0&&typeof n.createChild=="function"&&typeof n.postRun=="function"}function GC(n){return typeof n=="object"&&n!=null&&typeof n.name=="string"&&n.name==="langchain_tracer"}function ES(n){return Array.isArray(n)&&n.some(e=>GC(e))}function S3(n){return typeof n=="object"&&n!=null&&Array.isArray(n.handlers)}function E3(n){var e;return n!==void 0&&typeof n.callbacks=="object"&&(ES((e=n.callbacks)==null?void 0:e.handlers)||ES(n.callbacks))}let C3=class{getStore(){}run(e,t){return t()}};const rg=Symbol.for("ls:tracing_async_local_storage"),P3=new C3;let k3=class{getInstance(){return globalThis[rg]??P3}initializeGlobalInstance(e){globalThis[rg]===void 0&&(globalThis[rg]=e)}};const R3=new k3,O3=()=>{const n=R3.getInstance().getStore();if(!ZC(n))throw new Error(["Could not get the current run tree.","","Please make sure you are calling this method within a traceable function and that tracing is enabled."].join(`
`));return n};function A_(n){return typeof n=="function"&&"langsmith:traceable"in n}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const T3=Object.prototype.hasOwnProperty;function Jg(n,e){return T3.call(n,e)}function Kg(n){if(Array.isArray(n)){const t=new Array(n.length);for(let r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(n);let e=[];for(let t in n)Jg(n,t)&&e.push(t);return e}function Wr(n){switch(typeof n){case"object":return JSON.parse(JSON.stringify(n));case"undefined":return null;default:return n}}function Xg(n){let e=0;const t=n.length;let r;for(;e<t;){if(r=n.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function Ii(n){return n.indexOf("/")===-1&&n.indexOf("~")===-1?n:n.replace(/~/g,"~0").replace(/\//g,"~1")}function A3(n){return n.replace(/~1/g,"/").replace(/~0/g,"~")}function Yg(n){if(n===void 0)return!0;if(n){if(Array.isArray(n)){for(let t=0,r=n.length;t<r;t++)if(Yg(n[t]))return!0}else if(typeof n=="object"){const t=Kg(n),r=t.length;for(var e=0;e<r;e++)if(Yg(n[t[e]]))return!0}}return!1}function CS(n,e){const t=[n];for(const r in e){const s=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof s<"u"&&t.push(`${r}: ${s}`)}return t.join(`
`)}class $3 extends Error{constructor(e,t,r,s,a){super(CS(e,{name:t,index:r,operation:s,tree:a})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.setPrototypeOf(this,new.target.prototype),this.message=CS(e,{name:t,index:r,operation:s,tree:a})}}const bt=$3,Wi={add:function(n,e,t){return n[e]=this.value,{newDocument:t}},remove:function(n,e,t){var r=n[e];return delete n[e],{newDocument:t,removed:r}},replace:function(n,e,t){var r=n[e];return n[e]=this.value,{newDocument:t,removed:r}},move:function(n,e,t){let r=Qg(t,this.path);r&&(r=Wr(r));const s=jl(t,{op:"remove",path:this.from}).removed;return jl(t,{op:"add",path:this.path,value:s}),{newDocument:t,removed:r}},copy:function(n,e,t){const r=Qg(t,this.from);return jl(t,{op:"add",path:this.path,value:Wr(r)}),{newDocument:t}},test:function(n,e,t){return{newDocument:t,test:Wd(n[e],this.value)}},_get:function(n,e,t){return this.value=n[e],{newDocument:t}}};var I3={add:function(n,e,t){return Xg(e)?n.splice(e,0,this.value):n[e]=this.value,{newDocument:t,index:e}},remove:function(n,e,t){var r=n.splice(e,1);return{newDocument:t,removed:r[0]}},replace:function(n,e,t){var r=n[e];return n[e]=this.value,{newDocument:t,removed:r}},move:Wi.move,copy:Wi.copy,test:Wi.test,_get:Wi._get};function Qg(n,e){if(e=="")return n;var t={op:"_get",path:e};return jl(n,t),t.value}function jl(n,e,t=!1,r=!0,s=!0,a=0){if(t&&(typeof t=="function"?t(e,0,n,e.path):ey(e,0)),e.path===""){let l={newDocument:n};if(e.op==="add")return l.newDocument=e.value,l;if(e.op==="replace")return l.newDocument=e.value,l.removed=n,l;if(e.op==="move"||e.op==="copy")return l.newDocument=Qg(n,e.from),e.op==="move"&&(l.removed=n),l;if(e.op==="test"){if(l.test=Wd(n,e.value),l.test===!1)throw new bt("Test operation failed","TEST_OPERATION_FAILED",a,e,n);return l.newDocument=n,l}else{if(e.op==="remove")return l.removed=n,l.newDocument=null,l;if(e.op==="_get")return e.value=n,l;if(t)throw new bt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,e,n);return l}}else{r||(n=Wr(n));const u=(e.path||"").split("/");let c=n,f=1,h=u.length,m,g,y;for(typeof t=="function"?y=t:y=ey;;){if(g=u[f],g&&g.indexOf("~")!=-1&&(g=A3(g)),s&&(g=="__proto__"||g=="prototype"&&f>0&&u[f-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(t&&m===void 0&&(c[g]===void 0?m=u.slice(0,f).join("/"):f==h-1&&(m=e.path),m!==void 0&&y(e,0,n,m)),f++,Array.isArray(c)){if(g==="-")g=c.length;else{if(t&&!Xg(g))throw new bt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,e,n);Xg(g)&&(g=~~g)}if(f>=h){if(t&&e.op==="add"&&g>c.length)throw new bt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,e,n);const w=I3[e.op].call(e,c,g,n);if(w.test===!1)throw new bt("Test operation failed","TEST_OPERATION_FAILED",a,e,n);return w}}else if(f>=h){const w=Wi[e.op].call(e,c,g,n);if(w.test===!1)throw new bt("Test operation failed","TEST_OPERATION_FAILED",a,e,n);return w}if(c=c[g],t&&f<h&&(!c||typeof c!="object"))throw new bt("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,e,n)}}}function Hd(n,e,t,r=!0,s=!0){if(t&&!Array.isArray(e))throw new bt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(n=Wr(n));const a=new Array(e.length);for(let l=0,u=e.length;l<u;l++)a[l]=jl(n,e[l],t,!0,s,l),n=a[l].newDocument;return a.newDocument=n,a}function ey(n,e,t,r){if(typeof n!="object"||n===null||Array.isArray(n))throw new bt("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,n,t);if(Wi[n.op]){if(typeof n.path!="string")throw new bt("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,n,t);if(n.path.indexOf("/")!==0&&n.path.length>0)throw new bt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,n,t);if((n.op==="move"||n.op==="copy")&&typeof n.from!="string")throw new bt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,n,t);if((n.op==="add"||n.op==="replace"||n.op==="test")&&n.value===void 0)throw new bt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,n,t);if((n.op==="add"||n.op==="replace"||n.op==="test")&&Yg(n.value))throw new bt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,n,t);if(t){if(n.op=="add"){var s=n.path.split("/").length,a=r.split("/").length;if(s!==a+1&&s!==a)throw new bt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,n,t)}else if(n.op==="replace"||n.op==="remove"||n.op==="_get"){if(n.path!==r)throw new bt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,n,t)}else if(n.op==="move"||n.op==="copy"){var l={op:"_get",path:n.from,value:void 0},u=N3([l],t);if(u&&u.name==="OPERATION_PATH_UNRESOLVABLE")throw new bt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,n,t)}}}else throw new bt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,n,t)}function N3(n,e,t){try{if(!Array.isArray(n))throw new bt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)Hd(Wr(e),Wr(n),t||!0);else{t=t||ey;for(var r=0;r<n.length;r++)t(n[r],r,e,void 0)}}catch(s){if(s instanceof bt)return s;throw s}}function Wd(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){var t=Array.isArray(n),r=Array.isArray(e),s,a,l;if(t&&r){if(a=n.length,a!=e.length)return!1;for(s=a;s--!==0;)if(!Wd(n[s],e[s]))return!1;return!0}if(t!=r)return!1;var u=Object.keys(n);if(a=u.length,a!==Object.keys(e).length)return!1;for(s=a;s--!==0;)if(!e.hasOwnProperty(u[s]))return!1;for(s=a;s--!==0;)if(l=u[s],!Wd(n[l],e[l]))return!1;return!0}return n!==n&&e!==e}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2013-2021 Joachim Wester
 * MIT license
 */function JC(n,e,t,r,s){if(e!==n){typeof e.toJSON=="function"&&(e=e.toJSON());for(var a=Kg(e),l=Kg(n),u=!1,c=l.length-1;c>=0;c--){var f=l[c],h=n[f];if(Jg(e,f)&&!(e[f]===void 0&&h!==void 0&&Array.isArray(e)===!1)){var m=e[f];typeof h=="object"&&h!=null&&typeof m=="object"&&m!=null&&Array.isArray(h)===Array.isArray(m)?JC(h,m,t,r+"/"+Ii(f),s):h!==m&&(s&&t.push({op:"test",path:r+"/"+Ii(f),value:Wr(h)}),t.push({op:"replace",path:r+"/"+Ii(f),value:Wr(m)}))}else Array.isArray(n)===Array.isArray(e)?(s&&t.push({op:"test",path:r+"/"+Ii(f),value:Wr(h)}),t.push({op:"remove",path:r+"/"+Ii(f)}),u=!0):(s&&t.push({op:"test",path:r,value:n}),t.push({op:"replace",path:r,value:e}))}if(!(!u&&a.length==l.length))for(var c=0;c<a.length;c++){var f=a[c];!Jg(n,f)&&e[f]!==void 0&&t.push({op:"add",path:r+"/"+Ii(f),value:Wr(e[f])})}}}function j3(n,e,t=!1){var r=[];return JC(n,e,r,"",t),r}var sg={};const L3=()=>typeof window<"u"&&typeof window.document<"u",M3=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",D3=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),$_=()=>typeof Deno<"u",F3=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!$_(),U3=()=>{let n;return L3()?n="browser":F3()?n="node":M3()?n="webworker":D3()?n="jsdom":$_()?n="deno":n="other",n};let ag;async function z3(){return ag===void 0&&(ag={library:"langchain-js",runtime:U3()}),ag}function Jr(n){try{return typeof process<"u"?sg==null?void 0:sg[n]:$_()?Deno==null?void 0:Deno.env.get(n):void 0}catch{return}}class B3{}function H3(n){return"lc_prefer_streaming"in n&&n.lc_prefer_streaming}class Cu extends B3{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,CC(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:Jr("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return Ja.prototype.toJSON.call(this)}toJSONNotImplemented(){return Ja.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class t extends Cu{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Qt()}),Object.assign(this,e)}}return new t}}const W3=n=>{const e=n;return e!==void 0&&typeof e.copy=="function"&&typeof e.name=="string"&&typeof e.awaitHandlers=="boolean"};function ig(n,e){return n&&!Array.isArray(n)&&typeof n=="object"?n:{[e]:n}}function V3(n){return n.replace(/[-:.]/g,"")}function q3(n,e,t){const r=t.toFixed(0).slice(0,3).padStart(3,"0");return V3(`${new Date(n).toISOString().slice(0,-1)}${r}Z`)+e}function vl(n){return typeof n._addRunToRunMap=="function"}class Pu extends Cu{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e!=null&&e.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,t){e.child_runs.push(t)}_addRunToRunMap(e){const t=q3(e.start_time,e.id,e.execution_order),r={...e};if(r.parent_run_id!==void 0){const s=this.runMap.get(r.parent_run_id);s&&(this._addChildRun(s,r),s.child_execution_order=Math.max(s.child_execution_order,r.child_execution_order),r.trace_id=s.trace_id,s.dotted_order!==void 0&&(r.dotted_order=[s.dotted_order,t].join(".")))}else r.trace_id=r.id,r.dotted_order=t;return this.runMap.set(r.id,r),r}async _endTrace(e){var r;const t=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await((r=this.onRunUpdate)==null?void 0:r.call(this,e))}_getExecutionOrder(e){const t=e!==void 0&&this.runMap.get(e);return t?t.child_execution_order+1:1}_createRunForLLMStart(e,t,r,s,a,l,u,c){const f=this._getExecutionOrder(s),h=Date.now(),m=u?{...a,metadata:u}:a,g={id:r,name:c??e.id[e.id.length-1],parent_run_id:s,start_time:h,serialized:e,events:[{name:"start",time:new Date(h).toISOString()}],inputs:{prompts:t},execution_order:f,child_runs:[],child_execution_order:f,run_type:"llm",extra:m??{},tags:l||[]};return this._addRunToRunMap(g)}async handleLLMStart(e,t,r,s,a,l,u,c){var h,m;const f=this.runMap.get(r)??this._createRunForLLMStart(e,t,r,s,a,l,u,c);return await((h=this.onRunCreate)==null?void 0:h.call(this,f)),await((m=this.onLLMStart)==null?void 0:m.call(this,f)),f}_createRunForChatModelStart(e,t,r,s,a,l,u,c){const f=this._getExecutionOrder(s),h=Date.now(),m=u?{...a,metadata:u}:a,g={id:r,name:c??e.id[e.id.length-1],parent_run_id:s,start_time:h,serialized:e,events:[{name:"start",time:new Date(h).toISOString()}],inputs:{messages:t},execution_order:f,child_runs:[],child_execution_order:f,run_type:"llm",extra:m??{},tags:l||[]};return this._addRunToRunMap(g)}async handleChatModelStart(e,t,r,s,a,l,u,c){var h,m;const f=this.runMap.get(r)??this._createRunForChatModelStart(e,t,r,s,a,l,u,c);return await((h=this.onRunCreate)==null?void 0:h.call(this,f)),await((m=this.onLLMStart)==null?void 0:m.call(this,f)),f}async handleLLMEnd(e,t,r,s,a){var u;const l=this.runMap.get(t);if(!l||(l==null?void 0:l.run_type)!=="llm")throw new Error("No LLM run to end.");return l.end_time=Date.now(),l.outputs=e,l.events.push({name:"end",time:new Date(l.end_time).toISOString()}),l.extra={...l.extra,...a},await((u=this.onLLMEnd)==null?void 0:u.call(this,l)),await this._endTrace(l),l}async handleLLMError(e,t,r,s,a){var u;const l=this.runMap.get(t);if(!l||(l==null?void 0:l.run_type)!=="llm")throw new Error("No LLM run to end.");return l.end_time=Date.now(),l.error=this.stringifyError(e),l.events.push({name:"error",time:new Date(l.end_time).toISOString()}),l.extra={...l.extra,...a},await((u=this.onLLMError)==null?void 0:u.call(this,l)),await this._endTrace(l),l}_createRunForChainStart(e,t,r,s,a,l,u,c){const f=this._getExecutionOrder(s),h=Date.now(),m={id:r,name:c??e.id[e.id.length-1],parent_run_id:s,start_time:h,serialized:e,events:[{name:"start",time:new Date(h).toISOString()}],inputs:t,execution_order:f,child_execution_order:f,run_type:u??"chain",child_runs:[],extra:l?{metadata:l}:{},tags:a||[]};return this._addRunToRunMap(m)}async handleChainStart(e,t,r,s,a,l,u,c){var h,m;const f=this.runMap.get(r)??this._createRunForChainStart(e,t,r,s,a,l,u,c);return await((h=this.onRunCreate)==null?void 0:h.call(this,f)),await((m=this.onChainStart)==null?void 0:m.call(this,f)),f}async handleChainEnd(e,t,r,s,a){var u;const l=this.runMap.get(t);if(!l)throw new Error("No chain run to end.");return l.end_time=Date.now(),l.outputs=ig(e,"output"),l.events.push({name:"end",time:new Date(l.end_time).toISOString()}),(a==null?void 0:a.inputs)!==void 0&&(l.inputs=ig(a.inputs,"input")),await((u=this.onChainEnd)==null?void 0:u.call(this,l)),await this._endTrace(l),l}async handleChainError(e,t,r,s,a){var u;const l=this.runMap.get(t);if(!l)throw new Error("No chain run to end.");return l.end_time=Date.now(),l.error=this.stringifyError(e),l.events.push({name:"error",time:new Date(l.end_time).toISOString()}),(a==null?void 0:a.inputs)!==void 0&&(l.inputs=ig(a.inputs,"input")),await((u=this.onChainError)==null?void 0:u.call(this,l)),await this._endTrace(l),l}_createRunForToolStart(e,t,r,s,a,l,u){const c=this._getExecutionOrder(s),f=Date.now(),h={id:r,name:u??e.id[e.id.length-1],parent_run_id:s,start_time:f,serialized:e,events:[{name:"start",time:new Date(f).toISOString()}],inputs:{input:t},execution_order:c,child_execution_order:c,run_type:"tool",child_runs:[],extra:l?{metadata:l}:{},tags:a||[]};return this._addRunToRunMap(h)}async handleToolStart(e,t,r,s,a,l,u){var f,h;const c=this.runMap.get(r)??this._createRunForToolStart(e,t,r,s,a,l,u);return await((f=this.onRunCreate)==null?void 0:f.call(this,c)),await((h=this.onToolStart)==null?void 0:h.call(this,c)),c}async handleToolEnd(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((s=this.onToolEnd)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleToolError(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((s=this.onToolError)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleAgentAction(e,t){var a;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="chain")return;const s=r;s.actions=s.actions||[],s.actions.push(e),s.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((a=this.onAgentAction)==null?void 0:a.call(this,r))}async handleAgentEnd(e,t){var s;const r=this.runMap.get(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((s=this.onAgentEnd)==null?void 0:s.call(this,r)))}_createRunForRetrieverStart(e,t,r,s,a,l,u){const c=this._getExecutionOrder(s),f=Date.now(),h={id:r,name:u??e.id[e.id.length-1],parent_run_id:s,start_time:f,serialized:e,events:[{name:"start",time:new Date(f).toISOString()}],inputs:{query:t},execution_order:c,child_execution_order:c,run_type:"retriever",child_runs:[],extra:l?{metadata:l}:{},tags:a||[]};return this._addRunToRunMap(h)}async handleRetrieverStart(e,t,r,s,a,l,u){var f,h;const c=this.runMap.get(r)??this._createRunForRetrieverStart(e,t,r,s,a,l,u);return await((f=this.onRunCreate)==null?void 0:f.call(this,c)),await((h=this.onRetrieverStart)==null?void 0:h.call(this,c)),c}async handleRetrieverEnd(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((s=this.onRetrieverEnd)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleRetrieverError(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((s=this.onRetrieverError)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleText(e,t){var s;const r=this.runMap.get(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((s=this.onText)==null?void 0:s.call(this,r)))}async handleLLMNewToken(e,t,r,s,a,l){var c;const u=this.runMap.get(r);if(!u||(u==null?void 0:u.run_type)!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return u.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:t,chunk:l==null?void 0:l.chunk}}),await((c=this.onLLMNewToken)==null?void 0:c.call(this,u,e,{chunk:l==null?void 0:l.chunk})),u}}var yd={exports:{}};yd.exports;var PS;function Z3(){return PS||(PS=1,function(n){const t=(a=0)=>l=>`\x1B[${38+a};5;${l}m`,r=(a=0)=>(l,u,c)=>`\x1B[${38+a};2;${l};${u};${c}m`;function s(){const a=new Map,l={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};l.color.gray=l.color.blackBright,l.bgColor.bgGray=l.bgColor.bgBlackBright,l.color.grey=l.color.blackBright,l.bgColor.bgGrey=l.bgColor.bgBlackBright;for(const[u,c]of Object.entries(l)){for(const[f,h]of Object.entries(c))l[f]={open:`\x1B[${h[0]}m`,close:`\x1B[${h[1]}m`},c[f]=l[f],a.set(h[0],h[1]);Object.defineProperty(l,u,{value:c,enumerable:!1})}return Object.defineProperty(l,"codes",{value:a,enumerable:!1}),l.color.close="\x1B[39m",l.bgColor.close="\x1B[49m",l.color.ansi256=t(),l.color.ansi16m=r(),l.bgColor.ansi256=t(10),l.bgColor.ansi16m=r(10),Object.defineProperties(l,{rgbToAnsi256:{value:(u,c,f)=>u===c&&c===f?u<8?16:u>248?231:Math.round((u-8)/247*24)+232:16+36*Math.round(u/255*5)+6*Math.round(c/255*5)+Math.round(f/255*5),enumerable:!1},hexToRgb:{value:u=>{const c=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(u.toString(16));if(!c)return[0,0,0];let{colorString:f}=c.groups;f.length===3&&(f=f.split("").map(m=>m+m).join(""));const h=Number.parseInt(f,16);return[h>>16&255,h>>8&255,h&255]},enumerable:!1},hexToAnsi256:{value:u=>l.rgbToAnsi256(...l.hexToRgb(u)),enumerable:!1}}),l}Object.defineProperty(n,"exports",{enumerable:!0,get:s})}(yd)),yd.exports}var G3=Z3();const KC=ti(G3);function on(n,e){return`${n.open}${e}${n.close}`}function Jn(n,e){try{return JSON.stringify(n,null,2)}catch{return e}}function kS(n){return typeof n=="string"?n.trim():n==null?n:Jn(n,n.toString())}function ta(n){if(!n.end_time)return"";const e=n.end_time-n.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:vn}=KC;class RS extends Pu{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const t=[];let r=e;for(;r.parent_run_id;){const s=this.runMap.get(r.parent_run_id);if(s)t.push(s),r=s;else break}return t}getBreadcrumbs(e){const r=[...this.getParents(e).reverse(),e].map((s,a,l)=>{const u=`${s.execution_order}:${s.run_type}:${s.name}`;return a===l.length-1?on(KC.bold,u):u}).join(" > ");return on(vn.grey,r)}onChainStart(e){const t=this.getBreadcrumbs(e);console.log(`${on(vn.green,"[chain/start]")} [${t}] Entering Chain run with input: ${Jn(e.inputs,"[inputs]")}`)}onChainEnd(e){const t=this.getBreadcrumbs(e);console.log(`${on(vn.cyan,"[chain/end]")} [${t}] [${ta(e)}] Exiting Chain run with output: ${Jn(e.outputs,"[outputs]")}`)}onChainError(e){const t=this.getBreadcrumbs(e);console.log(`${on(vn.red,"[chain/error]")} [${t}] [${ta(e)}] Chain run errored with error: ${Jn(e.error,"[error]")}`)}onLLMStart(e){const t=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(s=>s.trim())}:e.inputs;console.log(`${on(vn.green,"[llm/start]")} [${t}] Entering LLM run with input: ${Jn(r,"[inputs]")}`)}onLLMEnd(e){const t=this.getBreadcrumbs(e);console.log(`${on(vn.cyan,"[llm/end]")} [${t}] [${ta(e)}] Exiting LLM run with output: ${Jn(e.outputs,"[response]")}`)}onLLMError(e){const t=this.getBreadcrumbs(e);console.log(`${on(vn.red,"[llm/error]")} [${t}] [${ta(e)}] LLM run errored with error: ${Jn(e.error,"[error]")}`)}onToolStart(e){const t=this.getBreadcrumbs(e);console.log(`${on(vn.green,"[tool/start]")} [${t}] Entering Tool run with input: "${kS(e.inputs.input)}"`)}onToolEnd(e){var r;const t=this.getBreadcrumbs(e);console.log(`${on(vn.cyan,"[tool/end]")} [${t}] [${ta(e)}] Exiting Tool run with output: "${kS((r=e.outputs)==null?void 0:r.output)}"`)}onToolError(e){const t=this.getBreadcrumbs(e);console.log(`${on(vn.red,"[tool/error]")} [${t}] [${ta(e)}] Tool run errored with error: ${Jn(e.error,"[error]")}`)}onRetrieverStart(e){const t=this.getBreadcrumbs(e);console.log(`${on(vn.green,"[retriever/start]")} [${t}] Entering Retriever run with input: ${Jn(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const t=this.getBreadcrumbs(e);console.log(`${on(vn.cyan,"[retriever/end]")} [${t}] [${ta(e)}] Exiting Retriever run with output: ${Jn(e.outputs,"[outputs]")}`)}onRetrieverError(e){const t=this.getBreadcrumbs(e);console.log(`${on(vn.red,"[retriever/error]")} [${t}] [${ta(e)}] Retriever run errored with error: ${Jn(e.error,"[error]")}`)}onAgentAction(e){const t=e,r=this.getBreadcrumbs(e);console.log(`${on(vn.blue,"[agent/action]")} [${r}] Agent selected action: ${Jn(t.actions[t.actions.length-1],"[action]")}`)}}let og;const J3=()=>{if(og===void 0){const n=Jr("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{};og=new au(n)}return og};class Ll extends Pu{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:t,projectName:r,client:s}=e;this.projectName=r??Jr("LANGCHAIN_PROJECT")??Jr("LANGCHAIN_SESSION"),this.exampleId=t,this.client=s??J3();const a=Ll.getTraceableRunTree();a&&this.updateFromRunTree(a)}async _convertToCreate(e,t=void 0){return{...e,extra:{...e.extra,runtime:await z3()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:t}}async persistRun(e){}async onRunCreate(e){const t=await this._convertToCreate(e,this.exampleId);await this.client.createRun(t)}async onRunUpdate(e){const t={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id,extra:e.extra,session_name:this.projectName};await this.client.updateRun(e.id,t)}getRun(e){return this.runMap.get(e)}updateFromRunTree(e){let t=e;const r=new Set;for(;t.parent_run&&!(r.has(t.id)||(r.add(t.id),!t.parent_run));)t=t.parent_run;r.clear();const s=[t];for(;s.length>0;){const a=s.shift();!a||r.has(a.id)||(r.add(a.id),this.runMap.set(a.id,a),a.child_runs&&s.push(...a.child_runs))}this.client=e.client??this.client,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}convertToRunTree(e){const t={},r=[];for(const[s,a]of this.runMap){const l=new jn({...a,child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0});t[s]=l,r.push([s,a.dotted_order])}r.sort((s,a)=>!s[1]||!a[1]?0:s[1].localeCompare(a[1]));for(const[s]of r){const a=this.runMap.get(s),l=t[s];if(!(!a||!l)&&a.parent_run_id){const u=t[a.parent_run_id];u&&(u.child_runs.push(l),l.parent_run=u)}}return t[e]}static getTraceableRunTree(){try{return O3()}catch{return}}}const XC=Symbol.for("ls:tracing_async_local_storage"),_d=Symbol.for("lc:context_variables"),K3=n=>{globalThis[XC]=n},iu=()=>globalThis[XC];let Ml;function X3(){const n="default"in ks?ks.default:ks;return new n({autoStart:!0,concurrency:1})}function Y3(){return typeof Ml>"u"&&(Ml=X3()),Ml}async function kt(n,e){if(e===!0){const t=iu();t!==void 0?await t.run(void 0,async()=>n()):await n()}else Ml=Y3(),Ml.add(async()=>{const t=iu();t!==void 0?await t.run(void 0,async()=>n()):await n()})}const Q3=n=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(t=>Jr(t)==="true");function YC(n){var r;const e=iu();if(e===void 0)return;const t=e.getStore();return(r=t==null?void 0:t[_d])==null?void 0:r[n]}const eM=Symbol("lc:configure_hooks"),tM=()=>YC(eM)||[];class nM{setHandler(e){return this.setHandlers([e])}}class $f{constructor(e,t,r,s,a,l,u,c){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:u}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:c})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(t=>kt(async()=>{var r;try{await((r=t.handleText)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleText: ${s}`),t.raiseError)throw s}},t.awaitHandlers)))}async handleCustomEvent(e,t,r,s,a){await Promise.all(this.handlers.map(l=>kt(async()=>{var u;try{await((u=l.handleCustomEvent)==null?void 0:u.call(l,e,t,this.runId,this.tags,this.metadata))}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleCustomEvent: ${c}`),l.raiseError)throw c}},l.awaitHandlers)))}}class rM extends $f{getChild(e){const t=new Sn(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(t=>kt(async()=>{var r;if(!t.ignoreRetriever)try{await((r=t.handleRetrieverEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetriever`),t.raiseError)throw s}},t.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(t=>kt(async()=>{var r;if(!t.ignoreRetriever)try{await((r=t.handleRetrieverError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetrieverError: ${s}`),t.raiseError)throw e}},t.awaitHandlers)))}}class OS extends $f{async handleLLMNewToken(e,t,r,s,a,l){await Promise.all(this.handlers.map(u=>kt(async()=>{var c;if(!u.ignoreLLM)try{await((c=u.handleLLMNewToken)==null?void 0:c.call(u,e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,l))}catch(f){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleLLMNewToken: ${f}`),u.raiseError)throw f}},u.awaitHandlers)))}async handleLLMError(e,t,r,s,a){await Promise.all(this.handlers.map(l=>kt(async()=>{var u;if(!l.ignoreLLM)try{await((u=l.handleLLMError)==null?void 0:u.call(l,e,this.runId,this._parentRunId,this.tags,a))}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleLLMError: ${c}`),l.raiseError)throw c}},l.awaitHandlers)))}async handleLLMEnd(e,t,r,s,a){await Promise.all(this.handlers.map(l=>kt(async()=>{var u;if(!l.ignoreLLM)try{await((u=l.handleLLMEnd)==null?void 0:u.call(l,e,this.runId,this._parentRunId,this.tags,a))}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleLLMEnd: ${c}`),l.raiseError)throw c}},l.awaitHandlers)))}}class sM extends $f{getChild(e){const t=new Sn(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,r,s,a){await Promise.all(this.handlers.map(l=>kt(async()=>{var u;if(!l.ignoreChain)try{await((u=l.handleChainError)==null?void 0:u.call(l,e,this.runId,this._parentRunId,this.tags,a))}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleChainError: ${c}`),l.raiseError)throw c}},l.awaitHandlers)))}async handleChainEnd(e,t,r,s,a){await Promise.all(this.handlers.map(l=>kt(async()=>{var u;if(!l.ignoreChain)try{await((u=l.handleChainEnd)==null?void 0:u.call(l,e,this.runId,this._parentRunId,this.tags,a))}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleChainEnd: ${c}`),l.raiseError)throw c}},l.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>kt(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentAction)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentAction: ${s}`),t.raiseError)throw s}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>kt(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentEnd: ${s}`),t.raiseError)throw s}},t.awaitHandlers)))}}class aM extends $f{getChild(e){const t=new Sn(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>kt(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolError: ${s}`),t.raiseError)throw s}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>kt(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolEnd: ${s}`),t.raiseError)throw s}},t.awaitHandlers)))}}class Sn extends nM{constructor(e,t){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=(t==null?void 0:t.handlers)??this.handlers,this.inheritableHandlers=(t==null?void 0:t.inheritableHandlers)??this.inheritableHandlers,this.tags=(t==null?void 0:t.tags)??this.tags,this.inheritableTags=(t==null?void 0:t.inheritableTags)??this.inheritableTags,this.metadata=(t==null?void 0:t.metadata)??this.metadata,this.inheritableMetadata=(t==null?void 0:t.inheritableMetadata)??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,t,r=void 0,s=void 0,a=void 0,l=void 0,u=void 0,c=void 0){return Promise.all(t.map(async(f,h)=>{const m=h===0&&r?r:Qt();return await Promise.all(this.handlers.map(g=>{if(!g.ignoreLLM)return vl(g)&&g._createRunForLLMStart(e,[f],m,this._parentRunId,a,this.tags,this.metadata,c),kt(async()=>{var y;try{await((y=g.handleLLMStart)==null?void 0:y.call(g,e,[f],m,this._parentRunId,a,this.tags,this.metadata,c))}catch(w){if((g.raiseError?console.error:console.warn)(`Error in handler ${g.constructor.name}, handleLLMStart: ${w}`),g.raiseError)throw w}},g.awaitHandlers)})),new OS(m,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,r=void 0,s=void 0,a=void 0,l=void 0,u=void 0,c=void 0){return Promise.all(t.map(async(f,h)=>{const m=h===0&&r?r:Qt();return await Promise.all(this.handlers.map(g=>{if(!g.ignoreLLM)return vl(g)&&g._createRunForChatModelStart(e,[f],m,this._parentRunId,a,this.tags,this.metadata,c),kt(async()=>{var y,w;try{if(g.handleChatModelStart)await((y=g.handleChatModelStart)==null?void 0:y.call(g,e,[f],m,this._parentRunId,a,this.tags,this.metadata,c));else if(g.handleLLMStart){const v=RC(f);await((w=g.handleLLMStart)==null?void 0:w.call(g,e,[v],m,this._parentRunId,a,this.tags,this.metadata,c))}}catch(v){if((g.raiseError?console.error:console.warn)(`Error in handler ${g.constructor.name}, handleLLMStart: ${v}`),g.raiseError)throw v}},g.awaitHandlers)})),new OS(m,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,r=Qt(),s=void 0,a=void 0,l=void 0,u=void 0){return await Promise.all(this.handlers.map(c=>{if(!c.ignoreChain)return vl(c)&&c._createRunForChainStart(e,t,r,this._parentRunId,this.tags,this.metadata,s,u),kt(async()=>{var f;try{await((f=c.handleChainStart)==null?void 0:f.call(c,e,t,r,this._parentRunId,this.tags,this.metadata,s,u))}catch(h){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleChainStart: ${h}`),c.raiseError)throw h}},c.awaitHandlers)})),new sM(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,r=Qt(),s=void 0,a=void 0,l=void 0,u=void 0){return await Promise.all(this.handlers.map(c=>{if(!c.ignoreAgent)return vl(c)&&c._createRunForToolStart(e,t,r,this._parentRunId,this.tags,this.metadata,u),kt(async()=>{var f;try{await((f=c.handleToolStart)==null?void 0:f.call(c,e,t,r,this._parentRunId,this.tags,this.metadata,u))}catch(h){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleToolStart: ${h}`),c.raiseError)throw h}},c.awaitHandlers)})),new aM(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,t,r=Qt(),s=void 0,a=void 0,l=void 0,u=void 0){return await Promise.all(this.handlers.map(c=>{if(!c.ignoreRetriever)return vl(c)&&c._createRunForRetrieverStart(e,t,r,this._parentRunId,this.tags,this.metadata,u),kt(async()=>{var f;try{await((f=c.handleRetrieverStart)==null?void 0:f.call(c,e,t,r,this._parentRunId,this.tags,this.metadata,u))}catch(h){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleRetrieverStart: ${h}`),c.raiseError)throw h}},c.awaitHandlers)})),new rM(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,t,r,s,a){await Promise.all(this.handlers.map(l=>kt(async()=>{var u;if(!l.ignoreCustomEvent)try{await((u=l.handleCustomEvent)==null?void 0:u.call(l,e,t,r,this.tags,this.metadata))}catch(c){if((l.raiseError?console.error:console.warn)(`Error in handler ${l.constructor.name}, handleCustomEvent: ${c}`),l.raiseError)throw c}},l.awaitHandlers)))}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){this.handlers=[],this.inheritableHandlers=[];for(const r of e)this.addHandler(r,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){const r=new Sn(this._parentRunId);for(const s of this.handlers){const a=this.inheritableHandlers.includes(s);r.addHandler(s,a)}for(const s of this.tags){const a=this.inheritableTags.includes(s);r.addTags([s],a)}for(const s of Object.keys(this.metadata)){const a=Object.keys(this.inheritableMetadata).includes(s);r.addMetadata({[s]:this.metadata[s]},a)}for(const s of e)r.handlers.filter(a=>a.name==="console_callback_handler").some(a=>a.name===s.name)||r.addHandler(s,t);return r}static fromHandlers(e){class t extends Cu{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Qt()}),Object.assign(this,e)}}const r=new this;return r.addHandler(new t),r}static configure(e,t,r,s,a,l,u){return this._configureSync(e,t,r,s,a,l,u)}static _configureSync(e,t,r,s,a,l,u){var g,y;let c;(e||t)&&(Array.isArray(e)||!e?(c=new Sn,c.setHandlers((e==null?void 0:e.map(Vd))??[],!0)):c=e,c=c.copy(Array.isArray(t)?t.map(Vd):t==null?void 0:t.handlers,!1));const f=Jr("LANGCHAIN_VERBOSE")==="true"||(u==null?void 0:u.verbose),h=((g=Ll.getTraceableRunTree())==null?void 0:g.tracingEnabled)||Q3(),m=h||(Jr("LANGCHAIN_TRACING")??!1);if(f||m){if(c||(c=new Sn),f&&!c.handlers.some(w=>w.name===RS.prototype.name)){const w=new RS;c.addHandler(w,!0)}if(m&&!c.handlers.some(w=>w.name==="langchain_tracer")&&h){const w=new Ll;c.addHandler(w,!0),c._parentRunId=((y=Ll.getTraceableRunTree())==null?void 0:y.id)??c._parentRunId}}for(const{contextVar:w,inheritable:v=!0,handlerClass:x,envVar:E}of tM()){const P=E&&Jr(E)==="true"&&x;let S;const R=w!==void 0?YC(w):void 0;R&&W3(R)?S=R:P&&(S=new x({})),S!==void 0&&(c||(c=new Sn),c.handlers.some($=>$.name===S.name)||c.addHandler(S,v))}return(r||s)&&c&&(c.addTags(r??[]),c.addTags(s??[],!1)),(a||l)&&c&&(c.addMetadata(a??{}),c.addMetadata(l??{},!1)),c}}function Vd(n){return"name"in n?n:Cu.fromMethods(n)}class iM{getStore(){}run(e,t){return t()}enterWith(e){}}const oM=new iM,TS=Symbol.for("lc:child_config");class lM{getInstance(){return iu()??oM}getRunnableConfig(){var t,r;return(r=(t=this.getInstance().getStore())==null?void 0:t.extra)==null?void 0:r[TS]}runWithConfig(e,t,r){var h;const s=Sn._configureSync(e==null?void 0:e.callbacks,void 0,e==null?void 0:e.tags,void 0,e==null?void 0:e.metadata),a=this.getInstance(),l=a.getStore(),u=s==null?void 0:s.getParentRunId(),c=(h=s==null?void 0:s.handlers)==null?void 0:h.find(m=>(m==null?void 0:m.name)==="langchain_tracer");let f;return c&&u?f=c.convertToRunTree(u):r||(f=new jn({name:"<runnable_lambda>",tracingEnabled:!1})),f&&(f.extra={...f.extra,[TS]:e}),l!==void 0&&l[_d]!==void 0&&(f===void 0&&(f={}),f[_d]=l[_d]),a.run(f,t)}initializeGlobalInstance(e){iu()===void 0&&K3(e)}}const ma=new lM,lg=25;async function Er(n){return Sn._configureSync(n==null?void 0:n.callbacks,void 0,n==null?void 0:n.tags,void 0,n==null?void 0:n.metadata)}function AS(...n){const e={};for(const t of n.filter(r=>!!r))for(const r of Object.keys(t))if(r==="metadata")e[r]={...e[r],...t[r]};else if(r==="tags"){const s=e[r]??[];e[r]=[...new Set(s.concat(t[r]??[]))]}else if(r==="configurable")e[r]={...e[r],...t[r]};else if(r==="timeout")e.timeout===void 0?e.timeout=t.timeout:t.timeout!==void 0&&(e.timeout=Math.min(e.timeout,t.timeout));else if(r==="signal")e.signal===void 0?e.signal=t.signal:t.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,t.signal]):e.signal=t.signal);else if(r==="callbacks"){const s=e.callbacks,a=t.callbacks;if(Array.isArray(a))if(!s)e.callbacks=a;else if(Array.isArray(s))e.callbacks=s.concat(a);else{const l=s.copy();for(const u of a)l.addHandler(Vd(u),!0);e.callbacks=l}else if(a)if(!s)e.callbacks=a;else if(Array.isArray(s)){const l=a.copy();for(const u of s)l.addHandler(Vd(u),!0);e.callbacks=l}else e.callbacks=new Sn(a._parentRunId,{handlers:s.handlers.concat(a.handlers),inheritableHandlers:s.inheritableHandlers.concat(a.inheritableHandlers),tags:Array.from(new Set(s.tags.concat(a.tags))),inheritableTags:Array.from(new Set(s.inheritableTags.concat(a.inheritableTags))),metadata:{...s.metadata,...a.metadata}})}else{const s=r;e[s]=t[s]??e[s]}return e}const uM=new Set(["string","number","boolean"]);function Ze(n){var r;const e=ma.getRunnableConfig();let t={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:s,runName:a,...l}=e;t=Object.entries(l).reduce((u,[c,f])=>(f!==void 0&&(u[c]=f),u),t)}if(n&&(t=Object.entries(n).reduce((s,[a,l])=>(l!==void 0&&(s[a]=l),s),t)),t!=null&&t.configurable)for(const s of Object.keys(t.configurable))uM.has(typeof t.configurable[s])&&!((r=t.metadata)!=null&&r[s])&&(t.metadata||(t.metadata={}),t.metadata[s]=t.configurable[s]);if(t.timeout!==void 0){if(t.timeout<=0)throw new Error("Timeout must be a positive number");const s=AbortSignal.timeout(t.timeout);t.signal!==void 0?"any"in AbortSignal&&(t.signal=AbortSignal.any([t.signal,s])):t.signal=s,delete t.timeout}return t}function en(n={},{callbacks:e,maxConcurrency:t,recursionLimit:r,runName:s,configurable:a,runId:l}={}){const u=Ze(n);return e!==void 0&&(delete u.runName,u.callbacks=e),r!==void 0&&(u.recursionLimit=r),t!==void 0&&(u.maxConcurrency=t),s!==void 0&&(u.runName=s),a!==void 0&&(u.configurable={...u.configurable,...a}),l!==void 0&&delete u.runId,u}function ao(n){return n?{configurable:n.configurable,recursionLimit:n.recursionLimit,callbacks:n.callbacks,tags:n.tags,metadata:n.metadata,maxConcurrency:n.maxConcurrency,timeout:n.timeout,signal:n.signal}:void 0}async function ga(n,e){if(e===void 0)return n;let t;return Promise.race([n.catch(r=>{if(!(e!=null&&e.aborted))throw r}),new Promise((r,s)=>{t=()=>{s(new Error("Aborted"))},e.addEventListener("abort",t),e.aborted&&s(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",t))}class Fn extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const t=this.reader.cancel();this.reader.releaseLock(),await t}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const t=e.getReader();return new Fn({start(r){return s();function s(){return t.read().then(({done:a,value:l})=>{if(a){r.close();return}return r.enqueue(l),s()})}},cancel(){t.releaseLock()}})}static fromAsyncGenerator(e){return new Fn({async pull(t){const{value:r,done:s}=await e.next();s&&t.close(),t.enqueue(r)},async cancel(t){await e.return(t)}})}}function QC(n,e=2){const t=Array.from({length:e},()=>[]);return t.map(async function*(s){for(;;)if(s.length===0){const a=await n.next();for(const l of t)l.push(a)}else{if(s[0].done)return;yield s.shift().value}})}function Xn(n,e){if(Array.isArray(n)&&Array.isArray(e))return n.concat(e);if(typeof n=="string"&&typeof e=="string")return n+e;if(typeof n=="number"&&typeof e=="number")return n+e;if("concat"in n&&typeof n.concat=="function")return n.concat(e);if(typeof n=="object"&&typeof e=="object"){const t={...n};for(const[r,s]of Object.entries(e))r in t&&!Array.isArray(t[r])?t[r]=Xn(t[r],s):t[r]=s;return t}else throw new Error(`Cannot concat ${typeof n} and ${typeof e}`)}class vo{constructor(e){var t;Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??((t=this.config)==null?void 0:t.signal),this.setup=new Promise((r,s)=>{ma.runWithConfig(ao(e.config),async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(r,s):this.firstResult.then(a=>r(void 0),s)},!0)})}async next(...e){var t;return(t=this.signal)==null||t.throwIfAborted(),this.firstResultUsed?ma.runWithConfig(ao(this.config),this.signal?async()=>ga(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function cM(n,e,t,r,...s){const a=new vo({generator:e,startSetup:t,signal:r}),l=await a.setup;return{output:n(a,l,...s),setup:l}}class aa{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const t=this.ops.concat(e.ops),r=Hd({},t);return new ou({ops:t,state:r[r.length-1].newDocument})}}class ou extends aa{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const t=this.ops.concat(e.ops),r=Hd(this.state,e.ops);return new ou({ops:t,state:r[r.length-1].newDocument})}static fromRunLogPatch(e){const t=Hd({},e.ops);return new ou({ops:e.ops,state:t[t.length-1].newDocument})}}const dM=n=>n.name==="log_stream_tracer";async function $S(n,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:t}=n;if(["retriever","llm","prompt"].includes(n.run_type))return t;if(!(Object.keys(t).length===1&&(t==null?void 0:t.input)===""))return t.input}async function IS(n,e){const{outputs:t}=n;return e==="original"||["retriever","llm","prompt"].includes(n.run_type)?t:t!==void 0&&Object.keys(t).length===1&&(t==null?void 0:t.output)!==void 0?t.output:t}function fM(n){return n!==void 0&&n.message!==void 0}class NS extends Pu{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this._schemaFormat=(e==null?void 0:e._schemaFormat)??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=Fn.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const t=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(r=r||t.find(s=>{var a;return(a=this.includeTags)==null?void 0:a.includes(s)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(r=r&&t.every(s=>{var a;return!((a=this.excludeTags)!=null&&a.includes(s))})),r}async*tapOutputIterable(e,t){for await(const r of t){if(e!==this.rootId){const s=this.keyMapByRunId[e];s&&await this.writer.write(new aa({ops:[{op:"add",path:`/logs/${s}/streamed_output/-`,value:r}]}))}yield r}}async onRunCreate(e){var s;if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new aa({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const t=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=t===1?e.name:`${e.name}:${t}`;const r={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(r.inputs=await $S(e,this._schemaFormat)),await this.writer.write(new aa({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:r}]}))}async onRunUpdate(e){try{const t=this.keyMapByRunId[e.id];if(t===void 0)return;const r=[];this._schemaFormat==="streaming_events"&&r.push({op:"replace",path:`/logs/${t}/inputs`,value:await $S(e,this._schemaFormat)}),r.push({op:"add",path:`/logs/${t}/final_output`,value:await IS(e,this._schemaFormat)}),e.end_time!==void 0&&r.push({op:"add",path:`/logs/${t}/end_time`,value:new Date(e.end_time).toISOString()});const s=new aa({ops:r});await this.writer.write(s)}finally{if(e.id===this.rootId){const t=new aa({ops:[{op:"replace",path:"/final_output",value:await IS(e,this._schemaFormat)}]});await this.writer.write(t),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,t,r){const s=this.keyMapByRunId[e.id];if(s===void 0)return;const a=e.inputs.messages!==void 0;let l;a?fM(r==null?void 0:r.chunk)?l=r==null?void 0:r.chunk:l=new Qr({id:`run-${e.id}`,content:t}):l=t;const u=new aa({ops:[{op:"add",path:`/logs/${s}/streamed_output_str/-`,value:t},{op:"add",path:`/logs/${s}/streamed_output/-`,value:l}]});await this.writer.write(u)}}const jS="__run";class io{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new io({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class Kr extends io{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new Kr({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}function td({name:n,serialized:e}){return n!==void 0?n:(e==null?void 0:e.name)!==void 0?e.name:(e==null?void 0:e.id)!==void 0&&Array.isArray(e==null?void 0:e.id)?e.id[e.id.length-1]:"Unnamed"}const hM=n=>n.name==="event_stream_tracer";class pM extends Pu{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=Fn.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const t=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(r=r||t.find(s=>{var a;return(a=this.includeTags)==null?void 0:a.includes(s)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(r=r&&t.every(s=>{var a;return!((a=this.excludeTags)!=null&&a.includes(s))})),r}async*tapOutputIterable(e,t){const r=await t.next();if(r.done)return;const s=this.runInfoMap.get(e);if(s===void 0){yield r.value;return}function a(u,c){return u==="llm"&&typeof c=="string"?new io({text:c}):c}let l=this.tappedPromises.get(e);if(l===void 0){let u;l=new Promise(c=>{u=c}),this.tappedPromises.set(e,l);try{const c={event:`on_${s.runType}_stream`,run_id:e,name:s.name,tags:s.tags,metadata:s.metadata,data:{}};await this.send({...c,data:{chunk:a(s.runType,r.value)}},s),yield r.value;for await(const f of t)s.runType!=="tool"&&s.runType!=="retriever"&&await this.send({...c,data:{chunk:a(s.runType,f)}},s),yield f}finally{u()}}else{yield r.value;for await(const u of t)yield u}}async send(e,t){this._includeRun(t)&&await this.writer.write(e)}async sendEndEvent(e,t){const r=this.tappedPromises.get(e.run_id);r!==void 0?r.then(()=>{this.send(e,t)}):await this.send(e,t)}async onLLMStart(e){var l,u;const t=td(e),r=e.inputs.messages!==void 0?"chat_model":"llm",s={tags:e.tags??[],metadata:((l=e.extra)==null?void 0:l.metadata)??{},name:t,runType:r,inputs:e.inputs};this.runInfoMap.set(e.id,s);const a=`on_${r}_start`;await this.send({event:a,data:{input:e.inputs},name:t,tags:e.tags??[],run_id:e.id,metadata:((u=e.extra)==null?void 0:u.metadata)??{}},s)}async onLLMNewToken(e,t,r){const s=this.runInfoMap.get(e.id);let a,l;if(s===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(s.runType==="chat_model")l="on_chat_model_stream",(r==null?void 0:r.chunk)===void 0?a=new Qr({content:t,id:`run-${e.id}`}):a=r.chunk.message;else if(s.runType==="llm")l="on_llm_stream",(r==null?void 0:r.chunk)===void 0?a=new io({text:t}):a=r.chunk;else throw new Error(`Unexpected run type ${s.runType}`);await this.send({event:l,data:{chunk:a},run_id:e.id,name:s.name,tags:s.tags,metadata:s.metadata},s)}}async onLLMEnd(e){var l,u,c;const t=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let r;if(t===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const s=(l=e.outputs)==null?void 0:l.generations;let a;if(t.runType==="chat_model"){for(const f of s??[]){if(a!==void 0)break;a=(u=f[0])==null?void 0:u.message}r="on_chat_model_end"}else if(t.runType==="llm")a={generations:s==null?void 0:s.map(f=>f.map(h=>({text:h.text,generationInfo:h.generationInfo}))),llmOutput:((c=e.outputs)==null?void 0:c.llmOutput)??{}},r="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${t.runType}`);await this.sendEndEvent({event:r,data:{output:a,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onChainStart(e){var l,u;const t=td(e),r=e.run_type??"chain",s={tags:e.tags??[],metadata:((l=e.extra)==null?void 0:l.metadata)??{},name:t,runType:e.run_type};let a={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(a={},s.inputs={}):e.inputs.input!==void 0?(a.input=e.inputs.input,s.inputs=e.inputs.input):(a.input=e.inputs,s.inputs=e.inputs),this.runInfoMap.set(e.id,s),await this.send({event:`on_${r}_start`,data:a,name:t,tags:e.tags??[],run_id:e.id,metadata:((u=e.extra)==null?void 0:u.metadata)??{}},s)}async onChainEnd(e){var u;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const r=`on_${e.run_type}_end`,s=e.inputs??t.inputs??{},l={output:((u=e.outputs)==null?void 0:u.output)??e.outputs,input:s};s.input&&Object.keys(s).length===1&&(l.input=s.input,t.inputs=s.input),await this.sendEndEvent({event:r,data:l,run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata??{}},t)}async onToolStart(e){var s,a;const t=td(e),r={tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{},name:t,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,r),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:t,run_id:e.id,tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{}},r)}async onToolEnd(e){var s;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(t.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const r=((s=e.outputs)==null?void 0:s.output)===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:r,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onRetrieverStart(e){var a,l;const t=td(e),s={tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},name:t,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,s),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:t,tags:e.tags??[],run_id:e.id,metadata:((l=e.extra)==null?void 0:l.metadata)??{}},s)}async onRetrieverEnd(e){var r;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:((r=e.outputs)==null?void 0:r.documents)??e.outputs,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async handleCustomEvent(e,t,r){const s=this.runInfoMap.get(r);if(s===void 0)throw new Error(`handleCustomEvent: Run ID ${r} not found in run map.`);await this.send({event:"on_custom_event",run_id:r,name:e,tags:s.tags,metadata:s.metadata,data:t},s)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const mM=[400,401,402,403,404,405,406,407,409],gM=n=>{var t,r;if(n.message.startsWith("Cancel")||n.message.startsWith("AbortError")||n.name==="AbortError"||(n==null?void 0:n.code)==="ECONNABORTED")throw n;const e=((t=n==null?void 0:n.response)==null?void 0:t.status)??(n==null?void 0:n.status);if(e&&mM.includes(+e))throw n;if(((r=n==null?void 0:n.error)==null?void 0:r.code)==="insufficient_quota"){const s=new Error(n==null?void 0:n.message);throw s.name="InsufficientQuotaError",s}};class I_{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??gM;const t="default"in ks?ks.default:ks;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>Ud(()=>e(...t).catch(r=>{throw r instanceof Error?r:new Error(r)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((s,a)=>{var l;(l=e.signal)==null||l.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}}class eP extends Pu{constructor({config:e,onStart:t,onEnd:r,onError:s}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=t,this.argOnEnd=r,this.argOnError=s}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}function N_(n){return n?n.lc_runnable:!1}class yM{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,t){let r=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const s=e.tags??[];return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(t)),this.includeTags!==void 0&&(r=r||s.some(a=>{var l;return(l=this.includeTags)==null?void 0:l.includes(a)})),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(t)),this.excludeTags!==void 0&&(r=r&&s.every(a=>{var l;return!((l=this.excludeTags)!=null&&l.includes(a))})),r}}const _M=Symbol("Let zodToJsonSchema decide on which parser to use"),wM={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},bM=n=>({...wM,...n}),vM=n=>{const e=bM(n),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function tP(n,e,t,r){r!=null&&r.errorMessages&&t&&(n.errorMessage={...n.errorMessage,[e]:t})}function Je(n,e,t,r,s){n[e]=t,tP(n,e,r,s)}function xM(){return{}}function SM(n,e){var r,s,a;const t={type:"array"};return(r=n.type)!=null&&r._def&&((a=(s=n.type)==null?void 0:s._def)==null?void 0:a.typeName)!==Z.ZodAny&&(t.items=qe(n.type._def,{...e,currentPath:[...e.currentPath,"items"]})),n.minLength&&Je(t,"minItems",n.minLength.value,n.minLength.message,e),n.maxLength&&Je(t,"maxItems",n.maxLength.value,n.maxLength.message,e),n.exactLength&&(Je(t,"minItems",n.exactLength.value,n.exactLength.message,e),Je(t,"maxItems",n.exactLength.value,n.exactLength.message,e)),t}function EM(n,e){const t={type:"integer",format:"int64"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?Je(t,"minimum",r.value,r.message,e):Je(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Je(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Je(t,"maximum",r.value,r.message,e):Je(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Je(t,"maximum",r.value,r.message,e));break;case"multipleOf":Je(t,"multipleOf",r.value,r.message,e);break}return t}function CM(){return{type:"boolean"}}function nP(n,e){return qe(n.type._def,e)}const PM=(n,e)=>qe(n.innerType._def,e);function rP(n,e,t){const r=t??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,a)=>rP(n,e,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return kM(n,e)}}const kM=(n,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const r of n.checks)switch(r.kind){case"min":Je(t,"minimum",r.value,r.message,e);break;case"max":Je(t,"maximum",r.value,r.message,e);break}return t};function RM(n,e){return{...qe(n.innerType._def,e),default:n.defaultValue()}}function OM(n,e){return e.effectStrategy==="input"?qe(n.schema._def,e):{}}function TM(n){return{type:"string",enum:Array.from(n.values)}}const AM=n=>"type"in n&&n.type==="string"?!1:"allOf"in n;function $M(n,e){const t=[qe(n.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),qe(n.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return t.forEach(a=>{if(AM(a))s.push(...a.allOf),a.unevaluatedProperties===void 0&&(r=void 0);else{let l=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:u,...c}=a;l=c}else r=void 0;s.push(l)}}),s.length?{allOf:s,...r}:void 0}function IM(n,e){const t=typeof n.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(n.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[n.value]}:{type:t==="bigint"?"integer":t,const:n.value}}let ug;const dr={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(ug===void 0&&(ug=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),ug),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function sP(n,e){const t={type:"string"};if(n.checks)for(const r of n.checks)switch(r.kind){case"min":Je(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,r.value):r.value,r.message,e);break;case"max":Je(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,r.value):r.value,r.message,e);break;case"email":switch(e.emailStrategy){case"format:email":fr(t,"email",r.message,e);break;case"format:idn-email":fr(t,"idn-email",r.message,e);break;case"pattern:zod":ln(t,dr.email,r.message,e);break}break;case"url":fr(t,"uri",r.message,e);break;case"uuid":fr(t,"uuid",r.message,e);break;case"regex":ln(t,r.regex,r.message,e);break;case"cuid":ln(t,dr.cuid,r.message,e);break;case"cuid2":ln(t,dr.cuid2,r.message,e);break;case"startsWith":ln(t,RegExp(`^${cg(r.value,e)}`),r.message,e);break;case"endsWith":ln(t,RegExp(`${cg(r.value,e)}$`),r.message,e);break;case"datetime":fr(t,"date-time",r.message,e);break;case"date":fr(t,"date",r.message,e);break;case"time":fr(t,"time",r.message,e);break;case"duration":fr(t,"duration",r.message,e);break;case"length":Je(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,r.value):r.value,r.message,e),Je(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,r.value):r.value,r.message,e);break;case"includes":{ln(t,RegExp(cg(r.value,e)),r.message,e);break}case"ip":{r.version!=="v6"&&fr(t,"ipv4",r.message,e),r.version!=="v4"&&fr(t,"ipv6",r.message,e);break}case"base64url":ln(t,dr.base64url,r.message,e);break;case"jwt":ln(t,dr.jwt,r.message,e);break;case"cidr":{r.version!=="v6"&&ln(t,dr.ipv4Cidr,r.message,e),r.version!=="v4"&&ln(t,dr.ipv6Cidr,r.message,e);break}case"emoji":ln(t,dr.emoji(),r.message,e);break;case"ulid":{ln(t,dr.ulid,r.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{fr(t,"binary",r.message,e);break}case"contentEncoding:base64":{Je(t,"contentEncoding","base64",r.message,e);break}case"pattern:zod":{ln(t,dr.base64,r.message,e);break}}break}case"nanoid":ln(t,dr.nanoid,r.message,e)}return t}function cg(n,e){return e.patternStrategy==="escape"?jM(n):n}const NM=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function jM(n){let e="";for(let t=0;t<n.length;t++)NM.has(n[t])||(e+="\\"),e+=n[t];return e}function fr(n,e,t,r){var s;n.format||(s=n.anyOf)!=null&&s.some(a=>a.format)?(n.anyOf||(n.anyOf=[]),n.format&&(n.anyOf.push({format:n.format,...n.errorMessage&&r.errorMessages&&{errorMessage:{format:n.errorMessage.format}}}),delete n.format,n.errorMessage&&(delete n.errorMessage.format,Object.keys(n.errorMessage).length===0&&delete n.errorMessage)),n.anyOf.push({format:e,...t&&r.errorMessages&&{errorMessage:{format:t}}})):Je(n,"format",e,t,r)}function ln(n,e,t,r){var s;n.pattern||(s=n.allOf)!=null&&s.some(a=>a.pattern)?(n.allOf||(n.allOf=[]),n.pattern&&(n.allOf.push({pattern:n.pattern,...n.errorMessage&&r.errorMessages&&{errorMessage:{pattern:n.errorMessage.pattern}}}),delete n.pattern,n.errorMessage&&(delete n.errorMessage.pattern,Object.keys(n.errorMessage).length===0&&delete n.errorMessage)),n.allOf.push({pattern:LS(e,r),...t&&r.errorMessages&&{errorMessage:{pattern:t}}})):Je(n,"pattern",LS(e,r),t,r)}function LS(n,e){var c;if(!e.applyRegexFlags||!n.flags)return n.source;const t={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},r=t.i?n.source.toLowerCase():n.source;let s="",a=!1,l=!1,u=!1;for(let f=0;f<r.length;f++){if(a){s+=r[f],a=!1;continue}if(t.i){if(l){if(r[f].match(/[a-z]/)){u?(s+=r[f],s+=`${r[f-2]}-${r[f]}`.toUpperCase(),u=!1):r[f+1]==="-"&&((c=r[f+2])!=null&&c.match(/[a-z]/))?(s+=r[f],u=!0):s+=`${r[f]}${r[f].toUpperCase()}`;continue}}else if(r[f].match(/[a-z]/)){s+=`[${r[f]}${r[f].toUpperCase()}]`;continue}}if(t.m){if(r[f]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(r[f]==="$"){s+=`($|(?=[\r
]))`;continue}}if(t.s&&r[f]==="."){s+=l?`${r[f]}\r
`:`[${r[f]}\r
]`;continue}s+=r[f],r[f]==="\\"?a=!0:l&&r[f]==="]"?l=!1:!l&&r[f]==="["&&(l=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return s}function aP(n,e){var r,s,a,l,u,c;if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&((r=n.keyType)==null?void 0:r._def.typeName)===Z.ZodEnum)return{type:"object",required:n.keyType._def.values,properties:n.keyType._def.values.reduce((f,h)=>({...f,[h]:qe(n.valueType._def,{...e,currentPath:[...e.currentPath,"properties",h]})??{}}),{}),additionalProperties:!1};const t={type:"object",additionalProperties:qe(n.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return t;if(((s=n.keyType)==null?void 0:s._def.typeName)===Z.ZodString&&((a=n.keyType._def.checks)!=null&&a.length)){const{type:f,...h}=sP(n.keyType._def,e);return{...t,propertyNames:h}}else{if(((l=n.keyType)==null?void 0:l._def.typeName)===Z.ZodEnum)return{...t,propertyNames:{enum:n.keyType._def.values}};if(((u=n.keyType)==null?void 0:u._def.typeName)===Z.ZodBranded&&n.keyType._def.type._def.typeName===Z.ZodString&&((c=n.keyType._def.type._def.checks)!=null&&c.length)){const{type:f,...h}=nP(n.keyType._def,e);return{...t,propertyNames:h}}}return t}function LM(n,e){if(e.mapStrategy==="record")return aP(n,e);const t=qe(n.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},r=qe(n.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,r],minItems:2,maxItems:2}}}function MM(n){const e=n.values,r=Object.keys(n.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),s=Array.from(new Set(r.map(a=>typeof a)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function DM(){return{not:{}}}function FM(n){return n.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const qd={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function UM(n,e){if(e.target==="openApi3")return MS(n,e);const t=n.options instanceof Map?Array.from(n.options.values()):n.options;if(t.every(r=>r._def.typeName in qd&&(!r._def.checks||!r._def.checks.length))){const r=t.reduce((s,a)=>{const l=qd[a._def.typeName];return l&&!s.includes(l)?[...s,l]:s},[]);return{type:r.length>1?r:r[0]}}else if(t.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=t.reduce((s,a)=>{const l=typeof a._def.value;switch(l){case"string":case"number":case"boolean":return[...s,l];case"bigint":return[...s,"integer"];case"object":if(a._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===t.length){const s=r.filter((a,l,u)=>u.indexOf(a)===l);return{type:s.length>1?s:s[0],enum:t.reduce((a,l)=>a.includes(l._def.value)?a:[...a,l._def.value],[])}}}else if(t.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((r,s)=>[...r,...s._def.values.filter(a=>!r.includes(a))],[])};return MS(n,e)}const MS=(n,e)=>{const t=(n.options instanceof Map?Array.from(n.options.values()):n.options).map((r,s)=>qe(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return t.length?{anyOf:t}:void 0};function zM(n,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(n.innerType._def.typeName)&&(!n.innerType._def.checks||!n.innerType._def.checks.length))return e.target==="openApi3"?{type:qd[n.innerType._def.typeName],nullable:!0}:{type:[qd[n.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=qe(n.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const t=qe(n.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function BM(n,e){const t={type:"number"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"int":t.type="integer",tP(t,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?Je(t,"minimum",r.value,r.message,e):Je(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Je(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Je(t,"maximum",r.value,r.message,e):Je(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Je(t,"maximum",r.value,r.message,e));break;case"multipleOf":Je(t,"multipleOf",r.value,r.message,e);break}return t}function HM(n,e){return e.removeAdditionalStrategy==="strict"?n.catchall._def.typeName==="ZodNever"?n.unknownKeys!=="strict":qe(n.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:n.catchall._def.typeName==="ZodNever"?n.unknownKeys==="passthrough":qe(n.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function WM(n,e){const t=e.target==="openAi",r={type:"object",...Object.entries(n.shape()).reduce((s,[a,l])=>{if(l===void 0||l._def===void 0)return s;let u=l.isOptional();u&&t&&(l instanceof Sr&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),u=!1);const c=qe(l._def,{...e,currentPath:[...e.currentPath,"properties",a],propertyPath:[...e.currentPath,"properties",a]});return c===void 0?s:{properties:{...s.properties,[a]:c},required:u?s.required:[...s.required,a]}},{properties:{},required:[]}),additionalProperties:HM(n,e)};return r.required.length||delete r.required,r}const VM=(n,e)=>{var r;if(e.currentPath.toString()===((r=e.propertyPath)==null?void 0:r.toString()))return qe(n.innerType._def,e);const t=qe(n.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}},qM=(n,e)=>{if(e.pipeStrategy==="input")return qe(n.in._def,e);if(e.pipeStrategy==="output")return qe(n.out._def,e);const t=qe(n.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=qe(n.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,r].filter(s=>s!==void 0)}};function ZM(n,e){return qe(n.type._def,e)}function GM(n,e){const r={type:"array",uniqueItems:!0,items:qe(n.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return n.minSize&&Je(r,"minItems",n.minSize.value,n.minSize.message,e),n.maxSize&&Je(r,"maxItems",n.maxSize.value,n.maxSize.message,e),r}function JM(n,e){return n.rest?{type:"array",minItems:n.items.length,items:n.items.map((t,r)=>qe(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[]),additionalItems:qe(n.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:n.items.length,maxItems:n.items.length,items:n.items.map((t,r)=>qe(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[])}}function KM(){return{not:{}}}function XM(){return{}}const YM=(n,e)=>qe(n.innerType._def,e);function qe(n,e,t=!1){var l;const r=e.seen.get(n);if(e.override){const u=(l=e.override)==null?void 0:l.call(e,n,e,r,t);if(u!==_M)return u}if(r&&!t){const u=QM(r,e);if(u!==void 0)return u}const s={def:n,path:e.currentPath,jsonSchema:void 0};e.seen.set(n,s);const a=tD(n,n.typeName,e);return a&&nD(n,e,a),s.jsonSchema=a,a}const QM=(n,e)=>{switch(e.$refStrategy){case"root":return{$ref:n.path.join("/")};case"relative":return{$ref:eD(e.currentPath,n.path)};case"none":case"seen":return n.path.length<e.currentPath.length&&n.path.every((t,r)=>e.currentPath[r]===t)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},eD=(n,e)=>{let t=0;for(;t<n.length&&t<e.length&&n[t]===e[t];t++);return[(n.length-t).toString(),...e.slice(t)].join("/")},tD=(n,e,t)=>{switch(e){case Z.ZodString:return sP(n,t);case Z.ZodNumber:return BM(n,t);case Z.ZodObject:return WM(n,t);case Z.ZodBigInt:return EM(n,t);case Z.ZodBoolean:return CM();case Z.ZodDate:return rP(n,t);case Z.ZodUndefined:return KM();case Z.ZodNull:return FM(t);case Z.ZodArray:return SM(n,t);case Z.ZodUnion:case Z.ZodDiscriminatedUnion:return UM(n,t);case Z.ZodIntersection:return $M(n,t);case Z.ZodTuple:return JM(n,t);case Z.ZodRecord:return aP(n,t);case Z.ZodLiteral:return IM(n,t);case Z.ZodEnum:return TM(n);case Z.ZodNativeEnum:return MM(n);case Z.ZodNullable:return zM(n,t);case Z.ZodOptional:return VM(n,t);case Z.ZodMap:return LM(n,t);case Z.ZodSet:return GM(n,t);case Z.ZodLazy:return qe(n.getter()._def,t);case Z.ZodPromise:return ZM(n,t);case Z.ZodNaN:case Z.ZodNever:return DM();case Z.ZodEffects:return OM(n,t);case Z.ZodAny:return xM();case Z.ZodUnknown:return XM();case Z.ZodDefault:return RM(n,t);case Z.ZodBranded:return nP(n,t);case Z.ZodReadonly:return YM(n,t);case Z.ZodCatch:return PM(n,t);case Z.ZodPipeline:return qM(n,t);case Z.ZodFunction:case Z.ZodVoid:case Z.ZodSymbol:return;default:return(r=>{})()}},nD=(n,e,t)=>(n.description&&(t.description=n.description,e.markdownDescription&&(t.markdownDescription=n.description)),t),ku=(n,e)=>{const t=vM(e),r=void 0,s=e==null?void 0:e.name,a=qe(n._def,t,!1)??{},l=s===void 0?r?{...a,[t.definitionPath]:r}:a:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,s].join("/"),[t.definitionPath]:{...r,[s]:a}};return t.target==="jsonSchema7"?l.$schema="http://json-schema.org/draft-07/schema#":(t.target==="jsonSchema2019-09"||t.target==="openAi")&&(l.$schema="https://json-schema.org/draft/2019-09/schema#"),t.target==="openAi"&&("anyOf"in l||"oneOf"in l||"allOf"in l||"type"in l&&Array.isArray(l.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),l};function dg(n){return n.replace(/[^a-zA-Z-_0-9]/g,"_")}const rD=["*","_","`"];function sD(n){let e="";for(const[t,r]of Object.entries(n))e+=`	classDef ${t} ${r};
`;return e}function aD(n,e,t){const{firstNode:r,lastNode:s,nodeColors:a,withStyles:l=!0,curveStyle:u="linear",wrapLabelNWords:c=9}=t??{};let f=l?`%%{init: {'flowchart': {'curve': '${u}'}}}%%
graph TD;
`:`graph TD;
`;if(l){const y="default",w={[y]:"{0}({1})"};r!==void 0&&(w[r]="{0}([{1}]):::first"),s!==void 0&&(w[s]="{0}([{1}]):::last");for(const[v,x]of Object.entries(n)){const E=x.name.split(":").pop()??"";let S=rD.some($=>E.startsWith($)&&E.endsWith($))?`<p>${E}</p>`:E;Object.keys(x.metadata??{}).length&&(S+=`<hr/><small><em>${Object.entries(x.metadata??{}).map(([$,I])=>`${$} = ${I}`).join(`
`)}</em></small>`);const R=(w[v]??w[y]).replace("{0}",dg(v)).replace("{1}",S);f+=`	${R}
`}}const h={};for(const y of e){const w=y.source.split(":"),v=y.target.split(":"),x=w.filter((E,P)=>E===v[P]).join(":");h[x]||(h[x]=[]),h[x].push(y)}const m=new Set;function g(y,w){const v=y.length===1&&y[0].source===y[0].target;if(w&&!v){const x=w.split(":").pop();if(m.has(x))throw new Error(`Found duplicate subgraph '${x}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);m.add(x),f+=`	subgraph ${x}
`}for(const x of y){const{source:E,target:P,data:S,conditional:R}=x;let $="";if(S!==void 0){let I=S;const D=I.split(" ");D.length>c&&(I=Array.from({length:Math.ceil(D.length/c)},(F,K)=>D.slice(K*c,(K+1)*c).join(" ")).join("&nbsp;<br>&nbsp;")),$=R?` -. &nbsp;${I}&nbsp; .-> `:` -- &nbsp;${I}&nbsp; --> `}else $=R?" -.-> ":" --> ";f+=`	${dg(E)}${$}${dg(P)};
`}for(const x in h)x.startsWith(`${w}:`)&&x!==w&&g(h[x],x);w&&!v&&(f+=`	end
`)}g(h[""]??[],"");for(const y in h)!y.includes(":")&&y!==""&&g(h[y],y);return l&&(f+=sD(a??{})),f}async function iD(n,e){let{backgroundColor:t="white"}=e??{};const r=btoa(n);t!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(t)||(t=`!${t}`));const s=`https://mermaid.ink/img/${r}?bgColor=${t}`,a=await fetch(s);if(!a.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${a.status}`,`Status text: ${a.statusText}`].join(`
`));return await a.blob()}function oD(n,e){if(n!==void 0&&!Il(n))return n;if(N_(e))try{let t=e.getName();return t=t.startsWith("Runnable")?t.slice(8):t,t}catch{return e.getName()}else return e.name??"UnknownSchema"}function lD(n){return N_(n.data)?{type:"runnable",data:{id:n.data.lc_id,name:n.data.getName()}}:{type:"schema",data:{...ku(n.data.schema),title:n.data.name}}}class If{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=(e==null?void 0:e.nodes)??this.nodes,this.edges=(e==null?void 0:e.edges)??this.edges}toJSON(){const e={};return Object.values(this.nodes).forEach((t,r)=>{e[t.id]=Il(t.id)?r:t.id}),{nodes:Object.values(this.nodes).map(t=>({id:e[t.id],...lD(t)})),edges:this.edges.map(t=>{const r={source:e[t.source],target:e[t.target]};return typeof t.data<"u"&&(r.data=t.data),typeof t.conditional<"u"&&(r.conditional=t.conditional),r})}}addNode(e,t,r){if(t!==void 0&&this.nodes[t]!==void 0)throw new Error(`Node with id ${t} already exists`);const s=t??Qt(),a={id:s,data:e,name:oD(t,e),metadata:r};return this.nodes[s]=a,a}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(t=>t.source!==e.id&&t.target!==e.id)}addEdge(e,t,r,s){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[t.id]===void 0)throw new Error(`Target node ${t.id} not in graph`);const a={source:e.id,target:t.id,data:r,conditional:s};return this.edges.push(a),a}firstNode(){return DS(this)}lastNode(){return FS(this)}extend(e,t=""){let r=t;Object.values(e.nodes).map(f=>f.id).every(Il)&&(r="");const a=f=>r?`${r}:${f}`:f;Object.entries(e.nodes).forEach(([f,h])=>{this.nodes[a(f)]={...h,id:a(f)}});const l=e.edges.map(f=>({...f,source:a(f.source),target:a(f.target)}));this.edges=[...this.edges,...l];const u=e.firstNode(),c=e.lastNode();return[u?{id:a(u.id),data:u.data}:void 0,c?{id:a(c.id),data:c.data}:void 0]}trimFirstNode(){const e=this.firstNode();e&&DS(this,[e.id])&&this.removeNode(e)}trimLastNode(){const e=this.lastNode();e&&FS(this,[e.id])&&this.removeNode(e)}reid(){const e=Object.fromEntries(Object.values(this.nodes).map(s=>[s.id,s.name])),t=new Map;Object.values(e).forEach(s=>{t.set(s,(t.get(s)||0)+1)});const r=s=>{const a=e[s];return Il(s)&&t.get(a)===1?a:s};return new If({nodes:Object.fromEntries(Object.entries(this.nodes).map(([s,a])=>[r(s),{...a,id:r(s)}])),edges:this.edges.map(s=>({...s,source:r(s.source),target:r(s.target)}))})}drawMermaid(e){const{withStyles:t,curveStyle:r,nodeColors:s={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:a}=e??{},l=this.reid(),u=l.firstNode(),c=l.lastNode();return aD(l.nodes,l.edges,{firstNode:u==null?void 0:u.id,lastNode:c==null?void 0:c.id,withStyles:t,curveStyle:r,nodeColors:s,wrapLabelNWords:a})}async drawMermaidPng(e){const t=this.drawMermaid(e);return iD(t,{backgroundColor:e==null?void 0:e.backgroundColor})}}function DS(n,e=[]){const t=new Set(n.edges.filter(s=>!e.includes(s.source)).map(s=>s.target)),r=[];for(const s of Object.values(n.nodes))!e.includes(s.id)&&!t.has(s.id)&&r.push(s);return r.length===1?r[0]:void 0}function FS(n,e=[]){const t=new Set(n.edges.filter(s=>!e.includes(s.target)).map(s=>s.source)),r=[];for(const s of Object.values(n.nodes))!e.includes(s.id)&&!t.has(s.id)&&r.push(s);return r.length===1?r[0]:void 0}function uD(n){const e=new TextEncoder,t=new ReadableStream({async start(r){for await(const s of n)r.enqueue(e.encode(`event: data
data: ${JSON.stringify(s)}

`));r.enqueue(e.encode(`event: end

`)),r.close()}});return Fn.fromReadableStream(t)}function US(n){return typeof n=="object"&&n!==null&&typeof n[Symbol.iterator]=="function"&&typeof n.next=="function"}const cD=n=>n!=null&&typeof n=="object"&&"next"in n&&typeof n.next=="function";function ty(n){return typeof n=="object"&&n!==null&&typeof n[Symbol.asyncIterator]=="function"}function*zS(n,e){for(;;){const{value:t,done:r}=ma.runWithConfig(ao(n),e.next.bind(e),!0);if(r)break;yield t}}async function*ny(n,e){const t=e[Symbol.asyncIterator]();for(;;){const{value:r,done:s}=await ma.runWithConfig(ao(n),t.next.bind(e),!0);if(s)break;yield r}}function jt(n,e){return n&&!Array.isArray(n)&&!(n instanceof Date)&&typeof n=="object"?n:{[e]:n}}class Lt extends Ja{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const t=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${t}${e}`:t}bind(e){return new Ba({bound:this,kwargs:e,config:{}})}map(){return new Zd({bound:this})}withRetry(e){return new dD({bound:this,kwargs:{},config:{},maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}withConfig(e){return new Ba({bound:this,config:e,kwargs:{}})}withFallbacks(e){const t=Array.isArray(e)?e:e.fallbacks;return new hD({runnable:this,fallbacks:t})}_getOptionsList(e,t=0){if(Array.isArray(e)&&e.length!==t)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${t} inputs`);if(Array.isArray(e))return e.map(Ze);if(t>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const r=Object.fromEntries(Object.entries(e).filter(([s])=>s!=="runId"));return Array.from({length:t},(s,a)=>Ze(a===0?e:r))}return Array.from({length:t},()=>Ze(e))}async batch(e,t,r){var c;const s=this._getOptionsList(t??{},e.length),a=((c=s[0])==null?void 0:c.maxConcurrency)??(r==null?void 0:r.maxConcurrency),l=new I_({maxConcurrency:a,onFailedAttempt:f=>{throw f}}),u=e.map((f,h)=>l.call(async()=>{try{return await this.invoke(f,s[h])}catch(m){if(r!=null&&r.returnExceptions)return m;throw m}}));return Promise.all(u)}async*_streamIterator(e,t){yield this.invoke(e,t)}async stream(e,t){const r=Ze(t),s=new vo({generator:this._streamIterator(e,r),config:r});return await s.setup,Fn.fromAsyncGenerator(s)}_separateRunnableConfigFromCallOptions(e){let t;e===void 0?t=Ze(e):t=Ze({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const r={...e};return delete r.callbacks,delete r.tags,delete r.metadata,delete r.runName,delete r.configurable,delete r.recursionLimit,delete r.maxConcurrency,delete r.runId,delete r.timeout,delete r.signal,[t,r]}async _callWithConfig(e,t,r){const s=Ze(r),a=await Er(s),l=await(a==null?void 0:a.handleChainStart(this.toJSON(),jt(t,"input"),s.runId,s==null?void 0:s.runType,void 0,void 0,(s==null?void 0:s.runName)??this.getName()));delete s.runId;let u;try{const c=e.call(this,t,s,l);u=await ga(c,r==null?void 0:r.signal)}catch(c){throw await(l==null?void 0:l.handleChainError(c)),c}return await(l==null?void 0:l.handleChainEnd(jt(u,"output"))),u}async _batchWithConfig(e,t,r,s){var f;const a=this._getOptionsList(r??{},t.length),l=await Promise.all(a.map(Er)),u=await Promise.all(l.map(async(h,m)=>{const g=await(h==null?void 0:h.handleChainStart(this.toJSON(),jt(t[m],"input"),a[m].runId,a[m].runType,void 0,void 0,a[m].runName??this.getName()));return delete a[m].runId,g}));let c;try{const h=e.call(this,t,a,u,s);c=await ga(h,(f=a==null?void 0:a[0])==null?void 0:f.signal)}catch(h){throw await Promise.all(u.map(m=>m==null?void 0:m.handleChainError(h))),h}return await Promise.all(u.map(h=>h==null?void 0:h.handleChainEnd(jt(c,"output")))),c}async*_transformStreamWithConfig(e,t,r){let s,a=!0,l,u=!0;const c=Ze(r),f=await Er(c);async function*h(){for await(const g of e){if(a)if(s===void 0)s=g;else try{s=Xn(s,g)}catch{s=void 0,a=!1}yield g}}let m;try{const g=await cM(t.bind(this),h(),async()=>f==null?void 0:f.handleChainStart(this.toJSON(),{input:""},c.runId,c.runType,void 0,void 0,c.runName??this.getName()),r==null?void 0:r.signal,c);delete c.runId,m=g.setup;const y=m==null?void 0:m.handlers.find(hM);let w=g.output;y!==void 0&&m!==void 0&&(w=y.tapOutputIterable(m.runId,w));const v=m==null?void 0:m.handlers.find(dM);v!==void 0&&m!==void 0&&(w=v.tapOutputIterable(m.runId,w));for await(const x of w)if(yield x,u)if(l===void 0)l=x;else try{l=Xn(l,x)}catch{l=void 0,u=!1}}catch(g){throw await(m==null?void 0:m.handleChainError(g,void 0,void 0,void 0,{inputs:jt(s,"input")})),g}await(m==null?void 0:m.handleChainEnd(l??{},void 0,void 0,void 0,{inputs:jt(s,"input")}))}getGraph(e){const t=new If,r=t.addNode({name:`${this.getName()}Input`,schema:Se.any()}),s=t.addNode(this),a=t.addNode({name:`${this.getName()}Output`,schema:Se.any()});return t.addEdge(r,s),t.addEdge(s,a),t}pipe(e){return new Cs({first:this,last:Da(e)})}pick(e){return this.pipe(new pD(e))}assign(e){return this.pipe(new iP(new xo({steps:e})))}async*transform(e,t){let r;for await(const s of e)r===void 0?r=s:r=Xn(r,s);yield*this._streamIterator(r,Ze(t))}async*streamLog(e,t,r){const s=new NS({...r,autoClose:!1,_schemaFormat:"original"}),a=Ze(t);yield*this._streamLog(e,s,a)}async*_streamLog(e,t,r){const{callbacks:s}=r;if(s===void 0)r.callbacks=[t];else if(Array.isArray(s))r.callbacks=s.concat([t]);else{const c=s.copy();c.addHandler(t,!0),r.callbacks=c}const a=this.stream(e,r);async function l(){try{const c=await a;for await(const f of c){const h=new aa({ops:[{op:"add",path:"/streamed_output/-",value:f}]});await t.writer.write(h)}}finally{await t.writer.close()}}const u=l();try{for await(const c of t)yield c}finally{await u}}streamEvents(e,t,r){let s;if(t.version==="v1")s=this._streamEventsV1(e,t,r);else if(t.version==="v2")s=this._streamEventsV2(e,t,r);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return t.encoding==="text/event-stream"?uD(s):Fn.fromAsyncGenerator(s)}async*_streamEventsV2(e,t,r){var w;const s=new pM({...r,autoClose:!1}),a=Ze(t),l=a.runId??Qt();a.runId=l;const u=a.callbacks;if(u===void 0)a.callbacks=[s];else if(Array.isArray(u))a.callbacks=u.concat(s);else{const v=u.copy();v.addHandler(s,!0),a.callbacks=v}const c=new AbortController,f=this;async function h(){try{let v;t!=null&&t.signal?"any"in AbortSignal?v=AbortSignal.any([c.signal,t.signal]):(v=t.signal,t.signal.addEventListener("abort",()=>{c.abort()},{once:!0})):v=c.signal;const x=await f.stream(e,{...a,signal:v}),E=s.tapOutputIterable(l,x);for await(const P of E)if(c.signal.aborted)break}finally{await s.finish()}}const m=h();let g=!1,y;try{for await(const v of s){if(!g){v.data.input=e,g=!0,y=v.run_id,yield v;continue}v.run_id===y&&v.event.endsWith("_end")&&(w=v.data)!=null&&w.input&&delete v.data.input,yield v}}finally{c.abort(),await m}}async*_streamEventsV1(e,t,r){let s,a=!1;const l=Ze(t),u=l.tags??[],c=l.metadata??{},f=l.runName??this.getName(),h=new NS({...r,autoClose:!1,_schemaFormat:"streaming_events"}),m=new yM({...r}),g=this._streamLog(e,h,l);for await(const w of g){if(s?s=s.concat(w):s=ou.fromRunLogPatch(w),s.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!a){a=!0;const P={...s.state},S={run_id:P.id,event:`on_${P.type}_start`,name:f,tags:u,metadata:c,data:{input:e}};m.includeEvent(S,P.type)&&(yield S)}const v=w.ops.filter(P=>P.path.startsWith("/logs/")).map(P=>P.path.split("/")[2]),x=[...new Set(v)];for(const P of x){let S,R={};const $=s.state.logs[P];if($.end_time===void 0?$.streamed_output.length>0?S="stream":S="start":S="end",S==="start")$.inputs!==void 0&&(R.input=$.inputs);else if(S==="end")$.inputs!==void 0&&(R.input=$.inputs),R.output=$.final_output;else if(S==="stream"){const I=$.streamed_output.length;if(I!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${I} instead. Encountered in: "${$.name}"`);R={chunk:$.streamed_output[0]},$.streamed_output=[]}yield{event:`on_${$.type}_${S}`,name:$.name,run_id:$.id,tags:$.tags,metadata:$.metadata,data:R}}const{state:E}=s;if(E.streamed_output.length>0){const P=E.streamed_output.length;if(P!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${P} instead. Encountered in: "${E.name}"`);const S={chunk:E.streamed_output[0]};E.streamed_output=[];const R={event:`on_${E.type}_stream`,run_id:E.id,tags:u,metadata:c,name:f,data:S};m.includeEvent(R,E.type)&&(yield R)}}const y=s==null?void 0:s.state;if(y!==void 0){const w={event:`on_${y.type}_end`,name:f,run_id:y.id,tags:u,metadata:c,data:{output:y.final_output}};m.includeEvent(w,y.type)&&(yield w)}}static isRunnable(e){return N_(e)}withListeners({onStart:e,onEnd:t,onError:r}){return new Ba({bound:this,config:{},configFactories:[s=>({callbacks:[new eP({config:s,onStart:e,onEnd:t,onError:r})]})]})}asTool(e){return mD(this,e)}}class Ba extends Lt{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const t=AS(this.config,...e);return AS(t,...this.configFactories?await Promise.all(this.configFactories.map(async r=>await r(t))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}async invoke(e,t){return this.bound.invoke(e,await this._mergeConfig(Ze(t),this.kwargs))}async batch(e,t,r){const s=Array.isArray(t)?await Promise.all(t.map(async a=>this._mergeConfig(Ze(a),this.kwargs))):await this._mergeConfig(Ze(t),this.kwargs);return this.bound.batch(e,s,r)}async*_streamIterator(e,t){yield*this.bound._streamIterator(e,await this._mergeConfig(Ze(t),this.kwargs))}async stream(e,t){return this.bound.stream(e,await this._mergeConfig(Ze(t),this.kwargs))}async*transform(e,t){yield*this.bound.transform(e,await this._mergeConfig(Ze(t),this.kwargs))}streamEvents(e,t,r){const s=this,a=async function*(){yield*s.bound.streamEvents(e,{...await s._mergeConfig(Ze(t),s.kwargs),version:t.version},r)};return Fn.fromAsyncGenerator(a())}static isRunnableBinding(e){return e.bound&&Lt.isRunnable(e.bound)}withListeners({onStart:e,onEnd:t,onError:r}){return new Ba({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[s=>({callbacks:[new eP({config:s,onStart:e,onEnd:t,onError:r})]})]})}}class Zd extends Lt{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new Zd({bound:this.bound.bind(e)})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _invoke(e,t,r){return this.bound.batch(e,en(t,{callbacks:r==null?void 0:r.getChild()}))}withListeners({onStart:e,onEnd:t,onError:r}){return new Zd({bound:this.bound.withListeners({onStart:e,onEnd:t,onError:r})})}}class dD extends Ba{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,t,r){const s=e>1?`retry:attempt:${e}`:void 0;return en(t,{callbacks:r==null?void 0:r.getChild(s)})}async _invoke(e,t,r){return Ud(s=>super.invoke(e,this._patchConfigForRetry(s,t,r)),{onFailedAttempt:s=>this.onFailedAttempt(s,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _batch(e,t,r,s){const a={};try{await Ud(async l=>{const u=e.map((g,y)=>y).filter(g=>a[g.toString()]===void 0||a[g.toString()]instanceof Error),c=u.map(g=>e[g]),f=u.map(g=>this._patchConfigForRetry(l,t==null?void 0:t[g],r==null?void 0:r[g])),h=await super.batch(c,f,{...s,returnExceptions:!0});let m;for(let g=0;g<h.length;g+=1){const y=h[g],w=u[g];y instanceof Error&&m===void 0&&(m=y,m.input=c[g]),a[w.toString()]=y}if(m)throw m;return h},{onFailedAttempt:l=>this.onFailedAttempt(l,l.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(l){if((s==null?void 0:s.returnExceptions)!==!0)throw l}return Object.keys(a).sort((l,u)=>parseInt(l,10)-parseInt(u,10)).map(l=>a[parseInt(l,10)])}async batch(e,t,r){return this._batchWithConfig(this._batch.bind(this),e,t,r)}}class Cs extends Lt{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,t){var c;const r=Ze(t),s=await Er(r),a=await(s==null?void 0:s.handleChainStart(this.toJSON(),jt(e,"input"),r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));delete r.runId;let l=e,u;try{const f=[this.first,...this.middle];for(let h=0;h<f.length;h+=1){const g=f[h].invoke(l,en(r,{callbacks:a==null?void 0:a.getChild(this.omitSequenceTags?void 0:`seq:step:${h+1}`)}));l=await ga(g,t==null?void 0:t.signal)}if((c=t==null?void 0:t.signal)!=null&&c.aborted)throw new Error("Aborted");u=await this.last.invoke(l,en(r,{callbacks:a==null?void 0:a.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(f){throw await(a==null?void 0:a.handleChainError(f)),f}return await(a==null?void 0:a.handleChainEnd(jt(u,"output"))),u}async batch(e,t,r){var c;const s=this._getOptionsList(t??{},e.length),a=await Promise.all(s.map(Er)),l=await Promise.all(a.map(async(f,h)=>{const m=await(f==null?void 0:f.handleChainStart(this.toJSON(),jt(e[h],"input"),s[h].runId,void 0,void 0,void 0,s[h].runName));return delete s[h].runId,m}));let u=e;try{for(let f=0;f<this.steps.length;f+=1){const m=this.steps[f].batch(u,l.map((g,y)=>{const w=g==null?void 0:g.getChild(this.omitSequenceTags?void 0:`seq:step:${f+1}`);return en(s[y],{callbacks:w})}),r);u=await ga(m,(c=s[0])==null?void 0:c.signal)}}catch(f){throw await Promise.all(l.map(h=>h==null?void 0:h.handleChainError(f))),f}return await Promise.all(l.map(f=>f==null?void 0:f.handleChainEnd(jt(u,"output")))),u}async*_streamIterator(e,t){var m;const r=await Er(t),{runId:s,...a}=t??{},l=await(r==null?void 0:r.handleChainStart(this.toJSON(),jt(e,"input"),s,void 0,void 0,void 0,a==null?void 0:a.runName)),u=[this.first,...this.middle,this.last];let c=!0,f;async function*h(){yield e}try{let g=u[0].transform(h(),en(a,{callbacks:l==null?void 0:l.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let y=1;y<u.length;y+=1)g=await u[y].transform(g,en(a,{callbacks:l==null?void 0:l.getChild(this.omitSequenceTags?void 0:`seq:step:${y+1}`)}));for await(const y of g)if((m=t==null?void 0:t.signal)==null||m.throwIfAborted(),yield y,c)if(f===void 0)f=y;else try{f=Xn(f,y)}catch{f=void 0,c=!1}}catch(g){throw await(l==null?void 0:l.handleChainError(g)),g}await(l==null?void 0:l.handleChainEnd(jt(f,"output")))}getGraph(e){const t=new If;let r=null;return this.steps.forEach((s,a)=>{const l=s.getGraph(e);a!==0&&l.trimFirstNode(),a!==this.steps.length-1&&l.trimLastNode(),t.extend(l);const u=l.firstNode();if(!u)throw new Error(`Runnable ${s} has no first node`);r&&t.addEdge(r,u),r=l.lastNode()}),t}pipe(e){return Cs.isRunnableSequence(e)?new Cs({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new Cs({first:this.first,middle:[...this.middle,this.last],last:Da(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&Lt.isRunnable(e)}static from([e,...t],r){let s={};return typeof r=="string"?s.name=r:r!==void 0&&(s=r),new Cs({...s,first:Da(e),middle:t.slice(0,-1).map(Da),last:Da(t[t.length-1])})}}class xo extends Lt{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[t,r]of Object.entries(e.steps))this.steps[t]=Da(r)}static from(e){return new xo({steps:e})}async invoke(e,t){const r=Ze(t),s=await Er(r),a=await(s==null?void 0:s.handleChainStart(this.toJSON(),{input:e},r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));delete r.runId;const l={};try{const u=Object.entries(this.steps).map(async([c,f])=>{l[c]=await f.invoke(e,en(r,{callbacks:a==null?void 0:a.getChild(`map:key:${c}`)}))});await ga(Promise.all(u),t==null?void 0:t.signal)}catch(u){throw await(a==null?void 0:a.handleChainError(u)),u}return await(a==null?void 0:a.handleChainEnd(l)),l}async*_transform(e,t,r){const s={...this.steps},a=QC(e,Object.keys(s).length),l=new Map(Object.entries(s).map(([u,c],f)=>{const h=c.transform(a[f],en(r,{callbacks:t==null?void 0:t.getChild(`map:key:${u}`)}));return[u,h.next().then(m=>({key:u,gen:h,result:m}))]}));for(;l.size;){const u=Promise.race(l.values()),{key:c,result:f,gen:h}=await ga(u,r==null?void 0:r.signal);l.delete(c),f.done||(yield{[c]:f.value},l.set(c,h.next().then(m=>({key:c,gen:h,result:m}))))}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const s=Ze(t),a=new vo({generator:this.transform(r(),s),config:s});return await a.setup,Fn.fromAsyncGenerator(a)}}class j_ extends Lt{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!A_(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,t){const[r]=this._getOptionsList(t??{},1),s=await Er(r),a=this.func(en(r,{callbacks:s}),e);return ga(a,r==null?void 0:r.signal)}async*_streamIterator(e,t){var a,l;const[r]=this._getOptionsList(t??{},1),s=await this.invoke(e,t);if(ty(s)){for await(const u of s)(a=r==null?void 0:r.signal)==null||a.throwIfAborted(),yield u;return}if(cD(s)){for(;;){(l=r==null?void 0:r.signal)==null||l.throwIfAborted();const u=s.next();if(u.done)break;yield u.value}return}yield s}static from(e){return new j_({func:e})}}function fD(n){if(A_(n))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}class So extends Lt{static lc_name(){return"RunnableLambda"}constructor(e){if(A_(e.func))return j_.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),fD(e.func),this.func=e.func}static from(e){return new So({func:e})}async _invoke(e,t,r){return new Promise((s,a)=>{const l=en(t,{callbacks:r==null?void 0:r.getChild(),recursionLimit:((t==null?void 0:t.recursionLimit)??lg)-1});ma.runWithConfig(ao(l),async()=>{var u,c;try{let f=await this.func(e,{...l});if(f&&Lt.isRunnable(f)){if((t==null?void 0:t.recursionLimit)===0)throw new Error("Recursion limit reached.");f=await f.invoke(e,{...l,recursionLimit:(l.recursionLimit??lg)-1})}else if(ty(f)){let h;for await(const m of ny(l,f))if((u=t==null?void 0:t.signal)==null||u.throwIfAborted(),h===void 0)h=m;else try{h=Xn(h,m)}catch{h=m}f=h}else if(US(f)){let h;for(const m of zS(l,f))if((c=t==null?void 0:t.signal)==null||c.throwIfAborted(),h===void 0)h=m;else try{h=Xn(h,m)}catch{h=m}f=h}s(f)}catch(f){a(f)}})})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async*_transform(e,t,r){var u,c;let s;for await(const f of e)if(s===void 0)s=f;else try{s=Xn(s,f)}catch{s=f}const a=en(r,{callbacks:t==null?void 0:t.getChild(),recursionLimit:((r==null?void 0:r.recursionLimit)??lg)-1}),l=await new Promise((f,h)=>{ma.runWithConfig(ao(a),async()=>{try{const m=await this.func(s,{...a,config:a});f(m)}catch(m){h(m)}})});if(l&&Lt.isRunnable(l)){if((r==null?void 0:r.recursionLimit)===0)throw new Error("Recursion limit reached.");const f=await l.stream(s,a);for await(const h of f)yield h}else if(ty(l))for await(const f of ny(a,l))(u=r==null?void 0:r.signal)==null||u.throwIfAborted(),yield f;else if(US(l))for(const f of zS(a,l))(c=r==null?void 0:r.signal)==null||c.throwIfAborted(),yield f;else yield l}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const s=Ze(t),a=new vo({generator:this.transform(r(),s),config:s});return await a.setup,Fn.fromAsyncGenerator(a)}}class hD extends Lt{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,t){const r=Ze(t),s=await Er(r),{runId:a,...l}=r,u=await(s==null?void 0:s.handleChainStart(this.toJSON(),jt(e,"input"),a,void 0,void 0,void 0,l==null?void 0:l.runName)),c=en(l,{callbacks:u==null?void 0:u.getChild()});return await ma.runWithConfig(c,async()=>{var m;let h;for(const g of this.runnables()){(m=r==null?void 0:r.signal)==null||m.throwIfAborted();try{const y=await g.invoke(e,c);return await(u==null?void 0:u.handleChainEnd(jt(y,"output"))),y}catch(y){h===void 0&&(h=y)}}throw h===void 0?new Error("No error stored at end of fallback."):(await(u==null?void 0:u.handleChainError(h)),h)})}async*_streamIterator(e,t){var m;const r=Ze(t),s=await Er(r),{runId:a,...l}=r,u=await(s==null?void 0:s.handleChainStart(this.toJSON(),jt(e,"input"),a,void 0,void 0,void 0,l==null?void 0:l.runName));let c,f;for(const g of this.runnables()){(m=r==null?void 0:r.signal)==null||m.throwIfAborted();const y=en(l,{callbacks:u==null?void 0:u.getChild()});try{const w=await g.stream(e,y);f=ny(y,w);break}catch(w){c===void 0&&(c=w)}}if(f===void 0){const g=c??new Error("No error stored at end of fallback.");throw await(u==null?void 0:u.handleChainError(g)),g}let h;try{for await(const g of f){yield g;try{h=h===void 0?h:Xn(h,g)}catch{h=void 0}}}catch(g){throw await(u==null?void 0:u.handleChainError(g)),g}await(u==null?void 0:u.handleChainEnd(jt(h,"output")))}async batch(e,t,r){var c;if(r!=null&&r.returnExceptions)throw new Error("Not implemented.");const s=this._getOptionsList(t??{},e.length),a=await Promise.all(s.map(f=>Er(f))),l=await Promise.all(a.map(async(f,h)=>{const m=await(f==null?void 0:f.handleChainStart(this.toJSON(),jt(e[h],"input"),s[h].runId,void 0,void 0,void 0,s[h].runName));return delete s[h].runId,m}));let u;for(const f of this.runnables()){(c=s[0].signal)==null||c.throwIfAborted();try{const h=await f.batch(e,l.map((m,g)=>en(s[g],{callbacks:m==null?void 0:m.getChild()})),r);return await Promise.all(l.map((m,g)=>m==null?void 0:m.handleChainEnd(jt(h[g],"output")))),h}catch(h){u===void 0&&(u=h)}}throw u?(await Promise.all(l.map(f=>f==null?void 0:f.handleChainError(u))),u):new Error("No error stored at end of fallbacks.")}}function Da(n){if(typeof n=="function")return new So({func:n});if(Lt.isRunnable(n))return n;if(!Array.isArray(n)&&typeof n=="object"){const e={};for(const[t,r]of Object.entries(n))e[t]=Da(r);return new xo({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class iP extends Lt{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof xo&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,t){const r=await this.mapper.invoke(e,t);return{...e,...r}}async*_transform(e,t,r){const s=this.mapper.getStepsKeys(),[a,l]=QC(e),u=this.mapper.transform(l,en(r,{callbacks:t==null?void 0:t.getChild()})),c=u.next();for await(const f of a){if(typeof f!="object"||Array.isArray(f))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof f}`);const h=Object.fromEntries(Object.entries(f).filter(([m])=>!s.includes(m)));Object.keys(h).length>0&&(yield h)}yield(await c).value;for await(const f of u)yield f}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const s=Ze(t),a=new vo({generator:this.transform(r(),s),config:s});return await a.setup,Fn.fromAsyncGenerator(a)}}class pD extends Lt{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const t=this.keys.map(r=>[r,e[r]]).filter(r=>r[1]!==void 0);return t.length===0?void 0:Object.fromEntries(t)}}async invoke(e,t){return this._callWithConfig(this._pick.bind(this),e,t)}async*_transform(e){for await(const t of e){const r=await this._pick(t);r!==void 0&&(yield r)}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const s=Ze(t),a=new vo({generator:this.transform(r(),s),config:s});return await a.setup,Fn.fromAsyncGenerator(a)}}class BS extends Ba{constructor(e){const t=Cs.from([So.from(async r=>{let s;if(kC(r))try{s=await this.schema.parseAsync(r.args)}catch{throw new KL("Received tool input did not match expected schema",JSON.stringify(r.args))}else s=r;return s}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:t,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function mD(n,e){var s;const t=e.name??n.getName(),r=e.description??((s=e.schema)==null?void 0:s.description);return e.schema.constructor===Se.ZodString?new BS({name:t,description:r,schema:Se.object({input:Se.string()}).transform(a=>a.input),bound:n}):new BS({name:t,description:r,schema:e.schema,bound:n})}/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var gD=typeof window=="object"?window:{},Le="0123456789abcdef".split(""),yD=[-2147483648,8388608,32768,128],hr=[24,16,8,0],It=[];function Or(n){n?(It[0]=It[16]=It[1]=It[2]=It[3]=It[4]=It[5]=It[6]=It[7]=It[8]=It[9]=It[10]=It[11]=It[12]=It[13]=It[14]=It[15]=0,this.blocks=It):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Or.prototype.update=function(n){if(!this.finalized){var e=typeof n!="string";e&&n.constructor===gD.ArrayBuffer&&(n=new Uint8Array(n));for(var t,r=0,s,a=n.length||0,l=this.blocks;r<a;){if(this.hashed&&(this.hashed=!1,l[0]=this.block,l[16]=l[1]=l[2]=l[3]=l[4]=l[5]=l[6]=l[7]=l[8]=l[9]=l[10]=l[11]=l[12]=l[13]=l[14]=l[15]=0),e)for(s=this.start;r<a&&s<64;++r)l[s>>2]|=n[r]<<hr[s++&3];else for(s=this.start;r<a&&s<64;++r)t=n.charCodeAt(r),t<128?l[s>>2]|=t<<hr[s++&3]:t<2048?(l[s>>2]|=(192|t>>6)<<hr[s++&3],l[s>>2]|=(128|t&63)<<hr[s++&3]):t<55296||t>=57344?(l[s>>2]|=(224|t>>12)<<hr[s++&3],l[s>>2]|=(128|t>>6&63)<<hr[s++&3],l[s>>2]|=(128|t&63)<<hr[s++&3]):(t=65536+((t&1023)<<10|n.charCodeAt(++r)&1023),l[s>>2]|=(240|t>>18)<<hr[s++&3],l[s>>2]|=(128|t>>12&63)<<hr[s++&3],l[s>>2]|=(128|t>>6&63)<<hr[s++&3],l[s>>2]|=(128|t&63)<<hr[s++&3]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=l[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};Or.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var n=this.blocks,e=this.lastByteIndex;n[16]=this.block,n[e>>2]|=yD[e&3],this.block=n[16],e>=56&&(this.hashed||this.hash(),n[0]=this.block,n[16]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=n[11]=n[12]=n[13]=n[14]=n[15]=0),n[14]=this.hBytes<<3|this.bytes>>>29,n[15]=this.bytes<<3,this.hash()}};Or.prototype.hash=function(){var n=this.h0,e=this.h1,t=this.h2,r=this.h3,s=this.h4,a,l,u,c=this.blocks;for(l=16;l<80;++l)u=c[l-3]^c[l-8]^c[l-14]^c[l-16],c[l]=u<<1|u>>>31;for(l=0;l<20;l+=5)a=e&t|~e&r,u=n<<5|n>>>27,s=u+a+s+1518500249+c[l]<<0,e=e<<30|e>>>2,a=n&e|~n&t,u=s<<5|s>>>27,r=u+a+r+1518500249+c[l+1]<<0,n=n<<30|n>>>2,a=s&n|~s&e,u=r<<5|r>>>27,t=u+a+t+1518500249+c[l+2]<<0,s=s<<30|s>>>2,a=r&s|~r&n,u=t<<5|t>>>27,e=u+a+e+1518500249+c[l+3]<<0,r=r<<30|r>>>2,a=t&r|~t&s,u=e<<5|e>>>27,n=u+a+n+1518500249+c[l+4]<<0,t=t<<30|t>>>2;for(;l<40;l+=5)a=e^t^r,u=n<<5|n>>>27,s=u+a+s+1859775393+c[l]<<0,e=e<<30|e>>>2,a=n^e^t,u=s<<5|s>>>27,r=u+a+r+1859775393+c[l+1]<<0,n=n<<30|n>>>2,a=s^n^e,u=r<<5|r>>>27,t=u+a+t+1859775393+c[l+2]<<0,s=s<<30|s>>>2,a=r^s^n,u=t<<5|t>>>27,e=u+a+e+1859775393+c[l+3]<<0,r=r<<30|r>>>2,a=t^r^s,u=e<<5|e>>>27,n=u+a+n+1859775393+c[l+4]<<0,t=t<<30|t>>>2;for(;l<60;l+=5)a=e&t|e&r|t&r,u=n<<5|n>>>27,s=u+a+s-1894007588+c[l]<<0,e=e<<30|e>>>2,a=n&e|n&t|e&t,u=s<<5|s>>>27,r=u+a+r-1894007588+c[l+1]<<0,n=n<<30|n>>>2,a=s&n|s&e|n&e,u=r<<5|r>>>27,t=u+a+t-1894007588+c[l+2]<<0,s=s<<30|s>>>2,a=r&s|r&n|s&n,u=t<<5|t>>>27,e=u+a+e-1894007588+c[l+3]<<0,r=r<<30|r>>>2,a=t&r|t&s|r&s,u=e<<5|e>>>27,n=u+a+n-1894007588+c[l+4]<<0,t=t<<30|t>>>2;for(;l<80;l+=5)a=e^t^r,u=n<<5|n>>>27,s=u+a+s-899497514+c[l]<<0,e=e<<30|e>>>2,a=n^e^t,u=s<<5|s>>>27,r=u+a+r-899497514+c[l+1]<<0,n=n<<30|n>>>2,a=s^n^e,u=r<<5|r>>>27,t=u+a+t-899497514+c[l+2]<<0,s=s<<30|s>>>2,a=r^s^n,u=t<<5|t>>>27,e=u+a+e-899497514+c[l+3]<<0,r=r<<30|r>>>2,a=t^r^s,u=e<<5|e>>>27,n=u+a+n-899497514+c[l+4]<<0,t=t<<30|t>>>2;this.h0=this.h0+n<<0,this.h1=this.h1+e<<0,this.h2=this.h2+t<<0,this.h3=this.h3+r<<0,this.h4=this.h4+s<<0};Or.prototype.hex=function(){this.finalize();var n=this.h0,e=this.h1,t=this.h2,r=this.h3,s=this.h4;return Le[n>>28&15]+Le[n>>24&15]+Le[n>>20&15]+Le[n>>16&15]+Le[n>>12&15]+Le[n>>8&15]+Le[n>>4&15]+Le[n&15]+Le[e>>28&15]+Le[e>>24&15]+Le[e>>20&15]+Le[e>>16&15]+Le[e>>12&15]+Le[e>>8&15]+Le[e>>4&15]+Le[e&15]+Le[t>>28&15]+Le[t>>24&15]+Le[t>>20&15]+Le[t>>16&15]+Le[t>>12&15]+Le[t>>8&15]+Le[t>>4&15]+Le[t&15]+Le[r>>28&15]+Le[r>>24&15]+Le[r>>20&15]+Le[r>>16&15]+Le[r>>12&15]+Le[r>>8&15]+Le[r>>4&15]+Le[r&15]+Le[s>>28&15]+Le[s>>24&15]+Le[s>>20&15]+Le[s>>16&15]+Le[s>>12&15]+Le[s>>8&15]+Le[s>>4&15]+Le[s&15]};Or.prototype.toString=Or.prototype.hex;Or.prototype.digest=function(){this.finalize();var n=this.h0,e=this.h1,t=this.h2,r=this.h3,s=this.h4;return[n>>24&255,n>>16&255,n>>8&255,n&255,e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,r>>24&255,r>>16&255,r>>8&255,r&255,s>>24&255,s>>16&255,s>>8&255,s&255]};Or.prototype.array=Or.prototype.digest;Or.prototype.arrayBuffer=function(){this.finalize();var n=new ArrayBuffer(20),e=new DataView(n);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),n};const _D=n=>new Or(!0).update(n).hex(),HS=(...n)=>_D(n.join("_"));class wD{}const bD=new Map;class L_ extends wD{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(HS(e,t))??null)}async update(e,t,r){this.cache.set(HS(e,t),r)}static global(){return new L_(bD)}}class oP extends Ja{}class vD extends oP{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new to(this.value)]}}class xD extends oP{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return RC(this.messages)}toChatMessages(){return this.messages}}var xl={},WS;function SD(){if(WS)return xl;WS=1,xl.byteLength=u,xl.toByteArray=f,xl.fromByteArray=g;for(var n=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=r.length;s<a;++s)n[s]=r[s],e[r.charCodeAt(s)]=s;e[45]=62,e[95]=63;function l(y){var w=y.length;if(w%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=y.indexOf("=");v===-1&&(v=w);var x=v===w?0:4-v%4;return[v,x]}function u(y){var w=l(y),v=w[0],x=w[1];return(v+x)*3/4-x}function c(y,w,v){return(w+v)*3/4-v}function f(y){var w,v=l(y),x=v[0],E=v[1],P=new t(c(y,x,E)),S=0,R=E>0?x-4:x,$;for($=0;$<R;$+=4)w=e[y.charCodeAt($)]<<18|e[y.charCodeAt($+1)]<<12|e[y.charCodeAt($+2)]<<6|e[y.charCodeAt($+3)],P[S++]=w>>16&255,P[S++]=w>>8&255,P[S++]=w&255;return E===2&&(w=e[y.charCodeAt($)]<<2|e[y.charCodeAt($+1)]>>4,P[S++]=w&255),E===1&&(w=e[y.charCodeAt($)]<<10|e[y.charCodeAt($+1)]<<4|e[y.charCodeAt($+2)]>>2,P[S++]=w>>8&255,P[S++]=w&255),P}function h(y){return n[y>>18&63]+n[y>>12&63]+n[y>>6&63]+n[y&63]}function m(y,w,v){for(var x,E=[],P=w;P<v;P+=3)x=(y[P]<<16&16711680)+(y[P+1]<<8&65280)+(y[P+2]&255),E.push(h(x));return E.join("")}function g(y){for(var w,v=y.length,x=v%3,E=[],P=16383,S=0,R=v-x;S<R;S+=P)E.push(m(y,S,S+P>R?R:S+P));return x===1?(w=y[v-1],E.push(n[w>>2]+n[w<<4&63]+"==")):x===2&&(w=(y[v-2]<<8)+y[v-1],E.push(n[w>>10]+n[w>>4&63]+n[w<<2&63]+"=")),E.join("")}return xl}var ED=SD();const CD=ti(ED);var PD=Object.defineProperty,kD=(n,e,t)=>e in n?PD(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,RD=(n,e,t)=>(kD(n,e+"",t),t);function OD(n,e){let t=Array.from({length:n.length},(r,s)=>({start:s,end:s+1}));for(;t.length>1;){let r=null;for(let s=0;s<t.length-1;s++){const a=n.slice(t[s].start,t[s+1].end),l=e.get(a.join(","));l!=null&&(r==null||l<r[0])&&(r=[l,s])}if(r!=null){const s=r[1];t[s]={start:t[s].start,end:t[s+1].end},t.splice(s+1,1)}else break}return t}function TD(n,e){return n.length===1?[e.get(n.join(","))]:OD(n,e).map(t=>e.get(n.slice(t.start,t.end).join(","))).filter(t=>t!=null)}function AD(n){return n.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var ry=class{constructor(n,e){Qs(this,"specialTokens");Qs(this,"inverseSpecialTokens");Qs(this,"patStr");Qs(this,"textEncoder",new TextEncoder);Qs(this,"textDecoder",new TextDecoder("utf-8"));Qs(this,"rankMap",new Map);Qs(this,"textMap",new Map);this.patStr=n.pat_str;const t=n.bpe_ranks.split(`
`).filter(Boolean).reduce((r,s)=>{const[a,l,...u]=s.split(" "),c=Number.parseInt(l,10);return u.forEach((f,h)=>r[f]=c+h),r},{});for(const[r,s]of Object.entries(t)){const a=CD.toByteArray(r);this.rankMap.set(a.join(","),s),this.textMap.set(s,a)}this.specialTokens={...n.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((r,[s,a])=>(r[a]=this.textEncoder.encode(s),r),{})}encode(n,e=[],t="all"){const r=new RegExp(this.patStr,"ug"),s=ry.specialTokenRegex(Object.keys(this.specialTokens)),a=[],l=new Set(e==="all"?Object.keys(this.specialTokens):e),u=new Set(t==="all"?Object.keys(this.specialTokens).filter(f=>!l.has(f)):t);if(u.size>0){const f=ry.specialTokenRegex([...u]),h=n.match(f);if(h!=null)throw new Error(`The text contains a special token that is not allowed: ${h[0]}`)}let c=0;for(;;){let f=null,h=c;for(;s.lastIndex=h,f=s.exec(n),!(f==null||l.has(f[0]));)h=f.index+1;const m=(f==null?void 0:f.index)??n.length;for(const y of n.substring(c,m).matchAll(r)){const w=this.textEncoder.encode(y[0]),v=this.rankMap.get(w.join(","));if(v!=null){a.push(v);continue}a.push(...TD(w,this.rankMap))}if(f==null)break;let g=this.specialTokens[f[0]];a.push(g),c=f.index+f[0].length}return a}decode(n){const e=[];let t=0;for(let a=0;a<n.length;++a){const l=n[a],u=this.textMap.get(l)??this.inverseSpecialTokens[l];u!=null&&(e.push(u),t+=u.length)}const r=new Uint8Array(t);let s=0;for(const a of e)r.set(a,s),s+=a.length;return this.textDecoder.decode(r)}},lP=ry;RD(lP,"specialTokenRegex",n=>new RegExp(n.map(e=>AD(e)).join("|"),"g"));function $D(n){switch(n){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-preview":case"o1-preview-2024-09-12":case"o1-mini-2024-09-12":case"o3-mini":case"o3-mini-2025-01-31":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":return"o200k_base";default:throw new Error("Unknown model")}}const nd={},ID=new I_({});async function ND(n){return n in nd||(nd[n]=ID.fetch(`https://tiktoken.pages.dev/js/${n}.json`).then(e=>e.json()).then(e=>new lP(e)).catch(e=>{throw delete nd[n],e})),await nd[n]}async function jD(n){return ND($D(n))}const LD=n=>n.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":n.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":n.startsWith("gpt-4-32k")?"gpt-4-32k":n.startsWith("gpt-4-")?"gpt-4":n.startsWith("gpt-4o")?"gpt-4o":n;function uP(n){return typeof n!="object"||!n?!1:!!("type"in n&&n.type==="function"&&"function"in n&&typeof n.function=="object"&&n.function&&"name"in n.function&&"parameters"in n.function)}const MD=()=>!1;class DD extends Lt{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??MD(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class FD extends DD{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:t,...r}){const{cache:s,...a}=r;super({callbacks:e??t,...a}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof s=="object"?this.cache=s:s?this.cache=L_.global():this.cache=void 0,this.caller=new I_(r??{})}async getNumTokens(e){if(typeof e!="string")return 0;let t=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await jD("modelName"in this?LD(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{t=this._encoding.encode(e).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return t}static _convertInputToPromptValue(e){return typeof e=="string"?new vD(e):Array.isArray(e)?new xD(e.map(Sl)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...t}){const r={...this._identifyingParams(),...t,_type:this._llmType(),_model:this._modelType()};return Object.entries(r).filter(([l,u])=>u!==void 0).map(([l,u])=>`${l}:${JSON.stringify(u)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}class Gd extends Lt{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,t){const r=Ze(t);return this.func&&await this.func(e,r),this._callWithConfig(s=>Promise.resolve(s),e,r)}async*transform(e,t){const r=Ze(t);let s,a=!0;for await(const l of this._transformStreamWithConfig(e,u=>u,r))if(yield l,a)if(s===void 0)s=l;else try{s=Xn(s,l)}catch{s=void 0,a=!1}this.func&&s!==void 0&&await this.func(s,r)}static assign(e){return new iP(new xo({steps:e}))}}function M_(n){var r;if(!n||typeof n!="object"||Array.isArray(n))return!1;const e=n;return e._def||Object.values(Se.ZodFirstPartyTypeKind).includes(((r=e.constructor)==null?void 0:r.name)??"NOT_INCLUDED")?!0:typeof e.parse=="function"&&typeof e.parseAsync=="function"&&typeof e.safeParse=="function"&&typeof e.safeParseAsync=="function"}class Ss extends FD{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]}),Object.defineProperty(this,"disableStreaming",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_separateRunnableConfigFromCallOptionsCompat(e){const[t,r]=super._separateRunnableConfigFromCallOptions(e);return r.signal=t.signal,[t,r]}async invoke(e,t){const r=Ss._convertInputToPromptValue(e);return(await this.generatePrompt([r],t,t==null?void 0:t.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,t,r){throw new Error("Not implemented.")}async*_streamIterator(e,t){var r;if(this._streamResponseChunks===Ss.prototype._streamResponseChunks||this.disableStreaming)yield this.invoke(e,t);else{const a=Ss._convertInputToPromptValue(e).toChatMessages(),[l,u]=this._separateRunnableConfigFromCallOptionsCompat(t),c={...l.metadata,...this.getLsParams(u)},f=await Sn.configure(l.callbacks,this.callbacks,l.tags,this.tags,c,this.metadata,{verbose:this.verbose}),h={options:u,invocation_params:this==null?void 0:this.invocationParams(u),batch_size:1},m=await(f==null?void 0:f.handleChatModelStart(this.toJSON(),[a],l.runId,void 0,h,void 0,void 0,l.runName));let g,y;try{for await(const w of this._streamResponseChunks(a,u,m==null?void 0:m[0])){if(w.message.id==null){const v=(r=m==null?void 0:m.at(0))==null?void 0:r.runId;v!=null&&w.message._updateId(`run-${v}`)}w.message.response_metadata={...w.generationInfo,...w.message.response_metadata},yield w.message,g?g=g.concat(w):g=w,dx(w.message)&&w.message.usage_metadata!==void 0&&(y={tokenUsage:{promptTokens:w.message.usage_metadata.input_tokens,completionTokens:w.message.usage_metadata.output_tokens,totalTokens:w.message.usage_metadata.total_tokens}})}}catch(w){throw await Promise.all((m??[]).map(v=>v==null?void 0:v.handleLLMError(w))),w}await Promise.all((m??[]).map(w=>w==null?void 0:w.handleLLMEnd({generations:[[g]],llmOutput:y})))}}getLsParams(e){const t=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:t}}async _generateUncached(e,t,r,s){var m,g;const a=e.map(y=>y.map(Sl));let l;if(s!==void 0&&s.length===a.length)l=s;else{const y={...r.metadata,...this.getLsParams(t)},w=await Sn.configure(r.callbacks,this.callbacks,r.tags,this.tags,y,this.metadata,{verbose:this.verbose}),v={options:t,invocation_params:this==null?void 0:this.invocationParams(t),batch_size:1};l=await(w==null?void 0:w.handleChatModelStart(this.toJSON(),a,r.runId,void 0,v,void 0,void 0,r.runName))}const u=[],c=[];if(!!(l!=null&&l[0].handlers.find(H3))&&!this.disableStreaming&&a.length===1&&this._streamResponseChunks!==Ss.prototype._streamResponseChunks)try{const y=await this._streamResponseChunks(a[0],t,l==null?void 0:l[0]);let w,v;for await(const x of y){if(x.message.id==null){const E=(m=l==null?void 0:l.at(0))==null?void 0:m.runId;E!=null&&x.message._updateId(`run-${E}`)}w===void 0?w=x:w=Xn(w,x),dx(x.message)&&x.message.usage_metadata!==void 0&&(v={tokenUsage:{promptTokens:x.message.usage_metadata.input_tokens,completionTokens:x.message.usage_metadata.output_tokens,totalTokens:x.message.usage_metadata.total_tokens}})}if(w===void 0)throw new Error("Received empty response from chat model call.");u.push([w]),await(l==null?void 0:l[0].handleLLMEnd({generations:u,llmOutput:v}))}catch(y){throw await(l==null?void 0:l[0].handleLLMError(y)),y}else{const y=await Promise.allSettled(a.map((w,v)=>this._generate(w,{...t,promptIndex:v},l==null?void 0:l[v])));await Promise.all(y.map(async(w,v)=>{var x,E,P;if(w.status==="fulfilled"){const S=w.value;for(const R of S.generations){if(R.message.id==null){const $=(x=l==null?void 0:l.at(0))==null?void 0:x.runId;$!=null&&R.message._updateId(`run-${$}`)}R.message.response_metadata={...R.generationInfo,...R.message.response_metadata}}return S.generations.length===1&&(S.generations[0].message.response_metadata={...S.llmOutput,...S.generations[0].message.response_metadata}),u[v]=S.generations,c[v]=S.llmOutput,(E=l==null?void 0:l[v])==null?void 0:E.handleLLMEnd({generations:[S.generations],llmOutput:S.llmOutput})}else return await((P=l==null?void 0:l[v])==null?void 0:P.handleLLMError(w.reason)),Promise.reject(w.reason)}))}const h={generations:u,llmOutput:c.length?(g=this._combineLLMOutput)==null?void 0:g.call(this,...c):void 0};return Object.defineProperty(h,jS,{value:l?{runIds:l==null?void 0:l.map(y=>y.runId)}:void 0,configurable:!0}),h}async _generateCached({messages:e,cache:t,llmStringKey:r,parsedOptions:s,handledOptions:a}){const l=e.map(x=>x.map(Sl)),u={...a.metadata,...this.getLsParams(s)},c=await Sn.configure(a.callbacks,this.callbacks,a.tags,this.tags,u,this.metadata,{verbose:this.verbose}),f={options:s,invocation_params:this==null?void 0:this.invocationParams(s),batch_size:1},h=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),l,a.runId,void 0,f,void 0,void 0,a.runName)),m=[],y=(await Promise.allSettled(l.map(async(x,E)=>{const P=Ss._convertInputToPromptValue(x).toString(),S=await t.lookup(P,r);return S==null&&m.push(E),S}))).map((x,E)=>({result:x,runManager:h==null?void 0:h[E]})).filter(({result:x})=>x.status==="fulfilled"&&x.value!=null||x.status==="rejected"),w=[];await Promise.all(y.map(async({result:x,runManager:E},P)=>{if(x.status==="fulfilled"){const S=x.value;return w[P]=S.map(R=>("message"in R&&xf(R.message)&&vu(R.message)&&(R.message.usage_metadata={input_tokens:0,output_tokens:0,total_tokens:0}),R.generationInfo={...R.generationInfo,tokenUsage:{}},R)),S.length&&await(E==null?void 0:E.handleLLMNewToken(S[0].text)),E==null?void 0:E.handleLLMEnd({generations:[S]},void 0,void 0,void 0,{cached:!0})}else return await(E==null?void 0:E.handleLLMError(x.reason,void 0,void 0,void 0,{cached:!0})),Promise.reject(x.reason)}));const v={generations:w,missingPromptIndices:m,startedRunManagers:h};return Object.defineProperty(v,jS,{value:h?{runIds:h==null?void 0:h.map(x=>x.runId)}:void 0,configurable:!0}),v}async generate(e,t,r){let s;Array.isArray(t)?s={stop:t}:s=t;const a=e.map(w=>w.map(Sl)),[l,u]=this._separateRunnableConfigFromCallOptionsCompat(s);if(l.callbacks=l.callbacks??r,!this.cache)return this._generateUncached(a,u,l);const{cache:c}=this,f=this._getSerializedCacheKeyParametersForCall(u),{generations:h,missingPromptIndices:m,startedRunManagers:g}=await this._generateCached({messages:a,cache:c,llmStringKey:f,parsedOptions:u,handledOptions:l});let y={};if(m.length>0){const w=await this._generateUncached(m.map(v=>a[v]),u,l,g!==void 0?m.map(v=>g==null?void 0:g[v]):void 0);await Promise.all(w.generations.map(async(v,x)=>{const E=m[x];h[E]=v;const P=Ss._convertInputToPromptValue(a[E]).toString();return c.update(P,f,v)})),y=w.llmOutput??{}}return{generations:h,llmOutput:y}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,t,r){const s=e.map(a=>a.toChatMessages());return this.generate(s,t,r)}async call(e,t,r){return(await this.generate([e.map(Sl)],t,r)).generations[0][0].message}async callPrompt(e,t,r){const s=e.toChatMessages();return this.call(s,t,r)}async predictMessages(e,t,r){return this.call(e,t,r)}async predict(e,t,r){const s=new to(e),a=await this.call([s],t,r);if(typeof a.content!="string")throw new Error("Cannot use predict when output is not a string.");return a.content}withStructuredOutput(e,t){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(t!=null&&t.strict)throw new Error('"strict" mode is not supported for this model by default.');const r=e,s=t==null?void 0:t.name,a=r.description??"A function available to call.",l=t==null?void 0:t.method,u=t==null?void 0:t.includeRaw;if(l==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let c=s??"extract",f;M_(r)?f=[{type:"function",function:{name:c,description:a,parameters:ku(r)}}]:("name"in r&&(c=r.name),f=[{type:"function",function:{name:c,description:a,parameters:r}}]);const h=this.bindTools(f),m=So.from(v=>{if(!v.tool_calls||v.tool_calls.length===0)throw new Error("No tool calls found in the response.");const x=v.tool_calls.find(E=>E.name===c);if(!x)throw new Error(`No tool call found with name ${c}.`);return x.args});if(!u)return h.pipe(m).withConfig({runName:"StructuredOutput"});const g=Gd.assign({parsed:(v,x)=>m.invoke(v.raw,x)}),y=Gd.assign({parsed:()=>null}),w=g.withFallbacks({fallbacks:[y]});return Cs.from([{raw:h},w]).withConfig({runName:"StructuredOutputRunnable"})}}var Bt=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{},un={searchParams:"URLSearchParams"in Bt,iterable:"Symbol"in Bt&&"iterator"in Symbol,blob:"FileReader"in Bt&&"Blob"in Bt&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in Bt,arrayBuffer:"ArrayBuffer"in Bt};function UD(n){return n&&DataView.prototype.isPrototypeOf(n)}if(un.arrayBuffer)var zD=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],BD=ArrayBuffer.isView||function(n){return n&&zD.indexOf(Object.prototype.toString.call(n))>-1};function Eo(n){if(typeof n!="string"&&(n=String(n)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(n)||n==="")throw new TypeError('Invalid character in header field name: "'+n+'"');return n.toLowerCase()}function D_(n){return typeof n!="string"&&(n=String(n)),n}function F_(n){var e={next:function(){var t=n.shift();return{done:t===void 0,value:t}}};return un.iterable&&(e[Symbol.iterator]=function(){return e}),e}function Rt(n){this.map={},n instanceof Rt?n.forEach(function(e,t){this.append(t,e)},this):Array.isArray(n)?n.forEach(function(e){if(e.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(e){this.append(e,n[e])},this)}Rt.prototype.append=function(n,e){n=Eo(n),e=D_(e);var t=this.map[n];this.map[n]=t?t+", "+e:e};Rt.prototype.delete=function(n){delete this.map[Eo(n)]};Rt.prototype.get=function(n){return n=Eo(n),this.has(n)?this.map[n]:null};Rt.prototype.has=function(n){return this.map.hasOwnProperty(Eo(n))};Rt.prototype.set=function(n,e){this.map[Eo(n)]=D_(e)};Rt.prototype.forEach=function(n,e){for(var t in this.map)this.map.hasOwnProperty(t)&&n.call(e,this.map[t],t,this)};Rt.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),F_(n)};Rt.prototype.values=function(){var n=[];return this.forEach(function(e){n.push(e)}),F_(n)};Rt.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),F_(n)};un.iterable&&(Rt.prototype[Symbol.iterator]=Rt.prototype.entries);function fg(n){if(!n._noBody){if(n.bodyUsed)return Promise.reject(new TypeError("Already read"));n.bodyUsed=!0}}function cP(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function HD(n){var e=new FileReader,t=cP(e);return e.readAsArrayBuffer(n),t}function WD(n){var e=new FileReader,t=cP(e),r=/charset=([A-Za-z0-9_-]+)/.exec(n.type),s=r?r[1]:"utf-8";return e.readAsText(n,s),t}function VD(n){for(var e=new Uint8Array(n),t=new Array(e.length),r=0;r<e.length;r++)t[r]=String.fromCharCode(e[r]);return t.join("")}function VS(n){if(n.slice)return n.slice(0);var e=new Uint8Array(n.byteLength);return e.set(new Uint8Array(n)),e.buffer}function dP(){return this.bodyUsed=!1,this._initBody=function(n){this.bodyUsed=this.bodyUsed,this._bodyInit=n,n?typeof n=="string"?this._bodyText=n:un.blob&&Blob.prototype.isPrototypeOf(n)?this._bodyBlob=n:un.formData&&FormData.prototype.isPrototypeOf(n)?this._bodyFormData=n:un.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)?this._bodyText=n.toString():un.arrayBuffer&&un.blob&&UD(n)?(this._bodyArrayBuffer=VS(n.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):un.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(n)||BD(n))?this._bodyArrayBuffer=VS(n):this._bodyText=n=Object.prototype.toString.call(n):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof n=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):un.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},un.blob&&(this.blob=function(){var n=fg(this);if(n)return n;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var n=fg(this);return n||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(un.blob)return this.blob().then(HD);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var n=fg(this);if(n)return n;if(this._bodyBlob)return WD(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(VD(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},un.formData&&(this.formData=function(){return this.text().then(GD)}),this.json=function(){return this.text().then(JSON.parse)},this}var qD=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function ZD(n){var e=n.toUpperCase();return qD.indexOf(e)>-1?e:n}function ei(n,e){if(!(this instanceof ei))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{};var t=e.body;if(n instanceof ei){if(n.bodyUsed)throw new TypeError("Already read");this.url=n.url,this.credentials=n.credentials,e.headers||(this.headers=new Rt(n.headers)),this.method=n.method,this.mode=n.mode,this.signal=n.signal,!t&&n._bodyInit!=null&&(t=n._bodyInit,n.bodyUsed=!0)}else this.url=String(n);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new Rt(e.headers)),this.method=ZD(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in Bt){var a=new AbortController;return a.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&t)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(t),(this.method==="GET"||this.method==="HEAD")&&(e.cache==="no-store"||e.cache==="no-cache")){var r=/([?&])_=[^&]*/;if(r.test(this.url))this.url=this.url.replace(r,"$1_="+new Date().getTime());else{var s=/\?/;this.url+=(s.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}ei.prototype.clone=function(){return new ei(this,{body:this._bodyInit})};function GD(n){var e=new FormData;return n.trim().split("&").forEach(function(t){if(t){var r=t.split("="),s=r.shift().replace(/\+/g," "),a=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(s),decodeURIComponent(a))}}),e}function JD(n){var e=new Rt,t=n.replace(/\r?\n[\t ]+/g," ");return t.split("\r").map(function(r){return r.indexOf(`
`)===0?r.substr(1,r.length):r}).forEach(function(r){var s=r.split(":"),a=s.shift().trim();if(a){var l=s.join(":").trim();try{e.append(a,l)}catch(u){console.warn("Response "+u.message)}}}),e}dP.call(ei.prototype);function ns(n,e){if(!(this instanceof ns))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new Rt(e.headers),this.url=e.url||"",this._initBody(n)}dP.call(ns.prototype);ns.prototype.clone=function(){return new ns(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Rt(this.headers),url:this.url})};ns.error=function(){var n=new ns(null,{status:200,statusText:""});return n.ok=!1,n.status=0,n.type="error",n};var KD=[301,302,303,307,308];ns.redirect=function(n,e){if(KD.indexOf(e)===-1)throw new RangeError("Invalid status code");return new ns(null,{status:e,headers:{location:n}})};var La=Bt.DOMException;try{new La}catch{La=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},La.prototype=Object.create(Error.prototype),La.prototype.constructor=La}function fP(n,e){return new Promise(function(t,r){var s=new ei(n,e);if(s.signal&&s.signal.aborted)return r(new La("Aborted","AbortError"));var a=new XMLHttpRequest;function l(){a.abort()}a.onload=function(){var f={statusText:a.statusText,headers:JD(a.getAllResponseHeaders()||"")};s.url.indexOf("file://")===0&&(a.status<200||a.status>599)?f.status=200:f.status=a.status,f.url="responseURL"in a?a.responseURL:f.headers.get("X-Request-URL");var h="response"in a?a.response:a.responseText;setTimeout(function(){t(new ns(h,f))},0)},a.onerror=function(){setTimeout(function(){r(new TypeError("Network request failed"))},0)},a.ontimeout=function(){setTimeout(function(){r(new TypeError("Network request timed out"))},0)},a.onabort=function(){setTimeout(function(){r(new La("Aborted","AbortError"))},0)};function u(f){try{return f===""&&Bt.location.href?Bt.location.href:f}catch{return f}}if(a.open(s.method,u(s.url),!0),s.credentials==="include"?a.withCredentials=!0:s.credentials==="omit"&&(a.withCredentials=!1),"responseType"in a&&(un.blob?a.responseType="blob":un.arrayBuffer&&(a.responseType="arraybuffer")),e&&typeof e.headers=="object"&&!(e.headers instanceof Rt||Bt.Headers&&e.headers instanceof Bt.Headers)){var c=[];Object.getOwnPropertyNames(e.headers).forEach(function(f){c.push(Eo(f)),a.setRequestHeader(f,D_(e.headers[f]))}),s.headers.forEach(function(f,h){c.indexOf(h)===-1&&a.setRequestHeader(h,f)})}else s.headers.forEach(function(f,h){a.setRequestHeader(h,f)});s.signal&&(s.signal.addEventListener("abort",l),a.onreadystatechange=function(){a.readyState===4&&s.signal.removeEventListener("abort",l)}),a.send(typeof s._bodyInit>"u"?null:s._bodyInit)})}fP.polyfill=!0;Bt.fetch||(Bt.fetch=fP,Bt.Headers=Rt,Bt.Request=ei,Bt.Response=ns);const XD="0.5.12";var YD=Object.defineProperty,QD=(n,e,t)=>e in n?YD(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,hg=(n,e,t)=>(QD(n,typeof e!="symbol"?e+"":e,t),t);class U_ extends Error{constructor(e,t){super(e),this.error=e,this.status_code=t,this.name="ResponseError",Error.captureStackTrace&&Error.captureStackTrace(this,U_)}}class eF{constructor(e,t,r){hg(this,"abortController"),hg(this,"itr"),hg(this,"doneCallback"),this.abortController=e,this.itr=t,this.doneCallback=r}abort(){this.abortController.abort()}async*[Symbol.asyncIterator](){for await(const e of this.itr){if("error"in e)throw new Error(e.error);if(yield e,e.done||e.status==="success"){this.doneCallback();return}}throw new Error("Did not receive done or success response in stream.")}}const z_=async n=>{var r;if(n.ok)return;let e=`Error ${n.status}: ${n.statusText}`,t=null;if((r=n.headers.get("content-type"))!=null&&r.includes("application/json"))try{t=await n.json(),e=t.error||e}catch{console.log("Failed to parse error response as JSON")}else try{console.log("Getting text from response"),e=await n.text()||e}catch{console.log("Failed to get text from error response")}throw new U_(e,n.status)};function tF(){return typeof window<"u"&&window.navigator?`${window.navigator.platform.toLowerCase()} Browser/${navigator.userAgent};`:typeof process<"u"?`${process.arch} ${process.platform} Node.js/${process.version}`:""}const B_=async(n,e,t={})=>{const r={"Content-Type":"application/json",Accept:"application/json","User-Agent":`ollama-js/${XD} (${tF()})`};t.headers||(t.headers={});const s=Object.fromEntries(Object.entries(t.headers).filter(([a])=>!Object.keys(r).some(l=>l.toLowerCase()===a.toLowerCase())));return t.headers={...r,...s},n(e,t)},qS=async(n,e,t)=>{const r=await B_(n,e,{headers:t==null?void 0:t.headers});return await z_(r),r},Ni=async(n,e,t,r)=>{const a=(u=>u!==null&&typeof u=="object"&&!Array.isArray(u))(t)?JSON.stringify(t):t,l=await B_(n,e,{method:"POST",body:a,signal:r==null?void 0:r.signal,headers:r==null?void 0:r.headers});return await z_(l),l},nF=async(n,e,t,r)=>{const s=await B_(n,e,{method:"DELETE",body:JSON.stringify(t),headers:r==null?void 0:r.headers});return await z_(s),s},rF=async function*(n){const e=new TextDecoder("utf-8");let t="";const r=n.getReader();for(;;){const{done:s,value:a}=await r.read();if(s)break;t+=e.decode(a);const l=t.split(`
`);t=l.pop()??"";for(const u of l)try{yield JSON.parse(u)}catch{console.warn("invalid json: ",u)}}for(const s of t.split(`
`).filter(a=>a!==""))try{yield JSON.parse(s)}catch{console.warn("invalid json: ",s)}},sF=n=>{if(!n)return"http://127.0.0.1:11434";let e=n.includes("://");n.startsWith(":")&&(n=`http://127.0.0.1${n}`,e=!0),e||(n=`http://${n}`);const t=new URL(n);let r=t.port;r||(e?r=t.protocol==="https:"?"443":"80":r="11434");let s=`${t.protocol}//${t.hostname}:${r}${t.pathname}`;return s.endsWith("/")&&(s=s.slice(0,-1)),s};var aF=Object.defineProperty,iF=(n,e,t)=>e in n?aF(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,pg=(n,e,t)=>(iF(n,typeof e!="symbol"?e+"":e,t),t);let hP=class{constructor(e){pg(this,"config"),pg(this,"fetch"),pg(this,"ongoingStreamedRequests",[]),this.config={host:"",headers:e==null?void 0:e.headers},e!=null&&e.proxy||(this.config.host=sF((e==null?void 0:e.host)??"http://127.0.0.1:11434")),this.fetch=(e==null?void 0:e.fetch)??fetch}abort(){for(const e of this.ongoingStreamedRequests)e.abort();this.ongoingStreamedRequests.length=0}async processStreamableRequest(e,t){t.stream=t.stream??!1;const r=`${this.config.host}/api/${e}`;if(t.stream){const a=new AbortController,l=await Ni(this.fetch,r,t,{signal:a.signal,headers:this.config.headers});if(!l.body)throw new Error("Missing body");const u=rF(l.body),c=new eF(a,u,()=>{const f=this.ongoingStreamedRequests.indexOf(c);f>-1&&this.ongoingStreamedRequests.splice(f,1)});return this.ongoingStreamedRequests.push(c),c}return await(await Ni(this.fetch,r,t,{headers:this.config.headers})).json()}async encodeImage(e){if(typeof e!="string"){const t=new Uint8Array(e);let r="";const s=t.byteLength;for(let a=0;a<s;a++)r+=String.fromCharCode(t[a]);return btoa(r)}return e}async generate(e){return e.images&&(e.images=await Promise.all(e.images.map(this.encodeImage.bind(this)))),this.processStreamableRequest("generate",e)}async chat(e){if(e.messages)for(const t of e.messages)t.images&&(t.images=await Promise.all(t.images.map(this.encodeImage.bind(this))));return this.processStreamableRequest("chat",e)}async create(e){return this.processStreamableRequest("create",{...e})}async pull(e){return this.processStreamableRequest("pull",{name:e.model,stream:e.stream,insecure:e.insecure})}async push(e){return this.processStreamableRequest("push",{name:e.model,stream:e.stream,insecure:e.insecure})}async delete(e){return await nF(this.fetch,`${this.config.host}/api/delete`,{name:e.model},{headers:this.config.headers}),{status:"success"}}async copy(e){return await Ni(this.fetch,`${this.config.host}/api/copy`,{...e},{headers:this.config.headers}),{status:"success"}}async list(){return await(await qS(this.fetch,`${this.config.host}/api/tags`,{headers:this.config.headers})).json()}async show(e){return await(await Ni(this.fetch,`${this.config.host}/api/show`,{...e},{headers:this.config.headers})).json()}async embed(e){return await(await Ni(this.fetch,`${this.config.host}/api/embed`,{...e},{headers:this.config.headers})).json()}async embeddings(e){return await(await Ni(this.fetch,`${this.config.host}/api/embeddings`,{...e},{headers:this.config.headers})).json()}async ps(){return await(await qS(this.fetch,`${this.config.host}/api/ps`,{headers:this.config.headers})).json()}};new hP;function oF(n){return n!==void 0&&Array.isArray(n.lc_namespace)}function lF(n){return n!==void 0&&Lt.isRunnable(n)&&"lc_name"in n.constructor&&typeof n.constructor.lc_name=="function"&&n.constructor.lc_name()==="RunnableToolLike"}function uF(n){return!!n&&typeof n=="object"&&"name"in n&&"schema"in n&&M_(n.schema)}function pP(n){return uF(n)||lF(n)||oF(n)}function sy(n,e){const t=typeof n;if(t!==typeof e)return!1;if(Array.isArray(n)){if(!Array.isArray(e))return!1;const r=n.length;if(r!==e.length)return!1;for(let s=0;s<r;s++)if(!sy(n[s],e[s]))return!1;return!0}if(t==="object"){if(!n||!e)return n===e;const r=Object.keys(n),s=Object.keys(e);if(r.length!==s.length)return!1;for(const l of r)if(!sy(n[l],e[l]))return!1;return!0}return n===e}function cF(n){return M_(n)?ku(n):n}function dF(n,e){return{name:n.name,description:n.description,parameters:cF(n.schema)}}function ay(n,e){let t;return pP(n)?t={type:"function",function:dF(n)}:t=n,t}function ZS(n,e){var t;return new Qr({content:n.content??"",tool_call_chunks:(t=n.tool_calls)==null?void 0:t.map(r=>({name:r.function.name,args:JSON.stringify(r.function.arguments),type:"tool_call_chunk",index:0,id:Qt()})),response_metadata:e==null?void 0:e.responseMetadata,usage_metadata:e==null?void 0:e.usageMetadata})}function GS(n){const e=n.match(/^data:.*?;base64,(.*)$/);return e?e[1]:""}function fF(n){var s,a,l;if(typeof n.content=="string")return[{role:"assistant",content:n.content}];const t=n.content.filter(u=>u.type==="text"&&typeof u.text=="string").map(u=>({role:"assistant",content:u.text}));let r;if(n.content.find(u=>u.type==="tool_use")&&((s=n.tool_calls)!=null&&s.length)){const u=(a=n.tool_calls)==null?void 0:a.map(c=>({id:c.id,type:"function",function:{name:c.name,arguments:c.args}}));u&&(r={role:"assistant",tool_calls:u,content:""})}else if(n.content.find(u=>u.type==="tool_use")&&!((l=n.tool_calls)!=null&&l.length))throw new Error("'tool_use' content type is not supported without tool calls.");return[...t,...r?[r]:[]]}function hF(n){return typeof n.content=="string"?[{role:"user",content:n.content}]:n.content.map(e=>{if(e.type==="text")return{role:"user",content:e.text};if(e.type==="image_url"){if(typeof e.image_url=="string")return{role:"user",content:"",images:[GS(e.image_url)]};if(e.image_url.url&&typeof e.image_url.url=="string")return{role:"user",content:"",images:[GS(e.image_url.url)]}}throw new Error(`Unsupported content type: ${e.type}`)})}function pF(n){if(typeof n.content=="string")return[{role:"system",content:n.content}];if(n.content.every(e=>e.type==="text"&&typeof e.text=="string"))return n.content.map(e=>({role:"system",content:e.text}));throw new Error(`Unsupported content type(s): ${n.content.map(e=>e.type).join(", ")}`)}function mF(n){if(typeof n.content!="string")throw new Error("Non string tool message content is not supported");return[{role:"tool",content:n.content}]}function gF(n){return n.flatMap(e=>{if(["human","generic"].includes(e._getType()))return hF(e);if(e._getType()==="ai")return fF(e);if(e._getType()==="system")return pF(e);if(e._getType()==="tool")return mF(e);throw new Error(`Unsupported message type: ${e._getType()}`)})}class JS extends Ss{static lc_name(){return"ChatOllama"}constructor(e){super(e??{}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"llama3"}),Object.defineProperty(this,"numa",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numCtx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numBatch",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numGpu",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mainGpu",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lowVram",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"f16Kv",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logitsAll",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vocabOnly",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"useMmap",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"useMlock",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"embeddingOnly",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numThread",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numKeep",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"seed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numPredict",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tfsZ",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"typicalP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"repeatLastN",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"repeatPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mirostat",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mirostatTau",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mirostatEta",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"penalizeNewline",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"format",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keepAlive",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"checkOrPullModel",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"baseUrl",{enumerable:!0,configurable:!0,writable:!0,value:"http://127.0.0.1:11434"}),this.client=new hP({host:e==null?void 0:e.baseUrl,headers:e==null?void 0:e.headers}),this.baseUrl=(e==null?void 0:e.baseUrl)??this.baseUrl,this.model=(e==null?void 0:e.model)??this.model,this.numa=e==null?void 0:e.numa,this.numCtx=e==null?void 0:e.numCtx,this.numBatch=e==null?void 0:e.numBatch,this.numGpu=e==null?void 0:e.numGpu,this.mainGpu=e==null?void 0:e.mainGpu,this.lowVram=e==null?void 0:e.lowVram,this.f16Kv=e==null?void 0:e.f16Kv,this.logitsAll=e==null?void 0:e.logitsAll,this.vocabOnly=e==null?void 0:e.vocabOnly,this.useMmap=e==null?void 0:e.useMmap,this.useMlock=e==null?void 0:e.useMlock,this.embeddingOnly=e==null?void 0:e.embeddingOnly,this.numThread=e==null?void 0:e.numThread,this.numKeep=e==null?void 0:e.numKeep,this.seed=e==null?void 0:e.seed,this.numPredict=e==null?void 0:e.numPredict,this.topK=e==null?void 0:e.topK,this.topP=e==null?void 0:e.topP,this.tfsZ=e==null?void 0:e.tfsZ,this.typicalP=e==null?void 0:e.typicalP,this.repeatLastN=e==null?void 0:e.repeatLastN,this.temperature=e==null?void 0:e.temperature,this.repeatPenalty=e==null?void 0:e.repeatPenalty,this.presencePenalty=e==null?void 0:e.presencePenalty,this.frequencyPenalty=e==null?void 0:e.frequencyPenalty,this.mirostat=e==null?void 0:e.mirostat,this.mirostatTau=e==null?void 0:e.mirostatTau,this.mirostatEta=e==null?void 0:e.mirostatEta,this.penalizeNewline=e==null?void 0:e.penalizeNewline,this.streaming=e==null?void 0:e.streaming,this.format=e==null?void 0:e.format,this.keepAlive=e==null?void 0:e.keepAlive,this.checkOrPullModel=(e==null?void 0:e.checkOrPullModel)??this.checkOrPullModel}_llmType(){return"ollama"}async pull(e,t){const{stream:r,insecure:s,logProgress:a}={stream:!0,...t};if(r)for await(const l of await this.client.pull({model:e,insecure:s,stream:r}))a&&console.log(l);else{const l=await this.client.pull({model:e,insecure:s});a&&console.log(l)}}bindTools(e,t){return this.bind({tools:e.map(r=>ay(r)),...t})}getLsParams(e){var r,s;const t=this.invocationParams(e);return{ls_provider:"ollama",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:((r=t.options)==null?void 0:r.temperature)??void 0,ls_max_tokens:((s=t.options)==null?void 0:s.num_predict)??void 0,ls_stop:e.stop}}invocationParams(e){var t;if(e!=null&&e.tool_choice)throw new Error("Tool choice is not supported for ChatOllama.");return{model:this.model,format:this.format,keep_alive:this.keepAlive,options:{numa:this.numa,num_ctx:this.numCtx,num_batch:this.numBatch,num_gpu:this.numGpu,main_gpu:this.mainGpu,low_vram:this.lowVram,f16_kv:this.f16Kv,logits_all:this.logitsAll,vocab_only:this.vocabOnly,use_mmap:this.useMmap,use_mlock:this.useMlock,embedding_only:this.embeddingOnly,num_thread:this.numThread,num_keep:this.numKeep,seed:this.seed,num_predict:this.numPredict,top_k:this.topK,top_p:this.topP,tfs_z:this.tfsZ,typical_p:this.typicalP,repeat_last_n:this.repeatLastN,temperature:this.temperature,repeat_penalty:this.repeatPenalty,presence_penalty:this.presencePenalty,frequency_penalty:this.frequencyPenalty,mirostat:this.mirostat,mirostat_tau:this.mirostatTau,mirostat_eta:this.mirostatEta,penalize_newline:this.penalizeNewline,stop:e==null?void 0:e.stop},tools:(t=e==null?void 0:e.tools)!=null&&t.length?e.tools.map(r=>ay(r)):void 0}}async checkModelExistsOnMachine(e){const{models:t}=await this.client.list();return!!t.find(r=>r.name===e||r.name===`${e}:latest`)}async _generate(e,t,r){this.checkOrPullModel&&(await this.checkModelExistsOnMachine(this.model)||await this.pull(this.model,{logProgress:!0}));let s;for await(const l of this._streamResponseChunks(e,t,r))s?s=Xn(s,l.message):s=l.message;const a=new Ka({id:s==null?void 0:s.id,content:(s==null?void 0:s.content)??"",tool_calls:s==null?void 0:s.tool_calls,response_metadata:s==null?void 0:s.response_metadata,usage_metadata:s==null?void 0:s.usage_metadata});return{generations:[{text:typeof a.content=="string"?a.content:"",message:a}]}}async*_streamResponseChunks(e,t,r){var f;this.checkOrPullModel&&(await this.checkModelExistsOnMachine(this.model)||await this.pull(this.model,{logProgress:!0}));const s=this.invocationParams(t),a=gF(e),l={input_tokens:0,output_tokens:0,total_tokens:0};if(s.tools&&s.tools.length>0){const h=await this.client.chat({...s,messages:a,stream:!1}),{message:m,...g}=h;return l.input_tokens+=g.prompt_eval_count??0,l.output_tokens+=g.eval_count??0,l.total_tokens=l.input_tokens+l.output_tokens,yield new Kr({text:m.content,message:ZS(m,{responseMetadata:g,usageMetadata:l})}),r==null?void 0:r.handleLLMNewToken(m.content)}const u=await this.client.chat({...s,messages:a,stream:!0});let c;for await(const h of u){(f=t.signal)!=null&&f.aborted&&this.client.abort();const{message:m,...g}=h;l.input_tokens+=g.prompt_eval_count??0,l.output_tokens+=g.eval_count??0,l.total_tokens=l.input_tokens+l.output_tokens,c=g,yield new Kr({text:m.content??"",message:ZS(m)}),await(r==null?void 0:r.handleLLMNewToken(m.content??""))}yield new Kr({text:"",message:new Qr({content:"",response_metadata:c,usage_metadata:l})})}}const iy="RFC3986",oy={RFC1738:n=>String(n).replace(/%20/g,"+"),RFC3986:n=>String(n)},yF="RFC1738",_F=Array.isArray,Fr=(()=>{const n=[];for(let e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n})(),mg=1024,wF=(n,e,t,r,s)=>{if(n.length===0)return n;let a=n;if(typeof n=="symbol"?a=Symbol.prototype.toString.call(n):typeof n!="string"&&(a=String(n)),t==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(u){return"%26%23"+parseInt(u.slice(2),16)+"%3B"});let l="";for(let u=0;u<a.length;u+=mg){const c=a.length>=mg?a.slice(u,u+mg):a,f=[];for(let h=0;h<c.length;++h){let m=c.charCodeAt(h);if(m===45||m===46||m===95||m===126||m>=48&&m<=57||m>=65&&m<=90||m>=97&&m<=122||s===yF&&(m===40||m===41)){f[f.length]=c.charAt(h);continue}if(m<128){f[f.length]=Fr[m];continue}if(m<2048){f[f.length]=Fr[192|m>>6]+Fr[128|m&63];continue}if(m<55296||m>=57344){f[f.length]=Fr[224|m>>12]+Fr[128|m>>6&63]+Fr[128|m&63];continue}h+=1,m=65536+((m&1023)<<10|c.charCodeAt(h)&1023),f[f.length]=Fr[240|m>>18]+Fr[128|m>>12&63]+Fr[128|m>>6&63]+Fr[128|m&63]}l+=f.join("")}return l};function bF(n){return!n||typeof n!="object"?!1:!!(n.constructor&&n.constructor.isBuffer&&n.constructor.isBuffer(n))}function KS(n,e){if(_F(n)){const t=[];for(let r=0;r<n.length;r+=1)t.push(e(n[r]));return t}return e(n)}const vF=Object.prototype.hasOwnProperty,mP={brackets(n){return String(n)+"[]"},comma:"comma",indices(n,e){return String(n)+"["+e+"]"},repeat(n){return String(n)}},zr=Array.isArray,xF=Array.prototype.push,gP=function(n,e){xF.apply(n,zr(e)?e:[e])},SF=Date.prototype.toISOString,Pt={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:wF,encodeValuesOnly:!1,format:iy,formatter:oy[iy],indices:!1,serializeDate(n){return SF.call(n)},skipNulls:!1,strictNullHandling:!1};function EF(n){return typeof n=="string"||typeof n=="number"||typeof n=="boolean"||typeof n=="symbol"||typeof n=="bigint"}const gg={};function yP(n,e,t,r,s,a,l,u,c,f,h,m,g,y,w,v,x,E){let P=n,S=E,R=0,$=!1;for(;(S=S.get(gg))!==void 0&&!$;){const Y=S.get(n);if(R+=1,typeof Y<"u"){if(Y===R)throw new RangeError("Cyclic object value");$=!0}typeof S.get(gg)>"u"&&(R=0)}if(typeof f=="function"?P=f(e,P):P instanceof Date?P=g==null?void 0:g(P):t==="comma"&&zr(P)&&(P=KS(P,function(Y){return Y instanceof Date?g==null?void 0:g(Y):Y})),P===null){if(a)return c&&!v?c(e,Pt.encoder,x,"key",y):e;P=""}if(EF(P)||bF(P)){if(c){const Y=v?e:c(e,Pt.encoder,x,"key",y);return[(w==null?void 0:w(Y))+"="+(w==null?void 0:w(c(P,Pt.encoder,x,"value",y)))]}return[(w==null?void 0:w(e))+"="+(w==null?void 0:w(String(P)))]}const I=[];if(typeof P>"u")return I;let D;if(t==="comma"&&zr(P))v&&c&&(P=KS(P,c)),D=[{value:P.length>0?P.join(",")||null:void 0}];else if(zr(f))D=f;else{const Y=Object.keys(P);D=h?Y.sort(h):Y}const F=u?String(e).replace(/\./g,"%2E"):String(e),K=r&&zr(P)&&P.length===1?F+"[]":F;if(s&&zr(P)&&P.length===0)return K+"[]";for(let Y=0;Y<D.length;++Y){const ie=D[Y],de=typeof ie=="object"&&typeof ie.value<"u"?ie.value:P[ie];if(l&&de===null)continue;const ue=m&&u?ie.replace(/\./g,"%2E"):ie,V=zr(P)?typeof t=="function"?t(K,ue):K:K+(m?"."+ue:"["+ue+"]");E.set(n,R);const G=new WeakMap;G.set(gg,E),gP(I,yP(de,V,t,r,s,a,l,u,t==="comma"&&v&&zr(P)?null:c,f,h,m,g,y,w,v,x,G))}return I}function CF(n=Pt){if(typeof n.allowEmptyArrays<"u"&&typeof n.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof n.encodeDotInKeys<"u"&&typeof n.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(n.encoder!==null&&typeof n.encoder<"u"&&typeof n.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=n.charset||Pt.charset;if(typeof n.charset<"u"&&n.charset!=="utf-8"&&n.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=iy;if(typeof n.format<"u"){if(!vF.call(oy,n.format))throw new TypeError("Unknown format option provided.");t=n.format}const r=oy[t];let s=Pt.filter;(typeof n.filter=="function"||zr(n.filter))&&(s=n.filter);let a;if(n.arrayFormat&&n.arrayFormat in mP?a=n.arrayFormat:"indices"in n?a=n.indices?"indices":"repeat":a=Pt.arrayFormat,"commaRoundTrip"in n&&typeof n.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const l=typeof n.allowDots>"u"?n.encodeDotInKeys?!0:Pt.allowDots:!!n.allowDots;return{addQueryPrefix:typeof n.addQueryPrefix=="boolean"?n.addQueryPrefix:Pt.addQueryPrefix,allowDots:l,allowEmptyArrays:typeof n.allowEmptyArrays=="boolean"?!!n.allowEmptyArrays:Pt.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof n.charsetSentinel=="boolean"?n.charsetSentinel:Pt.charsetSentinel,commaRoundTrip:!!n.commaRoundTrip,delimiter:typeof n.delimiter>"u"?Pt.delimiter:n.delimiter,encode:typeof n.encode=="boolean"?n.encode:Pt.encode,encodeDotInKeys:typeof n.encodeDotInKeys=="boolean"?n.encodeDotInKeys:Pt.encodeDotInKeys,encoder:typeof n.encoder=="function"?n.encoder:Pt.encoder,encodeValuesOnly:typeof n.encodeValuesOnly=="boolean"?n.encodeValuesOnly:Pt.encodeValuesOnly,filter:s,format:t,formatter:r,serializeDate:typeof n.serializeDate=="function"?n.serializeDate:Pt.serializeDate,skipNulls:typeof n.skipNulls=="boolean"?n.skipNulls:Pt.skipNulls,sort:typeof n.sort=="function"?n.sort:null,strictNullHandling:typeof n.strictNullHandling=="boolean"?n.strictNullHandling:Pt.strictNullHandling}}function PF(n,e={}){let t=n;const r=CF(e);let s,a;typeof r.filter=="function"?(a=r.filter,t=a("",t)):zr(r.filter)&&(a=r.filter,s=a);const l=[];if(typeof t!="object"||t===null)return"";const u=mP[r.arrayFormat],c=u==="comma"&&r.commaRoundTrip;s||(s=Object.keys(t)),r.sort&&s.sort(r.sort);const f=new WeakMap;for(let g=0;g<s.length;++g){const y=s[g];r.skipNulls&&t[y]===null||gP(l,yP(t[y],y,u,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,f))}const h=l.join(r.delimiter);let m=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),h.length>0?m+h:""}const Ui="4.95.1";let XS=!1,Dl,_P,wP,ly,bP,vP,xP,SP,EP;function kF(n,e={auto:!1}){if(XS)throw new Error(`you must \`import 'openai/shims/${n.kind}'\` before importing anything else from openai`);if(Dl)throw new Error(`can't \`import 'openai/shims/${n.kind}'\` after \`import 'openai/shims/${Dl}'\``);XS=e.auto,Dl=n.kind,_P=n.fetch,wP=n.FormData,ly=n.File,bP=n.ReadableStream,vP=n.getMultipartRequestOptions,xP=n.getDefaultAgent,SP=n.fileFromPath,EP=n.isFsReadStream}class RF{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function OF({manuallyImported:n}={}){const e=n?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,r,s,a;try{t=fetch,r=Request,s=Response,a=Headers}catch(l){throw new Error(`this environment is missing the following Web Fetch API type: ${l.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:s,Headers:a,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(l,u)=>({...u,body:new RF(l)}),getDefaultAgent:l=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:l=>!1}}const CP=()=>{Dl||kF(OF(),{auto:!0})};CP();class Oe extends Error{}class Wt extends Oe{constructor(e,t,r,s){super(`${Wt.makeMessage(e,t,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=t;const a=t;this.code=a==null?void 0:a.code,this.param=a==null?void 0:a.param,this.type=a==null?void 0:a.type}static makeMessage(e,t,r){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,r,s){if(!e||!s)return new Nf({message:r,cause:cy(t)});const a=t==null?void 0:t.error;return e===400?new PP(e,a,r,s):e===401?new kP(e,a,r,s):e===403?new RP(e,a,r,s):e===404?new OP(e,a,r,s):e===409?new TP(e,a,r,s):e===422?new AP(e,a,r,s):e===429?new $P(e,a,r,s):e>=500?new IP(e,a,r,s):new Wt(e,a,r,s)}}class Ln extends Wt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Nf extends Wt{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class jf extends Nf{constructor({message:e}={}){super({message:e??"Request timed out."})}}class PP extends Wt{}class kP extends Wt{}class RP extends Wt{}class OP extends Wt{}class TP extends Wt{}class AP extends Wt{}class $P extends Wt{}class IP extends Wt{}class NP extends Oe{constructor(){super("Could not parse response content as the length limit was reached")}}class jP extends Oe{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var rd=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},Ia=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},In;class Lf{constructor(){In.set(this,void 0),this.buffer=new Uint8Array,rd(this,In,null,"f")}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let r=new Uint8Array(this.buffer.length+t.length);r.set(this.buffer),r.set(t,this.buffer.length),this.buffer=r;const s=[];let a;for(;(a=TF(this.buffer,Ia(this,In,"f")))!=null;){if(a.carriage&&Ia(this,In,"f")==null){rd(this,In,a.index,"f");continue}if(Ia(this,In,"f")!=null&&(a.index!==Ia(this,In,"f")+1||a.carriage)){s.push(this.decodeText(this.buffer.slice(0,Ia(this,In,"f")-1))),this.buffer=this.buffer.slice(Ia(this,In,"f")),rd(this,In,null,"f");continue}const l=Ia(this,In,"f")!==null?a.preceding-1:a.preceding,u=this.decodeText(this.buffer.slice(0,l));s.push(u),this.buffer=this.buffer.slice(a.index),rd(this,In,null,"f")}return s}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Oe(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Oe(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Oe("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}In=new WeakMap;Lf.NEWLINE_CHARS=new Set([`
`,"\r"]);Lf.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function TF(n,e){for(let s=e??0;s<n.length;s++){if(n[s]===10)return{preceding:s,index:s+1,carriage:!1};if(n[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function AF(n){for(let r=0;r<n.length-1;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}function LP(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class Vr{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const l of $F(e,t))if(!a){if(l.data.startsWith("[DONE]")){a=!0;continue}if(l.event===null||l.event.startsWith("response.")||l.event.startsWith("transcript.")){let u;try{u=JSON.parse(l.data)}catch(c){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),c}if(u&&u.error)throw new Wt(void 0,u.error,void 0,HP(e.headers));yield u}else{let u;try{u=JSON.parse(l.data)}catch(c){throw console.error("Could not parse message into JSON:",l.data),console.error("From chunk:",l.raw),c}if(l.event=="error")throw new Wt(void 0,u.error,u.message,void 0);yield{event:l.event,data:u}}}a=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{a||t.abort()}}return new Vr(s,t)}static fromReadableStream(e,t){let r=!1;async function*s(){const l=new Lf,u=LP(e);for await(const c of u)for(const f of l.decode(c))yield f;for(const c of l.flush())yield c}async function*a(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let l=!1;try{for await(const u of s())l||u&&(yield JSON.parse(u));l=!0}catch(u){if(u instanceof Error&&u.name==="AbortError")return;throw u}finally{l||t.abort()}}return new Vr(a,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),s=a=>({next:()=>{if(a.length===0){const l=r.next();e.push(l),t.push(l)}return a.shift()}});return[new Vr(()=>s(e),this.controller),new Vr(()=>s(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new bP({async start(){t=e[Symbol.asyncIterator]()},async pull(s){try{const{value:a,done:l}=await t.next();if(l)return s.close();const u=r.encode(JSON.stringify(a)+`
`);s.enqueue(u)}catch(a){s.error(a)}},async cancel(){var s;await((s=t.return)==null?void 0:s.call(t))}})}}async function*$F(n,e){if(!n.body)throw e.abort(),new Oe("Attempted to iterate over a response with no body");const t=new NF,r=new Lf,s=LP(n.body);for await(const a of IF(s))for(const l of r.decode(a)){const u=t.decode(l);u&&(yield u)}for(const a of r.flush()){const l=t.decode(a);l&&(yield l)}}async function*IF(n){let e=new Uint8Array;for await(const t of n){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let a;for(;(a=AF(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}class NF{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,s]=jF(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function jF(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}const MP=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function",DP=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&Mf(n),Mf=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",LF=n=>DP(n)||MP(n)||EP(n);async function FP(n,e,t){var s;if(n=await n,DP(n))return n;if(MP(n)){const a=await n.blob();e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()??"unknown_file");const l=Mf(a)?[await a.arrayBuffer()]:[a];return new ly(l,e,t)}const r=await MF(n);if(e||(e=FF(n)??"unknown_file"),!(t!=null&&t.type)){const a=(s=r[0])==null?void 0:s.type;typeof a=="string"&&(t={...t,type:a})}return new ly(r,e,t)}async function MF(n){var t;let e=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)e.push(n);else if(Mf(n))e.push(await n.arrayBuffer());else if(UF(n))for await(const r of n)e.push(r);else throw new Error(`Unexpected data type: ${typeof n}; constructor: ${(t=n==null?void 0:n.constructor)==null?void 0:t.name}; props: ${DF(n)}`);return e}function DF(n){return`[${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}function FF(n){var e;return yg(n.name)||yg(n.filename)||((e=yg(n.path))==null?void 0:e.split(/[\\/]/).pop())}const yg=n=>{if(typeof n=="string")return n;if(typeof Buffer<"u"&&n instanceof Buffer)return String(n)},UF=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",YS=n=>n&&typeof n=="object"&&n.body&&n[Symbol.toStringTag]==="MultipartBody",oo=async n=>{const e=await zF(n.body);return vP(e,n)},zF=async n=>{const e=new wP;return await Promise.all(Object.entries(n||{}).map(([t,r])=>uy(e,t,r))),e},uy=async(n,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")n.append(e,String(t));else if(LF(t)){const r=await FP(t);n.append(e,r)}else if(Array.isArray(t))await Promise.all(t.map(r=>uy(n,e+"[]",r)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([r,s])=>uy(n,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var Ji={},BF=function(n,e,t,r,s){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,t),t},HF=function(n,e,t,r){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},sd;CP();async function UP(n){var l;const{response:e}=n;if(n.options.stream)return la("response",e.status,e.url,e.headers,e.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(e,n.controller):Vr.fromSSEResponse(e,n.controller);if(e.status===204)return null;if(n.options.__binaryResponse)return e;const t=e.headers.get("content-type"),r=(l=t==null?void 0:t.split(";")[0])==null?void 0:l.trim();if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.endsWith("+json"))){const u=await e.json();return la("response",e.status,e.url,e.headers,u),zP(u,e)}const a=await e.text();return la("response",e.status,e.url,e.headers,a),a}function zP(n,e){return!n||typeof n!="object"||Array.isArray(n)?n:Object.defineProperty(n,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class Df extends Promise{constructor(e,t=UP){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Df(this.responsePromise,async t=>zP(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class WF{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:s,fetch:a}){this.baseURL=e,this.maxRetries=_g("maxRetries",t),this.timeout=_g("timeout",r),this.httpAgent=s,this.fetch=a??_P}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...JF(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${QF()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async s=>{const a=s&&Mf(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:t,...s,body:a}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var v;const r={...e},{method:s,path:a,query:l,headers:u={}}=r,c=ArrayBuffer.isView(r.body)||r.__binaryRequest&&typeof r.body=="string"?r.body:YS(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,f=this.calculateContentLength(c),h=this.buildURL(a,l);"timeout"in r&&_g("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const m=r.httpAgent??this.httpAgent??xP(h),g=r.timeout+1e3;typeof((v=m==null?void 0:m.options)==null?void 0:v.timeout)=="number"&&g>(m.options.timeout??0)&&(m.options.timeout=g),this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),u[this.idempotencyHeader]=e.idempotencyKey);const y=this.buildHeaders({options:r,headers:u,contentLength:f,retryCount:t});return{req:{method:s,...c&&{body:c},headers:y,...m&&{agent:m},signal:r.signal??null},url:h,timeout:r.timeout}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:s}){const a={};r&&(a["content-length"]=r);const l=this.defaultHeaders(e);return n1(a,l),n1(a,t),YS(e.body)&&Dl!=="node"&&delete a["content-type"],id(l,"x-stainless-retry-count")===void 0&&id(t,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(s)),id(l,"x-stainless-timeout")===void 0&&id(t,"x-stainless-timeout")===void 0&&e.timeout&&(a["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(a,t),a}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,s){return Wt.generate(e,t,r,s)}request(e,t=null){return new Df(this.makeRequest(e,t))}async makeRequest(e,t){var m,g;const r=await e,s=r.maxRetries??this.maxRetries;t==null&&(t=s),await this.prepareOptions(r);const{req:a,url:l,timeout:u}=this.buildRequest(r,{retryCount:s-t});if(await this.prepareRequest(a,{url:l,options:r}),la("request",l,r,a.headers),(m=r.signal)!=null&&m.aborted)throw new Ln;const c=new AbortController,f=await this.fetchWithTimeout(l,a,u,c).catch(cy);if(f instanceof Error){if((g=r.signal)!=null&&g.aborted)throw new Ln;if(t)return this.retryRequest(r,t);throw f.name==="AbortError"?new jf:new Nf({cause:f})}const h=HP(f.headers);if(!f.ok){if(t&&this.shouldRetry(f)){const P=`retrying, ${t} attempts remaining`;return la(`response (error; ${P})`,f.status,l,h),this.retryRequest(r,t,h)}const y=await f.text().catch(P=>cy(P).message),w=KF(y),v=w?void 0:y;throw la(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,f.status,l,h,v),this.makeStatusError(f.status,w,v,h)}return{response:f,options:r,controller:c}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new VF(this,r,e)}buildURL(e,t){const r=YF(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return WP(s)||(t={...s,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new Oe(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,s){const{signal:a,...l}=t||{};a&&a.addEventListener("abort",()=>s.abort());const u=setTimeout(()=>s.abort(),r),c={signal:s.signal,...l};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,e,c).finally(()=>{clearTimeout(u)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let s;const a=r==null?void 0:r["retry-after-ms"];if(a){const u=parseFloat(a);Number.isNaN(u)||(s=u)}const l=r==null?void 0:r["retry-after"];if(l&&!s){const u=parseFloat(l);Number.isNaN(u)?s=Date.parse(l)-Date.now():s=u*1e3}if(!(s&&0<=s&&s<60*1e3)){const u=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,u)}return await Ru(s),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,l=Math.min(.5*Math.pow(2,a),8),u=1-Math.random()*.25;return l*u*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Ui}`}}class BP{constructor(e,t,r,s){sd.set(this,void 0),BF(this,sd,e),this.options=s,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Oe("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[s,a]of r)e.url.searchParams.set(s,a);t.query=void 0,t.path=e.url.toString()}return await HF(this,sd,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(sd=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class VF extends Df{constructor(e,t,r){super(t,async s=>new r(e,s.response,await UP(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const HP=n=>new Proxy(Object.fromEntries(n.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),qF={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},ht=n=>typeof n=="object"&&n!==null&&!WP(n)&&Object.keys(n).every(e=>VP(qF,e)),ZF=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ui,"X-Stainless-OS":e1(Deno.build.os),"X-Stainless-Arch":QS(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ui,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ui,"X-Stainless-OS":e1(process.platform),"X-Stainless-Arch":QS(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const n=GF();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ui,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${n.browser}`,"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ui,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function GF(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const r=t.exec(navigator.userAgent);if(r){const s=r[1]||0,a=r[2]||0,l=r[3]||0;return{browser:e,version:`${s}.${a}.${l}`}}}return null}const QS=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",e1=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let t1;const JF=()=>t1??(t1=ZF()),KF=n=>{try{return JSON.parse(n)}catch{return}},XF=/^[a-z][a-z0-9+.-]*:/i,YF=n=>XF.test(n),Ru=n=>new Promise(e=>setTimeout(e,n)),_g=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Oe(`${n} must be an integer`);if(e<0)throw new Oe(`${n} must be a positive integer`);return e},cy=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null)try{return new Error(JSON.stringify(n))}catch{}return new Error(n)},ad=n=>{var e,t,r,s;if(typeof process<"u")return((e=Ji==null?void 0:Ji[n])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(s=(r=(t=Deno.env)==null?void 0:t.get)==null?void 0:r.call(t,n))==null?void 0:s.trim()};function WP(n){if(!n)return!0;for(const e in n)return!1;return!0}function VP(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function n1(n,e){for(const t in e){if(!VP(e,t))continue;const r=t.toLowerCase();if(!r)continue;const s=e[t];s===null?delete n[r]:s!==void 0&&(n[r]=s)}}const r1=new Set(["authorization","api-key"]);function la(n,...e){if(typeof process<"u"&&(Ji==null?void 0:Ji.DEBUG)==="true"){const t=e.map(r=>{if(!r)return r;if(r.headers){const a={...r,headers:{...r.headers}};for(const l in r.headers)r1.has(l.toLowerCase())&&(a.headers[l]="REDACTED");return a}let s=null;for(const a in r)r1.has(a.toLowerCase())&&(s??(s={...r}),s[a]="REDACTED");return s??r});console.log(`OpenAI:DEBUG:${n}`,...t)}}const QF=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)}),e9=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",t9=n=>typeof(n==null?void 0:n.get)=="function",id=(n,e)=>{var r;const t=e.toLowerCase();if(t9(n)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(a,l,u)=>l+u.toUpperCase());for(const a of[e,t,e.toUpperCase(),s]){const l=n.get(a);if(l)return l}}for(const[s,a]of Object.entries(n))if(s.toLowerCase()===t)return Array.isArray(a)?(a.length<=1||console.warn(`Received ${a.length} entries for the ${e} header, using the first entry.`),a[0]):a},n9=n=>{if(typeof Buffer<"u"){const e=Buffer.from(n,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(n),t=e.length,r=new Uint8Array(t);for(let s=0;s<t;s++)r[s]=e.charCodeAt(s);return Array.from(new Float32Array(r.buffer))}};function wg(n){return n!=null&&typeof n=="object"&&!Array.isArray(n)}class Ff extends BP{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Vt extends BP{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const t=(r=e[e.length-1])==null?void 0:r.id;return t?{params:{after:t}}:null}}class De{constructor(e){this._client=e}}let qP=class extends De{list(e,t={},r){return ht(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,r9,{query:t,...r})}},Uf=class extends De{constructor(){super(...arguments),this.messages=new qP(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,r){return this._client.post(`/chat/completions/${e}`,{body:t,...r})}list(e={},t){return ht(e)?this.list({},e):this._client.getAPIList("/chat/completions",zf,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}};class zf extends Vt{}class r9 extends Vt{}Uf.ChatCompletionsPage=zf;Uf.Messages=qP;let Bf=class extends De{constructor(){super(...arguments),this.completions=new Uf(this._client)}};Bf.Completions=Uf;Bf.ChatCompletionsPage=zf;class ZP extends De{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class GP extends De{create(e,t){return this._client.post("/audio/transcriptions",oo({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}}))}}class JP extends De{create(e,t){return this._client.post("/audio/translations",oo({body:e,...t,__metadata:{model:e.model}}))}}class Ou extends De{constructor(){super(...arguments),this.transcriptions=new GP(this._client),this.translations=new JP(this._client),this.speech=new ZP(this._client)}}Ou.Transcriptions=GP;Ou.Translations=JP;Ou.Speech=ZP;class H_ extends De{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return ht(e)?this.list({},e):this._client.getAPIList("/batches",W_,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class W_ extends Vt{}H_.BatchesPage=W_;class V_ extends De{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/assistants/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return ht(e)?this.list({},e):this._client.getAPIList("/assistants",q_,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class q_ extends Vt{}V_.AssistantsPage=q_;function s1(n){return typeof n.parse=="function"}const Ki=n=>(n==null?void 0:n.role)==="assistant",KP=n=>(n==null?void 0:n.role)==="function",XP=n=>(n==null?void 0:n.role)==="tool";var gr=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},ot=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},dy,wd,bd,Pl,kl,vd,Rl,vs,Ol,Jd,Kd,zi,YP;class Z_{constructor(){dy.add(this),this.controller=new AbortController,wd.set(this,void 0),bd.set(this,()=>{}),Pl.set(this,()=>{}),kl.set(this,void 0),vd.set(this,()=>{}),Rl.set(this,()=>{}),vs.set(this,{}),Ol.set(this,!1),Jd.set(this,!1),Kd.set(this,!1),zi.set(this,!1),gr(this,wd,new Promise((e,t)=>{gr(this,bd,e,"f"),gr(this,Pl,t,"f")}),"f"),gr(this,kl,new Promise((e,t)=>{gr(this,vd,e,"f"),gr(this,Rl,t,"f")}),"f"),ot(this,wd,"f").catch(()=>{}),ot(this,kl,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},ot(this,dy,"m",YP).bind(this))},0)}_connected(){this.ended||(ot(this,bd,"f").call(this),this._emit("connect"))}get ended(){return ot(this,Ol,"f")}get errored(){return ot(this,Jd,"f")}get aborted(){return ot(this,Kd,"f")}abort(){this.controller.abort()}on(e,t){return(ot(this,vs,"f")[e]||(ot(this,vs,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=ot(this,vs,"f")[e];if(!r)return this;const s=r.findIndex(a=>a.listener===t);return s>=0&&r.splice(s,1),this}once(e,t){return(ot(this,vs,"f")[e]||(ot(this,vs,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{gr(this,zi,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){gr(this,zi,!0,"f"),await ot(this,kl,"f")}_emit(e,...t){if(ot(this,Ol,"f"))return;e==="end"&&(gr(this,Ol,!0,"f"),ot(this,vd,"f").call(this));const r=ot(this,vs,"f")[e];if(r&&(ot(this,vs,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...t))),e==="abort"){const s=t[0];!ot(this,zi,"f")&&!(r!=null&&r.length)&&Promise.reject(s),ot(this,Pl,"f").call(this,s),ot(this,Rl,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=t[0];!ot(this,zi,"f")&&!(r!=null&&r.length)&&Promise.reject(s),ot(this,Pl,"f").call(this,s),ot(this,Rl,"f").call(this,s),this._emit("end")}}_emitFinal(){}}wd=new WeakMap,bd=new WeakMap,Pl=new WeakMap,kl=new WeakMap,vd=new WeakMap,Rl=new WeakMap,vs=new WeakMap,Ol=new WeakMap,Jd=new WeakMap,Kd=new WeakMap,zi=new WeakMap,dy=new WeakSet,YP=function(e){if(gr(this,Jd,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Ln),e instanceof Ln)return gr(this,Kd,!0,"f"),this._emit("abort",e);if(e instanceof Oe)return this._emit("error",e);if(e instanceof Error){const t=new Oe(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new Oe(String(e)))};function s9(n,e){const t={...n};return Object.defineProperties(t,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),t}function G_(n){return(n==null?void 0:n.$brand)==="auto-parseable-response-format"}function Tu(n){return(n==null?void 0:n.$brand)==="auto-parseable-tool"}function a9(n,e){return!e||!QP(e)?{...n,choices:n.choices.map(t=>({...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:J_(n,e)}function J_(n,e){const t=n.choices.map(r=>{var s;if(r.finish_reason==="length")throw new NP;if(r.finish_reason==="content_filter")throw new jP;return{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(a=>o9(e,a)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?i9(e,r.message.content):null}}});return{...n,choices:t}}function i9(n,e){var t,r;return((t=n.response_format)==null?void 0:t.type)!=="json_schema"?null:((r=n.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in n.response_format?n.response_format.$parseRaw(e):JSON.parse(e):null}function o9(n,e){var r;const t=(r=n.tools)==null?void 0:r.find(s=>{var a;return((a=s.function)==null?void 0:a.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:Tu(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function l9(n,e){var r;if(!n)return!1;const t=(r=n.tools)==null?void 0:r.find(s=>{var a;return((a=s.function)==null?void 0:a.name)===e.function.name});return Tu(t)||(t==null?void 0:t.function.strict)||!1}function QP(n){var e;return G_(n.response_format)?!0:((e=n.tools)==null?void 0:e.some(t=>Tu(t)||t.type==="function"&&t.function.strict===!0))??!1}function u9(n){for(const e of n??[]){if(e.type!=="function")throw new Oe(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new Oe(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var xn=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Xt,fy,Xd,hy,py,my,ek,gy;const a1=10;class tk extends Z_{constructor(){super(...arguments),Xt.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(r=e.choices[0])==null?void 0:r.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(KP(e)||XP(e))&&e.content)this._emit("functionCallResult",e.content);else if(Ki(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Ki(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new Oe("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),xn(this,Xt,"m",fy).call(this)}async finalMessage(){return await this.done(),xn(this,Xt,"m",Xd).call(this)}async finalFunctionCall(){return await this.done(),xn(this,Xt,"m",hy).call(this)}async finalFunctionCallResult(){return await this.done(),xn(this,Xt,"m",py).call(this)}async totalUsage(){return await this.done(),xn(this,Xt,"m",my).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=xn(this,Xt,"m",Xd).call(this);t&&this._emit("finalMessage",t);const r=xn(this,Xt,"m",fy).call(this);r&&this._emit("finalContent",r);const s=xn(this,Xt,"m",hy).call(this);s&&this._emit("finalFunctionCall",s);const a=xn(this,Xt,"m",py).call(this);a!=null&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some(l=>l.usage)&&this._emit("totalUsage",xn(this,Xt,"m",my).call(this))}async _createChatCompletion(e,t,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),xn(this,Xt,"m",ek).call(this,t);const a=await e.chat.completions.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(J_(a,t))}async _runChatCompletion(e,t,r){for(const s of t.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,t,r)}async _runFunctions(e,t,r){var g;const s="function",{function_call:a="auto",stream:l,...u}=t,c=typeof a!="string"&&(a==null?void 0:a.name),{maxChatCompletions:f=a1}=r||{},h={};for(const y of t.functions)h[y.name||y.function.name]=y;const m=t.functions.map(y=>({name:y.name||y.function.name,parameters:y.parameters,description:y.description}));for(const y of t.messages)this._addMessage(y,!1);for(let y=0;y<f;++y){const v=(g=(await this._createChatCompletion(e,{...u,function_call:a,functions:m,messages:[...this.messages]},r)).choices[0])==null?void 0:g.message;if(!v)throw new Oe("missing message in ChatCompletion response");if(!v.function_call)return;const{name:x,arguments:E}=v.function_call,P=h[x];if(P){if(c&&c!==x){const I=`Invalid function_call: ${JSON.stringify(x)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,name:x,content:I});continue}}else{const I=`Invalid function_call: ${JSON.stringify(x)}. Available options are: ${m.map(D=>JSON.stringify(D.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:x,content:I});continue}let S;try{S=s1(P)?await P.parse(E):E}catch(I){this._addMessage({role:s,name:x,content:I instanceof Error?I.message:String(I)});continue}const R=await P.function(S,this),$=xn(this,Xt,"m",gy).call(this,R);if(this._addMessage({role:s,name:x,content:$}),c)return}}async _runTools(e,t,r){var y,w,v;const s="tool",{tool_choice:a="auto",stream:l,...u}=t,c=typeof a!="string"&&((y=a==null?void 0:a.function)==null?void 0:y.name),{maxChatCompletions:f=a1}=r||{},h=t.tools.map(x=>{if(Tu(x)){if(!x.$callback)throw new Oe("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:x.$callback,name:x.function.name,description:x.function.description||"",parameters:x.function.parameters,parse:x.$parseRaw,strict:!0}}}return x}),m={};for(const x of h)x.type==="function"&&(m[x.function.name||x.function.function.name]=x.function);const g="tools"in t?h.map(x=>x.type==="function"?{type:"function",function:{name:x.function.name||x.function.function.name,parameters:x.function.parameters,description:x.function.description,strict:x.function.strict}}:x):void 0;for(const x of t.messages)this._addMessage(x,!1);for(let x=0;x<f;++x){const P=(w=(await this._createChatCompletion(e,{...u,tool_choice:a,tools:g,messages:[...this.messages]},r)).choices[0])==null?void 0:w.message;if(!P)throw new Oe("missing message in ChatCompletion response");if(!((v=P.tool_calls)!=null&&v.length))return;for(const S of P.tool_calls){if(S.type!=="function")continue;const R=S.id,{name:$,arguments:I}=S.function,D=m[$];if(D){if(c&&c!==$){const ie=`Invalid tool_call: ${JSON.stringify($)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,tool_call_id:R,content:ie});continue}}else{const ie=`Invalid tool_call: ${JSON.stringify($)}. Available options are: ${Object.keys(m).map(de=>JSON.stringify(de)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:R,content:ie});continue}let F;try{F=s1(D)?await D.parse(I):I}catch(ie){const de=ie instanceof Error?ie.message:String(ie);this._addMessage({role:s,tool_call_id:R,content:de});continue}const K=await D.function(F,this),Y=xn(this,Xt,"m",gy).call(this,K);if(this._addMessage({role:s,tool_call_id:R,content:Y}),c)return}}}}Xt=new WeakSet,fy=function(){return xn(this,Xt,"m",Xd).call(this).content??null},Xd=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Ki(t)){const{function_call:r,...s}=t,a={...s,content:t.content??null,refusal:t.refusal??null};return r&&(a.function_call=r),a}}throw new Oe("stream ended without producing a ChatCompletionMessage with role=assistant")},hy=function(){var e,t;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(Ki(s)&&(s!=null&&s.function_call))return s.function_call;if(Ki(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(t=s.tool_calls.at(-1))==null?void 0:t.function}},py=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(KP(t)&&t.content!=null||XP(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},my=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},ek=function(e){if(e.n!=null&&e.n>1)throw new Oe("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},gy=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class lu extends tk{static runFunctions(e,t,r){const s=new lu,a={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,a)),s}static runTools(e,t,r){const s=new lu,a={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,a)),s}_addMessage(e,t=!0){super._addMessage(e,t),Ki(e)&&e.content&&this._emit("content",e.content)}}const nk=1,rk=2,sk=4,ak=8,ik=16,ok=32,lk=64,uk=128,ck=256,c9=uk|ck,d9=ik|ok|c9|lk,f9=nk|rk|d9,h9=sk|ak,p9=f9|h9,Nt={STR:nk,NUM:rk,ARR:sk,OBJ:ak,NULL:ik,BOOL:ok,NAN:lk,INFINITY:uk,MINUS_INFINITY:ck,ALL:p9};class m9 extends Error{}class g9 extends Error{}function y9(n,e=Nt.ALL){if(typeof n!="string")throw new TypeError(`expecting str, got ${typeof n}`);if(!n.trim())throw new Error(`${n} is empty`);return _9(n.trim(),e)}const _9=(n,e)=>{const t=n.length;let r=0;const s=g=>{throw new m9(`${g} at position ${r}`)},a=g=>{throw new g9(`${g} at position ${r}`)},l=()=>(m(),r>=t&&s("Unexpected end of input"),n[r]==='"'?u():n[r]==="{"?c():n[r]==="["?f():n.substring(r,r+4)==="null"||Nt.NULL&e&&t-r<4&&"null".startsWith(n.substring(r))?(r+=4,null):n.substring(r,r+4)==="true"||Nt.BOOL&e&&t-r<4&&"true".startsWith(n.substring(r))?(r+=4,!0):n.substring(r,r+5)==="false"||Nt.BOOL&e&&t-r<5&&"false".startsWith(n.substring(r))?(r+=5,!1):n.substring(r,r+8)==="Infinity"||Nt.INFINITY&e&&t-r<8&&"Infinity".startsWith(n.substring(r))?(r+=8,1/0):n.substring(r,r+9)==="-Infinity"||Nt.MINUS_INFINITY&e&&1<t-r&&t-r<9&&"-Infinity".startsWith(n.substring(r))?(r+=9,-1/0):n.substring(r,r+3)==="NaN"||Nt.NAN&e&&t-r<3&&"NaN".startsWith(n.substring(r))?(r+=3,NaN):h()),u=()=>{const g=r;let y=!1;for(r++;r<t&&(n[r]!=='"'||y&&n[r-1]==="\\");)y=n[r]==="\\"?!y:!1,r++;if(n.charAt(r)=='"')try{return JSON.parse(n.substring(g,++r-Number(y)))}catch(w){a(String(w))}else if(Nt.STR&e)try{return JSON.parse(n.substring(g,r-Number(y))+'"')}catch{return JSON.parse(n.substring(g,n.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},c=()=>{r++,m();const g={};try{for(;n[r]!=="}";){if(m(),r>=t&&Nt.OBJ&e)return g;const y=u();m(),r++;try{const w=l();Object.defineProperty(g,y,{value:w,writable:!0,enumerable:!0,configurable:!0})}catch(w){if(Nt.OBJ&e)return g;throw w}m(),n[r]===","&&r++}}catch{if(Nt.OBJ&e)return g;s("Expected '}' at end of object")}return r++,g},f=()=>{r++;const g=[];try{for(;n[r]!=="]";)g.push(l()),m(),n[r]===","&&r++}catch{if(Nt.ARR&e)return g;s("Expected ']' at end of array")}return r++,g},h=()=>{if(r===0){n==="-"&&Nt.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n)}catch(y){if(Nt.NUM&e)try{return n[n.length-1]==="."?JSON.parse(n.substring(0,n.lastIndexOf("."))):JSON.parse(n.substring(0,n.lastIndexOf("e")))}catch{}a(String(y))}}const g=r;for(n[r]==="-"&&r++;n[r]&&!",]}".includes(n[r]);)r++;r==t&&!(Nt.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(n.substring(g,r))}catch{n.substring(g,r)==="-"&&Nt.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n.substring(g,n.lastIndexOf("e")))}catch(w){a(String(w))}}},m=()=>{for(;r<t&&` 
\r	`.includes(n[r]);)r++};return l()},i1=n=>y9(n,Nt.ALL^Nt.NUM);var ji=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},Ye=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Ct,ws,Li,na,bg,od,vg,xg,Sg,ld,Eg,o1;class uu extends tk{constructor(e){super(),Ct.add(this),ws.set(this,void 0),Li.set(this,void 0),na.set(this,void 0),ji(this,ws,e,"f"),ji(this,Li,[],"f")}get currentChatCompletionSnapshot(){return Ye(this,na,"f")}static fromReadableStream(e){const t=new uu(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){const s=new uu(t);return s._run(()=>s._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,t,r){var l;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Ye(this,Ct,"m",bg).call(this);const a=await e.chat.completions.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const u of a)Ye(this,Ct,"m",vg).call(this,u);if((l=a.controller.signal)!=null&&l.aborted)throw new Ln;return this._addChatCompletion(Ye(this,Ct,"m",ld).call(this))}async _fromReadableStream(e,t){var l;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Ye(this,Ct,"m",bg).call(this),this._connected();const s=Vr.fromReadableStream(e,this.controller);let a;for await(const u of s)a&&a!==u.id&&this._addChatCompletion(Ye(this,Ct,"m",ld).call(this)),Ye(this,Ct,"m",vg).call(this,u),a=u.id;if((l=s.controller.signal)!=null&&l.aborted)throw new Ln;return this._addChatCompletion(Ye(this,Ct,"m",ld).call(this))}[(ws=new WeakMap,Li=new WeakMap,na=new WeakMap,Ct=new WeakSet,bg=function(){this.ended||ji(this,na,void 0,"f")},od=function(t){let r=Ye(this,Li,"f")[t.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Ye(this,Li,"f")[t.index]=r,r)},vg=function(t){var s,a,l,u,c,f,h,m,g,y,w,v,x,E,P;if(this.ended)return;const r=Ye(this,Ct,"m",o1).call(this,t);this._emit("chunk",t,r);for(const S of t.choices){const R=r.choices[S.index];S.delta.content!=null&&((s=R.message)==null?void 0:s.role)==="assistant"&&((a=R.message)!=null&&a.content)&&(this._emit("content",S.delta.content,R.message.content),this._emit("content.delta",{delta:S.delta.content,snapshot:R.message.content,parsed:R.message.parsed})),S.delta.refusal!=null&&((l=R.message)==null?void 0:l.role)==="assistant"&&((u=R.message)!=null&&u.refusal)&&this._emit("refusal.delta",{delta:S.delta.refusal,snapshot:R.message.refusal}),((c=S.logprobs)==null?void 0:c.content)!=null&&((f=R.message)==null?void 0:f.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(h=S.logprobs)==null?void 0:h.content,snapshot:((m=R.logprobs)==null?void 0:m.content)??[]}),((g=S.logprobs)==null?void 0:g.refusal)!=null&&((y=R.message)==null?void 0:y.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(w=S.logprobs)==null?void 0:w.refusal,snapshot:((v=R.logprobs)==null?void 0:v.refusal)??[]});const $=Ye(this,Ct,"m",od).call(this,R);R.finish_reason&&(Ye(this,Ct,"m",Sg).call(this,R),$.current_tool_call_index!=null&&Ye(this,Ct,"m",xg).call(this,R,$.current_tool_call_index));for(const I of S.delta.tool_calls??[])$.current_tool_call_index!==I.index&&(Ye(this,Ct,"m",Sg).call(this,R),$.current_tool_call_index!=null&&Ye(this,Ct,"m",xg).call(this,R,$.current_tool_call_index)),$.current_tool_call_index=I.index;for(const I of S.delta.tool_calls??[]){const D=(x=R.message.tool_calls)==null?void 0:x[I.index];D!=null&&D.type&&((D==null?void 0:D.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(E=D.function)==null?void 0:E.name,index:I.index,arguments:D.function.arguments,parsed_arguments:D.function.parsed_arguments,arguments_delta:((P=I.function)==null?void 0:P.arguments)??""}):(D==null||D.type,void 0))}}},xg=function(t,r){var l,u,c;if(Ye(this,Ct,"m",od).call(this,t).done_tool_calls.has(r))return;const a=(l=t.message.tool_calls)==null?void 0:l[r];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const f=(c=(u=Ye(this,ws,"f"))==null?void 0:u.tools)==null?void 0:c.find(h=>h.type==="function"&&h.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:r,arguments:a.function.arguments,parsed_arguments:Tu(f)?f.$parseRaw(a.function.arguments):f!=null&&f.function.strict?JSON.parse(a.function.arguments):null})}else a.type},Sg=function(t){var s,a;const r=Ye(this,Ct,"m",od).call(this,t);if(t.message.content&&!r.content_done){r.content_done=!0;const l=Ye(this,Ct,"m",Eg).call(this);this._emit("content.done",{content:t.message.content,parsed:l?l.$parseRaw(t.message.content):null})}t.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(s=t.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},ld=function(){if(this.ended)throw new Oe("stream has ended, this shouldn't happen");const t=Ye(this,na,"f");if(!t)throw new Oe("request ended without sending any chunks");return ji(this,na,void 0,"f"),ji(this,Li,[],"f"),w9(t,Ye(this,ws,"f"))},Eg=function(){var r;const t=(r=Ye(this,ws,"f"))==null?void 0:r.response_format;return G_(t)?t:null},o1=function(t){var r,s,a,l;let u=Ye(this,na,"f");const{choices:c,...f}=t;u?Object.assign(u,f):u=ji(this,na,{...f,choices:[]},"f");for(const{delta:h,finish_reason:m,index:g,logprobs:y=null,...w}of t.choices){let v=u.choices[g];if(v||(v=u.choices[g]={finish_reason:m,index:g,message:{},logprobs:y,...w}),y)if(!v.logprobs)v.logprobs=Object.assign({},y);else{const{content:I,refusal:D,...F}=y;Object.assign(v.logprobs,F),I&&((r=v.logprobs).content??(r.content=[]),v.logprobs.content.push(...I)),D&&((s=v.logprobs).refusal??(s.refusal=[]),v.logprobs.refusal.push(...D))}if(m&&(v.finish_reason=m,Ye(this,ws,"f")&&QP(Ye(this,ws,"f")))){if(m==="length")throw new NP;if(m==="content_filter")throw new jP}if(Object.assign(v,w),!h)continue;const{content:x,refusal:E,function_call:P,role:S,tool_calls:R,...$}=h;if(Object.assign(v.message,$),E&&(v.message.refusal=(v.message.refusal||"")+E),S&&(v.message.role=S),P&&(v.message.function_call?(P.name&&(v.message.function_call.name=P.name),P.arguments&&((a=v.message.function_call).arguments??(a.arguments=""),v.message.function_call.arguments+=P.arguments)):v.message.function_call=P),x&&(v.message.content=(v.message.content||"")+x,!v.message.refusal&&Ye(this,Ct,"m",Eg).call(this)&&(v.message.parsed=i1(v.message.content))),R){v.message.tool_calls||(v.message.tool_calls=[]);for(const{index:I,id:D,type:F,function:K,...Y}of R){const ie=(l=v.message.tool_calls)[I]??(l[I]={});Object.assign(ie,Y),D&&(ie.id=D),F&&(ie.type=F),K&&(ie.function??(ie.function={name:K.name??"",arguments:""})),K!=null&&K.name&&(ie.function.name=K.name),K!=null&&K.arguments&&(ie.function.arguments+=K.arguments,l9(Ye(this,ws,"f"),ie)&&(ie.function.parsed_arguments=i1(ie.function.arguments)))}}}return u},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("chunk",s=>{const a=t.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,l)=>t.push({resolve:a,reject:l})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Vr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function w9(n,e){const{id:t,choices:r,created:s,model:a,system_fingerprint:l,...u}=n,c={...u,id:t,choices:r.map(({message:f,finish_reason:h,index:m,logprobs:g,...y})=>{if(!h)throw new Oe(`missing finish_reason for choice ${m}`);const{content:w=null,function_call:v,tool_calls:x,...E}=f,P=f.role;if(!P)throw new Oe(`missing role for choice ${m}`);if(v){const{arguments:S,name:R}=v;if(S==null)throw new Oe(`missing function_call.arguments for choice ${m}`);if(!R)throw new Oe(`missing function_call.name for choice ${m}`);return{...y,message:{content:w,function_call:{arguments:S,name:R},role:P,refusal:f.refusal??null},finish_reason:h,index:m,logprobs:g}}return x?{...y,index:m,finish_reason:h,logprobs:g,message:{...E,role:P,content:w,refusal:f.refusal??null,tool_calls:x.map((S,R)=>{const{function:$,type:I,id:D,...F}=S,{arguments:K,name:Y,...ie}=$||{};if(D==null)throw new Oe(`missing choices[${m}].tool_calls[${R}].id
${ud(n)}`);if(I==null)throw new Oe(`missing choices[${m}].tool_calls[${R}].type
${ud(n)}`);if(Y==null)throw new Oe(`missing choices[${m}].tool_calls[${R}].function.name
${ud(n)}`);if(K==null)throw new Oe(`missing choices[${m}].tool_calls[${R}].function.arguments
${ud(n)}`);return{...F,id:D,type:I,function:{...ie,name:Y,arguments:K}}})}}:{...y,message:{...E,content:w,role:P,refusal:f.refusal??null},finish_reason:h,index:m,logprobs:g}}),created:s,model:a,object:"chat.completion",...l?{system_fingerprint:l}:{}};return a9(c,e)}function ud(n){return JSON.stringify(n)}class Xi extends uu{static fromReadableStream(e){const t=new Xi(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,r){const s=new Xi(null),a={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,a)),s}static runTools(e,t,r){const s=new Xi(t),a={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,a)),s}}let dk=class extends De{parse(e,t){return u9(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>J_(r,e))}runFunctions(e,t){return e.stream?Xi.runFunctions(this._client,e,t):lu.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Xi.runTools(this._client,e,t):lu.runTools(this._client,e,t)}stream(e,t){return uu.createChatCompletion(this._client,e,t)}};class yy extends De{constructor(){super(...arguments),this.completions=new dk(this._client)}}(function(n){n.Completions=dk})(yy||(yy={}));class fk extends De{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class hk extends De{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Hf extends De{constructor(){super(...arguments),this.sessions=new fk(this._client),this.transcriptionSessions=new hk(this._client)}}Hf.Sessions=fk;Hf.TranscriptionSessions=hk;var ve=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},An=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},zt,_y,Br,xd,yr,Fa,Vi,Ma,Yd,Nn,Sd,Ed,Fl,Tl,Al,l1,u1,c1,d1,f1,h1,p1;class vr extends Z_{constructor(){super(...arguments),zt.add(this),_y.set(this,[]),Br.set(this,{}),xd.set(this,{}),yr.set(this,void 0),Fa.set(this,void 0),Vi.set(this,void 0),Ma.set(this,void 0),Yd.set(this,void 0),Nn.set(this,void 0),Sd.set(this,void 0),Ed.set(this,void 0),Fl.set(this,void 0)}[(_y=new WeakMap,Br=new WeakMap,xd=new WeakMap,yr=new WeakMap,Fa=new WeakMap,Vi=new WeakMap,Ma=new WeakMap,Yd=new WeakMap,Nn=new WeakMap,Sd=new WeakMap,Ed=new WeakMap,Fl=new WeakMap,zt=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",s=>{const a=t.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,l)=>t.push({resolve:a,reject:l})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new vr;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var a;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=Vr.fromReadableStream(e,this.controller);for await(const l of s)ve(this,zt,"m",Tl).call(this,l);if((a=s.controller.signal)!=null&&a.aborted)throw new Ln;return this._addRun(ve(this,zt,"m",Al).call(this))}toReadableStream(){return new Vr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,r,s,a){const l=new vr;return l._run(()=>l._runToolAssistantStream(e,t,r,s,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),l}async _createToolAssistantStream(e,t,r,s,a){var f;const l=a==null?void 0:a.signal;l&&(l.aborted&&this.controller.abort(),l.addEventListener("abort",()=>this.controller.abort()));const u={...s,stream:!0},c=await e.submitToolOutputs(t,r,u,{...a,signal:this.controller.signal});this._connected();for await(const h of c)ve(this,zt,"m",Tl).call(this,h);if((f=c.controller.signal)!=null&&f.aborted)throw new Ln;return this._addRun(ve(this,zt,"m",Al).call(this))}static createThreadAssistantStream(e,t,r){const s=new vr;return s._run(()=>s._threadAssistantStream(e,t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,t,r,s){const a=new vr;return a._run(()=>a._runAssistantStream(e,t,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return ve(this,Sd,"f")}currentRun(){return ve(this,Ed,"f")}currentMessageSnapshot(){return ve(this,yr,"f")}currentRunStepSnapshot(){return ve(this,Fl,"f")}async finalRunSteps(){return await this.done(),Object.values(ve(this,Br,"f"))}async finalMessages(){return await this.done(),Object.values(ve(this,xd,"f"))}async finalRun(){if(await this.done(),!ve(this,Fa,"f"))throw Error("Final run was not received.");return ve(this,Fa,"f")}async _createThreadAssistantStream(e,t,r){var u;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const a={...t,stream:!0},l=await e.createAndRun(a,{...r,signal:this.controller.signal});this._connected();for await(const c of l)ve(this,zt,"m",Tl).call(this,c);if((u=l.controller.signal)!=null&&u.aborted)throw new Ln;return this._addRun(ve(this,zt,"m",Al).call(this))}async _createAssistantStream(e,t,r,s){var c;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const l={...r,stream:!0},u=await e.create(t,l,{...s,signal:this.controller.signal});this._connected();for await(const f of u)ve(this,zt,"m",Tl).call(this,f);if((c=u.controller.signal)!=null&&c.aborted)throw new Ln;return this._addRun(ve(this,zt,"m",Al).call(this))}static accumulateDelta(e,t){for(const[r,s]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let a=e[r];if(a==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof a=="string"&&typeof s=="string")a+=s;else if(typeof a=="number"&&typeof s=="number")a+=s;else if(wg(a)&&wg(s))a=this.accumulateDelta(a,s);else if(Array.isArray(a)&&Array.isArray(s)){if(a.every(l=>typeof l=="string"||typeof l=="number")){a.push(...s);continue}for(const l of s){if(!wg(l))throw new Error(`Expected array delta entry to be an object but got: ${l}`);const u=l.index;if(u==null)throw console.error(l),new Error("Expected array delta entry to have an `index` property");if(typeof u!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${u}`);const c=a[u];c==null?a.push(l):a[u]=this.accumulateDelta(c,l)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${a}`);e[r]=a}return e}_addRun(e){return e}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,s){return await this._createAssistantStream(t,e,r,s)}async _runToolAssistantStream(e,t,r,s,a){return await this._createToolAssistantStream(r,e,t,s,a)}}Tl=function(e){if(!this.ended)switch(An(this,Sd,e,"f"),ve(this,zt,"m",c1).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":ve(this,zt,"m",p1).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":ve(this,zt,"m",u1).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":ve(this,zt,"m",l1).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Al=function(){if(this.ended)throw new Oe("stream has ended, this shouldn't happen");if(!ve(this,Fa,"f"))throw Error("Final run has not been received");return ve(this,Fa,"f")},l1=function(e){const[t,r]=ve(this,zt,"m",f1).call(this,e,ve(this,yr,"f"));An(this,yr,t,"f"),ve(this,xd,"f")[t.id]=t;for(const s of r){const a=t.content[s.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let a=s.text,l=t.content[s.index];if(l&&l.type=="text")this._emit("textDelta",a,l.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=ve(this,Vi,"f")){if(ve(this,Ma,"f"))switch(ve(this,Ma,"f").type){case"text":this._emit("textDone",ve(this,Ma,"f").text,ve(this,yr,"f"));break;case"image_file":this._emit("imageFileDone",ve(this,Ma,"f").image_file,ve(this,yr,"f"));break}An(this,Vi,s.index,"f")}An(this,Ma,t.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(ve(this,Vi,"f")!==void 0){const s=e.data.content[ve(this,Vi,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,ve(this,yr,"f"));break;case"text":this._emit("textDone",s.text,ve(this,yr,"f"));break}}ve(this,yr,"f")&&this._emit("messageDone",e.data),An(this,yr,void 0,"f")}},u1=function(e){const t=ve(this,zt,"m",d1).call(this,e);switch(An(this,Fl,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const a of r.step_details.tool_calls)a.index==ve(this,Yd,"f")?this._emit("toolCallDelta",a,t.step_details.tool_calls[a.index]):(ve(this,Nn,"f")&&this._emit("toolCallDone",ve(this,Nn,"f")),An(this,Yd,a.index,"f"),An(this,Nn,t.step_details.tool_calls[a.index],"f"),ve(this,Nn,"f")&&this._emit("toolCallCreated",ve(this,Nn,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":An(this,Fl,void 0,"f"),e.data.step_details.type=="tool_calls"&&ve(this,Nn,"f")&&(this._emit("toolCallDone",ve(this,Nn,"f")),An(this,Nn,void 0,"f")),this._emit("runStepDone",e.data,t);break}},c1=function(e){ve(this,_y,"f").push(e),this._emit("event",e)},d1=function(e){switch(e.event){case"thread.run.step.created":return ve(this,Br,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=ve(this,Br,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=vr.accumulateDelta(t,r.delta);ve(this,Br,"f")[e.data.id]=s}return ve(this,Br,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":ve(this,Br,"f")[e.data.id]=e.data;break}if(ve(this,Br,"f")[e.data.id])return ve(this,Br,"f")[e.data.id];throw new Error("No snapshot available")},f1=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const a of s.delta.content)if(a.index in t.content){let l=t.content[a.index];t.content[a.index]=ve(this,zt,"m",h1).call(this,a,l)}else t.content[a.index]=a,r.push(a);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},h1=function(e,t){return vr.accumulateDelta(t,e)},p1=function(e){switch(An(this,Ed,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":An(this,Fa,e.data,"f"),ve(this,Nn,"f")&&(this._emit("toolCallDone",ve(this,Nn,"f")),An(this,Nn,void 0,"f"));break}};class K_ extends De{create(e,t,r){return this._client.post(`/threads/${e}/messages`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,s){return this._client.post(`/threads/${e}/messages/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},r){return ht(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,X_,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class X_ extends Vt{}K_.MessagesPage=X_;class Y_ extends De{retrieve(e,t,r,s={},a){return ht(s)?this.retrieve(e,t,r,{},s):this._client.get(`/threads/${e}/runs/${t}/steps/${r}`,{query:s,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(e,t,r={},s){return ht(r)?this.list(e,t,{},r):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,Q_,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class Q_ extends Vt{}Y_.RunStepsPage=Q_;let Au=class extends De{constructor(){super(...arguments),this.steps=new Y_(this._client)}create(e,t,r){const{include:s,...a}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:a,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:t.stream??!1})}retrieve(e,t,r){return this._client.get(`/threads/${e}/runs/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,s){return this._client.post(`/threads/${e}/runs/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},r){return ht(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,ew,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t,r);return await this.poll(e,s.id,r)}createAndStream(e,t,r){return vr.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:a,response:l}=await this.retrieve(e,t,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let u=5e3;if(r!=null&&r.pollIntervalMs)u=r.pollIntervalMs;else{const c=l.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(u=f)}}await Ru(u);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,t,r){return vr.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r,s){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,t,r,s){const a=await this.submitToolOutputs(e,t,r,s);return await this.poll(e,a.id,s)}submitToolOutputsStream(e,t,r,s){return vr.createToolAssistantStream(e,t,this._client.beta.threads.runs,r,s)}};class ew extends Vt{}Au.RunsPage=ew;Au.Steps=Y_;Au.RunStepsPage=Q_;class Co extends De{constructor(){super(...arguments),this.runs=new Au(this._client),this.messages=new K_(this._client)}create(e={},t){return ht(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/threads/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const r=await this.createAndRun(e,t);return await this.runs.poll(r.thread_id,r.id,t)}createAndRunStream(e,t){return vr.createThreadAssistantStream(e,this._client.beta.threads,t)}}Co.Runs=Au;Co.RunsPage=ew;Co.Messages=K_;Co.MessagesPage=X_;class Po extends De{constructor(){super(...arguments),this.realtime=new Hf(this._client),this.chat=new yy(this._client),this.assistants=new V_(this._client),this.threads=new Co(this._client)}}Po.Realtime=Hf;Po.Assistants=V_;Po.AssistantsPage=q_;Po.Threads=Co;class pk extends De{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class mk extends De{create(e,t){const r=!!e.encoding_format;let s=r?e.encoding_format:"base64";r&&la("Request","User defined encoding_format:",e.encoding_format);const a=this._client.post("/embeddings",{body:{...e,encoding_format:s},...t});return r?a:(la("response","Decoding base64 embeddings to float32 array"),a._thenUnwrap(l=>(l&&l.data&&l.data.forEach(u=>{const c=u.embedding;u.embedding=n9(c)}),l)))}}class tw extends De{retrieve(e,t,r,s){return this._client.get(`/evals/${e}/runs/${t}/output_items/${r}`,s)}list(e,t,r={},s){return ht(r)?this.list(e,t,{},r):this._client.getAPIList(`/evals/${e}/runs/${t}/output_items`,nw,{query:r,...s})}}class nw extends Vt{}tw.OutputItemListResponsesPage=nw;class $u extends De{constructor(){super(...arguments),this.outputItems=new tw(this._client)}create(e,t,r){return this._client.post(`/evals/${e}/runs`,{body:t,...r})}retrieve(e,t,r){return this._client.get(`/evals/${e}/runs/${t}`,r)}list(e,t={},r){return ht(t)?this.list(e,{},t):this._client.getAPIList(`/evals/${e}/runs`,rw,{query:t,...r})}del(e,t,r){return this._client.delete(`/evals/${e}/runs/${t}`,r)}cancel(e,t,r){return this._client.post(`/evals/${e}/runs/${t}`,r)}}class rw extends Vt{}$u.RunListResponsesPage=rw;$u.OutputItems=tw;$u.OutputItemListResponsesPage=nw;class Iu extends De{constructor(){super(...arguments),this.runs=new $u(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(`/evals/${e}`,t)}update(e,t,r){return this._client.post(`/evals/${e}`,{body:t,...r})}list(e={},t){return ht(e)?this.list({},e):this._client.getAPIList("/evals",sw,{query:e,...t})}del(e,t){return this._client.delete(`/evals/${e}`,t)}}class sw extends Vt{}Iu.EvalListResponsesPage=sw;Iu.Runs=$u;Iu.RunListResponsesPage=rw;let aw=class extends De{create(e,t){return this._client.post("/files",oo({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return ht(e)?this.list({},e):this._client.getAPIList("/files",iw,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),a=Date.now();let l=await this.retrieve(e);for(;!l.status||!s.has(l.status);)if(await Ru(t),l=await this.retrieve(e),Date.now()-a>r)throw new jf({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return l}};class iw extends Vt{}aw.FileObjectsPage=iw;class ow extends De{create(e,t,r){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,lw,{body:t,method:"post",...r})}retrieve(e,t={},r){return ht(t)?this.retrieve(e,{},t):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...r})}del(e,t){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions`,t)}}class lw extends Ff{}ow.PermissionCreateResponsesPage=lw;let Wf=class extends De{constructor(){super(...arguments),this.permissions=new ow(this._client)}};Wf.Permissions=ow;Wf.PermissionCreateResponsesPage=lw;class uw extends De{list(e,t={},r){return ht(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,cw,{query:t,...r})}}class cw extends Vt{}uw.FineTuningJobCheckpointsPage=cw;class ko extends De{constructor(){super(...arguments),this.checkpoints=new uw(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return ht(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",dw,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return ht(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,fw,{query:t,...r})}}class dw extends Vt{}class fw extends Vt{}ko.FineTuningJobsPage=dw;ko.FineTuningJobEventsPage=fw;ko.Checkpoints=uw;ko.FineTuningJobCheckpointsPage=cw;class Ro extends De{constructor(){super(...arguments),this.jobs=new ko(this._client),this.checkpoints=new Wf(this._client)}}Ro.Jobs=ko;Ro.FineTuningJobsPage=dw;Ro.FineTuningJobEventsPage=fw;Ro.Checkpoints=Wf;class gk extends De{createVariation(e,t){return this._client.post("/images/variations",oo({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",oo({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class hw extends De{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",pw,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class pw extends Ff{}hw.ModelsPage=pw;class yk extends De{create(e,t){return this._client.post("/moderations",{body:e,...t})}}function b9(n,e){return!e||!x9(e)?{...n,output_parsed:null,output:n.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(r=>({...r,parsed:null}))}:t)}:_k(n,e)}function _k(n,e){const t=n.output.map(s=>{if(s.type==="function_call")return{...s,parsed_arguments:C9(e,s)};if(s.type==="message"){const a=s.content.map(l=>l.type==="output_text"?{...l,parsed:v9(e,l.text)}:l);return{...s,content:a}}return s}),r=Object.assign({},n,{output:t});return Object.getOwnPropertyDescriptor(n,"output_text")||wk(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const s of r.output)if(s.type==="message"){for(const a of s.content)if(a.type==="output_text"&&a.parsed!==null)return a.parsed}return null}}),r}function v9(n,e){var t,r,s,a;return((r=(t=n.text)==null?void 0:t.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((s=n.text)==null?void 0:s.format)?((a=n.text)==null?void 0:a.format).$parseRaw(e):JSON.parse(e)}function x9(n){var e;return!!G_((e=n.text)==null?void 0:e.format)}function S9(n){return(n==null?void 0:n.$brand)==="auto-parseable-tool"}function E9(n,e){return n.find(t=>t.type==="function"&&t.name===e)}function C9(n,e){const t=E9(n.tools??[],e.name);return{...e,...e,parsed_arguments:S9(t)?t.$parseRaw(e.arguments):t!=null&&t.strict?JSON.parse(e.arguments):null}}function wk(n){const e=[];for(const t of n.output)if(t.type==="message")for(const r of t.content)r.type==="output_text"&&e.push(r.text);n.output_text=e.join("")}class bk extends De{list(e,t={},r){return ht(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,k9,{query:t,...r})}}var Mi=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},ra=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Di,cd,sa,dd,m1,g1,y1,_1;class mw extends Z_{constructor(e){super(),Di.add(this),cd.set(this,void 0),sa.set(this,void 0),dd.set(this,void 0),Mi(this,cd,e,"f")}static createResponse(e,t,r){const s=new mw(t);return s._run(()=>s._createResponse(e,t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createResponse(e,t,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),ra(this,Di,"m",m1).call(this);const a=await e.responses.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const u of a)ra(this,Di,"m",g1).call(this,u);if((l=a.controller.signal)!=null&&l.aborted)throw new Ln;return ra(this,Di,"m",y1).call(this)}[(cd=new WeakMap,sa=new WeakMap,dd=new WeakMap,Di=new WeakSet,m1=function(){this.ended||Mi(this,sa,void 0,"f")},g1=function(t){if(this.ended)return;const r=ra(this,Di,"m",_1).call(this,t);switch(this._emit("event",t),t.type){case"response.output_text.delta":{const s=r.output[t.output_index];if(!s)throw new Oe(`missing output at index ${t.output_index}`);if(s.type==="message"){const a=s.content[t.content_index];if(!a)throw new Oe(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new Oe(`expected content to be 'output_text', got ${a.type}`);this._emit("response.output_text.delta",{...t,snapshot:a.text})}break}case"response.function_call_arguments.delta":{const s=r.output[t.output_index];if(!s)throw new Oe(`missing output at index ${t.output_index}`);s.type==="function_call"&&this._emit("response.function_call_arguments.delta",{...t,snapshot:s.arguments});break}default:this._emit(t.type,t);break}},y1=function(){if(this.ended)throw new Oe("stream has ended, this shouldn't happen");const t=ra(this,sa,"f");if(!t)throw new Oe("request ended without sending any events");Mi(this,sa,void 0,"f");const r=P9(t,ra(this,cd,"f"));return Mi(this,dd,r,"f"),r},_1=function(t){let r=ra(this,sa,"f");if(!r){if(t.type!=="response.created")throw new Oe(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return r=Mi(this,sa,t.response,"f"),r}switch(t.type){case"response.output_item.added":{r.output.push(t.item);break}case"response.content_part.added":{const s=r.output[t.output_index];if(!s)throw new Oe(`missing output at index ${t.output_index}`);s.type==="message"&&s.content.push(t.part);break}case"response.output_text.delta":{const s=r.output[t.output_index];if(!s)throw new Oe(`missing output at index ${t.output_index}`);if(s.type==="message"){const a=s.content[t.content_index];if(!a)throw new Oe(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new Oe(`expected content to be 'output_text', got ${a.type}`);a.text+=t.delta}break}case"response.function_call_arguments.delta":{const s=r.output[t.output_index];if(!s)throw new Oe(`missing output at index ${t.output_index}`);s.type==="function_call"&&(s.arguments+=t.delta);break}case"response.completed":{Mi(this,sa,t.response,"f");break}}return r},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",s=>{const a=t.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,l)=>t.push({resolve:a,reject:l})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=ra(this,dd,"f");if(!e)throw new Oe("stream ended without producing a ChatCompletion");return e}}function P9(n,e){return b9(n,e)}class gw extends De{constructor(){super(...arguments),this.inputItems=new bk(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&wk(r),r))}retrieve(e,t={},r){return ht(t)?this.retrieve(e,{},t):this._client.get(`/responses/${e}`,{query:t,...r})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(r=>_k(r,e))}stream(e,t){return mw.createResponse(this._client,e,t)}}class k9 extends Vt{}gw.InputItems=bk;class vk extends De{create(e,t,r){return this._client.post(`/uploads/${e}/parts`,oo({body:t,...r}))}}class yw extends De{constructor(){super(...arguments),this.parts=new vk(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,r){return this._client.post(`/uploads/${e}/complete`,{body:t,...r})}}yw.Parts=vk;const R9=async n=>{const e=await Promise.allSettled(n),t=e.filter(s=>s.status==="rejected");if(t.length){for(const s of t)console.error(s.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};class Vf extends De{create(e,t,r){return this._client.post(`/vector_stores/${e}/files`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,s){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},r){return ht(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,qf,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t,r);return await this.poll(e,s.id,r)}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...r,headers:s}).withResponse(),l=a.data;switch(l.status){case"in_progress":let u=5e3;if(r!=null&&r.pollIntervalMs)u=r.pollIntervalMs;else{const c=a.response.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(u=f)}}await Ru(u);break;case"failed":case"completed":return l}}}async upload(e,t,r){const s=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,t,r){const s=await this.upload(e,t,r);return await this.poll(e,s.id,r)}content(e,t,r){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,_w,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class qf extends Vt{}class _w extends Ff{}Vf.VectorStoreFilesPage=qf;Vf.FileContentResponsesPage=_w;class xk extends De{create(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t);return await this.poll(e,s.id,r)}listFiles(e,t,r={},s){return ht(r)?this.listFiles(e,t,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,qf,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:a,response:l}=await this.retrieve(e,t,{...r,headers:s}).withResponse();switch(a.status){case"in_progress":let u=5e3;if(r!=null&&r.pollIntervalMs)u=r.pollIntervalMs;else{const c=l.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(u=f)}}await Ru(u);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},s){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=(s==null?void 0:s.maxConcurrency)??5,l=Math.min(a,t.length),u=this._client,c=t.values(),f=[...r];async function h(g){for(let y of g){const w=await u.files.create({file:y,purpose:"assistants"},s);f.push(w.id)}}const m=Array(l).fill(c).map(h);return await R9(m),await this.createAndPoll(e,{file_ids:f})}}class _a extends De{constructor(){super(...arguments),this.files=new Vf(this._client),this.fileBatches=new xk(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/vector_stores/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return ht(e)?this.list({},e):this._client.getAPIList("/vector_stores",ww,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}search(e,t,r){return this._client.getAPIList(`/vector_stores/${e}/search`,bw,{body:t,method:"post",...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class ww extends Vt{}class bw extends Ff{}_a.VectorStoresPage=ww;_a.VectorStoreSearchResponsesPage=bw;_a.Files=Vf;_a.VectorStoreFilesPage=qf;_a.FileContentResponsesPage=_w;_a.FileBatches=xk;var Sk;let Ne=class extends WF{constructor({baseURL:e=ad("OPENAI_BASE_URL"),apiKey:t=ad("OPENAI_API_KEY"),organization:r=ad("OPENAI_ORG_ID")??null,project:s=ad("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new Oe("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const l={apiKey:t,organization:r,project:s,...a,baseURL:e||"https://api.openai.com/v1"};if(!l.dangerouslyAllowBrowser&&e9())throw new Oe(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:l.baseURL,timeout:l.timeout??6e5,httpAgent:l.httpAgent,maxRetries:l.maxRetries,fetch:l.fetch}),this.completions=new pk(this),this.chat=new Bf(this),this.embeddings=new mk(this),this.files=new aw(this),this.images=new gk(this),this.audio=new Ou(this),this.moderations=new yk(this),this.models=new hw(this),this.fineTuning=new Ro(this),this.vectorStores=new _a(this),this.beta=new Po(this),this.batches=new H_(this),this.uploads=new yw(this),this.responses=new gw(this),this.evals=new Iu(this),this._options=l,this.apiKey=t,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return PF(e,{arrayFormat:"brackets"})}};Sk=Ne;Ne.OpenAI=Sk;Ne.DEFAULT_TIMEOUT=6e5;Ne.OpenAIError=Oe;Ne.APIError=Wt;Ne.APIConnectionError=Nf;Ne.APIConnectionTimeoutError=jf;Ne.APIUserAbortError=Ln;Ne.NotFoundError=OP;Ne.ConflictError=TP;Ne.RateLimitError=$P;Ne.BadRequestError=PP;Ne.AuthenticationError=kP;Ne.InternalServerError=IP;Ne.PermissionDeniedError=RP;Ne.UnprocessableEntityError=AP;Ne.toFile=FP;Ne.fileFromPath=SP;Ne.Completions=pk;Ne.Chat=Bf;Ne.ChatCompletionsPage=zf;Ne.Embeddings=mk;Ne.Files=aw;Ne.FileObjectsPage=iw;Ne.Images=gk;Ne.Audio=Ou;Ne.Moderations=yk;Ne.Models=hw;Ne.ModelsPage=pw;Ne.FineTuning=Ro;Ne.VectorStores=_a;Ne.VectorStoresPage=ww;Ne.VectorStoreSearchResponsesPage=bw;Ne.Beta=Po;Ne.Batches=H_;Ne.BatchesPage=W_;Ne.Uploads=yw;Ne.Responses=gw;Ne.Evals=Iu;Ne.EvalListResponsesPage=sw;class O9 extends Lt{parseResultWithPrompt(e,t,r){return this.parseResult(e,r)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,t){return typeof e=="string"?this._callWithConfig(async(r,s)=>this.parseResult([{text:r}],s==null?void 0:s.callbacks),e,{...t,runType:"parser"}):this._callWithConfig(async(r,s)=>this.parseResult([{message:r,text:this._baseMessageToString(r)}],s==null?void 0:s.callbacks),e,{...t,runType:"parser"})}}class Ek extends O9{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,r){return this.parse(e,r)}_type(){throw new Error("_type not implemented")}}class vw extends Error{constructor(e,t,r,s=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=t,this.observation=r,this.sendToLLM=s,s&&(r===void 0||t===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");PC(this,"OUTPUT_PARSING_FAILURE")}}class T9 extends Ek{async*_transform(e){for await(const t of e)typeof t=="string"?yield this.parseResult([{text:t}]):yield this.parseResult([{message:t,text:this._baseMessageToString(t)}])}async*transform(e,t){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...t,runType:"parser"})}}class Ck extends T9{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(e==null?void 0:e.diff)??this.diff}async*_transform(e){let t,r;for await(const s of e){if(typeof s!="string"&&typeof s.content!="string")throw new Error("Cannot handle non-string output.");let a;if(ZL(s)){if(typeof s.content!="string")throw new Error("Cannot handle non-string message output.");a=new Kr({message:s,text:s.content})}else if(xf(s)){if(typeof s.content!="string")throw new Error("Cannot handle non-string message output.");a=new Kr({message:QL(s),text:s.content})}else a=new io({text:s});r===void 0?r=a:r=r.concat(a);const l=await this.parsePartialResult([r]);l!=null&&!sy(l,t)&&(this.diff?yield this._diff(t,l):yield l,t=l)}}getFormatInstructions(){return""}}class w1 extends Ek{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const t=Se.object(Object.fromEntries(Object.entries(e).map(([r,s])=>[r,Se.string().describe(s)])));return new this(t)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(ku(this.schema))}
\`\`\`
`}async parse(e){try{const r=(e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(s,a)=>`"${a.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(r))}catch(t){throw new vw(`Failed to parse. Text: "${e}". Error: ${t}`,e)}}}class b1 extends Ck{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,t){if(t)return e?j3(e,t):[{op:"replace",path:"",value:t}]}async parsePartialResult(e){return ox(e[0].text)}async parse(e){return ox(e,JSON.parse)}getFormatInstructions(){return""}}function xw(n,e){if(n.function===void 0)return;let t;if(e!=null&&e.partial)try{t=x_(n.function.arguments??"{}")}catch{return}else try{t=JSON.parse(n.function.arguments)}catch(s){throw new vw([`Function "${n.function.name}" arguments:`,"",n.function.arguments,"","are not valid JSON.",`Error: ${s.message}`].join(`
`))}const r={name:n.function.name,args:t,type:"tool_call"};return e!=null&&e.returnId&&(r.id=n.id),r}function A9(n){if(n.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:n.id,type:"function",function:{name:n.name,arguments:JSON.stringify(n.args)}}}function Pk(n,e){var t,r;return{name:(t=n.function)==null?void 0:t.name,args:(r=n.function)==null?void 0:r.arguments,id:n.id,error:e,type:"invalid_tool_call"}}class $9 extends Ck{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(e==null?void 0:e.returnId)??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(e){return await this.parsePartialResult(e,!1)}async parsePartialResult(e,t=!0){var l;const r=e[0].message;let s;if(vu(r)&&((l=r.tool_calls)!=null&&l.length)?s=r.tool_calls.map(u=>{const{id:c,...f}=u;return this.returnId?{id:c,...f}:f}):r.additional_kwargs.tool_calls!==void 0&&(s=JSON.parse(JSON.stringify(r.additional_kwargs.tool_calls)).map(c=>xw(c,{returnId:this.returnId,partial:t}))),!s)return[];const a=[];for(const u of s)if(u!==void 0){const c={type:u.name,args:u.args,id:u.id};a.push(c)}return a}}class v1 extends $9{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const t=await this.zodSchema.safeParseAsync(e);if(t.success)return t.data;throw new vw(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(t.error.errors)}`,JSON.stringify(e,null,2))}async parsePartialResult(e){const r=(await super.parsePartialResult(e)).filter(a=>a.type===this.keyName);let s=r;if(r.length)return this.returnId||(s=r.map(a=>a.args)),this.returnSingle?s[0]:s}async parseResult(e){const r=(await super.parsePartialResult(e,!1)).filter(l=>l.type===this.keyName);let s=r;return r.length?(this.returnId||(s=r.map(l=>l.args)),this.returnSingle?this._validateResult(s[0]):await Promise.all(s.map(l=>this._validateResult(l)))):void 0}}const I9=Symbol("Let zodToJsonSchema decide on which parser to use"),x1={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},N9=n=>typeof n=="string"?{...x1,basePath:["#"],definitions:{},name:n}:{...x1,basePath:["#"],definitions:{},...n},wy=n=>"_def"in n?n._def:n;function j9(n){if(!n)return!0;for(const e in n)return!1;return!0}const L9=n=>{const e=N9(n),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map(([r,s])=>[wy(s),{def:wy(s),path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function kk(n,e,t,r){r!=null&&r.errorMessages&&t&&(n.errorMessage={...n.errorMessage,[e]:t})}function Ke(n,e,t,r,s){n[e]=t,kk(n,e,r,s)}function M9(){return{}}function D9(n,e){var r,s;const t={type:"array"};return((s=(r=n.type)==null?void 0:r._def)==null?void 0:s.typeName)!==Z.ZodAny&&(t.items=Ve(n.type._def,{...e,currentPath:[...e.currentPath,"items"]})),n.minLength&&Ke(t,"minItems",n.minLength.value,n.minLength.message,e),n.maxLength&&Ke(t,"maxItems",n.maxLength.value,n.maxLength.message,e),n.exactLength&&(Ke(t,"minItems",n.exactLength.value,n.exactLength.message,e),Ke(t,"maxItems",n.exactLength.value,n.exactLength.message,e)),t}function F9(n,e){const t={type:"integer",format:"int64"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?Ke(t,"minimum",r.value,r.message,e):Ke(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Ke(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Ke(t,"maximum",r.value,r.message,e):Ke(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Ke(t,"maximum",r.value,r.message,e));break;case"multipleOf":Ke(t,"multipleOf",r.value,r.message,e);break}return t}function U9(){return{type:"boolean"}}function z9(n,e){return Ve(n.type._def,e)}const B9=(n,e)=>Ve(n.innerType._def,e);function Rk(n,e,t){const r=t??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,a)=>Rk(n,e,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return H9(n,e)}}const H9=(n,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const r of n.checks)switch(r.kind){case"min":Ke(t,"minimum",r.value,r.message,e);break;case"max":Ke(t,"maximum",r.value,r.message,e);break}return t};function W9(n,e){return{...Ve(n.innerType._def,e),default:n.defaultValue()}}function V9(n,e,t){return e.effectStrategy==="input"?Ve(n.schema._def,e,t):{}}function q9(n){return{type:"string",enum:[...n.values]}}const Z9=n=>"type"in n&&n.type==="string"?!1:"allOf"in n;function G9(n,e){const t=[Ve(n.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Ve(n.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return t.forEach(a=>{if(Z9(a))s.push(...a.allOf),a.unevaluatedProperties===void 0&&(r=void 0);else{let l=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:u,...c}=a;l=c}else r=void 0;s.push(l)}}),s.length?{allOf:s,...r}:void 0}function J9(n,e){const t=typeof n.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(n.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[n.value]}:{type:t==="bigint"?"integer":t,const:n.value}}let Cg;const Na={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Cg===void 0&&(Cg=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Cg),base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function Ok(n,e){const t={type:"string"};function r(s){return e.patternStrategy==="escape"?K9(s):s}if(n.checks)for(const s of n.checks)switch(s.kind){case"min":Ke(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,s.value):s.value,s.message,e);break;case"max":Ke(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,s.value):s.value,s.message,e);break;case"email":switch(e.emailStrategy){case"format:email":pr(t,"email",s.message,e);break;case"format:idn-email":pr(t,"idn-email",s.message,e);break;case"pattern:zod":mr(t,Na.email,s.message,e);break}break;case"url":pr(t,"uri",s.message,e);break;case"uuid":pr(t,"uuid",s.message,e);break;case"regex":mr(t,s.regex,s.message,e);break;case"cuid":mr(t,Na.cuid,s.message,e);break;case"cuid2":mr(t,Na.cuid2,s.message,e);break;case"startsWith":mr(t,RegExp(`^${r(s.value)}`),s.message,e);break;case"endsWith":mr(t,RegExp(`${r(s.value)}$`),s.message,e);break;case"datetime":pr(t,"date-time",s.message,e);break;case"date":pr(t,"date",s.message,e);break;case"time":pr(t,"time",s.message,e);break;case"duration":pr(t,"duration",s.message,e);break;case"length":Ke(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,s.value):s.value,s.message,e),Ke(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,s.value):s.value,s.message,e);break;case"includes":{mr(t,RegExp(r(s.value)),s.message,e);break}case"ip":{s.version!=="v6"&&pr(t,"ipv4",s.message,e),s.version!=="v4"&&pr(t,"ipv6",s.message,e);break}case"emoji":mr(t,Na.emoji,s.message,e);break;case"ulid":{mr(t,Na.ulid,s.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{pr(t,"binary",s.message,e);break}case"contentEncoding:base64":{Ke(t,"contentEncoding","base64",s.message,e);break}case"pattern:zod":{mr(t,Na.base64,s.message,e);break}}break}case"nanoid":mr(t,Na.nanoid,s.message,e)}return t}const K9=n=>Array.from(n).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),pr=(n,e,t,r)=>{var s;n.format||(s=n.anyOf)!=null&&s.some(a=>a.format)?(n.anyOf||(n.anyOf=[]),n.format&&(n.anyOf.push({format:n.format,...n.errorMessage&&r.errorMessages&&{errorMessage:{format:n.errorMessage.format}}}),delete n.format,n.errorMessage&&(delete n.errorMessage.format,Object.keys(n.errorMessage).length===0&&delete n.errorMessage)),n.anyOf.push({format:e,...t&&r.errorMessages&&{errorMessage:{format:t}}})):Ke(n,"format",e,t,r)},mr=(n,e,t,r)=>{var s;n.pattern||(s=n.allOf)!=null&&s.some(a=>a.pattern)?(n.allOf||(n.allOf=[]),n.pattern&&(n.allOf.push({pattern:n.pattern,...n.errorMessage&&r.errorMessages&&{errorMessage:{pattern:n.errorMessage.pattern}}}),delete n.pattern,n.errorMessage&&(delete n.errorMessage.pattern,Object.keys(n.errorMessage).length===0&&delete n.errorMessage)),n.allOf.push({pattern:S1(e,r),...t&&r.errorMessages&&{errorMessage:{pattern:t}}})):Ke(n,"pattern",S1(e,r),t,r)},S1=(n,e)=>{var f;const t=typeof n=="function"?n():n;if(!e.applyRegexFlags||!t.flags)return t.source;const r={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},s=r.i?t.source.toLowerCase():t.source;let a="",l=!1,u=!1,c=!1;for(let h=0;h<s.length;h++){if(l){a+=s[h],l=!1;continue}if(r.i){if(u){if(s[h].match(/[a-z]/)){c?(a+=s[h],a+=`${s[h-2]}-${s[h]}`.toUpperCase(),c=!1):s[h+1]==="-"&&((f=s[h+2])!=null&&f.match(/[a-z]/))?(a+=s[h],c=!0):a+=`${s[h]}${s[h].toUpperCase()}`;continue}}else if(s[h].match(/[a-z]/)){a+=`[${s[h]}${s[h].toUpperCase()}]`;continue}}if(r.m){if(s[h]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(s[h]==="$"){a+=`($|(?=[\r
]))`;continue}}if(r.s&&s[h]==="."){a+=u?`${s[h]}\r
`:`[${s[h]}\r
]`;continue}a+=s[h],s[h]==="\\"?l=!0:u&&s[h]==="]"?u=!1:!u&&s[h]==="["&&(u=!0)}try{const h=new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return a};function Tk(n,e){var r,s,a,l;if(e.target==="openApi3"&&((r=n.keyType)==null?void 0:r._def.typeName)===Z.ZodEnum)return{type:"object",required:n.keyType._def.values,properties:n.keyType._def.values.reduce((u,c)=>({...u,[c]:Ve(n.valueType._def,{...e,currentPath:[...e.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const t={type:"object",additionalProperties:Ve(n.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return t;if(((s=n.keyType)==null?void 0:s._def.typeName)===Z.ZodString&&((a=n.keyType._def.checks)!=null&&a.length)){const u=Object.entries(Ok(n.keyType._def,e)).reduce((c,[f,h])=>f==="type"?c:{...c,[f]:h},{});return{...t,propertyNames:u}}else if(((l=n.keyType)==null?void 0:l._def.typeName)===Z.ZodEnum)return{...t,propertyNames:{enum:n.keyType._def.values}};return t}function X9(n,e){if(e.mapStrategy==="record")return Tk(n,e);const t=Ve(n.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},r=Ve(n.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,r],minItems:2,maxItems:2}}}function Y9(n){const e=n.values,r=Object.keys(n.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),s=Array.from(new Set(r.map(a=>typeof a)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function Q9(){return{not:{}}}function e5(n){return n.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Qd={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function t5(n,e){if(e.target==="openApi3")return E1(n,e);const t=n.options instanceof Map?Array.from(n.options.values()):n.options;if(t.every(r=>r._def.typeName in Qd&&(!r._def.checks||!r._def.checks.length))){const r=t.reduce((s,a)=>{const l=Qd[a._def.typeName];return l&&!s.includes(l)?[...s,l]:s},[]);return{type:r.length>1?r:r[0]}}else if(t.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=t.reduce((s,a)=>{const l=typeof a._def.value;switch(l){case"string":case"number":case"boolean":return[...s,l];case"bigint":return[...s,"integer"];case"object":if(a._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===t.length){const s=r.filter((a,l,u)=>u.indexOf(a)===l);return{type:s.length>1?s:s[0],enum:t.reduce((a,l)=>a.includes(l._def.value)?a:[...a,l._def.value],[])}}}else if(t.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((r,s)=>[...r,...s._def.values.filter(a=>!r.includes(a))],[])};return E1(n,e)}const E1=(n,e)=>{const t=(n.options instanceof Map?Array.from(n.options.values()):n.options).map((r,s)=>Ve(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return t.length?{anyOf:t}:void 0};function n5(n,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(n.innerType._def.typeName)&&(!n.innerType._def.checks||!n.innerType._def.checks.length))return e.target==="openApi3"||e.nullableStrategy==="property"?{type:Qd[n.innerType._def.typeName],nullable:!0}:{type:[Qd[n.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=Ve(n.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const t=Ve(n.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function r5(n,e){const t={type:"number"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"int":t.type="integer",kk(t,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?Ke(t,"minimum",r.value,r.message,e):Ke(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Ke(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Ke(t,"maximum",r.value,r.message,e):Ke(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Ke(t,"maximum",r.value,r.message,e));break;case"multipleOf":Ke(t,"multipleOf",r.value,r.message,e);break}return t}function s5(n,e){return e.removeAdditionalStrategy==="strict"?n.catchall._def.typeName==="ZodNever"?n.unknownKeys!=="strict":Ve(n.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:n.catchall._def.typeName==="ZodNever"?n.unknownKeys==="passthrough":Ve(n.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function a5(n,e){const t={type:"object",...Object.entries(n.shape()).reduce((r,[s,a])=>{if(a===void 0||a._def===void 0)return r;const l=[...e.currentPath,"properties",s],u=Ve(a._def,{...e,currentPath:l,propertyPath:l});return u===void 0?r:(e.openaiStrictMode&&a.isOptional()&&!a.isNullable()&&console.warn(`Zod field at \`${l.join("/")}\` uses \`.optional()\` without \`.nullable()\` which is not supported by the API. See: https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#all-fields-must-be-required
This will become an error in a future version of the SDK.`),{properties:{...r.properties,[s]:u},required:a.isOptional()&&!e.openaiStrictMode?r.required:[...r.required,s]})},{properties:{},required:[]}),additionalProperties:s5(n,e)};return t.required.length||delete t.required,t}const i5=(n,e)=>{var r;if(e.currentPath.toString()===((r=e.propertyPath)==null?void 0:r.toString()))return Ve(n.innerType._def,e);const t=Ve(n.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}},o5=(n,e)=>{if(e.pipeStrategy==="input")return Ve(n.in._def,e);if(e.pipeStrategy==="output")return Ve(n.out._def,e);const t=Ve(n.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=Ve(n.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,r].filter(s=>s!==void 0)}};function l5(n,e){return Ve(n.type._def,e)}function u5(n,e){const r={type:"array",uniqueItems:!0,items:Ve(n.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return n.minSize&&Ke(r,"minItems",n.minSize.value,n.minSize.message,e),n.maxSize&&Ke(r,"maxItems",n.maxSize.value,n.maxSize.message,e),r}function c5(n,e){return n.rest?{type:"array",minItems:n.items.length,items:n.items.map((t,r)=>Ve(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[]),additionalItems:Ve(n.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:n.items.length,maxItems:n.items.length,items:n.items.map((t,r)=>Ve(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[])}}function d5(){return{not:{}}}function f5(){return{}}const h5=(n,e)=>Ve(n.innerType._def,e);function Ve(n,e,t=!1){var l;const r=e.seen.get(n);if(e.override){const u=(l=e.override)==null?void 0:l.call(e,n,e,r,t);if(u!==I9)return u}if(r&&!t){const u=p5(r,e);if(u!==void 0)return"$ref"in u&&e.seenRefs.add(u.$ref),u}const s={def:n,path:e.currentPath,jsonSchema:void 0};e.seen.set(n,s);const a=g5(n,n.typeName,e,t);return a&&y5(n,e,a),s.jsonSchema=a,a}const p5=(n,e)=>{switch(e.$refStrategy){case"root":return{$ref:n.path.join("/")};case"extract-to-root":const t=n.path.slice(e.basePath.length+1).join("_");return t!==e.name&&e.nameStrategy==="duplicate-ref"&&(e.definitions[t]=n.def),{$ref:[...e.basePath,e.definitionPath,t].join("/")};case"relative":return{$ref:m5(e.currentPath,n.path)};case"none":case"seen":return n.path.length<e.currentPath.length&&n.path.every((r,s)=>e.currentPath[s]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},m5=(n,e)=>{let t=0;for(;t<n.length&&t<e.length&&n[t]===e[t];t++);return[(n.length-t).toString(),...e.slice(t)].join("/")},g5=(n,e,t,r)=>{switch(e){case Z.ZodString:return Ok(n,t);case Z.ZodNumber:return r5(n,t);case Z.ZodObject:return a5(n,t);case Z.ZodBigInt:return F9(n,t);case Z.ZodBoolean:return U9();case Z.ZodDate:return Rk(n,t);case Z.ZodUndefined:return d5();case Z.ZodNull:return e5(t);case Z.ZodArray:return D9(n,t);case Z.ZodUnion:case Z.ZodDiscriminatedUnion:return t5(n,t);case Z.ZodIntersection:return G9(n,t);case Z.ZodTuple:return c5(n,t);case Z.ZodRecord:return Tk(n,t);case Z.ZodLiteral:return J9(n,t);case Z.ZodEnum:return q9(n);case Z.ZodNativeEnum:return Y9(n);case Z.ZodNullable:return n5(n,t);case Z.ZodOptional:return i5(n,t);case Z.ZodMap:return X9(n,t);case Z.ZodSet:return u5(n,t);case Z.ZodLazy:return Ve(n.getter()._def,t);case Z.ZodPromise:return l5(n,t);case Z.ZodNaN:case Z.ZodNever:return Q9();case Z.ZodEffects:return V9(n,t,r);case Z.ZodAny:return M9();case Z.ZodUnknown:return f5();case Z.ZodDefault:return W9(n,t);case Z.ZodBranded:return z9(n,t);case Z.ZodReadonly:return h5(n,t);case Z.ZodCatch:return B9(n,t);case Z.ZodPipeline:return o5(n,t);case Z.ZodFunction:case Z.ZodVoid:case Z.ZodSymbol:return;default:return(s=>{})()}},y5=(n,e,t)=>(n.description&&(t.description=n.description,e.markdownDescription&&(t.markdownDescription=n.description)),t),_5=(n,e)=>{const t=L9(e),r=typeof e=="string"?e:(e==null?void 0:e.nameStrategy)==="title"||e==null?void 0:e.name,s=Ve(n._def,r===void 0?t:{...t,currentPath:[...t.basePath,t.definitionPath,r]},!1)??{},a=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;a!==void 0&&(s.title=a);const l=(()=>{if(j9(t.definitions))return;const c={},f=new Set;for(let h=0;h<500;h++){const m=Object.entries(t.definitions).filter(([g])=>!f.has(g));if(m.length===0)break;for(const[g,y]of m)c[g]=Ve(wy(y),{...t,currentPath:[...t.basePath,t.definitionPath,g]},!0)??{},f.add(g)}return c})(),u=r===void 0?l?{...s,[t.definitionPath]:l}:s:t.nameStrategy==="duplicate-ref"?{...s,...l||t.seenRefs.size?{[t.definitionPath]:{...l,...t.seenRefs.size?{[r]:s}:void 0}}:void 0}:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,r].join("/"),[t.definitionPath]:{...l,[r]:s}};return t.target==="jsonSchema7"?u.$schema="http://json-schema.org/draft-07/schema#":t.target==="jsonSchema2019-09"&&(u.$schema="https://json-schema.org/draft/2019-09/schema#"),u};function w5(n,e){return _5(n,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function b5(n,e,t){return s9({type:"json_schema",json_schema:{...t,name:e,strict:!0,schema:w5(n,{name:e})}},r=>n.parse(JSON.parse(r)))}function v5(n){const{azureOpenAIApiDeploymentName:e,azureOpenAIApiInstanceName:t,azureOpenAIApiKey:r,azureOpenAIBasePath:s,baseURL:a,azureADTokenProvider:l,azureOpenAIEndpoint:u}=n;if((r||l)&&s&&e)return`${s}/${e}`;if((r||l)&&u&&e)return`${u}/openai/deployments/${e}`;if(r||l){if(!t)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${t}.openai.azure.com/openai/deployments/${e}`}return a}function fd(n,e){return n.lc_error_code=e,n.message=`${n.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,n}function Pg(n){let e;return n.constructor.name===jf.name?(e=new Error(n.message),e.name="TimeoutError"):n.constructor.name===Ln.name?(e=new Error(n.message),e.name="AbortError"):n.status===400&&n.message.includes("tool_calls")?e=fd(n,"INVALID_TOOL_RESULTS"):n.status===401?e=fd(n,"MODEL_AUTHENTICATION"):n.status===429?e=fd(n,"MODEL_RATE_LIMIT"):n.status===404?e=fd(n,"MODEL_NOT_FOUND"):e=n,e}function C1(n){if(n)return n==="any"||n==="required"?"required":n==="auto"?"auto":n==="none"?"none":typeof n=="string"?{type:"function",function:{name:n}}:n}function x5(n){return n.anyOf!==void 0&&Array.isArray(n.anyOf)}function S5(n){const e=["namespace functions {",""];for(const t of n)t.description&&e.push(`// ${t.description}`),Object.keys(t.parameters.properties??{}).length>0?(e.push(`type ${t.name} = (_: {`),e.push(Ak(t.parameters,0)),e.push("}) => any;")):e.push(`type ${t.name} = () => any;`),e.push("");return e.push("} // namespace functions"),e.join(`
`)}function Ak(n,e){var r;const t=[];for(const[s,a]of Object.entries(n.properties??{}))a.description&&e<2&&t.push(`// ${a.description}`),(r=n.required)!=null&&r.includes(s)?t.push(`${s}: ${ef(a,e)},`):t.push(`${s}?: ${ef(a,e)},`);return t.map(s=>" ".repeat(e)+s).join(`
`)}function ef(n,e){if(x5(n))return n.anyOf.map(t=>ef(t,e)).join(" | ");switch(n.type){case"string":return n.enum?n.enum.map(t=>`"${t}"`).join(" | "):"string";case"number":return n.enum?n.enum.map(t=>`${t}`).join(" | "):"number";case"integer":return n.enum?n.enum.map(t=>`${t}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",Ak(n,e+2),"}"].join(`
`);case"array":return n.items?`${ef(n.items,e)}[]`:"any[]";default:return""}}function E5(n,e){let t;return pP(n)?t=ay(n):t=n,(e==null?void 0:e.strict)!==void 0&&(t.function.strict=e.strict),t}function C5(n){return n.role!=="system"&&n.role!=="developer"&&n.role!=="assistant"&&n.role!=="user"&&n.role!=="function"&&n.role!=="tool"&&console.warn(`Unknown message role: ${n.role}`),n.role}function Sw(n){const e=n._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!xu.isInstance(n))throw new Error("Invalid generic chat message");return C5(n)}default:throw new Error(`Unknown message type: ${e}`)}}function P1(n,e){return n.flatMap(t=>{var a;let r=Sw(t);r==="system"&&Ew(e)&&(r="developer");const s={role:r,content:t.content};if(t.name!=null&&(s.name=t.name),t.additional_kwargs.function_call!=null&&(s.function_call=t.additional_kwargs.function_call,s.content=""),vu(t)&&((a=t.tool_calls)!=null&&a.length)?(s.tool_calls=t.tool_calls.map(A9),s.content=""):(t.additional_kwargs.tool_calls!=null&&(s.tool_calls=t.additional_kwargs.tool_calls),t.tool_call_id!=null&&(s.tool_call_id=t.tool_call_id)),t.additional_kwargs.audio&&typeof t.additional_kwargs.audio=="object"&&"id"in t.additional_kwargs.audio){const l={role:"assistant",audio:{id:t.additional_kwargs.audio.id}};return[s,l]}return s})}const qi="__openai_function_call_ids__";function k1(n,e){return n.flatMap(t=>{var a,l,u;let r=Sw(t);if(r==="system"&&Ew(e)&&(r="developer"),r==="function")throw new Error("Function messages are not supported in Responses API");if(r==="tool"){const c=t;return((a=c.additional_kwargs)==null?void 0:a.type)==="computer_call_output"?{type:"computer_call_output",output:(()=>{if(typeof c.content=="string")return{type:"computer_screenshot",image_url:c.content};if(Array.isArray(c.content)){const h=c.content.find(g=>g.type==="computer_screenshot");if(h)return h;const m=c.content.find(g=>g.type==="image_url");if(m)return{type:"computer_screenshot",image_url:typeof m.image_url=="string"?m.image_url:m.image_url.url}}throw new Error("Invalid computer call output")})(),call_id:c.tool_call_id}:{type:"function_call_output",call_id:c.tool_call_id,id:c.id,output:typeof c.content!="string"?JSON.stringify(c.content):c.content}}if(r==="assistant"){const c=[];t.additional_kwargs.reasoning!=null&&(y=>typeof y=="object"&&y!=null&&"type"in y&&y.type==="reasoning")(t.additional_kwargs.reasoning)&&c.push(t.additional_kwargs.reasoning);let{content:f}=t;t.additional_kwargs.refusal!=null&&(typeof f=="string"&&(f=[{type:"output_text",text:f,annotations:[]}]),f=[...f,{type:"refusal",refusal:t.additional_kwargs.refusal}]),c.push({type:"message",role:"assistant",content:typeof f=="string"?f:f.flatMap(g=>g.type==="text"?{type:"output_text",text:g.text,annotations:g.annotations??[]}:g.type==="output_text"||g.type==="refusal"?g:[])});const h=t.additional_kwargs[qi];vu(t)&&((l=t.tool_calls)!=null&&l.length)?c.push(...t.tool_calls.map(g=>({type:"function_call",name:g.name,arguments:JSON.stringify(g.args),call_id:g.id,id:h==null?void 0:h[g.id]}))):t.additional_kwargs.tool_calls!=null&&c.push(...t.additional_kwargs.tool_calls.map(g=>({type:"function_call",name:g.function.name,call_id:g.id,id:h==null?void 0:h[g.id],arguments:g.function.arguments})));const m=(u=t.response_metadata.output)!=null&&u.length?t.response_metadata.output:t.additional_kwargs.tool_outputs;if(m!=null){const g=m,y=g==null?void 0:g.filter(v=>v.type==="reasoning"),w=g==null?void 0:g.filter(v=>v.type==="computer_call");y.length>0&&w.length>0&&c.push(...y),w.length>0&&c.push(...w)}return c}const s=typeof t.content=="string"?t.content:t.content.flatMap(c=>{if(c.type==="text")return{type:"input_text",text:c.text};if(c.type==="image_url"){const f=typeof c.image_url=="string"?c.image_url:c.image_url.url,h=typeof c.image_url=="string"?"auto":c.image_url.detail;return{type:"input_image",image_url:f,detail:h}}return c.type==="input_text"||c.type==="input_image"||c.type==="input_file"?c:[]});return r==="user"||r==="system"||r==="developer"?{type:"message",role:r,content:s}:(console.warn(`Unsupported role found when converting to OpenAI Responses API: ${r}`),[])})}function $k(n){if(n.error){const l=new Error(n.error.message);throw l.name=n.error.code,l}const e=[],t=[],r=[],s={model:n.model,created_at:n.created_at,id:n.id,incomplete_details:n.incomplete_details,metadata:n.metadata,object:n.object,status:n.status,user:n.user,model_name:n.model},a={};for(const l of n.output)if(l.type==="message")e.push(...l.content.flatMap(u=>u.type==="output_text"?("parsed"in u&&u.parsed!=null&&(a.parsed=u.parsed),{type:"text",text:u.text,annotations:u.annotations}):u.type==="refusal"?(a.refusal=u.refusal,[]):u));else if(l.type==="function_call"){const u={function:{name:l.name,arguments:l.arguments},id:l.call_id};try{t.push(xw(u,{returnId:!0}))}catch(c){let f;typeof c=="object"&&c!=null&&"message"in c&&typeof c.message=="string"&&(f=c.message),r.push(Pk(u,f))}a[qi]??(a[qi]={}),l.id&&(a[qi][l.call_id]=l.id)}else l.type==="reasoning"?a.reasoning=l:(a.tool_outputs??(a.tool_outputs=[]),a.tool_outputs.push(l));return new Ka({id:n.id,content:e,tool_calls:t,invalid_tool_calls:r,usage_metadata:n.usage,additional_kwargs:a,response_metadata:s})}function P5(n){var c,f;const e=[];let t={},r;const s=[],a={},l={};let u;if(n.type==="response.output_text.delta")e.push({type:"text",text:n.delta,index:n.content_index});else if(n.type==="response.output_text.annotation.added")e.push({type:"text",text:"",annotations:[n.annotation],index:n.content_index});else if(n.type==="response.output_item.added"&&n.item.type==="message")u=n.item.id;else if(n.type==="response.output_item.added"&&n.item.type==="function_call")s.push({type:"tool_call_chunk",name:n.item.name,args:n.item.arguments,id:n.item.id,index:n.output_index}),l[qi]={[n.item.call_id]:n.item.id};else if(n.type==="response.output_item.done"&&(n.item.type==="web_search_call"||n.item.type==="file_search_call"||n.item.type==="computer_call"))l.tool_outputs=[n.item];else if(n.type==="response.created")a.id=n.response.id,a.model_name=n.response.model,a.model=n.response.model;else if(n.type==="response.completed"){const h=$k(n.response);r=n.response.usage,((f=(c=n.response.text)==null?void 0:c.format)==null?void 0:f.type)==="json_schema"&&(l.parsed??(l.parsed=JSON.parse(h.text)));for(const[m,g]of Object.entries(n.response))m!=="id"&&(a[m]=g)}else if(n.type==="response.function_call_arguments.delta")s.push({type:"tool_call_chunk",args:n.delta,index:n.output_index});else if(n.type==="response.web_search_call.completed"||n.type==="response.file_search_call.completed")t={tool_outputs:{id:n.item_id,type:n.type.replace("response.","").replace(".completed",""),status:"completed"}};else if(n.type==="response.refusal.done")l.refusal=n.refusal;else return null;return new Kr({text:e.map(h=>h.text).join(""),message:new Qr({id:u,content:e,tool_call_chunks:s,usage_metadata:r,additional_kwargs:l,response_metadata:a}),generationInfo:t})}function kg(n){return"type"in n&&n.type!=="function"}function k5(n){return n!=null&&typeof n=="object"&&"type"in n&&n.type!=="function"}function R1(n,e){return uP(n)?(e==null?void 0:e.strict)!==void 0?{...n,function:{...n.function,strict:e.strict}}:n:E5(n,e)}function Ew(n){return(n==null?void 0:n.startsWith("o1"))||(n==null?void 0:n.startsWith("o3"))||(n==null?void 0:n.startsWith("o4"))}class O1 extends Ss{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning_effort"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key"}}get lc_serializable_keys(){return["configuration","logprobs","topLogprobs","prefixMessages","supportsStrictToolCalling","modalities","audio","reasoningEffort","temperature","maxTokens","topP","frequencyPenalty","presencePenalty","n","logitBias","user","streaming","streamUsage","modelName","model","modelKwargs","stop","stopSequences","timeout","openAIApiKey","apiKey","cache","maxConcurrency","maxRetries","verbose","callbacks","tags","metadata","disableStreaming"]}constructor(e){var t,r;super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoningEffort",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"useResponsesApi",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.openAIApiKey=(e==null?void 0:e.apiKey)??(e==null?void 0:e.openAIApiKey)??((t=e==null?void 0:e.configuration)==null?void 0:t.apiKey)??Jr("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.organization=((r=e==null?void 0:e.configuration)==null?void 0:r.organization)??Jr("OPENAI_ORGANIZATION"),this.model=(e==null?void 0:e.model)??(e==null?void 0:e.modelName)??this.model,this.modelName=this.model,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.logprobs=e==null?void 0:e.logprobs,this.topLogprobs=e==null?void 0:e.topLogprobs,this.n=(e==null?void 0:e.n)??this.n,this.logitBias=e==null?void 0:e.logitBias,this.stop=(e==null?void 0:e.stopSequences)??(e==null?void 0:e.stop),this.stopSequences=this.stop,this.user=e==null?void 0:e.user,this.__includeRawResponse=e==null?void 0:e.__includeRawResponse,this.audio=e==null?void 0:e.audio,this.modalities=e==null?void 0:e.modalities,this.reasoningEffort=e==null?void 0:e.reasoningEffort,this.maxTokens=(e==null?void 0:e.maxCompletionTokens)??(e==null?void 0:e.maxTokens),this.useResponsesApi=(e==null?void 0:e.useResponsesApi)??this.useResponsesApi,this.disableStreaming=(e==null?void 0:e.disableStreaming)??this.disableStreaming,this.model==="o1"&&(this.disableStreaming=!0),this.streaming=(e==null?void 0:e.streaming)??!1,this.disableStreaming&&(this.streaming=!1),this.streamUsage=(e==null?void 0:e.streamUsage)??this.streamUsage,this.disableStreaming&&(this.streamUsage=!1),this.clientConfig={apiKey:this.apiKey,organization:this.organization,dangerouslyAllowBrowser:!0,...e==null?void 0:e.configuration},(e==null?void 0:e.supportsStrictToolCalling)!==void 0&&(this.supportsStrictToolCalling=e.supportsStrictToolCalling)}getLsParams(e){const t=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:t.temperature??void 0,ls_max_tokens:t.max_tokens??void 0,ls_stop:e.stop}}bindTools(e,t){let r;return(t==null?void 0:t.strict)!==void 0?r=t.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling),this.bind({tools:e.map(s=>kg(s)?s:R1(s,{strict:r})),...t})}createResponseFormat(e){return e&&e.type==="json_schema"&&e.json_schema.schema&&hd(e.json_schema.schema)?b5(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}invocationParams(e,t){var u,c;let r;if((e==null?void 0:e.strict)!==void 0?r=e.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling),this._useResponseApi(e)){const f={model:this.model,temperature:this.temperature,top_p:this.topP,user:this.user,stream:this.streaming,previous_response_id:e==null?void 0:e.previous_response_id,truncation:e==null?void 0:e.truncation,include:e==null?void 0:e.include,tools:(u=e==null?void 0:e.tools)!=null&&u.length?e.tools.map(m=>kg(m)?m:uP(m)?{type:"function",name:m.function.name,parameters:m.function.parameters,description:m.function.description,strict:r}:null).filter(m=>m!==null):void 0,tool_choice:k5(e==null?void 0:e.tool_choice)?e==null?void 0:e.tool_choice:(()=>{const m=C1(e==null?void 0:e.tool_choice);if(typeof m=="object"&&"type"in m)return{type:"function",name:m.function.name}})(),text:(()=>{if(e!=null&&e.text)return e.text;const m=this.createResponseFormat(e==null?void 0:e.response_format);return(m==null?void 0:m.type)==="json_schema"?m.json_schema.schema!=null?{format:{type:"json_schema",schema:m.json_schema.schema,description:m.json_schema.description,name:m.json_schema.name,strict:m.json_schema.strict}}:void 0:{format:m}})(),parallel_tool_calls:e==null?void 0:e.parallel_tool_calls,max_output_tokens:this.maxTokens===-1?void 0:this.maxTokens,...this.modelKwargs},h=(e==null?void 0:e.reasoning_effort)??this.reasoningEffort;return h!==void 0&&(f.reasoning={effort:h}),f}let s={};(e==null?void 0:e.stream_options)!==void 0?s={stream_options:e.stream_options}:this.streamUsage&&(this.streaming||t!=null&&t.streaming)&&(s={stream_options:{include_usage:!0}});const a={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(e==null?void 0:e.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:e==null?void 0:e.functions,function_call:e==null?void 0:e.function_call,tools:(c=e==null?void 0:e.tools)!=null&&c.length?e.tools.map(f=>R1(f,{strict:r})):void 0,tool_choice:C1(e==null?void 0:e.tool_choice),response_format:this.createResponseFormat(e==null?void 0:e.response_format),seed:e==null?void 0:e.seed,...s,parallel_tool_calls:e==null?void 0:e.parallel_tool_calls,...this.audio||e!=null&&e.audio?{audio:this.audio||(e==null?void 0:e.audio)}:{},...this.modalities||e!=null&&e.modalities?{modalities:this.modalities||(e==null?void 0:e.modalities)}:{},...this.modelKwargs};(e==null?void 0:e.prediction)!==void 0&&(a.prediction=e.prediction);const l=(e==null?void 0:e.reasoning_effort)??this.reasoningEffort;return l!==void 0&&(a.reasoning_effort=l),Ew(a.model)?a.max_completion_tokens=this.maxTokens===-1?void 0:this.maxTokens:a.max_tokens=this.maxTokens===-1?void 0:this.maxTokens,a}_convertOpenAIChatCompletionMessageToBaseMessage(e,t){const r=e.tool_calls;switch(e.role){case"assistant":{const s=[],a=[];for(const c of r??[])try{s.push(xw(c,{returnId:!0}))}catch(f){a.push(Pk(c,f.message))}const l={function_call:e.function_call,tool_calls:r};this.__includeRawResponse!==void 0&&(l.__raw_response=t);const u={model_name:t.model,...t.system_fingerprint?{usage:{...t.usage},system_fingerprint:t.system_fingerprint}:{}};return e.audio&&(l.audio=e.audio),new Ka({content:e.content||"",tool_calls:s,invalid_tool_calls:a,additional_kwargs:l,response_metadata:u,id:t.id})}default:return new xu(e.content||"",e.role??"unknown")}}_convertOpenAIDeltaToBaseMessageChunk(e,t,r){var c,f;const s=e.role??r,a=e.content??"";let l;e.function_call?l={function_call:e.function_call}:e.tool_calls?l={tool_calls:e.tool_calls}:l={},this.__includeRawResponse&&(l.__raw_response=t),e.audio&&(l.audio={...e.audio,index:t.choices[0].index});const u={usage:{...t.usage}};if(s==="user")return new Cf({content:a,response_metadata:u});if(s==="assistant"){const h=[];if(Array.isArray(e.tool_calls))for(const m of e.tool_calls)h.push({name:(c=m.function)==null?void 0:c.name,args:(f=m.function)==null?void 0:f.arguments,id:m.id,index:m.index,type:"tool_call_chunk"});return new Qr({content:a,tool_call_chunks:h,additional_kwargs:l,id:t.id,response_metadata:u})}else return s==="system"?new Vl({content:a,response_metadata:u}):s==="developer"?new Vl({content:a,response_metadata:u,additional_kwargs:{__openai_role__:"developer"}}):s==="function"?new Ef({content:a,additional_kwargs:l,name:e.name,response_metadata:u}):s==="tool"?new S_({content:a,additional_kwargs:l,tool_call_id:e.tool_call_id,response_metadata:u}):new Sf({content:a,role:s,response_metadata:u})}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(e,t,r){var f,h,m,g,y,w,v,x,E,P;if(this._useResponseApi(t)){const S=await this.responseApiWithRetry({...this.invocationParams(t,{streaming:!0}),input:k1(e,this.model),stream:!0},t);for await(const R of S){const $=P5(R);$!=null&&(yield $)}return}const s=P1(e,this.model),a={...this.invocationParams(t,{streaming:!0}),messages:s,stream:!0};let l;const u=await this.completionWithRetry(a,t);let c;for await(const S of u){const R=(f=S==null?void 0:S.choices)==null?void 0:f[0];if(S.usage&&(c=S.usage),!R)continue;const{delta:$}=R;if(!$)continue;const I=this._convertOpenAIDeltaToBaseMessageChunk($,S,l);l=$.role??l;const D={prompt:t.promptIndex??0,completion:R.index??0};if(typeof I.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const F={...D};R.finish_reason!=null&&(F.finish_reason=R.finish_reason,F.system_fingerprint=S.system_fingerprint,F.model_name=S.model),this.logprobs&&(F.logprobs=R.logprobs);const K=new Kr({message:I,text:I.content,generationInfo:F});yield K,await(r==null?void 0:r.handleLLMNewToken(K.text??"",D,void 0,void 0,void 0,{chunk:K}))}if(c){const S={...((h=c.prompt_tokens_details)==null?void 0:h.audio_tokens)!==null&&{audio:(m=c.prompt_tokens_details)==null?void 0:m.audio_tokens},...((g=c.prompt_tokens_details)==null?void 0:g.cached_tokens)!==null&&{cache_read:(y=c.prompt_tokens_details)==null?void 0:y.cached_tokens}},R={...((w=c.completion_tokens_details)==null?void 0:w.audio_tokens)!==null&&{audio:(v=c.completion_tokens_details)==null?void 0:v.audio_tokens},...((x=c.completion_tokens_details)==null?void 0:x.reasoning_tokens)!==null&&{reasoning:(E=c.completion_tokens_details)==null?void 0:E.reasoning_tokens}};yield new Kr({message:new Qr({content:"",response_metadata:{usage:{...c}},usage_metadata:{input_tokens:c.prompt_tokens,output_tokens:c.completion_tokens,total_tokens:c.total_tokens,...Object.keys(S).length>0&&{input_token_details:S},...Object.keys(R).length>0&&{output_token_details:R}}}),text:""})}if((P=t.signal)!=null&&P.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _responseApiGenerate(e,t,r){var u;const s=this.invocationParams(t);if(s.stream){const c=this._streamResponseChunks(e,t,r);let f;for await(const h of c)h.message.response_metadata={...h.generationInfo,...h.message.response_metadata},f=(f==null?void 0:f.concat(h))??h;return{generations:f?[f]:[],llmOutput:{estimatedTokenUsage:(u=f==null?void 0:f.message)==null?void 0:u.usage_metadata}}}const a=k1(e,this.model),l=await this.responseApiWithRetry({input:a,...s},{signal:t==null?void 0:t.signal,...t==null?void 0:t.options});return{generations:[{text:l.output_text,message:$k(l)}],llmOutput:{id:l.id,estimatedTokenUsage:l.usage?{promptTokens:l.usage.input_tokens,completionTokens:l.usage.output_tokens,totalTokens:l.usage.total_tokens}:void 0}}}_useResponseApi(e){var s;const t=(s=e==null?void 0:e.tools)==null?void 0:s.some(kg),r=(e==null?void 0:e.previous_response_id)!=null||(e==null?void 0:e.text)!=null||(e==null?void 0:e.truncation)!=null||(e==null?void 0:e.include)!=null;return this.useResponsesApi||t||r}async _generate(e,t,r){var u,c;if(this._useResponseApi(t))return this._responseApiGenerate(e,t,r);const s={},a=this.invocationParams(t),l=P1(e,this.model);if(a.stream){const f=this._streamResponseChunks(e,t,r),h={};for await(const x of f){x.message.response_metadata={...x.generationInfo,...x.message.response_metadata};const E=((u=x.generationInfo)==null?void 0:u.completion)??0;h[E]===void 0?h[E]=x:h[E]=h[E].concat(x)}const m=Object.entries(h).sort(([x],[E])=>parseInt(x,10)-parseInt(E,10)).map(([x,E])=>E),{functions:g,function_call:y}=this.invocationParams(t),w=await this.getEstimatedTokenCountFromPrompt(e,g,y),v=await this.getNumTokensFromGenerations(m);return s.input_tokens=w,s.output_tokens=v,s.total_tokens=w+v,{generations:m,llmOutput:{estimatedTokenUsage:{promptTokens:s.input_tokens,completionTokens:s.output_tokens,totalTokens:s.total_tokens}}}}else{let f;t.response_format&&t.response_format.type==="json_schema"?f=await this.betaParsedCompletionWithRetry({...a,stream:!1,messages:l},{signal:t==null?void 0:t.signal,...t==null?void 0:t.options}):f=await this.completionWithRetry({...a,stream:!1,messages:l},{signal:t==null?void 0:t.signal,...t==null?void 0:t.options});const{completion_tokens:h,prompt_tokens:m,total_tokens:g,prompt_tokens_details:y,completion_tokens_details:w}=(f==null?void 0:f.usage)??{};h&&(s.output_tokens=(s.output_tokens??0)+h),m&&(s.input_tokens=(s.input_tokens??0)+m),g&&(s.total_tokens=(s.total_tokens??0)+g),((y==null?void 0:y.audio_tokens)!==null||(y==null?void 0:y.cached_tokens)!==null)&&(s.input_token_details={...(y==null?void 0:y.audio_tokens)!==null&&{audio:y==null?void 0:y.audio_tokens},...(y==null?void 0:y.cached_tokens)!==null&&{cache_read:y==null?void 0:y.cached_tokens}}),((w==null?void 0:w.audio_tokens)!==null||(w==null?void 0:w.reasoning_tokens)!==null)&&(s.output_token_details={...(w==null?void 0:w.audio_tokens)!==null&&{audio:w==null?void 0:w.audio_tokens},...(w==null?void 0:w.reasoning_tokens)!==null&&{reasoning:w==null?void 0:w.reasoning_tokens}});const v=[];for(const x of(f==null?void 0:f.choices)??[]){const P={text:((c=x.message)==null?void 0:c.content)??"",message:this._convertOpenAIChatCompletionMessageToBaseMessage(x.message??{role:"assistant"},f)};P.generationInfo={...x.finish_reason?{finish_reason:x.finish_reason}:{},...x.logprobs?{logprobs:x.logprobs}:{}},vu(P.message)&&(P.message.usage_metadata=s),P.message=new Ka(Object.fromEntries(Object.entries(P.message).filter(([S])=>!S.startsWith("lc_")))),v.push(P)}return{generations:v,llmOutput:{tokenUsage:{promptTokens:s.input_tokens,completionTokens:s.output_tokens,totalTokens:s.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(e,t,r){let s=(await this.getNumTokensFromMessages(e)).totalCount;if(t&&r!=="auto"){const a=S5(t);s+=await this.getNumTokens(a),s+=9}return t&&e.find(a=>a._getType()==="system")&&(s-=4),r==="none"?s+=1:typeof r=="object"&&(s+=await this.getNumTokens(r.name)+4),s}async getNumTokensFromGenerations(e){return(await Promise.all(e.map(async r=>{var s;return(s=r.message.additional_kwargs)!=null&&s.function_call?(await this.getNumTokensFromMessages([r.message])).countPerMessage[0]:await this.getNumTokens(r.message.content)}))).reduce((r,s)=>r+s,0)}async getNumTokensFromMessages(e){let t=0,r=0,s=0;this.model==="gpt-3.5-turbo-0301"?(r=4,s=-1):(r=3,s=1);const a=await Promise.all(e.map(async l=>{var g,y,w,v,x,E;const u=await this.getNumTokens(l.content),c=await this.getNumTokens(Sw(l)),f=l.name!==void 0?s+await this.getNumTokens(l.name):0;let h=u+r+c+f;const m=l;if(m._getType()==="function"&&(h-=2),(g=m.additional_kwargs)!=null&&g.function_call&&(h+=3),(y=m==null?void 0:m.additional_kwargs.function_call)!=null&&y.name&&(h+=await this.getNumTokens((w=m.additional_kwargs.function_call)==null?void 0:w.name)),(v=m.additional_kwargs.function_call)!=null&&v.arguments)try{h+=await this.getNumTokens(JSON.stringify(JSON.parse((x=m.additional_kwargs.function_call)==null?void 0:x.arguments)))}catch(P){console.error("Error parsing function arguments",P,JSON.stringify(m.additional_kwargs.function_call)),h+=await this.getNumTokens((E=m.additional_kwargs.function_call)==null?void 0:E.arguments)}return t+=h,h}));return t+=3,{totalCount:t,countPerMessage:a}}async completionWithRetry(e,t){const r=this._getClientOptions(t);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(e,r)}catch(s){throw Pg(s)}})}async responseApiWithRetry(e,t){return this.caller.call(async()=>{var s,a;const r=this._getClientOptions(t);try{return((a=(s=e.text)==null?void 0:s.format)==null?void 0:a.type)==="json_schema"&&!e.stream?await this.client.responses.parse(e,r):await this.client.responses.create(e,r)}catch(l){throw Pg(l)}})}async betaParsedCompletionWithRetry(e,t){const r=this._getClientOptions(t);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(e,r)}catch(s){throw Pg(s)}})}_getClientOptions(e){if(!this.client){const r={baseURL:this.clientConfig.baseURL},s=v5(r),a={...this.clientConfig,baseURL:s,timeout:this.timeout,maxRetries:0};a.baseURL||delete a.baseURL,this.client=new Ne(a)}return{...this.clientConfig,...e}}_llmType(){return"openai"}_combineLLMOutput(...e){return e.reduce((t,r)=>(r&&r.tokenUsage&&(t.tokenUsage.completionTokens+=r.tokenUsage.completionTokens??0,t.tokenUsage.promptTokens+=r.tokenUsage.promptTokens??0,t.tokenUsage.totalTokens+=r.tokenUsage.totalTokens??0),t),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(e,t){let r,s,a,l;R5(e)?(r=e.schema,s=e.name,a=e.method,l=e.includeRaw):(r=e,s=t==null?void 0:t.name,a=t==null?void 0:t.method,l=t==null?void 0:t.includeRaw);let u,c;if((t==null?void 0:t.strict)!==void 0&&a==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(!this.model.startsWith("gpt-3")&&!this.model.startsWith("gpt-4-")&&this.model!=="gpt-4"?a===void 0&&(a="jsonSchema"):a==="jsonSchema"&&console.warn(`[WARNING]: JSON Schema is not supported for model "${this.model}". Falling back to tool calling.`),a==="jsonMode")u=this.bind({response_format:{type:"json_object"}}),hd(r)?c=w1.fromZodSchema(r):c=new b1;else if(a==="jsonSchema")if(u=this.bind({response_format:{type:"json_schema",json_schema:{name:s??"extract",description:r.description,schema:r,strict:t==null?void 0:t.strict}}}),hd(r)){const g=w1.fromZodSchema(r);c=So.from(y=>"parsed"in y.additional_kwargs?y.additional_kwargs.parsed:g)}else c=new b1;else{let g=s??"extract";if(hd(r)){const y=ku(r);u=this.bind({tools:[{type:"function",function:{name:g,description:y.description,parameters:y}}],tool_choice:{type:"function",function:{name:g}},...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}),c=new v1({returnSingle:!0,keyName:g,zodSchema:r})}else{let y;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(y=r,g=r.name):(g=r.title??g,y={name:g,description:r.description??"",parameters:r}),u=this.bind({tools:[{type:"function",function:y}],tool_choice:{type:"function",function:{name:g}},...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}),c=new v1({returnSingle:!0,keyName:g})}}if(!l)return u.pipe(c);const f=Gd.assign({parsed:(g,y)=>c.invoke(g.raw,y)}),h=Gd.assign({parsed:()=>null}),m=f.withFallbacks({fallbacks:[h]});return Cs.from([{raw:u},m])}}function hd(n){return typeof(n==null?void 0:n.parse)=="function"}function R5(n){return n!==void 0&&typeof n.schema=="object"}const O5=({chapters:n,onChapterChange:e,onSceneChange:t})=>O.jsxs(ke,{children:[O.jsx(Es,{order:4,mb:"xs",children:"本文"}),O.jsx(Ad,{gap:"lg",children:n.map((r,s)=>O.jsxs(ke,{p:"md",bd:"1px solid gray",style:{borderRadius:"4px"},children:[O.jsxs(Es,{order:5,mb:"sm",children:["第",r.number,"章"]}),O.jsx(wr,{label:"章タイトル",value:r.title,onChange:a=>e(s,"title",a.currentTarget.value),mb:"md"}),O.jsx(Es,{order:6,mb:"xs",children:"シーン"}),O.jsx(Ad,{gap:"md",children:r.scenes.map((a,l)=>O.jsxs(ke,{p:"sm",bd:"1px solid gray",style:{borderRadius:"4px"},children:[O.jsxs(Es,{order:6,mb:"xs",children:["シーン ",a.number]}),O.jsx(Gr,{value:a.content,onChange:u=>t(s,l,"content",u.currentTarget.value),autosize:!0,minRows:5,mb:"xs"})]},a.number))})]},r.number))})]}),T5=({characters:n,onChange:e})=>O.jsxs("div",{children:[O.jsx(Es,{order:4,mb:"xs",children:"登場人物"}),O.jsx(yt,{variant:"separated",children:n.map((t,r)=>O.jsxs(yt.Item,{value:`char-${t.number}`,children:[O.jsxs(yt.Control,{children:["#",t.number," ",t.name," (",t.role,")"]}),O.jsxs(yt.Panel,{children:[O.jsx(wr,{label:"役割",value:t.role,onChange:s=>e(r,"role",s.currentTarget.value),mb:"xs"}),O.jsx(wr,{label:"名前",value:t.name,onChange:s=>e(r,"name",s.currentTarget.value),mb:"xs"}),O.jsx(wr,{label:"年齢",value:String(t.age),onChange:s=>e(r,"age",s.currentTarget.value),mb:"xs"}),O.jsx(wr,{label:"性別",value:t.sex,onChange:s=>e(r,"sex",s.currentTarget.value),mb:"xs"}),O.jsx(Gr,{label:"外見",value:t.appearance,onChange:s=>e(r,"appearance",s.currentTarget.value),autosize:!0,minRows:2,mb:"xs"}),O.jsx(Gr,{label:"性格",value:t.personality,onChange:s=>e(r,"personality",s.currentTarget.value),autosize:!0,minRows:2,mb:"xs"}),O.jsx(Gr,{label:"能力",value:t.ability,onChange:s=>e(r,"ability",s.currentTarget.value),autosize:!0,minRows:2,mb:"md"})]})]},t.number))})]}),A5=({settings:n,onChange:e})=>O.jsx(yt,{defaultValue:"settings",children:O.jsxs(yt.Item,{value:"settings",children:[O.jsx(yt.Control,{children:"設定"}),O.jsxs(yt.Panel,{children:[O.jsx(wr,{label:"テーマ",value:n.theme,onChange:t=>e("theme",t.currentTarget.value),mb:"xs"}),O.jsx(wr,{label:"ジャンル",value:n.genre,onChange:t=>e("genre",t.currentTarget.value),mb:"xs"}),O.jsx(wr,{label:"時代",value:n.era,onChange:t=>e("era",t.currentTarget.value),mb:"xs"}),O.jsx(wr,{label:"舞台",value:n.stage,onChange:t=>e("stage",t.currentTarget.value),mb:"xs"}),O.jsx(Gr,{label:"ルール",value:n.rules,onChange:t=>e("rules",t.currentTarget.value),autosize:!0,minRows:2,mb:"md"})]})]})}),$5=({config:n,onChange:e})=>O.jsx(yt,{defaultValue:"prompt-config",mb:"md",children:O.jsxs(yt.Item,{value:"prompt-config",children:[O.jsx(yt.Control,{children:"プロンプト設定"}),O.jsxs(yt.Panel,{children:[O.jsx(Gr,{label:"エージェントペルソナ",value:n.persona,onChange:t=>e("persona",t.currentTarget.value),autosize:!0,minRows:2,mb:"xs"}),O.jsx(Gr,{label:"エージェント目標",value:n.goal,onChange:t=>e("goal",t.currentTarget.value),autosize:!0,minRows:3,mb:"xs"})]})]})});function I5(n,e){const t=structuredClone(n);return e.forEach(r=>{var s;switch(r.type){case"update_setting":t.settings[r.field]=r.value;break;case"update_character_field":{const a=t.characters[r.index];a&&(a[r.field]=r.value);break}case"add_character":t.characters.push(r.character);break;case"add_chapter":t.chapters.push(r.chapter);break;case"add_scene":{const a=t.chapters[r.chapterIndex];a&&a.scenes.push(r.scene);break}case"update_scene_content":{const a=(s=t.chapters[r.chapterIndex])==null?void 0:s.scenes[r.sceneIndex];a&&(a[r.field]=r.value);break}}}),t}function N5(n){const e=n.replace(/<think>[\s\S]*?<\/think>/,"").trim(),t=e.indexOf("{"),r=e.lastIndexOf("}");return t===-1||r===-1?null:e.slice(t,r+1)}const j5=Se.enum(["theme","genre","era","stage","rules"]).describe("Updatable setting fields"),L5=Se.enum(["role","name","age","sex","appearance","personality","ability"]).describe("Updatable character attributes"),M5=Se.enum(["content"]).describe("Updatable scene attributes"),D5=Se.object({type:Se.literal("update_setting").describe("Operation type: Update setting"),field:j5.describe("Name of the setting field to update"),value:Se.string().describe("New value for the setting field")}).describe("Operation to update a novel setting field"),F5=Se.object({type:Se.literal("update_character_field").describe("Operation type: Update character attribute"),index:Se.number().int().describe("0-based index of the character to update"),field:L5.describe("Name of the character attribute to update"),value:Se.union([Se.string(),Se.number()]).describe("New value for the character attribute (age can be number)")}).describe("Operation to update a specific attribute of an existing character"),U5=Se.object({number:Se.number().int().describe("Character number (starting from 1)"),role:Se.string().describe("Role of the character (e.g., protagonist, heroine)"),name:Se.string().describe("Name of the character"),age:Se.union([Se.number(),Se.string()]).describe("Age of the character (number or string)"),sex:Se.string().describe("Sex of the character"),appearance:Se.string().describe("Description of the character's appearance"),personality:Se.string().describe("Description of the character's personality"),ability:Se.string().describe("Character's abilities or special skills")}).describe("Definition of a character appearing in the novel"),z5=Se.object({type:Se.literal("add_character").describe("Operation type: Add character"),character:U5.describe("Detailed information of the character to add")}).describe("Operation to add a new character to the novel"),Ik=Se.object({number:Se.number().int().describe("Scene number (starting from 1 within the chapter)"),content:Se.string().describe("Content/body of the scene")}).describe("Definition of an individual scene composing a chapter"),B5=Se.object({number:Se.number().int().describe("Chapter number (starting from 1)"),title:Se.string().describe("Title of the chapter"),scenes:Se.array(Ik).describe("List of scenes included in the chapter")}).describe("Definition of a novel chapter"),H5=Se.object({type:Se.literal("add_chapter").describe("Operation type: Add chapter"),chapter:B5.describe("Detailed information of the chapter to add")}).describe("Operation to add a new chapter to the novel"),W5=Se.object({type:Se.literal("add_scene").describe("Operation type: Add scene"),chapterIndex:Se.number().int().describe("0-based index of the chapter to add the scene to"),scene:Ik.describe("Detailed information of the scene to add")}).describe("Operation to add a new scene to an existing chapter"),V5=Se.object({type:Se.literal("update_scene_content").describe("Operation type: Update scene content"),chapterIndex:Se.number().int().describe("0-based index of the chapter containing the scene to update"),sceneIndex:Se.number().int().describe("0-based index of the scene to update"),field:M5.describe("Name of the scene attribute to update (currently only 'content')"),value:Se.string().describe("New value for the scene content")}).describe("Operation to update the content of an existing scene"),q5=Se.union([D5,F5,z5,H5,W5,V5]).describe("One of the possible operation objects to modify the novel state"),Z5=Se.object({reply:Se.string().describe("Reply message to the user (in Japanese)"),operations:Se.array(q5).describe("List of operations to execute (empty array if no changes)")}).describe("Overall structure of the JSON response generated by the agent"),G5={persona:"あなたは小説の共同執筆エージェントです。",goal:"ユーザーの指示を理解し、現在のプロジェクト状態を更新しながら魅力的な物語コンテンツを生成してください。"},J5=()=>{const[n,e]=k.useState(()=>localStorage.getItem("apiProvider")==="openai"?"openai":"ollama"),[t,r]=k.useState(()=>localStorage.getItem("openaiModelName")||"gpt-4o"),[s,a]=k.useState(()=>localStorage.getItem("selectedModel")||""),[l,u]=k.useState([]),[c,f]=k.useState({settings:{theme:"AIによる管理社会と人間の自由",genre:"SF・ディストピア・サスペンス",era:"近未来（西暦2093年）",stage:"メガシティ・ネオトウキョウ",rules:"市民は全てAIによって監視・管理され、自由意志を持つことが許されない。人間の意思決定は『ガイダンスAI』によって最適化される。"},characters:[{number:1,role:"主人公",name:"天城 レン",age:24,sex:"男",appearance:"黒髪の短髪、鋭い目つき、細身の体型",personality:"冷静沈着だが、内心は自由を求める強い意志を持つ",ability:"高度なハッキングスキルと電子機器の扱いに長けている"},{number:2,role:"ヒロイン",name:"ユナ・アンドロイド No.107",age:20,sex:"女",appearance:"銀髪に琥珀色の瞳、アンドロイドらしからぬ表情豊かな顔",personality:"好奇心旺盛で、感情を持つことに興味を抱いている",ability:"高度な分析能力と戦闘スキルを搭載"}],chapters:[]}),[h,m]=k.useState(G5),[g,y]=k.useState(""),[w,v]=k.useState([]),[x,E]=k.useState(""),[P,S]=k.useState(!1),[R,$]=k.useState(!1),I=k.useRef(null);k.useEffect(()=>{(async()=>{if(n!=="ollama"){v([]),a(""),$(!1);return}$(!0),v([]),a("");try{const M=await fetch("http://localhost:11434/api/tags");if(!M.ok)console.warn(`Ollama fetch failed: ${M.status}`),v([]),a("");else{const ae=(await M.json()).models.map(Q=>Q.name);v(ae),ae.length>0?a(ae[0]):(console.warn("No Ollama models found."),a(""))}}catch(M){console.error("Failed to fetch Ollama models:",M),v([]),a("")}finally{$(!1)}})()},[n]),k.useEffect(()=>{localStorage.setItem("apiProvider",n)},[n]),k.useEffect(()=>{localStorage.setItem("selectedModel",s)},[s]),k.useEffect(()=>{localStorage.setItem("openaiModelName",t)},[t]);const D=k.useCallback((T,M)=>{f(X=>({...X,settings:{...X.settings,[T]:M}}))},[]),F=k.useCallback((T,M)=>{m(X=>({...X,[T]:M}))},[]),K=k.useCallback((T,M,X)=>{f(ae=>{const Q=[...ae.characters];return Q[T]&&(Q[T][M]=X),{...ae,characters:Q}})},[]),Y=k.useCallback((T,M,X)=>{f(ae=>{const Q=[...ae.chapters];return Q[T]&&(Q[T][M]=X),{...ae,chapters:Q}})},[]),ie=k.useCallback((T,M,X,ae)=>{f(Q=>{const le=[...Q.chapters],Re=le[T];return Re&&Re.scenes[M]&&(Re.scenes[M][X]=ae),{...Q,chapters:le}})},[]),de=k.useCallback(()=>{const M=JSON.stringify({promptConfig:h,novel:c},null,2),X=new Blob([M],{type:"application/json"}),ae=URL.createObjectURL(X),Q=document.createElement("a");Q.href=ae,Q.download="novel-project.json",document.body.appendChild(Q),Q.click(),document.body.removeChild(Q),URL.revokeObjectURL(ae)},[c,h]),ue=k.useCallback(()=>{const T=c.chapters.map(Q=>`# Chapter ${Q.number}: ${Q.title}

`+Q.scenes.map(le=>`## Scene ${le.number}

${le.content}`).join(`

`)).join(`

`),M=new Blob([T],{type:"text/markdown"}),X=URL.createObjectURL(M),ae=document.createElement("a");ae.href=X,ae.download="novel.md",document.body.appendChild(ae),ae.click(),document.body.removeChild(ae),URL.revokeObjectURL(X)},[c]),V=k.useCallback(T=>{if(!T)return;const M=new FileReader;M.onload=X=>{var ae;try{const Q=(ae=X.target)==null?void 0:ae.result,le=JSON.parse(Q);if(le&&typeof le=="object"&&"promptConfig"in le&&"novel"in le&&"settings"in le.novel&&"characters"in le.novel&&"chapters"in le.novel&&typeof le.promptConfig.persona=="string"&&typeof le.promptConfig.goal=="string")m(le.promptConfig),f(le.novel),u([]),alert("プロジェクトをインポートしました。");else throw new Error("Invalid or unrecognized project file structure.")}catch(Q){console.error("Failed to import project:",Q),alert(`ファイルのインポートに失敗しました。
Error: ${Q instanceof Error?Q.message:String(Q)}`)}},M.onerror=X=>{console.error("Error reading file:",X),alert("ファイルの読み込みに失敗しました。")},M.readAsText(T)},[]),G=k.useCallback(async()=>{var Ee;const T=x.trim();let M=null;if(n==="ollama"){if(!s){alert("Ollamaモデルを選択してください。");return}M=new JS({model:s})}else if(n==="openai"){if(!g){alert("OpenAI APIキーを入力してください。");return}if(!t.trim()){alert("OpenAIモデル名を入力してください。");return}M=new O1({apiKey:g,modelName:t.trim()})}if(!T||!M)return;u(be=>[...be,{role:"user",content:T}]),E(""),S(!0);const{persona:X,goal:ae}=h,Q=`${X}

# Goal
${ae}

# Output Format
必ず JSON 形式のみを出力してください。構造は以下です。
\`\`\`json
{
  "reply": "ユーザーに返す日本語メッセージ。具体的な内容はoperationsに出力するため、概要を出力。",
  "operations": [ /* 状態を変更する命令。不要なら [] */ ]
}
\`\`\`

# Permitted operation objects
- update_setting: { "type": "update_setting", "field": "theme|genre|era|stage|rules", "value": "..." }
- update_character_field: { "type": "update_character_field", "index": 0-based, "field": "role|name|age|sex|appearance|personality|ability", "value": "..." }
- add_character: { "type": "add_character", "character": { "number": number, "role": string, "name": string, "age": number or string, "sex": string, "appearance": string, "personality": string, "ability": string } }
- add_chapter: { "type": "add_chapter", "chapter": { "number": number, "title": string, "scenes": { "number": number, "content": string }[] }
- add_scene: { "type": "add_scene", "chapterIndex": 0-based, "scene": { "number": number, "content": string } }
- update_scene_content: { "type": "update_scene_content", "chapterIndex": 0-based, "sceneIndex": 0-based, "field": "content", "value": "..." }

# Strict rules
- JSON 以外を絶対に出力しないこと。
- "reply" の改行は \\n でエスケープ。
- <think></think> タグ内で自由に思考して良いが、タグの外には JSON のみを出力すること。
- **"operations" 配列には、必ず # Permitted operation objects で定義された type のオブジェクトのみを含めること。それ以外の type を持つオブジェクトは絶対に使用しないこと。**
- **ユーザーが「第X章」「Y番目のキャラクター」「Z番目のシーン」のように1から始まる番号で指示した場合でも、JSON内の \`index\` や \`chapterIndex\`, \`sceneIndex\` は必ず0から始まる番号に変換して出力すること。例えば、ユーザーが「第1章のシーン3」について言及した場合、\`chapterIndex\` は \`0\`、\`sceneIndex\` は \`2\` となります。**`,le=[new Hg(Q)];l.slice(-8).forEach(be=>{be.role==="user"?le.push(new to(be.content)):le.push(new Ka(be.content))}),le.push(new to(`${T}

# 現在の小説状態
${JSON.stringify(c,null,2)}`));try{let be;if(n==="openai"&&M instanceof O1)be=await M.withStructuredOutput(Z5).invoke(le);else if(n==="ollama"&&M instanceof JS){let je="";for await(const qt of await M.stream(le))je+=qt.content;const ct=N5(je);if(!ct)throw new Error("JSON payload not found in Ollama response");be=JSON.parse(ct)}else throw new Error("Invalid API provider or model instance.");(Ee=be.operations)!=null&&Ee.length&&f(je=>I5(je,be.operations)),u(je=>[...je,{role:"assistant",content:be.reply}])}catch(be){console.error(be);const je=be instanceof Error?be.message:"Unknown error occurred";be instanceof Se.ZodError?u(ct=>[...ct,{role:"assistant",content:`⚠️ モデルの応答形式が無効です:
${be.errors.map(qt=>`${qt.path.join(".")} - ${qt.message}`).join(`
`)}`}]):u(ct=>[...ct,{role:"assistant",content:`⚠️ 返答の処理中にエラーが発生しました: ${je}`}])}finally{S(!1)}},[x,l,c,h,n,s,g,t]),q=k.useCallback(T=>{const M=!P&&x.trim()&&(n==="ollama"?!!s:!!g&&!!t.trim());(T.ctrlKey||T.metaKey)&&T.key==="Enter"&&M&&(T.preventDefault(),G())},[G,P,x,n,s,g,t]),J=(T,M)=>O.jsx(Kn,{align:T.role==="user"?"flex-end":"flex-start",bg:T.role==="user"?"blue.6":"gray.7",c:"white",children:O.jsx(t_,{size:"sm",children:T.content})},M),j=P||!x.trim()||n==="ollama"&&(!s||R)||n==="openai"&&(!g||!t),B=P||n==="ollama"&&(!s||R)||n==="openai"&&(!g||!t),W=n==="ollama"?R?"Ollamaモデルを読み込み中...":s?"メッセージを入力...":"Ollamaモデルを選択してください":g?t?"メッセージを入力...":"OpenAIモデルを選択してください":"OpenAI APIキーを入力してください";return O.jsxs(Kn,{direction:"row",gap:"md",p:"md",w:"100%",h:"100vh",bg:"dark.8",children:[O.jsxs(Kn,{direction:"column",w:"60%",h:"100%",children:[O.jsxs(Kn,{justify:"space-between",align:"center",mb:"xs",gap:"xs",children:[O.jsx(Es,{order:2,c:"gray.2",children:"Novel Agent"}),O.jsxs(Kn,{gap:"md",children:[O.jsx($l,{data:[{value:"ollama",label:"Ollama"},{value:"openai",label:"OpenAI"}],value:n,onChange:T=>e(T),disabled:P,allowDeselect:!1,w:120}),n==="ollama"?O.jsx($l,{placeholder:R?"Loading models...":"Choose Ollama model",data:w,value:s,onChange:T=>a(T||""),disabled:P||R||w.length===0,allowDeselect:!1,w:200,searchable:!0}):O.jsx($l,{placeholder:"Choose OpenAI model",data:["gpt-4o","gpt-4.1","o4-mini"],value:t,onChange:T=>r(T||""),disabled:P,allowDeselect:!1,w:200})]})]}),n==="openai"&&O.jsx(g_,{placeholder:"Enter OpenAI API Key",value:g,onChange:T=>y(T.currentTarget.value),disabled:P,mb:"xs"}),O.jsx(qa,{style:{flex:1},offsetScrollbars:!0,children:O.jsxs(Kn,{direction:"column",gap:"xs",p:"xs",children:[l.map(J),P&&O.jsx(Kn,{align:"flex-start",children:O.jsx(Ga,{size:"sm"})})]})}),O.jsxs(Kn,{mt:"xs",gap:"xs",children:[O.jsx(Gr,{placeholder:W,value:x,onChange:T=>E(T.currentTarget.value),onKeyDown:q,autosize:!0,minRows:1,maxRows:4,style:{flex:1},disabled:B}),O.jsx(ia,{onClick:G,disabled:j,w:100,children:P?O.jsx(Ga,{color:"white",size:"sm"}):"送信"})]})]}),O.jsxs(_f,{shadow:"sm",p:"md",pr:"sm",radius:"md",withBorder:!0,w:"40%",children:[O.jsxs(Kn,{justify:"space-between",align:"center",mb:"md",children:[O.jsx(Es,{order:3,children:"現在のプロジェクト"}),O.jsxs(Kn,{align:"center",gap:"xs",children:[O.jsx(LN,{ref:I,onChange:V,accept:"application/json",style:{display:"none"}}),O.jsx(ia,{variant:"outline",size:"xs",onClick:()=>{var T;return(T=I.current)==null?void 0:T.click()},disabled:P,children:"Import"}),O.jsx(ia,{variant:"outline",size:"xs",onClick:de,disabled:P,children:"Export"}),O.jsx(ia,{variant:"outline",size:"xs",onClick:ue,disabled:P,children:"Markdown"})]})]}),O.jsxs(qa,{h:"calc(100vh - 100px)",offsetScrollbars:!0,children:[" ",O.jsx($5,{config:h,onChange:F}),O.jsx(A5,{settings:c.settings,onChange:D}),O.jsx(T5,{characters:c.characters,onChange:K}),O.jsx(O5,{chapters:c.chapters,onChapterChange:Y,onSceneChange:ie})]})]})]})};function K5(){return O.jsx(PL,{children:O.jsx(nL,{children:O.jsx(wC,{path:"/",element:O.jsx(J5,{})})})})}function X5(){return O.jsx(G1,{defaultColorScheme:"dark",children:O.jsx(K5,{})})}FO.createRoot(document.getElementById("root")).render(O.jsx(k.StrictMode,{children:O.jsx(X5,{})}));
