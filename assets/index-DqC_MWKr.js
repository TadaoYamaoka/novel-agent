var TO=Object.defineProperty;var AO=(n,e,t)=>e in n?TO(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ea=(n,e,t)=>AO(n,typeof e!="symbol"?e+"":e,t);function $O(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function ti(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var jp={exports:{}},hl={},Lp={exports:{}},Be={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l0;function IO(){if(l0)return Be;l0=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),m=Symbol.iterator;function g($){return $===null||typeof $!="object"?null:($=m&&$[m]||$["@@iterator"],typeof $=="function"?$:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,v={};function x($,U,re){this.props=$,this.context=U,this.refs=v,this.updater=re||y}x.prototype.isReactComponent={},x.prototype.setState=function($,U){if(typeof $!="object"&&typeof $!="function"&&$!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,$,U,"setState")},x.prototype.forceUpdate=function($){this.updater.enqueueForceUpdate(this,$,"forceUpdate")};function E(){}E.prototype=x.prototype;function k($,U,re){this.props=$,this.context=U,this.refs=v,this.updater=re||y}var S=k.prototype=new E;S.constructor=k,w(S,x.prototype),S.isPureReactComponent=!0;var R=Array.isArray,A=Object.prototype.hasOwnProperty,I={current:null},M={key:!0,ref:!0,__self:!0,__source:!0};function D($,U,re){var pe,de={},Y=null,oe=null;if(U!=null)for(pe in U.ref!==void 0&&(oe=U.ref),U.key!==void 0&&(Y=""+U.key),U)A.call(U,pe)&&!M.hasOwnProperty(pe)&&(de[pe]=U[pe]);var ue=arguments.length-2;if(ue===1)de.children=re;else if(1<ue){for(var ge=Array(ue),_e=0;_e<ue;_e++)ge[_e]=arguments[_e+2];de.children=ge}if($&&$.defaultProps)for(pe in ue=$.defaultProps,ue)de[pe]===void 0&&(de[pe]=ue[pe]);return{$$typeof:n,type:$,key:Y,ref:oe,props:de,_owner:I.current}}function K($,U){return{$$typeof:n,type:$.type,key:U,ref:$.ref,props:$.props,_owner:$._owner}}function X($){return typeof $=="object"&&$!==null&&$.$$typeof===n}function ae($){var U={"=":"=0",":":"=2"};return"$"+$.replace(/[=:]/g,function(re){return U[re]})}var he=/\/+/g;function ce($,U){return typeof $=="object"&&$!==null&&$.key!=null?ae(""+$.key):U.toString(36)}function W($,U,re,pe,de){var Y=typeof $;(Y==="undefined"||Y==="boolean")&&($=null);var oe=!1;if($===null)oe=!0;else switch(Y){case"string":case"number":oe=!0;break;case"object":switch($.$$typeof){case n:case e:oe=!0}}if(oe)return oe=$,de=de(oe),$=pe===""?"."+ce(oe,0):pe,R(de)?(re="",$!=null&&(re=$.replace(he,"$&/")+"/"),W(de,U,re,"",function(_e){return _e})):de!=null&&(X(de)&&(de=K(de,re+(!de.key||oe&&oe.key===de.key?"":(""+de.key).replace(he,"$&/")+"/")+$)),U.push(de)),1;if(oe=0,pe=pe===""?".":pe+":",R($))for(var ue=0;ue<$.length;ue++){Y=$[ue];var ge=pe+ce(Y,ue);oe+=W(Y,U,re,ge,de)}else if(ge=g($),typeof ge=="function")for($=ge.call($),ue=0;!(Y=$.next()).done;)Y=Y.value,ge=pe+ce(Y,ue++),oe+=W(Y,U,re,ge,de);else if(Y==="object")throw U=String($),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys($).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.");return oe}function G($,U,re){if($==null)return $;var pe=[],de=0;return W($,pe,"","",function(Y){return U.call(re,Y,de++)}),pe}function q($){if($._status===-1){var U=$._result;U=U(),U.then(function(re){($._status===0||$._status===-1)&&($._status=1,$._result=re)},function(re){($._status===0||$._status===-1)&&($._status=2,$._result=re)}),$._status===-1&&($._status=0,$._result=U)}if($._status===1)return $._result.default;throw $._result}var J={current:null},j={transition:null},B={ReactCurrentDispatcher:J,ReactCurrentBatchConfig:j,ReactCurrentOwner:I};function V(){throw Error("act(...) is not supported in production builds of React.")}return Be.Children={map:G,forEach:function($,U,re){G($,function(){U.apply(this,arguments)},re)},count:function($){var U=0;return G($,function(){U++}),U},toArray:function($){return G($,function(U){return U})||[]},only:function($){if(!X($))throw Error("React.Children.only expected to receive a single React element child.");return $}},Be.Component=x,Be.Fragment=t,Be.Profiler=s,Be.PureComponent=k,Be.StrictMode=r,Be.Suspense=c,Be.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=B,Be.act=V,Be.cloneElement=function($,U,re){if($==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+$+".");var pe=w({},$.props),de=$.key,Y=$.ref,oe=$._owner;if(U!=null){if(U.ref!==void 0&&(Y=U.ref,oe=I.current),U.key!==void 0&&(de=""+U.key),$.type&&$.type.defaultProps)var ue=$.type.defaultProps;for(ge in U)A.call(U,ge)&&!M.hasOwnProperty(ge)&&(pe[ge]=U[ge]===void 0&&ue!==void 0?ue[ge]:U[ge])}var ge=arguments.length-2;if(ge===1)pe.children=re;else if(1<ge){ue=Array(ge);for(var _e=0;_e<ge;_e++)ue[_e]=arguments[_e+2];pe.children=ue}return{$$typeof:n,type:$.type,key:de,ref:Y,props:pe,_owner:oe}},Be.createContext=function($){return $={$$typeof:o,_currentValue:$,_currentValue2:$,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},$.Provider={$$typeof:a,_context:$},$.Consumer=$},Be.createElement=D,Be.createFactory=function($){var U=D.bind(null,$);return U.type=$,U},Be.createRef=function(){return{current:null}},Be.forwardRef=function($){return{$$typeof:u,render:$}},Be.isValidElement=X,Be.lazy=function($){return{$$typeof:h,_payload:{_status:-1,_result:$},_init:q}},Be.memo=function($,U){return{$$typeof:f,type:$,compare:U===void 0?null:U}},Be.startTransition=function($){var U=j.transition;j.transition={};try{$()}finally{j.transition=U}},Be.unstable_act=V,Be.useCallback=function($,U){return J.current.useCallback($,U)},Be.useContext=function($){return J.current.useContext($)},Be.useDebugValue=function(){},Be.useDeferredValue=function($){return J.current.useDeferredValue($)},Be.useEffect=function($,U){return J.current.useEffect($,U)},Be.useId=function(){return J.current.useId()},Be.useImperativeHandle=function($,U,re){return J.current.useImperativeHandle($,U,re)},Be.useInsertionEffect=function($,U){return J.current.useInsertionEffect($,U)},Be.useLayoutEffect=function($,U){return J.current.useLayoutEffect($,U)},Be.useMemo=function($,U){return J.current.useMemo($,U)},Be.useReducer=function($,U,re){return J.current.useReducer($,U,re)},Be.useRef=function($){return J.current.useRef($)},Be.useState=function($){return J.current.useState($)},Be.useSyncExternalStore=function($,U,re){return J.current.useSyncExternalStore($,U,re)},Be.useTransition=function(){return J.current.useTransition()},Be.version="18.3.1",Be}var u0;function by(){return u0||(u0=1,Lp.exports=IO()),Lp.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var c0;function NO(){if(c0)return hl;c0=1;var n=by(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(u,c,f){var h,m={},g=null,y=null;f!==void 0&&(g=""+f),c.key!==void 0&&(g=""+c.key),c.ref!==void 0&&(y=c.ref);for(h in c)r.call(c,h)&&!a.hasOwnProperty(h)&&(m[h]=c[h]);if(u&&u.defaultProps)for(h in c=u.defaultProps,c)m[h]===void 0&&(m[h]=c[h]);return{$$typeof:e,type:u,key:g,ref:y,props:m,_owner:s.current}}return hl.Fragment=t,hl.jsx=o,hl.jsxs=o,hl}var d0;function jO(){return d0||(d0=1,jp.exports=NO()),jp.exports}var O=jO(),P=by();const Va=ti(P),LO=$O({__proto__:null,default:Va},[P]);var Hc={},Mp={exports:{}},Pn={},Dp={exports:{}},Fp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f0;function MO(){return f0||(f0=1,function(n){function e(j,B){var V=j.length;j.push(B);e:for(;0<V;){var $=V-1>>>1,U=j[$];if(0<s(U,B))j[$]=B,j[V]=U,V=$;else break e}}function t(j){return j.length===0?null:j[0]}function r(j){if(j.length===0)return null;var B=j[0],V=j.pop();if(V!==B){j[0]=V;e:for(var $=0,U=j.length,re=U>>>1;$<re;){var pe=2*($+1)-1,de=j[pe],Y=pe+1,oe=j[Y];if(0>s(de,V))Y<U&&0>s(oe,de)?(j[$]=oe,j[Y]=V,$=Y):(j[$]=de,j[pe]=V,$=pe);else if(Y<U&&0>s(oe,V))j[$]=oe,j[Y]=V,$=Y;else break e}}return B}function s(j,B){var V=j.sortIndex-B.sortIndex;return V!==0?V:j.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,u=o.now();n.unstable_now=function(){return o.now()-u}}var c=[],f=[],h=1,m=null,g=3,y=!1,w=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function S(j){for(var B=t(f);B!==null;){if(B.callback===null)r(f);else if(B.startTime<=j)r(f),B.sortIndex=B.expirationTime,e(c,B);else break;B=t(f)}}function R(j){if(v=!1,S(j),!w)if(t(c)!==null)w=!0,q(A);else{var B=t(f);B!==null&&J(R,B.startTime-j)}}function A(j,B){w=!1,v&&(v=!1,E(D),D=-1),y=!0;var V=g;try{for(S(B),m=t(c);m!==null&&(!(m.expirationTime>B)||j&&!ae());){var $=m.callback;if(typeof $=="function"){m.callback=null,g=m.priorityLevel;var U=$(m.expirationTime<=B);B=n.unstable_now(),typeof U=="function"?m.callback=U:m===t(c)&&r(c),S(B)}else r(c);m=t(c)}if(m!==null)var re=!0;else{var pe=t(f);pe!==null&&J(R,pe.startTime-B),re=!1}return re}finally{m=null,g=V,y=!1}}var I=!1,M=null,D=-1,K=5,X=-1;function ae(){return!(n.unstable_now()-X<K)}function he(){if(M!==null){var j=n.unstable_now();X=j;var B=!0;try{B=M(!0,j)}finally{B?ce():(I=!1,M=null)}}else I=!1}var ce;if(typeof k=="function")ce=function(){k(he)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,G=W.port2;W.port1.onmessage=he,ce=function(){G.postMessage(null)}}else ce=function(){x(he,0)};function q(j){M=j,I||(I=!0,ce())}function J(j,B){D=x(function(){j(n.unstable_now())},B)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(j){j.callback=null},n.unstable_continueExecution=function(){w||y||(w=!0,q(A))},n.unstable_forceFrameRate=function(j){0>j||125<j?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):K=0<j?Math.floor(1e3/j):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(j){switch(g){case 1:case 2:case 3:var B=3;break;default:B=g}var V=g;g=B;try{return j()}finally{g=V}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(j,B){switch(j){case 1:case 2:case 3:case 4:case 5:break;default:j=3}var V=g;g=j;try{return B()}finally{g=V}},n.unstable_scheduleCallback=function(j,B,V){var $=n.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?$+V:$):V=$,j){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=V+U,j={id:h++,callback:B,priorityLevel:j,startTime:V,expirationTime:U,sortIndex:-1},V>$?(j.sortIndex=V,e(f,j),t(c)===null&&j===t(f)&&(v?(E(D),D=-1):v=!0,J(R,V-$))):(j.sortIndex=U,e(c,j),w||y||(w=!0,q(A))),j},n.unstable_shouldYield=ae,n.unstable_wrapCallback=function(j){var B=g;return function(){var V=g;g=B;try{return j.apply(this,arguments)}finally{g=V}}}}(Fp)),Fp}var h0;function DO(){return h0||(h0=1,Dp.exports=MO()),Dp.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var p0;function FO(){if(p0)return Pn;p0=1;var n=by(),e=DO();function t(i){for(var l="https://reactjs.org/docs/error-decoder.html?invariant="+i,d=1;d<arguments.length;d++)l+="&args[]="+encodeURIComponent(arguments[d]);return"Minified React error #"+i+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(i,l){o(i,l),o(i+"Capture",l)}function o(i,l){for(s[i]=l,i=0;i<l.length;i++)r.add(l[i])}var u=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},m={};function g(i){return c.call(m,i)?!0:c.call(h,i)?!1:f.test(i)?m[i]=!0:(h[i]=!0,!1)}function y(i,l,d,p){if(d!==null&&d.type===0)return!1;switch(typeof l){case"function":case"symbol":return!0;case"boolean":return p?!1:d!==null?!d.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function w(i,l,d,p){if(l===null||typeof l>"u"||y(i,l,d,p))return!0;if(p)return!1;if(d!==null)switch(d.type){case 3:return!l;case 4:return l===!1;case 5:return isNaN(l);case 6:return isNaN(l)||1>l}return!1}function v(i,l,d,p,_,b,C){this.acceptsBooleans=l===2||l===3||l===4,this.attributeName=p,this.attributeNamespace=_,this.mustUseProperty=d,this.propertyName=i,this.type=l,this.sanitizeURL=b,this.removeEmptyString=C}var x={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){x[i]=new v(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var l=i[0];x[l]=new v(l,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){x[i]=new v(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){x[i]=new v(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){x[i]=new v(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){x[i]=new v(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){x[i]=new v(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){x[i]=new v(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){x[i]=new v(i,5,!1,i.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function k(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var l=i.replace(E,k);x[l]=new v(l,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var l=i.replace(E,k);x[l]=new v(l,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var l=i.replace(E,k);x[l]=new v(l,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){x[i]=new v(i,1,!1,i.toLowerCase(),null,!1,!1)}),x.xlinkHref=new v("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){x[i]=new v(i,1,!1,i.toLowerCase(),null,!0,!0)});function S(i,l,d,p){var _=x.hasOwnProperty(l)?x[l]:null;(_!==null?_.type!==0:p||!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(w(l,d,_,p)&&(d=null),p||_===null?g(l)&&(d===null?i.removeAttribute(l):i.setAttribute(l,""+d)):_.mustUseProperty?i[_.propertyName]=d===null?_.type===3?!1:"":d:(l=_.attributeName,p=_.attributeNamespace,d===null?i.removeAttribute(l):(_=_.type,d=_===3||_===4&&d===!0?"":""+d,p?i.setAttributeNS(p,l,d):i.setAttribute(l,d))))}var R=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,A=Symbol.for("react.element"),I=Symbol.for("react.portal"),M=Symbol.for("react.fragment"),D=Symbol.for("react.strict_mode"),K=Symbol.for("react.profiler"),X=Symbol.for("react.provider"),ae=Symbol.for("react.context"),he=Symbol.for("react.forward_ref"),ce=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),q=Symbol.for("react.lazy"),J=Symbol.for("react.offscreen"),j=Symbol.iterator;function B(i){return i===null||typeof i!="object"?null:(i=j&&i[j]||i["@@iterator"],typeof i=="function"?i:null)}var V=Object.assign,$;function U(i){if($===void 0)try{throw Error()}catch(d){var l=d.stack.trim().match(/\n( *(at )?)/);$=l&&l[1]||""}return`
`+$+i}var re=!1;function pe(i,l){if(!i||re)return"";re=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(l)if(l=function(){throw Error()},Object.defineProperty(l.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(l,[])}catch(H){var p=H}Reflect.construct(i,[],l)}else{try{l.call()}catch(H){p=H}i.call(l.prototype)}else{try{throw Error()}catch(H){p=H}i()}}catch(H){if(H&&p&&typeof H.stack=="string"){for(var _=H.stack.split(`
`),b=p.stack.split(`
`),C=_.length-1,T=b.length-1;1<=C&&0<=T&&_[C]!==b[T];)T--;for(;1<=C&&0<=T;C--,T--)if(_[C]!==b[T]){if(C!==1||T!==1)do if(C--,T--,0>T||_[C]!==b[T]){var N=`
`+_[C].replace(" at new "," at ");return i.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",i.displayName)),N}while(1<=C&&0<=T);break}}}finally{re=!1,Error.prepareStackTrace=d}return(i=i?i.displayName||i.name:"")?U(i):""}function de(i){switch(i.tag){case 5:return U(i.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return i=pe(i.type,!1),i;case 11:return i=pe(i.type.render,!1),i;case 1:return i=pe(i.type,!0),i;default:return""}}function Y(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case M:return"Fragment";case I:return"Portal";case K:return"Profiler";case D:return"StrictMode";case ce:return"Suspense";case W:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case ae:return(i.displayName||"Context")+".Consumer";case X:return(i._context.displayName||"Context")+".Provider";case he:var l=i.render;return i=i.displayName,i||(i=l.displayName||l.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case G:return l=i.displayName||null,l!==null?l:Y(i.type)||"Memo";case q:l=i._payload,i=i._init;try{return Y(i(l))}catch{}}return null}function oe(i){var l=i.type;switch(i.tag){case 24:return"Cache";case 9:return(l.displayName||"Context")+".Consumer";case 10:return(l._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=l.render,i=i.displayName||i.name||"",l.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return l;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Y(l);case 8:return l===D?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l}return null}function ue(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ge(i){var l=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function _e(i){var l=ge(i)?"checked":"value",d=Object.getOwnPropertyDescriptor(i.constructor.prototype,l),p=""+i[l];if(!i.hasOwnProperty(l)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var _=d.get,b=d.set;return Object.defineProperty(i,l,{configurable:!0,get:function(){return _.call(this)},set:function(C){p=""+C,b.call(this,C)}}),Object.defineProperty(i,l,{enumerable:d.enumerable}),{getValue:function(){return p},setValue:function(C){p=""+C},stopTracking:function(){i._valueTracker=null,delete i[l]}}}}function Ie(i){i._valueTracker||(i._valueTracker=_e(i))}function Nt(i){if(!i)return!1;var l=i._valueTracker;if(!l)return!0;var d=l.getValue(),p="";return i&&(p=ge(i)?i.checked?"true":"false":i.value),i=p,i!==d?(l.setValue(i),!0):!1}function Bt(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Qe(i,l){var d=l.checked;return V({},l,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:d??i._wrapperState.initialChecked})}function Ct(i,l){var d=l.defaultValue==null?"":l.defaultValue,p=l.checked!=null?l.checked:l.defaultChecked;d=ue(l.value!=null?l.value:d),i._wrapperState={initialChecked:p,initialValue:d,controlled:l.type==="checkbox"||l.type==="radio"?l.checked!=null:l.value!=null}}function ot(i,l){l=l.checked,l!=null&&S(i,"checked",l,!1)}function st(i,l){ot(i,l);var d=ue(l.value),p=l.type;if(d!=null)p==="number"?(d===0&&i.value===""||i.value!=d)&&(i.value=""+d):i.value!==""+d&&(i.value=""+d);else if(p==="submit"||p==="reset"){i.removeAttribute("value");return}l.hasOwnProperty("value")?nt(i,l.type,d):l.hasOwnProperty("defaultValue")&&nt(i,l.type,ue(l.defaultValue)),l.checked==null&&l.defaultChecked!=null&&(i.defaultChecked=!!l.defaultChecked)}function or(i,l,d){if(l.hasOwnProperty("value")||l.hasOwnProperty("defaultValue")){var p=l.type;if(!(p!=="submit"&&p!=="reset"||l.value!==void 0&&l.value!==null))return;l=""+i._wrapperState.initialValue,d||l===i.value||(i.value=l),i.defaultValue=l}d=i.name,d!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,d!==""&&(i.name=d)}function nt(i,l,d){(l!=="number"||Bt(i.ownerDocument)!==i)&&(d==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+d&&(i.defaultValue=""+d))}var lr=Array.isArray;function Pt(i,l,d,p){if(i=i.options,l){l={};for(var _=0;_<d.length;_++)l["$"+d[_]]=!0;for(d=0;d<i.length;d++)_=l.hasOwnProperty("$"+i[d].value),i[d].selected!==_&&(i[d].selected=_),_&&p&&(i[d].defaultSelected=!0)}else{for(d=""+ue(d),l=null,_=0;_<i.length;_++){if(i[_].value===d){i[_].selected=!0,p&&(i[_].defaultSelected=!0);return}l!==null||i[_].disabled||(l=i[_])}l!==null&&(l.selected=!0)}}function Is(i,l){if(l.dangerouslySetInnerHTML!=null)throw Error(t(91));return V({},l,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function ii(i,l){var d=l.value;if(d==null){if(d=l.children,l=l.defaultValue,d!=null){if(l!=null)throw Error(t(92));if(lr(d)){if(1<d.length)throw Error(t(93));d=d[0]}l=d}l==null&&(l=""),d=l}i._wrapperState={initialValue:ue(d)}}function Ht(i,l){var d=ue(l.value),p=ue(l.defaultValue);d!=null&&(d=""+d,d!==i.value&&(i.value=d),l.defaultValue==null&&i.defaultValue!==d&&(i.defaultValue=d)),p!=null&&(i.defaultValue=""+p)}function qn(i){var l=i.textContent;l===i._wrapperState.initialValue&&l!==""&&l!==null&&(i.value=l)}function ds(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $n(i,l){return i==null||i==="http://www.w3.org/1999/xhtml"?ds(l):i==="http://www.w3.org/2000/svg"&&l==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var kt,Ns=function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(l,d,p,_){MSApp.execUnsafeLocalFunction(function(){return i(l,d,p,_)})}:i}(function(i,l){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=l;else{for(kt=kt||document.createElement("div"),kt.innerHTML="<svg>"+l.valueOf().toString()+"</svg>",l=kt.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;l.firstChild;)i.appendChild(l.firstChild)}});function yt(i,l){if(l){var d=i.firstChild;if(d&&d===i.lastChild&&d.nodeType===3){d.nodeValue=l;return}}i.textContent=l}var wa={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ju=["Webkit","ms","Moz","O"];Object.keys(wa).forEach(function(i){ju.forEach(function(l){l=l+i.charAt(0).toUpperCase()+i.substring(1),wa[l]=wa[i]})});function ln(i,l,d){return l==null||typeof l=="boolean"||l===""?"":d||typeof l!="number"||l===0||wa.hasOwnProperty(i)&&wa[i]?(""+l).trim():l+"px"}function Zn(i,l){i=i.style;for(var d in l)if(l.hasOwnProperty(d)){var p=d.indexOf("--")===0,_=ln(d,l[d],p);d==="float"&&(d="cssFloat"),p?i.setProperty(d,_):i[d]=_}}var To=V({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Zf(i,l){if(l){if(To[i]&&(l.children!=null||l.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(l.dangerouslySetInnerHTML!=null){if(l.children!=null)throw Error(t(60));if(typeof l.dangerouslySetInnerHTML!="object"||!("__html"in l.dangerouslySetInnerHTML))throw Error(t(61))}if(l.style!=null&&typeof l.style!="object")throw Error(t(62))}}function Gf(i,l){if(i.indexOf("-")===-1)return typeof l.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jf=null;function Kf(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Xf=null,oi=null,li=null;function Cw(i){if(i=Yo(i)){if(typeof Xf!="function")throw Error(t(280));var l=i.stateNode;l&&(l=sc(l),Xf(i.stateNode,i.type,l))}}function Pw(i){oi?li?li.push(i):li=[i]:oi=i}function kw(){if(oi){var i=oi,l=li;if(li=oi=null,Cw(i),l)for(i=0;i<l.length;i++)Cw(l[i])}}function Rw(i,l){return i(l)}function Ow(){}var Yf=!1;function Tw(i,l,d){if(Yf)return i(l,d);Yf=!0;try{return Rw(i,l,d)}finally{Yf=!1,(oi!==null||li!==null)&&(Ow(),kw())}}function Ao(i,l){var d=i.stateNode;if(d===null)return null;var p=sc(d);if(p===null)return null;d=p[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(i=i.type,p=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!p;break e;default:i=!1}if(i)return null;if(d&&typeof d!="function")throw Error(t(231,l,typeof d));return d}var Qf=!1;if(u)try{var $o={};Object.defineProperty($o,"passive",{get:function(){Qf=!0}}),window.addEventListener("test",$o,$o),window.removeEventListener("test",$o,$o)}catch{Qf=!1}function Lk(i,l,d,p,_,b,C,T,N){var H=Array.prototype.slice.call(arguments,3);try{l.apply(d,H)}catch(te){this.onError(te)}}var Io=!1,Lu=null,Mu=!1,eh=null,Mk={onError:function(i){Io=!0,Lu=i}};function Dk(i,l,d,p,_,b,C,T,N){Io=!1,Lu=null,Lk.apply(Mk,arguments)}function Fk(i,l,d,p,_,b,C,T,N){if(Dk.apply(this,arguments),Io){if(Io){var H=Lu;Io=!1,Lu=null}else throw Error(t(198));Mu||(Mu=!0,eh=H)}}function ba(i){var l=i,d=i;if(i.alternate)for(;l.return;)l=l.return;else{i=l;do l=i,l.flags&4098&&(d=l.return),i=l.return;while(i)}return l.tag===3?d:null}function Aw(i){if(i.tag===13){var l=i.memoizedState;if(l===null&&(i=i.alternate,i!==null&&(l=i.memoizedState)),l!==null)return l.dehydrated}return null}function $w(i){if(ba(i)!==i)throw Error(t(188))}function Uk(i){var l=i.alternate;if(!l){if(l=ba(i),l===null)throw Error(t(188));return l!==i?null:i}for(var d=i,p=l;;){var _=d.return;if(_===null)break;var b=_.alternate;if(b===null){if(p=_.return,p!==null){d=p;continue}break}if(_.child===b.child){for(b=_.child;b;){if(b===d)return $w(_),i;if(b===p)return $w(_),l;b=b.sibling}throw Error(t(188))}if(d.return!==p.return)d=_,p=b;else{for(var C=!1,T=_.child;T;){if(T===d){C=!0,d=_,p=b;break}if(T===p){C=!0,p=_,d=b;break}T=T.sibling}if(!C){for(T=b.child;T;){if(T===d){C=!0,d=b,p=_;break}if(T===p){C=!0,p=b,d=_;break}T=T.sibling}if(!C)throw Error(t(189))}}if(d.alternate!==p)throw Error(t(190))}if(d.tag!==3)throw Error(t(188));return d.stateNode.current===d?i:l}function Iw(i){return i=Uk(i),i!==null?Nw(i):null}function Nw(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var l=Nw(i);if(l!==null)return l;i=i.sibling}return null}var jw=e.unstable_scheduleCallback,Lw=e.unstable_cancelCallback,zk=e.unstable_shouldYield,Bk=e.unstable_requestPaint,bt=e.unstable_now,Hk=e.unstable_getCurrentPriorityLevel,th=e.unstable_ImmediatePriority,Mw=e.unstable_UserBlockingPriority,Du=e.unstable_NormalPriority,Vk=e.unstable_LowPriority,Dw=e.unstable_IdlePriority,Fu=null,Dr=null;function Wk(i){if(Dr&&typeof Dr.onCommitFiberRoot=="function")try{Dr.onCommitFiberRoot(Fu,i,void 0,(i.current.flags&128)===128)}catch{}}var ur=Math.clz32?Math.clz32:Gk,qk=Math.log,Zk=Math.LN2;function Gk(i){return i>>>=0,i===0?32:31-(qk(i)/Zk|0)|0}var Uu=64,zu=4194304;function No(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Bu(i,l){var d=i.pendingLanes;if(d===0)return 0;var p=0,_=i.suspendedLanes,b=i.pingedLanes,C=d&268435455;if(C!==0){var T=C&~_;T!==0?p=No(T):(b&=C,b!==0&&(p=No(b)))}else C=d&~_,C!==0?p=No(C):b!==0&&(p=No(b));if(p===0)return 0;if(l!==0&&l!==p&&!(l&_)&&(_=p&-p,b=l&-l,_>=b||_===16&&(b&4194240)!==0))return l;if(p&4&&(p|=d&16),l=i.entangledLanes,l!==0)for(i=i.entanglements,l&=p;0<l;)d=31-ur(l),_=1<<d,p|=i[d],l&=~_;return p}function Jk(i,l){switch(i){case 1:case 2:case 4:return l+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Kk(i,l){for(var d=i.suspendedLanes,p=i.pingedLanes,_=i.expirationTimes,b=i.pendingLanes;0<b;){var C=31-ur(b),T=1<<C,N=_[C];N===-1?(!(T&d)||T&p)&&(_[C]=Jk(T,l)):N<=l&&(i.expiredLanes|=T),b&=~T}}function nh(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Fw(){var i=Uu;return Uu<<=1,!(Uu&4194240)&&(Uu=64),i}function rh(i){for(var l=[],d=0;31>d;d++)l.push(i);return l}function jo(i,l,d){i.pendingLanes|=l,l!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,l=31-ur(l),i[l]=d}function Xk(i,l){var d=i.pendingLanes&~l;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=l,i.mutableReadLanes&=l,i.entangledLanes&=l,l=i.entanglements;var p=i.eventTimes;for(i=i.expirationTimes;0<d;){var _=31-ur(d),b=1<<_;l[_]=0,p[_]=-1,i[_]=-1,d&=~b}}function sh(i,l){var d=i.entangledLanes|=l;for(i=i.entanglements;d;){var p=31-ur(d),_=1<<p;_&l|i[p]&l&&(i[p]|=l),d&=~_}}var Je=0;function Uw(i){return i&=-i,1<i?4<i?i&268435455?16:536870912:4:1}var zw,ah,Bw,Hw,Vw,ih=!1,Hu=[],js=null,Ls=null,Ms=null,Lo=new Map,Mo=new Map,Ds=[],Yk="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ww(i,l){switch(i){case"focusin":case"focusout":js=null;break;case"dragenter":case"dragleave":Ls=null;break;case"mouseover":case"mouseout":Ms=null;break;case"pointerover":case"pointerout":Lo.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mo.delete(l.pointerId)}}function Do(i,l,d,p,_,b){return i===null||i.nativeEvent!==b?(i={blockedOn:l,domEventName:d,eventSystemFlags:p,nativeEvent:b,targetContainers:[_]},l!==null&&(l=Yo(l),l!==null&&ah(l)),i):(i.eventSystemFlags|=p,l=i.targetContainers,_!==null&&l.indexOf(_)===-1&&l.push(_),i)}function Qk(i,l,d,p,_){switch(l){case"focusin":return js=Do(js,i,l,d,p,_),!0;case"dragenter":return Ls=Do(Ls,i,l,d,p,_),!0;case"mouseover":return Ms=Do(Ms,i,l,d,p,_),!0;case"pointerover":var b=_.pointerId;return Lo.set(b,Do(Lo.get(b)||null,i,l,d,p,_)),!0;case"gotpointercapture":return b=_.pointerId,Mo.set(b,Do(Mo.get(b)||null,i,l,d,p,_)),!0}return!1}function qw(i){var l=va(i.target);if(l!==null){var d=ba(l);if(d!==null){if(l=d.tag,l===13){if(l=Aw(d),l!==null){i.blockedOn=l,Vw(i.priority,function(){Bw(d)});return}}else if(l===3&&d.stateNode.current.memoizedState.isDehydrated){i.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Vu(i){if(i.blockedOn!==null)return!1;for(var l=i.targetContainers;0<l.length;){var d=lh(i.domEventName,i.eventSystemFlags,l[0],i.nativeEvent);if(d===null){d=i.nativeEvent;var p=new d.constructor(d.type,d);Jf=p,d.target.dispatchEvent(p),Jf=null}else return l=Yo(d),l!==null&&ah(l),i.blockedOn=d,!1;l.shift()}return!0}function Zw(i,l,d){Vu(i)&&d.delete(l)}function eR(){ih=!1,js!==null&&Vu(js)&&(js=null),Ls!==null&&Vu(Ls)&&(Ls=null),Ms!==null&&Vu(Ms)&&(Ms=null),Lo.forEach(Zw),Mo.forEach(Zw)}function Fo(i,l){i.blockedOn===l&&(i.blockedOn=null,ih||(ih=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,eR)))}function Uo(i){function l(_){return Fo(_,i)}if(0<Hu.length){Fo(Hu[0],i);for(var d=1;d<Hu.length;d++){var p=Hu[d];p.blockedOn===i&&(p.blockedOn=null)}}for(js!==null&&Fo(js,i),Ls!==null&&Fo(Ls,i),Ms!==null&&Fo(Ms,i),Lo.forEach(l),Mo.forEach(l),d=0;d<Ds.length;d++)p=Ds[d],p.blockedOn===i&&(p.blockedOn=null);for(;0<Ds.length&&(d=Ds[0],d.blockedOn===null);)qw(d),d.blockedOn===null&&Ds.shift()}var ui=R.ReactCurrentBatchConfig,Wu=!0;function tR(i,l,d,p){var _=Je,b=ui.transition;ui.transition=null;try{Je=1,oh(i,l,d,p)}finally{Je=_,ui.transition=b}}function nR(i,l,d,p){var _=Je,b=ui.transition;ui.transition=null;try{Je=4,oh(i,l,d,p)}finally{Je=_,ui.transition=b}}function oh(i,l,d,p){if(Wu){var _=lh(i,l,d,p);if(_===null)Ch(i,l,p,qu,d),Ww(i,p);else if(Qk(_,i,l,d,p))p.stopPropagation();else if(Ww(i,p),l&4&&-1<Yk.indexOf(i)){for(;_!==null;){var b=Yo(_);if(b!==null&&zw(b),b=lh(i,l,d,p),b===null&&Ch(i,l,p,qu,d),b===_)break;_=b}_!==null&&p.stopPropagation()}else Ch(i,l,p,null,d)}}var qu=null;function lh(i,l,d,p){if(qu=null,i=Kf(p),i=va(i),i!==null)if(l=ba(i),l===null)i=null;else if(d=l.tag,d===13){if(i=Aw(l),i!==null)return i;i=null}else if(d===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;i=null}else l!==i&&(i=null);return qu=i,null}function Gw(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Hk()){case th:return 1;case Mw:return 4;case Du:case Vk:return 16;case Dw:return 536870912;default:return 16}default:return 16}}var Fs=null,uh=null,Zu=null;function Jw(){if(Zu)return Zu;var i,l=uh,d=l.length,p,_="value"in Fs?Fs.value:Fs.textContent,b=_.length;for(i=0;i<d&&l[i]===_[i];i++);var C=d-i;for(p=1;p<=C&&l[d-p]===_[b-p];p++);return Zu=_.slice(i,1<p?1-p:void 0)}function Gu(i){var l=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&l===13&&(i=13)):i=l,i===10&&(i=13),32<=i||i===13?i:0}function Ju(){return!0}function Kw(){return!1}function In(i){function l(d,p,_,b,C){this._reactName=d,this._targetInst=_,this.type=p,this.nativeEvent=b,this.target=C,this.currentTarget=null;for(var T in i)i.hasOwnProperty(T)&&(d=i[T],this[T]=d?d(b):b[T]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Ju:Kw,this.isPropagationStopped=Kw,this}return V(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=Ju)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=Ju)},persist:function(){},isPersistent:Ju}),l}var ci={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ch=In(ci),zo=V({},ci,{view:0,detail:0}),rR=In(zo),dh,fh,Bo,Ku=V({},zo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ph,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Bo&&(Bo&&i.type==="mousemove"?(dh=i.screenX-Bo.screenX,fh=i.screenY-Bo.screenY):fh=dh=0,Bo=i),dh)},movementY:function(i){return"movementY"in i?i.movementY:fh}}),Xw=In(Ku),sR=V({},Ku,{dataTransfer:0}),aR=In(sR),iR=V({},zo,{relatedTarget:0}),hh=In(iR),oR=V({},ci,{animationName:0,elapsedTime:0,pseudoElement:0}),lR=In(oR),uR=V({},ci,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),cR=In(uR),dR=V({},ci,{data:0}),Yw=In(dR),fR={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hR={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},pR={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function mR(i){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(i):(i=pR[i])?!!l[i]:!1}function ph(){return mR}var gR=V({},zo,{key:function(i){if(i.key){var l=fR[i.key]||i.key;if(l!=="Unidentified")return l}return i.type==="keypress"?(i=Gu(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?hR[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ph,charCode:function(i){return i.type==="keypress"?Gu(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Gu(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),yR=In(gR),_R=V({},Ku,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qw=In(_R),wR=V({},zo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ph}),bR=In(wR),vR=V({},ci,{propertyName:0,elapsedTime:0,pseudoElement:0}),xR=In(vR),SR=V({},Ku,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),ER=In(SR),CR=[9,13,27,32],mh=u&&"CompositionEvent"in window,Ho=null;u&&"documentMode"in document&&(Ho=document.documentMode);var PR=u&&"TextEvent"in window&&!Ho,eb=u&&(!mh||Ho&&8<Ho&&11>=Ho),tb=" ",nb=!1;function rb(i,l){switch(i){case"keyup":return CR.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sb(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var di=!1;function kR(i,l){switch(i){case"compositionend":return sb(l);case"keypress":return l.which!==32?null:(nb=!0,tb);case"textInput":return i=l.data,i===tb&&nb?null:i;default:return null}}function RR(i,l){if(di)return i==="compositionend"||!mh&&rb(i,l)?(i=Jw(),Zu=uh=Fs=null,di=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return eb&&l.locale!=="ko"?null:l.data;default:return null}}var OR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ab(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l==="input"?!!OR[i.type]:l==="textarea"}function ib(i,l,d,p){Pw(p),l=tc(l,"onChange"),0<l.length&&(d=new ch("onChange","change",null,d,p),i.push({event:d,listeners:l}))}var Vo=null,Wo=null;function TR(i){Eb(i,0)}function Xu(i){var l=gi(i);if(Nt(l))return i}function AR(i,l){if(i==="change")return l}var ob=!1;if(u){var gh;if(u){var yh="oninput"in document;if(!yh){var lb=document.createElement("div");lb.setAttribute("oninput","return;"),yh=typeof lb.oninput=="function"}gh=yh}else gh=!1;ob=gh&&(!document.documentMode||9<document.documentMode)}function ub(){Vo&&(Vo.detachEvent("onpropertychange",cb),Wo=Vo=null)}function cb(i){if(i.propertyName==="value"&&Xu(Wo)){var l=[];ib(l,Wo,i,Kf(i)),Tw(TR,l)}}function $R(i,l,d){i==="focusin"?(ub(),Vo=l,Wo=d,Vo.attachEvent("onpropertychange",cb)):i==="focusout"&&ub()}function IR(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Xu(Wo)}function NR(i,l){if(i==="click")return Xu(l)}function jR(i,l){if(i==="input"||i==="change")return Xu(l)}function LR(i,l){return i===l&&(i!==0||1/i===1/l)||i!==i&&l!==l}var cr=typeof Object.is=="function"?Object.is:LR;function qo(i,l){if(cr(i,l))return!0;if(typeof i!="object"||i===null||typeof l!="object"||l===null)return!1;var d=Object.keys(i),p=Object.keys(l);if(d.length!==p.length)return!1;for(p=0;p<d.length;p++){var _=d[p];if(!c.call(l,_)||!cr(i[_],l[_]))return!1}return!0}function db(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function fb(i,l){var d=db(i);i=0;for(var p;d;){if(d.nodeType===3){if(p=i+d.textContent.length,i<=l&&p>=l)return{node:d,offset:l-i};i=p}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=db(d)}}function hb(i,l){return i&&l?i===l?!0:i&&i.nodeType===3?!1:l&&l.nodeType===3?hb(i,l.parentNode):"contains"in i?i.contains(l):i.compareDocumentPosition?!!(i.compareDocumentPosition(l)&16):!1:!1}function pb(){for(var i=window,l=Bt();l instanceof i.HTMLIFrameElement;){try{var d=typeof l.contentWindow.location.href=="string"}catch{d=!1}if(d)i=l.contentWindow;else break;l=Bt(i.document)}return l}function _h(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l&&(l==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||l==="textarea"||i.contentEditable==="true")}function MR(i){var l=pb(),d=i.focusedElem,p=i.selectionRange;if(l!==d&&d&&d.ownerDocument&&hb(d.ownerDocument.documentElement,d)){if(p!==null&&_h(d)){if(l=p.start,i=p.end,i===void 0&&(i=l),"selectionStart"in d)d.selectionStart=l,d.selectionEnd=Math.min(i,d.value.length);else if(i=(l=d.ownerDocument||document)&&l.defaultView||window,i.getSelection){i=i.getSelection();var _=d.textContent.length,b=Math.min(p.start,_);p=p.end===void 0?b:Math.min(p.end,_),!i.extend&&b>p&&(_=p,p=b,b=_),_=fb(d,b);var C=fb(d,p);_&&C&&(i.rangeCount!==1||i.anchorNode!==_.node||i.anchorOffset!==_.offset||i.focusNode!==C.node||i.focusOffset!==C.offset)&&(l=l.createRange(),l.setStart(_.node,_.offset),i.removeAllRanges(),b>p?(i.addRange(l),i.extend(C.node,C.offset)):(l.setEnd(C.node,C.offset),i.addRange(l)))}}for(l=[],i=d;i=i.parentNode;)i.nodeType===1&&l.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof d.focus=="function"&&d.focus(),d=0;d<l.length;d++)i=l[d],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var DR=u&&"documentMode"in document&&11>=document.documentMode,fi=null,wh=null,Zo=null,bh=!1;function mb(i,l,d){var p=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;bh||fi==null||fi!==Bt(p)||(p=fi,"selectionStart"in p&&_h(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),Zo&&qo(Zo,p)||(Zo=p,p=tc(wh,"onSelect"),0<p.length&&(l=new ch("onSelect","select",null,l,d),i.push({event:l,listeners:p}),l.target=fi)))}function Yu(i,l){var d={};return d[i.toLowerCase()]=l.toLowerCase(),d["Webkit"+i]="webkit"+l,d["Moz"+i]="moz"+l,d}var hi={animationend:Yu("Animation","AnimationEnd"),animationiteration:Yu("Animation","AnimationIteration"),animationstart:Yu("Animation","AnimationStart"),transitionend:Yu("Transition","TransitionEnd")},vh={},gb={};u&&(gb=document.createElement("div").style,"AnimationEvent"in window||(delete hi.animationend.animation,delete hi.animationiteration.animation,delete hi.animationstart.animation),"TransitionEvent"in window||delete hi.transitionend.transition);function Qu(i){if(vh[i])return vh[i];if(!hi[i])return i;var l=hi[i],d;for(d in l)if(l.hasOwnProperty(d)&&d in gb)return vh[i]=l[d];return i}var yb=Qu("animationend"),_b=Qu("animationiteration"),wb=Qu("animationstart"),bb=Qu("transitionend"),vb=new Map,xb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Us(i,l){vb.set(i,l),a(l,[i])}for(var xh=0;xh<xb.length;xh++){var Sh=xb[xh],FR=Sh.toLowerCase(),UR=Sh[0].toUpperCase()+Sh.slice(1);Us(FR,"on"+UR)}Us(yb,"onAnimationEnd"),Us(_b,"onAnimationIteration"),Us(wb,"onAnimationStart"),Us("dblclick","onDoubleClick"),Us("focusin","onFocus"),Us("focusout","onBlur"),Us(bb,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Go="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zR=new Set("cancel close invalid load scroll toggle".split(" ").concat(Go));function Sb(i,l,d){var p=i.type||"unknown-event";i.currentTarget=d,Fk(p,l,void 0,i),i.currentTarget=null}function Eb(i,l){l=(l&4)!==0;for(var d=0;d<i.length;d++){var p=i[d],_=p.event;p=p.listeners;e:{var b=void 0;if(l)for(var C=p.length-1;0<=C;C--){var T=p[C],N=T.instance,H=T.currentTarget;if(T=T.listener,N!==b&&_.isPropagationStopped())break e;Sb(_,T,H),b=N}else for(C=0;C<p.length;C++){if(T=p[C],N=T.instance,H=T.currentTarget,T=T.listener,N!==b&&_.isPropagationStopped())break e;Sb(_,T,H),b=N}}}if(Mu)throw i=eh,Mu=!1,eh=null,i}function lt(i,l){var d=l[Ah];d===void 0&&(d=l[Ah]=new Set);var p=i+"__bubble";d.has(p)||(Cb(l,i,2,!1),d.add(p))}function Eh(i,l,d){var p=0;l&&(p|=4),Cb(d,i,p,l)}var ec="_reactListening"+Math.random().toString(36).slice(2);function Jo(i){if(!i[ec]){i[ec]=!0,r.forEach(function(d){d!=="selectionchange"&&(zR.has(d)||Eh(d,!1,i),Eh(d,!0,i))});var l=i.nodeType===9?i:i.ownerDocument;l===null||l[ec]||(l[ec]=!0,Eh("selectionchange",!1,l))}}function Cb(i,l,d,p){switch(Gw(l)){case 1:var _=tR;break;case 4:_=nR;break;default:_=oh}d=_.bind(null,l,d,i),_=void 0,!Qf||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(_=!0),p?_!==void 0?i.addEventListener(l,d,{capture:!0,passive:_}):i.addEventListener(l,d,!0):_!==void 0?i.addEventListener(l,d,{passive:_}):i.addEventListener(l,d,!1)}function Ch(i,l,d,p,_){var b=p;if(!(l&1)&&!(l&2)&&p!==null)e:for(;;){if(p===null)return;var C=p.tag;if(C===3||C===4){var T=p.stateNode.containerInfo;if(T===_||T.nodeType===8&&T.parentNode===_)break;if(C===4)for(C=p.return;C!==null;){var N=C.tag;if((N===3||N===4)&&(N=C.stateNode.containerInfo,N===_||N.nodeType===8&&N.parentNode===_))return;C=C.return}for(;T!==null;){if(C=va(T),C===null)return;if(N=C.tag,N===5||N===6){p=b=C;continue e}T=T.parentNode}}p=p.return}Tw(function(){var H=b,te=Kf(d),ne=[];e:{var ee=vb.get(i);if(ee!==void 0){var me=ch,be=i;switch(i){case"keypress":if(Gu(d)===0)break e;case"keydown":case"keyup":me=yR;break;case"focusin":be="focus",me=hh;break;case"focusout":be="blur",me=hh;break;case"beforeblur":case"afterblur":me=hh;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":me=Xw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":me=aR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":me=bR;break;case yb:case _b:case wb:me=lR;break;case bb:me=xR;break;case"scroll":me=rR;break;case"wheel":me=ER;break;case"copy":case"cut":case"paste":me=cR;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":me=Qw}var xe=(l&4)!==0,vt=!xe&&i==="scroll",F=xe?ee!==null?ee+"Capture":null:ee;xe=[];for(var L=H,z;L!==null;){z=L;var ie=z.stateNode;if(z.tag===5&&ie!==null&&(z=ie,F!==null&&(ie=Ao(L,F),ie!=null&&xe.push(Ko(L,ie,z)))),vt)break;L=L.return}0<xe.length&&(ee=new me(ee,be,null,d,te),ne.push({event:ee,listeners:xe}))}}if(!(l&7)){e:{if(ee=i==="mouseover"||i==="pointerover",me=i==="mouseout"||i==="pointerout",ee&&d!==Jf&&(be=d.relatedTarget||d.fromElement)&&(va(be)||be[fs]))break e;if((me||ee)&&(ee=te.window===te?te:(ee=te.ownerDocument)?ee.defaultView||ee.parentWindow:window,me?(be=d.relatedTarget||d.toElement,me=H,be=be?va(be):null,be!==null&&(vt=ba(be),be!==vt||be.tag!==5&&be.tag!==6)&&(be=null)):(me=null,be=H),me!==be)){if(xe=Xw,ie="onMouseLeave",F="onMouseEnter",L="mouse",(i==="pointerout"||i==="pointerover")&&(xe=Qw,ie="onPointerLeave",F="onPointerEnter",L="pointer"),vt=me==null?ee:gi(me),z=be==null?ee:gi(be),ee=new xe(ie,L+"leave",me,d,te),ee.target=vt,ee.relatedTarget=z,ie=null,va(te)===H&&(xe=new xe(F,L+"enter",be,d,te),xe.target=z,xe.relatedTarget=vt,ie=xe),vt=ie,me&&be)t:{for(xe=me,F=be,L=0,z=xe;z;z=pi(z))L++;for(z=0,ie=F;ie;ie=pi(ie))z++;for(;0<L-z;)xe=pi(xe),L--;for(;0<z-L;)F=pi(F),z--;for(;L--;){if(xe===F||F!==null&&xe===F.alternate)break t;xe=pi(xe),F=pi(F)}xe=null}else xe=null;me!==null&&Pb(ne,ee,me,xe,!1),be!==null&&vt!==null&&Pb(ne,vt,be,xe,!0)}}e:{if(ee=H?gi(H):window,me=ee.nodeName&&ee.nodeName.toLowerCase(),me==="select"||me==="input"&&ee.type==="file")var Se=AR;else if(ab(ee))if(ob)Se=jR;else{Se=IR;var Re=$R}else(me=ee.nodeName)&&me.toLowerCase()==="input"&&(ee.type==="checkbox"||ee.type==="radio")&&(Se=NR);if(Se&&(Se=Se(i,H))){ib(ne,Se,d,te);break e}Re&&Re(i,ee,H),i==="focusout"&&(Re=ee._wrapperState)&&Re.controlled&&ee.type==="number"&&nt(ee,"number",ee.value)}switch(Re=H?gi(H):window,i){case"focusin":(ab(Re)||Re.contentEditable==="true")&&(fi=Re,wh=H,Zo=null);break;case"focusout":Zo=wh=fi=null;break;case"mousedown":bh=!0;break;case"contextmenu":case"mouseup":case"dragend":bh=!1,mb(ne,d,te);break;case"selectionchange":if(DR)break;case"keydown":case"keyup":mb(ne,d,te)}var Oe;if(mh)e:{switch(i){case"compositionstart":var $e="onCompositionStart";break e;case"compositionend":$e="onCompositionEnd";break e;case"compositionupdate":$e="onCompositionUpdate";break e}$e=void 0}else di?rb(i,d)&&($e="onCompositionEnd"):i==="keydown"&&d.keyCode===229&&($e="onCompositionStart");$e&&(eb&&d.locale!=="ko"&&(di||$e!=="onCompositionStart"?$e==="onCompositionEnd"&&di&&(Oe=Jw()):(Fs=te,uh="value"in Fs?Fs.value:Fs.textContent,di=!0)),Re=tc(H,$e),0<Re.length&&($e=new Yw($e,i,null,d,te),ne.push({event:$e,listeners:Re}),Oe?$e.data=Oe:(Oe=sb(d),Oe!==null&&($e.data=Oe)))),(Oe=PR?kR(i,d):RR(i,d))&&(H=tc(H,"onBeforeInput"),0<H.length&&(te=new Yw("onBeforeInput","beforeinput",null,d,te),ne.push({event:te,listeners:H}),te.data=Oe))}Eb(ne,l)})}function Ko(i,l,d){return{instance:i,listener:l,currentTarget:d}}function tc(i,l){for(var d=l+"Capture",p=[];i!==null;){var _=i,b=_.stateNode;_.tag===5&&b!==null&&(_=b,b=Ao(i,d),b!=null&&p.unshift(Ko(i,b,_)),b=Ao(i,l),b!=null&&p.push(Ko(i,b,_))),i=i.return}return p}function pi(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Pb(i,l,d,p,_){for(var b=l._reactName,C=[];d!==null&&d!==p;){var T=d,N=T.alternate,H=T.stateNode;if(N!==null&&N===p)break;T.tag===5&&H!==null&&(T=H,_?(N=Ao(d,b),N!=null&&C.unshift(Ko(d,N,T))):_||(N=Ao(d,b),N!=null&&C.push(Ko(d,N,T)))),d=d.return}C.length!==0&&i.push({event:l,listeners:C})}var BR=/\r\n?/g,HR=/\u0000|\uFFFD/g;function kb(i){return(typeof i=="string"?i:""+i).replace(BR,`
`).replace(HR,"")}function nc(i,l,d){if(l=kb(l),kb(i)!==l&&d)throw Error(t(425))}function rc(){}var Ph=null,kh=null;function Rh(i,l){return i==="textarea"||i==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var Oh=typeof setTimeout=="function"?setTimeout:void 0,VR=typeof clearTimeout=="function"?clearTimeout:void 0,Rb=typeof Promise=="function"?Promise:void 0,WR=typeof queueMicrotask=="function"?queueMicrotask:typeof Rb<"u"?function(i){return Rb.resolve(null).then(i).catch(qR)}:Oh;function qR(i){setTimeout(function(){throw i})}function Th(i,l){var d=l,p=0;do{var _=d.nextSibling;if(i.removeChild(d),_&&_.nodeType===8)if(d=_.data,d==="/$"){if(p===0){i.removeChild(_),Uo(l);return}p--}else d!=="$"&&d!=="$?"&&d!=="$!"||p++;d=_}while(d);Uo(l)}function zs(i){for(;i!=null;i=i.nextSibling){var l=i.nodeType;if(l===1||l===3)break;if(l===8){if(l=i.data,l==="$"||l==="$!"||l==="$?")break;if(l==="/$")return null}}return i}function Ob(i){i=i.previousSibling;for(var l=0;i;){if(i.nodeType===8){var d=i.data;if(d==="$"||d==="$!"||d==="$?"){if(l===0)return i;l--}else d==="/$"&&l++}i=i.previousSibling}return null}var mi=Math.random().toString(36).slice(2),Fr="__reactFiber$"+mi,Xo="__reactProps$"+mi,fs="__reactContainer$"+mi,Ah="__reactEvents$"+mi,ZR="__reactListeners$"+mi,GR="__reactHandles$"+mi;function va(i){var l=i[Fr];if(l)return l;for(var d=i.parentNode;d;){if(l=d[fs]||d[Fr]){if(d=l.alternate,l.child!==null||d!==null&&d.child!==null)for(i=Ob(i);i!==null;){if(d=i[Fr])return d;i=Ob(i)}return l}i=d,d=i.parentNode}return null}function Yo(i){return i=i[Fr]||i[fs],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function gi(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function sc(i){return i[Xo]||null}var $h=[],yi=-1;function Bs(i){return{current:i}}function ut(i){0>yi||(i.current=$h[yi],$h[yi]=null,yi--)}function at(i,l){yi++,$h[yi]=i.current,i.current=l}var Hs={},Yt=Bs(Hs),vn=Bs(!1),xa=Hs;function _i(i,l){var d=i.type.contextTypes;if(!d)return Hs;var p=i.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===l)return p.__reactInternalMemoizedMaskedChildContext;var _={},b;for(b in d)_[b]=l[b];return p&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=l,i.__reactInternalMemoizedMaskedChildContext=_),_}function xn(i){return i=i.childContextTypes,i!=null}function ac(){ut(vn),ut(Yt)}function Tb(i,l,d){if(Yt.current!==Hs)throw Error(t(168));at(Yt,l),at(vn,d)}function Ab(i,l,d){var p=i.stateNode;if(l=l.childContextTypes,typeof p.getChildContext!="function")return d;p=p.getChildContext();for(var _ in p)if(!(_ in l))throw Error(t(108,oe(i)||"Unknown",_));return V({},d,p)}function ic(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Hs,xa=Yt.current,at(Yt,i),at(vn,vn.current),!0}function $b(i,l,d){var p=i.stateNode;if(!p)throw Error(t(169));d?(i=Ab(i,l,xa),p.__reactInternalMemoizedMergedChildContext=i,ut(vn),ut(Yt),at(Yt,i)):ut(vn),at(vn,d)}var hs=null,oc=!1,Ih=!1;function Ib(i){hs===null?hs=[i]:hs.push(i)}function JR(i){oc=!0,Ib(i)}function Vs(){if(!Ih&&hs!==null){Ih=!0;var i=0,l=Je;try{var d=hs;for(Je=1;i<d.length;i++){var p=d[i];do p=p(!0);while(p!==null)}hs=null,oc=!1}catch(_){throw hs!==null&&(hs=hs.slice(i+1)),jw(th,Vs),_}finally{Je=l,Ih=!1}}return null}var wi=[],bi=0,lc=null,uc=0,Gn=[],Jn=0,Sa=null,ps=1,ms="";function Ea(i,l){wi[bi++]=uc,wi[bi++]=lc,lc=i,uc=l}function Nb(i,l,d){Gn[Jn++]=ps,Gn[Jn++]=ms,Gn[Jn++]=Sa,Sa=i;var p=ps;i=ms;var _=32-ur(p)-1;p&=~(1<<_),d+=1;var b=32-ur(l)+_;if(30<b){var C=_-_%5;b=(p&(1<<C)-1).toString(32),p>>=C,_-=C,ps=1<<32-ur(l)+_|d<<_|p,ms=b+i}else ps=1<<b|d<<_|p,ms=i}function Nh(i){i.return!==null&&(Ea(i,1),Nb(i,1,0))}function jh(i){for(;i===lc;)lc=wi[--bi],wi[bi]=null,uc=wi[--bi],wi[bi]=null;for(;i===Sa;)Sa=Gn[--Jn],Gn[Jn]=null,ms=Gn[--Jn],Gn[Jn]=null,ps=Gn[--Jn],Gn[Jn]=null}var Nn=null,jn=null,ct=!1,dr=null;function jb(i,l){var d=Qn(5,null,null,0);d.elementType="DELETED",d.stateNode=l,d.return=i,l=i.deletions,l===null?(i.deletions=[d],i.flags|=16):l.push(d)}function Lb(i,l){switch(i.tag){case 5:var d=i.type;return l=l.nodeType!==1||d.toLowerCase()!==l.nodeName.toLowerCase()?null:l,l!==null?(i.stateNode=l,Nn=i,jn=zs(l.firstChild),!0):!1;case 6:return l=i.pendingProps===""||l.nodeType!==3?null:l,l!==null?(i.stateNode=l,Nn=i,jn=null,!0):!1;case 13:return l=l.nodeType!==8?null:l,l!==null?(d=Sa!==null?{id:ps,overflow:ms}:null,i.memoizedState={dehydrated:l,treeContext:d,retryLane:1073741824},d=Qn(18,null,null,0),d.stateNode=l,d.return=i,i.child=d,Nn=i,jn=null,!0):!1;default:return!1}}function Lh(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Mh(i){if(ct){var l=jn;if(l){var d=l;if(!Lb(i,l)){if(Lh(i))throw Error(t(418));l=zs(d.nextSibling);var p=Nn;l&&Lb(i,l)?jb(p,d):(i.flags=i.flags&-4097|2,ct=!1,Nn=i)}}else{if(Lh(i))throw Error(t(418));i.flags=i.flags&-4097|2,ct=!1,Nn=i}}}function Mb(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Nn=i}function cc(i){if(i!==Nn)return!1;if(!ct)return Mb(i),ct=!0,!1;var l;if((l=i.tag!==3)&&!(l=i.tag!==5)&&(l=i.type,l=l!=="head"&&l!=="body"&&!Rh(i.type,i.memoizedProps)),l&&(l=jn)){if(Lh(i))throw Db(),Error(t(418));for(;l;)jb(i,l),l=zs(l.nextSibling)}if(Mb(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,l=0;i;){if(i.nodeType===8){var d=i.data;if(d==="/$"){if(l===0){jn=zs(i.nextSibling);break e}l--}else d!=="$"&&d!=="$!"&&d!=="$?"||l++}i=i.nextSibling}jn=null}}else jn=Nn?zs(i.stateNode.nextSibling):null;return!0}function Db(){for(var i=jn;i;)i=zs(i.nextSibling)}function vi(){jn=Nn=null,ct=!1}function Dh(i){dr===null?dr=[i]:dr.push(i)}var KR=R.ReactCurrentBatchConfig;function Qo(i,l,d){if(i=d.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(d._owner){if(d=d._owner,d){if(d.tag!==1)throw Error(t(309));var p=d.stateNode}if(!p)throw Error(t(147,i));var _=p,b=""+i;return l!==null&&l.ref!==null&&typeof l.ref=="function"&&l.ref._stringRef===b?l.ref:(l=function(C){var T=_.refs;C===null?delete T[b]:T[b]=C},l._stringRef=b,l)}if(typeof i!="string")throw Error(t(284));if(!d._owner)throw Error(t(290,i))}return i}function dc(i,l){throw i=Object.prototype.toString.call(l),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":i))}function Fb(i){var l=i._init;return l(i._payload)}function Ub(i){function l(F,L){if(i){var z=F.deletions;z===null?(F.deletions=[L],F.flags|=16):z.push(L)}}function d(F,L){if(!i)return null;for(;L!==null;)l(F,L),L=L.sibling;return null}function p(F,L){for(F=new Map;L!==null;)L.key!==null?F.set(L.key,L):F.set(L.index,L),L=L.sibling;return F}function _(F,L){return F=Ys(F,L),F.index=0,F.sibling=null,F}function b(F,L,z){return F.index=z,i?(z=F.alternate,z!==null?(z=z.index,z<L?(F.flags|=2,L):z):(F.flags|=2,L)):(F.flags|=1048576,L)}function C(F){return i&&F.alternate===null&&(F.flags|=2),F}function T(F,L,z,ie){return L===null||L.tag!==6?(L=Op(z,F.mode,ie),L.return=F,L):(L=_(L,z),L.return=F,L)}function N(F,L,z,ie){var Se=z.type;return Se===M?te(F,L,z.props.children,ie,z.key):L!==null&&(L.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===q&&Fb(Se)===L.type)?(ie=_(L,z.props),ie.ref=Qo(F,L,z),ie.return=F,ie):(ie=jc(z.type,z.key,z.props,null,F.mode,ie),ie.ref=Qo(F,L,z),ie.return=F,ie)}function H(F,L,z,ie){return L===null||L.tag!==4||L.stateNode.containerInfo!==z.containerInfo||L.stateNode.implementation!==z.implementation?(L=Tp(z,F.mode,ie),L.return=F,L):(L=_(L,z.children||[]),L.return=F,L)}function te(F,L,z,ie,Se){return L===null||L.tag!==7?(L=$a(z,F.mode,ie,Se),L.return=F,L):(L=_(L,z),L.return=F,L)}function ne(F,L,z){if(typeof L=="string"&&L!==""||typeof L=="number")return L=Op(""+L,F.mode,z),L.return=F,L;if(typeof L=="object"&&L!==null){switch(L.$$typeof){case A:return z=jc(L.type,L.key,L.props,null,F.mode,z),z.ref=Qo(F,null,L),z.return=F,z;case I:return L=Tp(L,F.mode,z),L.return=F,L;case q:var ie=L._init;return ne(F,ie(L._payload),z)}if(lr(L)||B(L))return L=$a(L,F.mode,z,null),L.return=F,L;dc(F,L)}return null}function ee(F,L,z,ie){var Se=L!==null?L.key:null;if(typeof z=="string"&&z!==""||typeof z=="number")return Se!==null?null:T(F,L,""+z,ie);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case A:return z.key===Se?N(F,L,z,ie):null;case I:return z.key===Se?H(F,L,z,ie):null;case q:return Se=z._init,ee(F,L,Se(z._payload),ie)}if(lr(z)||B(z))return Se!==null?null:te(F,L,z,ie,null);dc(F,z)}return null}function me(F,L,z,ie,Se){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return F=F.get(z)||null,T(L,F,""+ie,Se);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case A:return F=F.get(ie.key===null?z:ie.key)||null,N(L,F,ie,Se);case I:return F=F.get(ie.key===null?z:ie.key)||null,H(L,F,ie,Se);case q:var Re=ie._init;return me(F,L,z,Re(ie._payload),Se)}if(lr(ie)||B(ie))return F=F.get(z)||null,te(L,F,ie,Se,null);dc(L,ie)}return null}function be(F,L,z,ie){for(var Se=null,Re=null,Oe=L,$e=L=0,Mt=null;Oe!==null&&$e<z.length;$e++){Oe.index>$e?(Mt=Oe,Oe=null):Mt=Oe.sibling;var We=ee(F,Oe,z[$e],ie);if(We===null){Oe===null&&(Oe=Mt);break}i&&Oe&&We.alternate===null&&l(F,Oe),L=b(We,L,$e),Re===null?Se=We:Re.sibling=We,Re=We,Oe=Mt}if($e===z.length)return d(F,Oe),ct&&Ea(F,$e),Se;if(Oe===null){for(;$e<z.length;$e++)Oe=ne(F,z[$e],ie),Oe!==null&&(L=b(Oe,L,$e),Re===null?Se=Oe:Re.sibling=Oe,Re=Oe);return ct&&Ea(F,$e),Se}for(Oe=p(F,Oe);$e<z.length;$e++)Mt=me(Oe,F,$e,z[$e],ie),Mt!==null&&(i&&Mt.alternate!==null&&Oe.delete(Mt.key===null?$e:Mt.key),L=b(Mt,L,$e),Re===null?Se=Mt:Re.sibling=Mt,Re=Mt);return i&&Oe.forEach(function(Qs){return l(F,Qs)}),ct&&Ea(F,$e),Se}function xe(F,L,z,ie){var Se=B(z);if(typeof Se!="function")throw Error(t(150));if(z=Se.call(z),z==null)throw Error(t(151));for(var Re=Se=null,Oe=L,$e=L=0,Mt=null,We=z.next();Oe!==null&&!We.done;$e++,We=z.next()){Oe.index>$e?(Mt=Oe,Oe=null):Mt=Oe.sibling;var Qs=ee(F,Oe,We.value,ie);if(Qs===null){Oe===null&&(Oe=Mt);break}i&&Oe&&Qs.alternate===null&&l(F,Oe),L=b(Qs,L,$e),Re===null?Se=Qs:Re.sibling=Qs,Re=Qs,Oe=Mt}if(We.done)return d(F,Oe),ct&&Ea(F,$e),Se;if(Oe===null){for(;!We.done;$e++,We=z.next())We=ne(F,We.value,ie),We!==null&&(L=b(We,L,$e),Re===null?Se=We:Re.sibling=We,Re=We);return ct&&Ea(F,$e),Se}for(Oe=p(F,Oe);!We.done;$e++,We=z.next())We=me(Oe,F,$e,We.value,ie),We!==null&&(i&&We.alternate!==null&&Oe.delete(We.key===null?$e:We.key),L=b(We,L,$e),Re===null?Se=We:Re.sibling=We,Re=We);return i&&Oe.forEach(function(OO){return l(F,OO)}),ct&&Ea(F,$e),Se}function vt(F,L,z,ie){if(typeof z=="object"&&z!==null&&z.type===M&&z.key===null&&(z=z.props.children),typeof z=="object"&&z!==null){switch(z.$$typeof){case A:e:{for(var Se=z.key,Re=L;Re!==null;){if(Re.key===Se){if(Se=z.type,Se===M){if(Re.tag===7){d(F,Re.sibling),L=_(Re,z.props.children),L.return=F,F=L;break e}}else if(Re.elementType===Se||typeof Se=="object"&&Se!==null&&Se.$$typeof===q&&Fb(Se)===Re.type){d(F,Re.sibling),L=_(Re,z.props),L.ref=Qo(F,Re,z),L.return=F,F=L;break e}d(F,Re);break}else l(F,Re);Re=Re.sibling}z.type===M?(L=$a(z.props.children,F.mode,ie,z.key),L.return=F,F=L):(ie=jc(z.type,z.key,z.props,null,F.mode,ie),ie.ref=Qo(F,L,z),ie.return=F,F=ie)}return C(F);case I:e:{for(Re=z.key;L!==null;){if(L.key===Re)if(L.tag===4&&L.stateNode.containerInfo===z.containerInfo&&L.stateNode.implementation===z.implementation){d(F,L.sibling),L=_(L,z.children||[]),L.return=F,F=L;break e}else{d(F,L);break}else l(F,L);L=L.sibling}L=Tp(z,F.mode,ie),L.return=F,F=L}return C(F);case q:return Re=z._init,vt(F,L,Re(z._payload),ie)}if(lr(z))return be(F,L,z,ie);if(B(z))return xe(F,L,z,ie);dc(F,z)}return typeof z=="string"&&z!==""||typeof z=="number"?(z=""+z,L!==null&&L.tag===6?(d(F,L.sibling),L=_(L,z),L.return=F,F=L):(d(F,L),L=Op(z,F.mode,ie),L.return=F,F=L),C(F)):d(F,L)}return vt}var xi=Ub(!0),zb=Ub(!1),fc=Bs(null),hc=null,Si=null,Fh=null;function Uh(){Fh=Si=hc=null}function zh(i){var l=fc.current;ut(fc),i._currentValue=l}function Bh(i,l,d){for(;i!==null;){var p=i.alternate;if((i.childLanes&l)!==l?(i.childLanes|=l,p!==null&&(p.childLanes|=l)):p!==null&&(p.childLanes&l)!==l&&(p.childLanes|=l),i===d)break;i=i.return}}function Ei(i,l){hc=i,Fh=Si=null,i=i.dependencies,i!==null&&i.firstContext!==null&&(i.lanes&l&&(Sn=!0),i.firstContext=null)}function Kn(i){var l=i._currentValue;if(Fh!==i)if(i={context:i,memoizedValue:l,next:null},Si===null){if(hc===null)throw Error(t(308));Si=i,hc.dependencies={lanes:0,firstContext:i}}else Si=Si.next=i;return l}var Ca=null;function Hh(i){Ca===null?Ca=[i]:Ca.push(i)}function Bb(i,l,d,p){var _=l.interleaved;return _===null?(d.next=d,Hh(l)):(d.next=_.next,_.next=d),l.interleaved=d,gs(i,p)}function gs(i,l){i.lanes|=l;var d=i.alternate;for(d!==null&&(d.lanes|=l),d=i,i=i.return;i!==null;)i.childLanes|=l,d=i.alternate,d!==null&&(d.childLanes|=l),d=i,i=i.return;return d.tag===3?d.stateNode:null}var Ws=!1;function Vh(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Hb(i,l){i=i.updateQueue,l.updateQueue===i&&(l.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function ys(i,l){return{eventTime:i,lane:l,tag:0,payload:null,callback:null,next:null}}function qs(i,l,d){var p=i.updateQueue;if(p===null)return null;if(p=p.shared,Ve&2){var _=p.pending;return _===null?l.next=l:(l.next=_.next,_.next=l),p.pending=l,gs(i,d)}return _=p.interleaved,_===null?(l.next=l,Hh(p)):(l.next=_.next,_.next=l),p.interleaved=l,gs(i,d)}function pc(i,l,d){if(l=l.updateQueue,l!==null&&(l=l.shared,(d&4194240)!==0)){var p=l.lanes;p&=i.pendingLanes,d|=p,l.lanes=d,sh(i,d)}}function Vb(i,l){var d=i.updateQueue,p=i.alternate;if(p!==null&&(p=p.updateQueue,d===p)){var _=null,b=null;if(d=d.firstBaseUpdate,d!==null){do{var C={eventTime:d.eventTime,lane:d.lane,tag:d.tag,payload:d.payload,callback:d.callback,next:null};b===null?_=b=C:b=b.next=C,d=d.next}while(d!==null);b===null?_=b=l:b=b.next=l}else _=b=l;d={baseState:p.baseState,firstBaseUpdate:_,lastBaseUpdate:b,shared:p.shared,effects:p.effects},i.updateQueue=d;return}i=d.lastBaseUpdate,i===null?d.firstBaseUpdate=l:i.next=l,d.lastBaseUpdate=l}function mc(i,l,d,p){var _=i.updateQueue;Ws=!1;var b=_.firstBaseUpdate,C=_.lastBaseUpdate,T=_.shared.pending;if(T!==null){_.shared.pending=null;var N=T,H=N.next;N.next=null,C===null?b=H:C.next=H,C=N;var te=i.alternate;te!==null&&(te=te.updateQueue,T=te.lastBaseUpdate,T!==C&&(T===null?te.firstBaseUpdate=H:T.next=H,te.lastBaseUpdate=N))}if(b!==null){var ne=_.baseState;C=0,te=H=N=null,T=b;do{var ee=T.lane,me=T.eventTime;if((p&ee)===ee){te!==null&&(te=te.next={eventTime:me,lane:0,tag:T.tag,payload:T.payload,callback:T.callback,next:null});e:{var be=i,xe=T;switch(ee=l,me=d,xe.tag){case 1:if(be=xe.payload,typeof be=="function"){ne=be.call(me,ne,ee);break e}ne=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=xe.payload,ee=typeof be=="function"?be.call(me,ne,ee):be,ee==null)break e;ne=V({},ne,ee);break e;case 2:Ws=!0}}T.callback!==null&&T.lane!==0&&(i.flags|=64,ee=_.effects,ee===null?_.effects=[T]:ee.push(T))}else me={eventTime:me,lane:ee,tag:T.tag,payload:T.payload,callback:T.callback,next:null},te===null?(H=te=me,N=ne):te=te.next=me,C|=ee;if(T=T.next,T===null){if(T=_.shared.pending,T===null)break;ee=T,T=ee.next,ee.next=null,_.lastBaseUpdate=ee,_.shared.pending=null}}while(!0);if(te===null&&(N=ne),_.baseState=N,_.firstBaseUpdate=H,_.lastBaseUpdate=te,l=_.shared.interleaved,l!==null){_=l;do C|=_.lane,_=_.next;while(_!==l)}else b===null&&(_.shared.lanes=0);Ra|=C,i.lanes=C,i.memoizedState=ne}}function Wb(i,l,d){if(i=l.effects,l.effects=null,i!==null)for(l=0;l<i.length;l++){var p=i[l],_=p.callback;if(_!==null){if(p.callback=null,p=d,typeof _!="function")throw Error(t(191,_));_.call(p)}}}var el={},Ur=Bs(el),tl=Bs(el),nl=Bs(el);function Pa(i){if(i===el)throw Error(t(174));return i}function Wh(i,l){switch(at(nl,l),at(tl,i),at(Ur,el),i=l.nodeType,i){case 9:case 11:l=(l=l.documentElement)?l.namespaceURI:$n(null,"");break;default:i=i===8?l.parentNode:l,l=i.namespaceURI||null,i=i.tagName,l=$n(l,i)}ut(Ur),at(Ur,l)}function Ci(){ut(Ur),ut(tl),ut(nl)}function qb(i){Pa(nl.current);var l=Pa(Ur.current),d=$n(l,i.type);l!==d&&(at(tl,i),at(Ur,d))}function qh(i){tl.current===i&&(ut(Ur),ut(tl))}var ft=Bs(0);function gc(i){for(var l=i;l!==null;){if(l.tag===13){var d=l.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if(l.flags&128)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Zh=[];function Gh(){for(var i=0;i<Zh.length;i++)Zh[i]._workInProgressVersionPrimary=null;Zh.length=0}var yc=R.ReactCurrentDispatcher,Jh=R.ReactCurrentBatchConfig,ka=0,ht=null,Rt=null,jt=null,_c=!1,rl=!1,sl=0,XR=0;function Qt(){throw Error(t(321))}function Kh(i,l){if(l===null)return!1;for(var d=0;d<l.length&&d<i.length;d++)if(!cr(i[d],l[d]))return!1;return!0}function Xh(i,l,d,p,_,b){if(ka=b,ht=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,yc.current=i===null||i.memoizedState===null?tO:nO,i=d(p,_),rl){b=0;do{if(rl=!1,sl=0,25<=b)throw Error(t(301));b+=1,jt=Rt=null,l.updateQueue=null,yc.current=rO,i=d(p,_)}while(rl)}if(yc.current=vc,l=Rt!==null&&Rt.next!==null,ka=0,jt=Rt=ht=null,_c=!1,l)throw Error(t(300));return i}function Yh(){var i=sl!==0;return sl=0,i}function zr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?ht.memoizedState=jt=i:jt=jt.next=i,jt}function Xn(){if(Rt===null){var i=ht.alternate;i=i!==null?i.memoizedState:null}else i=Rt.next;var l=jt===null?ht.memoizedState:jt.next;if(l!==null)jt=l,Rt=i;else{if(i===null)throw Error(t(310));Rt=i,i={memoizedState:Rt.memoizedState,baseState:Rt.baseState,baseQueue:Rt.baseQueue,queue:Rt.queue,next:null},jt===null?ht.memoizedState=jt=i:jt=jt.next=i}return jt}function al(i,l){return typeof l=="function"?l(i):l}function Qh(i){var l=Xn(),d=l.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=i;var p=Rt,_=p.baseQueue,b=d.pending;if(b!==null){if(_!==null){var C=_.next;_.next=b.next,b.next=C}p.baseQueue=_=b,d.pending=null}if(_!==null){b=_.next,p=p.baseState;var T=C=null,N=null,H=b;do{var te=H.lane;if((ka&te)===te)N!==null&&(N=N.next={lane:0,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null}),p=H.hasEagerState?H.eagerState:i(p,H.action);else{var ne={lane:te,action:H.action,hasEagerState:H.hasEagerState,eagerState:H.eagerState,next:null};N===null?(T=N=ne,C=p):N=N.next=ne,ht.lanes|=te,Ra|=te}H=H.next}while(H!==null&&H!==b);N===null?C=p:N.next=T,cr(p,l.memoizedState)||(Sn=!0),l.memoizedState=p,l.baseState=C,l.baseQueue=N,d.lastRenderedState=p}if(i=d.interleaved,i!==null){_=i;do b=_.lane,ht.lanes|=b,Ra|=b,_=_.next;while(_!==i)}else _===null&&(d.lanes=0);return[l.memoizedState,d.dispatch]}function ep(i){var l=Xn(),d=l.queue;if(d===null)throw Error(t(311));d.lastRenderedReducer=i;var p=d.dispatch,_=d.pending,b=l.memoizedState;if(_!==null){d.pending=null;var C=_=_.next;do b=i(b,C.action),C=C.next;while(C!==_);cr(b,l.memoizedState)||(Sn=!0),l.memoizedState=b,l.baseQueue===null&&(l.baseState=b),d.lastRenderedState=b}return[b,p]}function Zb(){}function Gb(i,l){var d=ht,p=Xn(),_=l(),b=!cr(p.memoizedState,_);if(b&&(p.memoizedState=_,Sn=!0),p=p.queue,tp(Xb.bind(null,d,p,i),[i]),p.getSnapshot!==l||b||jt!==null&&jt.memoizedState.tag&1){if(d.flags|=2048,il(9,Kb.bind(null,d,p,_,l),void 0,null),Lt===null)throw Error(t(349));ka&30||Jb(d,l,_)}return _}function Jb(i,l,d){i.flags|=16384,i={getSnapshot:l,value:d},l=ht.updateQueue,l===null?(l={lastEffect:null,stores:null},ht.updateQueue=l,l.stores=[i]):(d=l.stores,d===null?l.stores=[i]:d.push(i))}function Kb(i,l,d,p){l.value=d,l.getSnapshot=p,Yb(l)&&Qb(i)}function Xb(i,l,d){return d(function(){Yb(l)&&Qb(i)})}function Yb(i){var l=i.getSnapshot;i=i.value;try{var d=l();return!cr(i,d)}catch{return!0}}function Qb(i){var l=gs(i,1);l!==null&&mr(l,i,1,-1)}function ev(i){var l=zr();return typeof i=="function"&&(i=i()),l.memoizedState=l.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:al,lastRenderedState:i},l.queue=i,i=i.dispatch=eO.bind(null,ht,i),[l.memoizedState,i]}function il(i,l,d,p){return i={tag:i,create:l,destroy:d,deps:p,next:null},l=ht.updateQueue,l===null?(l={lastEffect:null,stores:null},ht.updateQueue=l,l.lastEffect=i.next=i):(d=l.lastEffect,d===null?l.lastEffect=i.next=i:(p=d.next,d.next=i,i.next=p,l.lastEffect=i)),i}function tv(){return Xn().memoizedState}function wc(i,l,d,p){var _=zr();ht.flags|=i,_.memoizedState=il(1|l,d,void 0,p===void 0?null:p)}function bc(i,l,d,p){var _=Xn();p=p===void 0?null:p;var b=void 0;if(Rt!==null){var C=Rt.memoizedState;if(b=C.destroy,p!==null&&Kh(p,C.deps)){_.memoizedState=il(l,d,b,p);return}}ht.flags|=i,_.memoizedState=il(1|l,d,b,p)}function nv(i,l){return wc(8390656,8,i,l)}function tp(i,l){return bc(2048,8,i,l)}function rv(i,l){return bc(4,2,i,l)}function sv(i,l){return bc(4,4,i,l)}function av(i,l){if(typeof l=="function")return i=i(),l(i),function(){l(null)};if(l!=null)return i=i(),l.current=i,function(){l.current=null}}function iv(i,l,d){return d=d!=null?d.concat([i]):null,bc(4,4,av.bind(null,l,i),d)}function np(){}function ov(i,l){var d=Xn();l=l===void 0?null:l;var p=d.memoizedState;return p!==null&&l!==null&&Kh(l,p[1])?p[0]:(d.memoizedState=[i,l],i)}function lv(i,l){var d=Xn();l=l===void 0?null:l;var p=d.memoizedState;return p!==null&&l!==null&&Kh(l,p[1])?p[0]:(i=i(),d.memoizedState=[i,l],i)}function uv(i,l,d){return ka&21?(cr(d,l)||(d=Fw(),ht.lanes|=d,Ra|=d,i.baseState=!0),l):(i.baseState&&(i.baseState=!1,Sn=!0),i.memoizedState=d)}function YR(i,l){var d=Je;Je=d!==0&&4>d?d:4,i(!0);var p=Jh.transition;Jh.transition={};try{i(!1),l()}finally{Je=d,Jh.transition=p}}function cv(){return Xn().memoizedState}function QR(i,l,d){var p=Ks(i);if(d={lane:p,action:d,hasEagerState:!1,eagerState:null,next:null},dv(i))fv(l,d);else if(d=Bb(i,l,d,p),d!==null){var _=cn();mr(d,i,p,_),hv(d,l,p)}}function eO(i,l,d){var p=Ks(i),_={lane:p,action:d,hasEagerState:!1,eagerState:null,next:null};if(dv(i))fv(l,_);else{var b=i.alternate;if(i.lanes===0&&(b===null||b.lanes===0)&&(b=l.lastRenderedReducer,b!==null))try{var C=l.lastRenderedState,T=b(C,d);if(_.hasEagerState=!0,_.eagerState=T,cr(T,C)){var N=l.interleaved;N===null?(_.next=_,Hh(l)):(_.next=N.next,N.next=_),l.interleaved=_;return}}catch{}finally{}d=Bb(i,l,_,p),d!==null&&(_=cn(),mr(d,i,p,_),hv(d,l,p))}}function dv(i){var l=i.alternate;return i===ht||l!==null&&l===ht}function fv(i,l){rl=_c=!0;var d=i.pending;d===null?l.next=l:(l.next=d.next,d.next=l),i.pending=l}function hv(i,l,d){if(d&4194240){var p=l.lanes;p&=i.pendingLanes,d|=p,l.lanes=d,sh(i,d)}}var vc={readContext:Kn,useCallback:Qt,useContext:Qt,useEffect:Qt,useImperativeHandle:Qt,useInsertionEffect:Qt,useLayoutEffect:Qt,useMemo:Qt,useReducer:Qt,useRef:Qt,useState:Qt,useDebugValue:Qt,useDeferredValue:Qt,useTransition:Qt,useMutableSource:Qt,useSyncExternalStore:Qt,useId:Qt,unstable_isNewReconciler:!1},tO={readContext:Kn,useCallback:function(i,l){return zr().memoizedState=[i,l===void 0?null:l],i},useContext:Kn,useEffect:nv,useImperativeHandle:function(i,l,d){return d=d!=null?d.concat([i]):null,wc(4194308,4,av.bind(null,l,i),d)},useLayoutEffect:function(i,l){return wc(4194308,4,i,l)},useInsertionEffect:function(i,l){return wc(4,2,i,l)},useMemo:function(i,l){var d=zr();return l=l===void 0?null:l,i=i(),d.memoizedState=[i,l],i},useReducer:function(i,l,d){var p=zr();return l=d!==void 0?d(l):l,p.memoizedState=p.baseState=l,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:l},p.queue=i,i=i.dispatch=QR.bind(null,ht,i),[p.memoizedState,i]},useRef:function(i){var l=zr();return i={current:i},l.memoizedState=i},useState:ev,useDebugValue:np,useDeferredValue:function(i){return zr().memoizedState=i},useTransition:function(){var i=ev(!1),l=i[0];return i=YR.bind(null,i[1]),zr().memoizedState=i,[l,i]},useMutableSource:function(){},useSyncExternalStore:function(i,l,d){var p=ht,_=zr();if(ct){if(d===void 0)throw Error(t(407));d=d()}else{if(d=l(),Lt===null)throw Error(t(349));ka&30||Jb(p,l,d)}_.memoizedState=d;var b={value:d,getSnapshot:l};return _.queue=b,nv(Xb.bind(null,p,b,i),[i]),p.flags|=2048,il(9,Kb.bind(null,p,b,d,l),void 0,null),d},useId:function(){var i=zr(),l=Lt.identifierPrefix;if(ct){var d=ms,p=ps;d=(p&~(1<<32-ur(p)-1)).toString(32)+d,l=":"+l+"R"+d,d=sl++,0<d&&(l+="H"+d.toString(32)),l+=":"}else d=XR++,l=":"+l+"r"+d.toString(32)+":";return i.memoizedState=l},unstable_isNewReconciler:!1},nO={readContext:Kn,useCallback:ov,useContext:Kn,useEffect:tp,useImperativeHandle:iv,useInsertionEffect:rv,useLayoutEffect:sv,useMemo:lv,useReducer:Qh,useRef:tv,useState:function(){return Qh(al)},useDebugValue:np,useDeferredValue:function(i){var l=Xn();return uv(l,Rt.memoizedState,i)},useTransition:function(){var i=Qh(al)[0],l=Xn().memoizedState;return[i,l]},useMutableSource:Zb,useSyncExternalStore:Gb,useId:cv,unstable_isNewReconciler:!1},rO={readContext:Kn,useCallback:ov,useContext:Kn,useEffect:tp,useImperativeHandle:iv,useInsertionEffect:rv,useLayoutEffect:sv,useMemo:lv,useReducer:ep,useRef:tv,useState:function(){return ep(al)},useDebugValue:np,useDeferredValue:function(i){var l=Xn();return Rt===null?l.memoizedState=i:uv(l,Rt.memoizedState,i)},useTransition:function(){var i=ep(al)[0],l=Xn().memoizedState;return[i,l]},useMutableSource:Zb,useSyncExternalStore:Gb,useId:cv,unstable_isNewReconciler:!1};function fr(i,l){if(i&&i.defaultProps){l=V({},l),i=i.defaultProps;for(var d in i)l[d]===void 0&&(l[d]=i[d]);return l}return l}function rp(i,l,d,p){l=i.memoizedState,d=d(p,l),d=d==null?l:V({},l,d),i.memoizedState=d,i.lanes===0&&(i.updateQueue.baseState=d)}var xc={isMounted:function(i){return(i=i._reactInternals)?ba(i)===i:!1},enqueueSetState:function(i,l,d){i=i._reactInternals;var p=cn(),_=Ks(i),b=ys(p,_);b.payload=l,d!=null&&(b.callback=d),l=qs(i,b,_),l!==null&&(mr(l,i,_,p),pc(l,i,_))},enqueueReplaceState:function(i,l,d){i=i._reactInternals;var p=cn(),_=Ks(i),b=ys(p,_);b.tag=1,b.payload=l,d!=null&&(b.callback=d),l=qs(i,b,_),l!==null&&(mr(l,i,_,p),pc(l,i,_))},enqueueForceUpdate:function(i,l){i=i._reactInternals;var d=cn(),p=Ks(i),_=ys(d,p);_.tag=2,l!=null&&(_.callback=l),l=qs(i,_,p),l!==null&&(mr(l,i,p,d),pc(l,i,p))}};function pv(i,l,d,p,_,b,C){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(p,b,C):l.prototype&&l.prototype.isPureReactComponent?!qo(d,p)||!qo(_,b):!0}function mv(i,l,d){var p=!1,_=Hs,b=l.contextType;return typeof b=="object"&&b!==null?b=Kn(b):(_=xn(l)?xa:Yt.current,p=l.contextTypes,b=(p=p!=null)?_i(i,_):Hs),l=new l(d,b),i.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,l.updater=xc,i.stateNode=l,l._reactInternals=i,p&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=_,i.__reactInternalMemoizedMaskedChildContext=b),l}function gv(i,l,d,p){i=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(d,p),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(d,p),l.state!==i&&xc.enqueueReplaceState(l,l.state,null)}function sp(i,l,d,p){var _=i.stateNode;_.props=d,_.state=i.memoizedState,_.refs={},Vh(i);var b=l.contextType;typeof b=="object"&&b!==null?_.context=Kn(b):(b=xn(l)?xa:Yt.current,_.context=_i(i,b)),_.state=i.memoizedState,b=l.getDerivedStateFromProps,typeof b=="function"&&(rp(i,l,b,d),_.state=i.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(l=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),l!==_.state&&xc.enqueueReplaceState(_,_.state,null),mc(i,d,_,p),_.state=i.memoizedState),typeof _.componentDidMount=="function"&&(i.flags|=4194308)}function Pi(i,l){try{var d="",p=l;do d+=de(p),p=p.return;while(p);var _=d}catch(b){_=`
Error generating stack: `+b.message+`
`+b.stack}return{value:i,source:l,stack:_,digest:null}}function ap(i,l,d){return{value:i,source:null,stack:d??null,digest:l??null}}function ip(i,l){try{console.error(l.value)}catch(d){setTimeout(function(){throw d})}}var sO=typeof WeakMap=="function"?WeakMap:Map;function yv(i,l,d){d=ys(-1,d),d.tag=3,d.payload={element:null};var p=l.value;return d.callback=function(){Oc||(Oc=!0,vp=p),ip(i,l)},d}function _v(i,l,d){d=ys(-1,d),d.tag=3;var p=i.type.getDerivedStateFromError;if(typeof p=="function"){var _=l.value;d.payload=function(){return p(_)},d.callback=function(){ip(i,l)}}var b=i.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(d.callback=function(){ip(i,l),typeof p!="function"&&(Gs===null?Gs=new Set([this]):Gs.add(this));var C=l.stack;this.componentDidCatch(l.value,{componentStack:C!==null?C:""})}),d}function wv(i,l,d){var p=i.pingCache;if(p===null){p=i.pingCache=new sO;var _=new Set;p.set(l,_)}else _=p.get(l),_===void 0&&(_=new Set,p.set(l,_));_.has(d)||(_.add(d),i=_O.bind(null,i,l,d),l.then(i,i))}function bv(i){do{var l;if((l=i.tag===13)&&(l=i.memoizedState,l=l!==null?l.dehydrated!==null:!0),l)return i;i=i.return}while(i!==null);return null}function vv(i,l,d,p,_){return i.mode&1?(i.flags|=65536,i.lanes=_,i):(i===l?i.flags|=65536:(i.flags|=128,d.flags|=131072,d.flags&=-52805,d.tag===1&&(d.alternate===null?d.tag=17:(l=ys(-1,1),l.tag=2,qs(d,l,1))),d.lanes|=1),i)}var aO=R.ReactCurrentOwner,Sn=!1;function un(i,l,d,p){l.child=i===null?zb(l,null,d,p):xi(l,i.child,d,p)}function xv(i,l,d,p,_){d=d.render;var b=l.ref;return Ei(l,_),p=Xh(i,l,d,p,b,_),d=Yh(),i!==null&&!Sn?(l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~_,_s(i,l,_)):(ct&&d&&Nh(l),l.flags|=1,un(i,l,p,_),l.child)}function Sv(i,l,d,p,_){if(i===null){var b=d.type;return typeof b=="function"&&!Rp(b)&&b.defaultProps===void 0&&d.compare===null&&d.defaultProps===void 0?(l.tag=15,l.type=b,Ev(i,l,b,p,_)):(i=jc(d.type,null,p,l,l.mode,_),i.ref=l.ref,i.return=l,l.child=i)}if(b=i.child,!(i.lanes&_)){var C=b.memoizedProps;if(d=d.compare,d=d!==null?d:qo,d(C,p)&&i.ref===l.ref)return _s(i,l,_)}return l.flags|=1,i=Ys(b,p),i.ref=l.ref,i.return=l,l.child=i}function Ev(i,l,d,p,_){if(i!==null){var b=i.memoizedProps;if(qo(b,p)&&i.ref===l.ref)if(Sn=!1,l.pendingProps=p=b,(i.lanes&_)!==0)i.flags&131072&&(Sn=!0);else return l.lanes=i.lanes,_s(i,l,_)}return op(i,l,d,p,_)}function Cv(i,l,d){var p=l.pendingProps,_=p.children,b=i!==null?i.memoizedState:null;if(p.mode==="hidden")if(!(l.mode&1))l.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(Ri,Ln),Ln|=d;else{if(!(d&1073741824))return i=b!==null?b.baseLanes|d:d,l.lanes=l.childLanes=1073741824,l.memoizedState={baseLanes:i,cachePool:null,transitions:null},l.updateQueue=null,at(Ri,Ln),Ln|=i,null;l.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=b!==null?b.baseLanes:d,at(Ri,Ln),Ln|=p}else b!==null?(p=b.baseLanes|d,l.memoizedState=null):p=d,at(Ri,Ln),Ln|=p;return un(i,l,_,d),l.child}function Pv(i,l){var d=l.ref;(i===null&&d!==null||i!==null&&i.ref!==d)&&(l.flags|=512,l.flags|=2097152)}function op(i,l,d,p,_){var b=xn(d)?xa:Yt.current;return b=_i(l,b),Ei(l,_),d=Xh(i,l,d,p,b,_),p=Yh(),i!==null&&!Sn?(l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~_,_s(i,l,_)):(ct&&p&&Nh(l),l.flags|=1,un(i,l,d,_),l.child)}function kv(i,l,d,p,_){if(xn(d)){var b=!0;ic(l)}else b=!1;if(Ei(l,_),l.stateNode===null)Ec(i,l),mv(l,d,p),sp(l,d,p,_),p=!0;else if(i===null){var C=l.stateNode,T=l.memoizedProps;C.props=T;var N=C.context,H=d.contextType;typeof H=="object"&&H!==null?H=Kn(H):(H=xn(d)?xa:Yt.current,H=_i(l,H));var te=d.getDerivedStateFromProps,ne=typeof te=="function"||typeof C.getSnapshotBeforeUpdate=="function";ne||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(T!==p||N!==H)&&gv(l,C,p,H),Ws=!1;var ee=l.memoizedState;C.state=ee,mc(l,p,C,_),N=l.memoizedState,T!==p||ee!==N||vn.current||Ws?(typeof te=="function"&&(rp(l,d,te,p),N=l.memoizedState),(T=Ws||pv(l,d,T,p,ee,N,H))?(ne||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(l.flags|=4194308)):(typeof C.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=p,l.memoizedState=N),C.props=p,C.state=N,C.context=H,p=T):(typeof C.componentDidMount=="function"&&(l.flags|=4194308),p=!1)}else{C=l.stateNode,Hb(i,l),T=l.memoizedProps,H=l.type===l.elementType?T:fr(l.type,T),C.props=H,ne=l.pendingProps,ee=C.context,N=d.contextType,typeof N=="object"&&N!==null?N=Kn(N):(N=xn(d)?xa:Yt.current,N=_i(l,N));var me=d.getDerivedStateFromProps;(te=typeof me=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(T!==ne||ee!==N)&&gv(l,C,p,N),Ws=!1,ee=l.memoizedState,C.state=ee,mc(l,p,C,_);var be=l.memoizedState;T!==ne||ee!==be||vn.current||Ws?(typeof me=="function"&&(rp(l,d,me,p),be=l.memoizedState),(H=Ws||pv(l,d,H,p,ee,be,N)||!1)?(te||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(p,be,N),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(p,be,N)),typeof C.componentDidUpdate=="function"&&(l.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof C.componentDidUpdate!="function"||T===i.memoizedProps&&ee===i.memoizedState||(l.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||T===i.memoizedProps&&ee===i.memoizedState||(l.flags|=1024),l.memoizedProps=p,l.memoizedState=be),C.props=p,C.state=be,C.context=N,p=H):(typeof C.componentDidUpdate!="function"||T===i.memoizedProps&&ee===i.memoizedState||(l.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||T===i.memoizedProps&&ee===i.memoizedState||(l.flags|=1024),p=!1)}return lp(i,l,d,p,b,_)}function lp(i,l,d,p,_,b){Pv(i,l);var C=(l.flags&128)!==0;if(!p&&!C)return _&&$b(l,d,!1),_s(i,l,b);p=l.stateNode,aO.current=l;var T=C&&typeof d.getDerivedStateFromError!="function"?null:p.render();return l.flags|=1,i!==null&&C?(l.child=xi(l,i.child,null,b),l.child=xi(l,null,T,b)):un(i,l,T,b),l.memoizedState=p.state,_&&$b(l,d,!0),l.child}function Rv(i){var l=i.stateNode;l.pendingContext?Tb(i,l.pendingContext,l.pendingContext!==l.context):l.context&&Tb(i,l.context,!1),Wh(i,l.containerInfo)}function Ov(i,l,d,p,_){return vi(),Dh(_),l.flags|=256,un(i,l,d,p),l.child}var up={dehydrated:null,treeContext:null,retryLane:0};function cp(i){return{baseLanes:i,cachePool:null,transitions:null}}function Tv(i,l,d){var p=l.pendingProps,_=ft.current,b=!1,C=(l.flags&128)!==0,T;if((T=C)||(T=i!==null&&i.memoizedState===null?!1:(_&2)!==0),T?(b=!0,l.flags&=-129):(i===null||i.memoizedState!==null)&&(_|=1),at(ft,_&1),i===null)return Mh(l),i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?(l.mode&1?i.data==="$!"?l.lanes=8:l.lanes=1073741824:l.lanes=1,null):(C=p.children,i=p.fallback,b?(p=l.mode,b=l.child,C={mode:"hidden",children:C},!(p&1)&&b!==null?(b.childLanes=0,b.pendingProps=C):b=Lc(C,p,0,null),i=$a(i,p,d,null),b.return=l,i.return=l,b.sibling=i,l.child=b,l.child.memoizedState=cp(d),l.memoizedState=up,i):dp(l,C));if(_=i.memoizedState,_!==null&&(T=_.dehydrated,T!==null))return iO(i,l,C,p,T,_,d);if(b){b=p.fallback,C=l.mode,_=i.child,T=_.sibling;var N={mode:"hidden",children:p.children};return!(C&1)&&l.child!==_?(p=l.child,p.childLanes=0,p.pendingProps=N,l.deletions=null):(p=Ys(_,N),p.subtreeFlags=_.subtreeFlags&14680064),T!==null?b=Ys(T,b):(b=$a(b,C,d,null),b.flags|=2),b.return=l,p.return=l,p.sibling=b,l.child=p,p=b,b=l.child,C=i.child.memoizedState,C=C===null?cp(d):{baseLanes:C.baseLanes|d,cachePool:null,transitions:C.transitions},b.memoizedState=C,b.childLanes=i.childLanes&~d,l.memoizedState=up,p}return b=i.child,i=b.sibling,p=Ys(b,{mode:"visible",children:p.children}),!(l.mode&1)&&(p.lanes=d),p.return=l,p.sibling=null,i!==null&&(d=l.deletions,d===null?(l.deletions=[i],l.flags|=16):d.push(i)),l.child=p,l.memoizedState=null,p}function dp(i,l){return l=Lc({mode:"visible",children:l},i.mode,0,null),l.return=i,i.child=l}function Sc(i,l,d,p){return p!==null&&Dh(p),xi(l,i.child,null,d),i=dp(l,l.pendingProps.children),i.flags|=2,l.memoizedState=null,i}function iO(i,l,d,p,_,b,C){if(d)return l.flags&256?(l.flags&=-257,p=ap(Error(t(422))),Sc(i,l,C,p)):l.memoizedState!==null?(l.child=i.child,l.flags|=128,null):(b=p.fallback,_=l.mode,p=Lc({mode:"visible",children:p.children},_,0,null),b=$a(b,_,C,null),b.flags|=2,p.return=l,b.return=l,p.sibling=b,l.child=p,l.mode&1&&xi(l,i.child,null,C),l.child.memoizedState=cp(C),l.memoizedState=up,b);if(!(l.mode&1))return Sc(i,l,C,null);if(_.data==="$!"){if(p=_.nextSibling&&_.nextSibling.dataset,p)var T=p.dgst;return p=T,b=Error(t(419)),p=ap(b,p,void 0),Sc(i,l,C,p)}if(T=(C&i.childLanes)!==0,Sn||T){if(p=Lt,p!==null){switch(C&-C){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(p.suspendedLanes|C)?0:_,_!==0&&_!==b.retryLane&&(b.retryLane=_,gs(i,_),mr(p,i,_,-1))}return kp(),p=ap(Error(t(421))),Sc(i,l,C,p)}return _.data==="$?"?(l.flags|=128,l.child=i.child,l=wO.bind(null,i),_._reactRetry=l,null):(i=b.treeContext,jn=zs(_.nextSibling),Nn=l,ct=!0,dr=null,i!==null&&(Gn[Jn++]=ps,Gn[Jn++]=ms,Gn[Jn++]=Sa,ps=i.id,ms=i.overflow,Sa=l),l=dp(l,p.children),l.flags|=4096,l)}function Av(i,l,d){i.lanes|=l;var p=i.alternate;p!==null&&(p.lanes|=l),Bh(i.return,l,d)}function fp(i,l,d,p,_){var b=i.memoizedState;b===null?i.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:p,tail:d,tailMode:_}:(b.isBackwards=l,b.rendering=null,b.renderingStartTime=0,b.last=p,b.tail=d,b.tailMode=_)}function $v(i,l,d){var p=l.pendingProps,_=p.revealOrder,b=p.tail;if(un(i,l,p.children,d),p=ft.current,p&2)p=p&1|2,l.flags|=128;else{if(i!==null&&i.flags&128)e:for(i=l.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Av(i,d,l);else if(i.tag===19)Av(i,d,l);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===l)break e;for(;i.sibling===null;){if(i.return===null||i.return===l)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}p&=1}if(at(ft,p),!(l.mode&1))l.memoizedState=null;else switch(_){case"forwards":for(d=l.child,_=null;d!==null;)i=d.alternate,i!==null&&gc(i)===null&&(_=d),d=d.sibling;d=_,d===null?(_=l.child,l.child=null):(_=d.sibling,d.sibling=null),fp(l,!1,_,d,b);break;case"backwards":for(d=null,_=l.child,l.child=null;_!==null;){if(i=_.alternate,i!==null&&gc(i)===null){l.child=_;break}i=_.sibling,_.sibling=d,d=_,_=i}fp(l,!0,d,null,b);break;case"together":fp(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function Ec(i,l){!(l.mode&1)&&i!==null&&(i.alternate=null,l.alternate=null,l.flags|=2)}function _s(i,l,d){if(i!==null&&(l.dependencies=i.dependencies),Ra|=l.lanes,!(d&l.childLanes))return null;if(i!==null&&l.child!==i.child)throw Error(t(153));if(l.child!==null){for(i=l.child,d=Ys(i,i.pendingProps),l.child=d,d.return=l;i.sibling!==null;)i=i.sibling,d=d.sibling=Ys(i,i.pendingProps),d.return=l;d.sibling=null}return l.child}function oO(i,l,d){switch(l.tag){case 3:Rv(l),vi();break;case 5:qb(l);break;case 1:xn(l.type)&&ic(l);break;case 4:Wh(l,l.stateNode.containerInfo);break;case 10:var p=l.type._context,_=l.memoizedProps.value;at(fc,p._currentValue),p._currentValue=_;break;case 13:if(p=l.memoizedState,p!==null)return p.dehydrated!==null?(at(ft,ft.current&1),l.flags|=128,null):d&l.child.childLanes?Tv(i,l,d):(at(ft,ft.current&1),i=_s(i,l,d),i!==null?i.sibling:null);at(ft,ft.current&1);break;case 19:if(p=(d&l.childLanes)!==0,i.flags&128){if(p)return $v(i,l,d);l.flags|=128}if(_=l.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),at(ft,ft.current),p)break;return null;case 22:case 23:return l.lanes=0,Cv(i,l,d)}return _s(i,l,d)}var Iv,hp,Nv,jv;Iv=function(i,l){for(var d=l.child;d!==null;){if(d.tag===5||d.tag===6)i.appendChild(d.stateNode);else if(d.tag!==4&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===l)break;for(;d.sibling===null;){if(d.return===null||d.return===l)return;d=d.return}d.sibling.return=d.return,d=d.sibling}},hp=function(){},Nv=function(i,l,d,p){var _=i.memoizedProps;if(_!==p){i=l.stateNode,Pa(Ur.current);var b=null;switch(d){case"input":_=Qe(i,_),p=Qe(i,p),b=[];break;case"select":_=V({},_,{value:void 0}),p=V({},p,{value:void 0}),b=[];break;case"textarea":_=Is(i,_),p=Is(i,p),b=[];break;default:typeof _.onClick!="function"&&typeof p.onClick=="function"&&(i.onclick=rc)}Zf(d,p);var C;d=null;for(H in _)if(!p.hasOwnProperty(H)&&_.hasOwnProperty(H)&&_[H]!=null)if(H==="style"){var T=_[H];for(C in T)T.hasOwnProperty(C)&&(d||(d={}),d[C]="")}else H!=="dangerouslySetInnerHTML"&&H!=="children"&&H!=="suppressContentEditableWarning"&&H!=="suppressHydrationWarning"&&H!=="autoFocus"&&(s.hasOwnProperty(H)?b||(b=[]):(b=b||[]).push(H,null));for(H in p){var N=p[H];if(T=_!=null?_[H]:void 0,p.hasOwnProperty(H)&&N!==T&&(N!=null||T!=null))if(H==="style")if(T){for(C in T)!T.hasOwnProperty(C)||N&&N.hasOwnProperty(C)||(d||(d={}),d[C]="");for(C in N)N.hasOwnProperty(C)&&T[C]!==N[C]&&(d||(d={}),d[C]=N[C])}else d||(b||(b=[]),b.push(H,d)),d=N;else H==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,T=T?T.__html:void 0,N!=null&&T!==N&&(b=b||[]).push(H,N)):H==="children"?typeof N!="string"&&typeof N!="number"||(b=b||[]).push(H,""+N):H!=="suppressContentEditableWarning"&&H!=="suppressHydrationWarning"&&(s.hasOwnProperty(H)?(N!=null&&H==="onScroll"&&lt("scroll",i),b||T===N||(b=[])):(b=b||[]).push(H,N))}d&&(b=b||[]).push("style",d);var H=b;(l.updateQueue=H)&&(l.flags|=4)}},jv=function(i,l,d,p){d!==p&&(l.flags|=4)};function ol(i,l){if(!ct)switch(i.tailMode){case"hidden":l=i.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?i.tail=null:d.sibling=null;break;case"collapsed":d=i.tail;for(var p=null;d!==null;)d.alternate!==null&&(p=d),d=d.sibling;p===null?l||i.tail===null?i.tail=null:i.tail.sibling=null:p.sibling=null}}function en(i){var l=i.alternate!==null&&i.alternate.child===i.child,d=0,p=0;if(l)for(var _=i.child;_!==null;)d|=_.lanes|_.childLanes,p|=_.subtreeFlags&14680064,p|=_.flags&14680064,_.return=i,_=_.sibling;else for(_=i.child;_!==null;)d|=_.lanes|_.childLanes,p|=_.subtreeFlags,p|=_.flags,_.return=i,_=_.sibling;return i.subtreeFlags|=p,i.childLanes=d,l}function lO(i,l,d){var p=l.pendingProps;switch(jh(l),l.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return en(l),null;case 1:return xn(l.type)&&ac(),en(l),null;case 3:return p=l.stateNode,Ci(),ut(vn),ut(Yt),Gh(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(i===null||i.child===null)&&(cc(l)?l.flags|=4:i===null||i.memoizedState.isDehydrated&&!(l.flags&256)||(l.flags|=1024,dr!==null&&(Ep(dr),dr=null))),hp(i,l),en(l),null;case 5:qh(l);var _=Pa(nl.current);if(d=l.type,i!==null&&l.stateNode!=null)Nv(i,l,d,p,_),i.ref!==l.ref&&(l.flags|=512,l.flags|=2097152);else{if(!p){if(l.stateNode===null)throw Error(t(166));return en(l),null}if(i=Pa(Ur.current),cc(l)){p=l.stateNode,d=l.type;var b=l.memoizedProps;switch(p[Fr]=l,p[Xo]=b,i=(l.mode&1)!==0,d){case"dialog":lt("cancel",p),lt("close",p);break;case"iframe":case"object":case"embed":lt("load",p);break;case"video":case"audio":for(_=0;_<Go.length;_++)lt(Go[_],p);break;case"source":lt("error",p);break;case"img":case"image":case"link":lt("error",p),lt("load",p);break;case"details":lt("toggle",p);break;case"input":Ct(p,b),lt("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!b.multiple},lt("invalid",p);break;case"textarea":ii(p,b),lt("invalid",p)}Zf(d,b),_=null;for(var C in b)if(b.hasOwnProperty(C)){var T=b[C];C==="children"?typeof T=="string"?p.textContent!==T&&(b.suppressHydrationWarning!==!0&&nc(p.textContent,T,i),_=["children",T]):typeof T=="number"&&p.textContent!==""+T&&(b.suppressHydrationWarning!==!0&&nc(p.textContent,T,i),_=["children",""+T]):s.hasOwnProperty(C)&&T!=null&&C==="onScroll"&&lt("scroll",p)}switch(d){case"input":Ie(p),or(p,b,!0);break;case"textarea":Ie(p),qn(p);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(p.onclick=rc)}p=_,l.updateQueue=p,p!==null&&(l.flags|=4)}else{C=_.nodeType===9?_:_.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=ds(d)),i==="http://www.w3.org/1999/xhtml"?d==="script"?(i=C.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof p.is=="string"?i=C.createElement(d,{is:p.is}):(i=C.createElement(d),d==="select"&&(C=i,p.multiple?C.multiple=!0:p.size&&(C.size=p.size))):i=C.createElementNS(i,d),i[Fr]=l,i[Xo]=p,Iv(i,l,!1,!1),l.stateNode=i;e:{switch(C=Gf(d,p),d){case"dialog":lt("cancel",i),lt("close",i),_=p;break;case"iframe":case"object":case"embed":lt("load",i),_=p;break;case"video":case"audio":for(_=0;_<Go.length;_++)lt(Go[_],i);_=p;break;case"source":lt("error",i),_=p;break;case"img":case"image":case"link":lt("error",i),lt("load",i),_=p;break;case"details":lt("toggle",i),_=p;break;case"input":Ct(i,p),_=Qe(i,p),lt("invalid",i);break;case"option":_=p;break;case"select":i._wrapperState={wasMultiple:!!p.multiple},_=V({},p,{value:void 0}),lt("invalid",i);break;case"textarea":ii(i,p),_=Is(i,p),lt("invalid",i);break;default:_=p}Zf(d,_),T=_;for(b in T)if(T.hasOwnProperty(b)){var N=T[b];b==="style"?Zn(i,N):b==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&Ns(i,N)):b==="children"?typeof N=="string"?(d!=="textarea"||N!=="")&&yt(i,N):typeof N=="number"&&yt(i,""+N):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(s.hasOwnProperty(b)?N!=null&&b==="onScroll"&&lt("scroll",i):N!=null&&S(i,b,N,C))}switch(d){case"input":Ie(i),or(i,p,!1);break;case"textarea":Ie(i),qn(i);break;case"option":p.value!=null&&i.setAttribute("value",""+ue(p.value));break;case"select":i.multiple=!!p.multiple,b=p.value,b!=null?Pt(i,!!p.multiple,b,!1):p.defaultValue!=null&&Pt(i,!!p.multiple,p.defaultValue,!0);break;default:typeof _.onClick=="function"&&(i.onclick=rc)}switch(d){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(l.flags|=4)}l.ref!==null&&(l.flags|=512,l.flags|=2097152)}return en(l),null;case 6:if(i&&l.stateNode!=null)jv(i,l,i.memoizedProps,p);else{if(typeof p!="string"&&l.stateNode===null)throw Error(t(166));if(d=Pa(nl.current),Pa(Ur.current),cc(l)){if(p=l.stateNode,d=l.memoizedProps,p[Fr]=l,(b=p.nodeValue!==d)&&(i=Nn,i!==null))switch(i.tag){case 3:nc(p.nodeValue,d,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&nc(p.nodeValue,d,(i.mode&1)!==0)}b&&(l.flags|=4)}else p=(d.nodeType===9?d:d.ownerDocument).createTextNode(p),p[Fr]=l,l.stateNode=p}return en(l),null;case 13:if(ut(ft),p=l.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(ct&&jn!==null&&l.mode&1&&!(l.flags&128))Db(),vi(),l.flags|=98560,b=!1;else if(b=cc(l),p!==null&&p.dehydrated!==null){if(i===null){if(!b)throw Error(t(318));if(b=l.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(t(317));b[Fr]=l}else vi(),!(l.flags&128)&&(l.memoizedState=null),l.flags|=4;en(l),b=!1}else dr!==null&&(Ep(dr),dr=null),b=!0;if(!b)return l.flags&65536?l:null}return l.flags&128?(l.lanes=d,l):(p=p!==null,p!==(i!==null&&i.memoizedState!==null)&&p&&(l.child.flags|=8192,l.mode&1&&(i===null||ft.current&1?Ot===0&&(Ot=3):kp())),l.updateQueue!==null&&(l.flags|=4),en(l),null);case 4:return Ci(),hp(i,l),i===null&&Jo(l.stateNode.containerInfo),en(l),null;case 10:return zh(l.type._context),en(l),null;case 17:return xn(l.type)&&ac(),en(l),null;case 19:if(ut(ft),b=l.memoizedState,b===null)return en(l),null;if(p=(l.flags&128)!==0,C=b.rendering,C===null)if(p)ol(b,!1);else{if(Ot!==0||i!==null&&i.flags&128)for(i=l.child;i!==null;){if(C=gc(i),C!==null){for(l.flags|=128,ol(b,!1),p=C.updateQueue,p!==null&&(l.updateQueue=p,l.flags|=4),l.subtreeFlags=0,p=d,d=l.child;d!==null;)b=d,i=p,b.flags&=14680066,C=b.alternate,C===null?(b.childLanes=0,b.lanes=i,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=C.childLanes,b.lanes=C.lanes,b.child=C.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=C.memoizedProps,b.memoizedState=C.memoizedState,b.updateQueue=C.updateQueue,b.type=C.type,i=C.dependencies,b.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),d=d.sibling;return at(ft,ft.current&1|2),l.child}i=i.sibling}b.tail!==null&&bt()>Oi&&(l.flags|=128,p=!0,ol(b,!1),l.lanes=4194304)}else{if(!p)if(i=gc(C),i!==null){if(l.flags|=128,p=!0,d=i.updateQueue,d!==null&&(l.updateQueue=d,l.flags|=4),ol(b,!0),b.tail===null&&b.tailMode==="hidden"&&!C.alternate&&!ct)return en(l),null}else 2*bt()-b.renderingStartTime>Oi&&d!==1073741824&&(l.flags|=128,p=!0,ol(b,!1),l.lanes=4194304);b.isBackwards?(C.sibling=l.child,l.child=C):(d=b.last,d!==null?d.sibling=C:l.child=C,b.last=C)}return b.tail!==null?(l=b.tail,b.rendering=l,b.tail=l.sibling,b.renderingStartTime=bt(),l.sibling=null,d=ft.current,at(ft,p?d&1|2:d&1),l):(en(l),null);case 22:case 23:return Pp(),p=l.memoizedState!==null,i!==null&&i.memoizedState!==null!==p&&(l.flags|=8192),p&&l.mode&1?Ln&1073741824&&(en(l),l.subtreeFlags&6&&(l.flags|=8192)):en(l),null;case 24:return null;case 25:return null}throw Error(t(156,l.tag))}function uO(i,l){switch(jh(l),l.tag){case 1:return xn(l.type)&&ac(),i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 3:return Ci(),ut(vn),ut(Yt),Gh(),i=l.flags,i&65536&&!(i&128)?(l.flags=i&-65537|128,l):null;case 5:return qh(l),null;case 13:if(ut(ft),i=l.memoizedState,i!==null&&i.dehydrated!==null){if(l.alternate===null)throw Error(t(340));vi()}return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 19:return ut(ft),null;case 4:return Ci(),null;case 10:return zh(l.type._context),null;case 22:case 23:return Pp(),null;case 24:return null;default:return null}}var Cc=!1,tn=!1,cO=typeof WeakSet=="function"?WeakSet:Set,we=null;function ki(i,l){var d=i.ref;if(d!==null)if(typeof d=="function")try{d(null)}catch(p){_t(i,l,p)}else d.current=null}function pp(i,l,d){try{d()}catch(p){_t(i,l,p)}}var Lv=!1;function dO(i,l){if(Ph=Wu,i=pb(),_h(i)){if("selectionStart"in i)var d={start:i.selectionStart,end:i.selectionEnd};else e:{d=(d=i.ownerDocument)&&d.defaultView||window;var p=d.getSelection&&d.getSelection();if(p&&p.rangeCount!==0){d=p.anchorNode;var _=p.anchorOffset,b=p.focusNode;p=p.focusOffset;try{d.nodeType,b.nodeType}catch{d=null;break e}var C=0,T=-1,N=-1,H=0,te=0,ne=i,ee=null;t:for(;;){for(var me;ne!==d||_!==0&&ne.nodeType!==3||(T=C+_),ne!==b||p!==0&&ne.nodeType!==3||(N=C+p),ne.nodeType===3&&(C+=ne.nodeValue.length),(me=ne.firstChild)!==null;)ee=ne,ne=me;for(;;){if(ne===i)break t;if(ee===d&&++H===_&&(T=C),ee===b&&++te===p&&(N=C),(me=ne.nextSibling)!==null)break;ne=ee,ee=ne.parentNode}ne=me}d=T===-1||N===-1?null:{start:T,end:N}}else d=null}d=d||{start:0,end:0}}else d=null;for(kh={focusedElem:i,selectionRange:d},Wu=!1,we=l;we!==null;)if(l=we,i=l.child,(l.subtreeFlags&1028)!==0&&i!==null)i.return=l,we=i;else for(;we!==null;){l=we;try{var be=l.alternate;if(l.flags&1024)switch(l.tag){case 0:case 11:case 15:break;case 1:if(be!==null){var xe=be.memoizedProps,vt=be.memoizedState,F=l.stateNode,L=F.getSnapshotBeforeUpdate(l.elementType===l.type?xe:fr(l.type,xe),vt);F.__reactInternalSnapshotBeforeUpdate=L}break;case 3:var z=l.stateNode.containerInfo;z.nodeType===1?z.textContent="":z.nodeType===9&&z.documentElement&&z.removeChild(z.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ie){_t(l,l.return,ie)}if(i=l.sibling,i!==null){i.return=l.return,we=i;break}we=l.return}return be=Lv,Lv=!1,be}function ll(i,l,d){var p=l.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var _=p=p.next;do{if((_.tag&i)===i){var b=_.destroy;_.destroy=void 0,b!==void 0&&pp(l,d,b)}_=_.next}while(_!==p)}}function Pc(i,l){if(l=l.updateQueue,l=l!==null?l.lastEffect:null,l!==null){var d=l=l.next;do{if((d.tag&i)===i){var p=d.create;d.destroy=p()}d=d.next}while(d!==l)}}function mp(i){var l=i.ref;if(l!==null){var d=i.stateNode;switch(i.tag){case 5:i=d;break;default:i=d}typeof l=="function"?l(i):l.current=i}}function Mv(i){var l=i.alternate;l!==null&&(i.alternate=null,Mv(l)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(l=i.stateNode,l!==null&&(delete l[Fr],delete l[Xo],delete l[Ah],delete l[ZR],delete l[GR])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Dv(i){return i.tag===5||i.tag===3||i.tag===4}function Fv(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Dv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function gp(i,l,d){var p=i.tag;if(p===5||p===6)i=i.stateNode,l?d.nodeType===8?d.parentNode.insertBefore(i,l):d.insertBefore(i,l):(d.nodeType===8?(l=d.parentNode,l.insertBefore(i,d)):(l=d,l.appendChild(i)),d=d._reactRootContainer,d!=null||l.onclick!==null||(l.onclick=rc));else if(p!==4&&(i=i.child,i!==null))for(gp(i,l,d),i=i.sibling;i!==null;)gp(i,l,d),i=i.sibling}function yp(i,l,d){var p=i.tag;if(p===5||p===6)i=i.stateNode,l?d.insertBefore(i,l):d.appendChild(i);else if(p!==4&&(i=i.child,i!==null))for(yp(i,l,d),i=i.sibling;i!==null;)yp(i,l,d),i=i.sibling}var Vt=null,hr=!1;function Zs(i,l,d){for(d=d.child;d!==null;)Uv(i,l,d),d=d.sibling}function Uv(i,l,d){if(Dr&&typeof Dr.onCommitFiberUnmount=="function")try{Dr.onCommitFiberUnmount(Fu,d)}catch{}switch(d.tag){case 5:tn||ki(d,l);case 6:var p=Vt,_=hr;Vt=null,Zs(i,l,d),Vt=p,hr=_,Vt!==null&&(hr?(i=Vt,d=d.stateNode,i.nodeType===8?i.parentNode.removeChild(d):i.removeChild(d)):Vt.removeChild(d.stateNode));break;case 18:Vt!==null&&(hr?(i=Vt,d=d.stateNode,i.nodeType===8?Th(i.parentNode,d):i.nodeType===1&&Th(i,d),Uo(i)):Th(Vt,d.stateNode));break;case 4:p=Vt,_=hr,Vt=d.stateNode.containerInfo,hr=!0,Zs(i,l,d),Vt=p,hr=_;break;case 0:case 11:case 14:case 15:if(!tn&&(p=d.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){_=p=p.next;do{var b=_,C=b.destroy;b=b.tag,C!==void 0&&(b&2||b&4)&&pp(d,l,C),_=_.next}while(_!==p)}Zs(i,l,d);break;case 1:if(!tn&&(ki(d,l),p=d.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=d.memoizedProps,p.state=d.memoizedState,p.componentWillUnmount()}catch(T){_t(d,l,T)}Zs(i,l,d);break;case 21:Zs(i,l,d);break;case 22:d.mode&1?(tn=(p=tn)||d.memoizedState!==null,Zs(i,l,d),tn=p):Zs(i,l,d);break;default:Zs(i,l,d)}}function zv(i){var l=i.updateQueue;if(l!==null){i.updateQueue=null;var d=i.stateNode;d===null&&(d=i.stateNode=new cO),l.forEach(function(p){var _=bO.bind(null,i,p);d.has(p)||(d.add(p),p.then(_,_))})}}function pr(i,l){var d=l.deletions;if(d!==null)for(var p=0;p<d.length;p++){var _=d[p];try{var b=i,C=l,T=C;e:for(;T!==null;){switch(T.tag){case 5:Vt=T.stateNode,hr=!1;break e;case 3:Vt=T.stateNode.containerInfo,hr=!0;break e;case 4:Vt=T.stateNode.containerInfo,hr=!0;break e}T=T.return}if(Vt===null)throw Error(t(160));Uv(b,C,_),Vt=null,hr=!1;var N=_.alternate;N!==null&&(N.return=null),_.return=null}catch(H){_t(_,l,H)}}if(l.subtreeFlags&12854)for(l=l.child;l!==null;)Bv(l,i),l=l.sibling}function Bv(i,l){var d=i.alternate,p=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(pr(l,i),Br(i),p&4){try{ll(3,i,i.return),Pc(3,i)}catch(xe){_t(i,i.return,xe)}try{ll(5,i,i.return)}catch(xe){_t(i,i.return,xe)}}break;case 1:pr(l,i),Br(i),p&512&&d!==null&&ki(d,d.return);break;case 5:if(pr(l,i),Br(i),p&512&&d!==null&&ki(d,d.return),i.flags&32){var _=i.stateNode;try{yt(_,"")}catch(xe){_t(i,i.return,xe)}}if(p&4&&(_=i.stateNode,_!=null)){var b=i.memoizedProps,C=d!==null?d.memoizedProps:b,T=i.type,N=i.updateQueue;if(i.updateQueue=null,N!==null)try{T==="input"&&b.type==="radio"&&b.name!=null&&ot(_,b),Gf(T,C);var H=Gf(T,b);for(C=0;C<N.length;C+=2){var te=N[C],ne=N[C+1];te==="style"?Zn(_,ne):te==="dangerouslySetInnerHTML"?Ns(_,ne):te==="children"?yt(_,ne):S(_,te,ne,H)}switch(T){case"input":st(_,b);break;case"textarea":Ht(_,b);break;case"select":var ee=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!b.multiple;var me=b.value;me!=null?Pt(_,!!b.multiple,me,!1):ee!==!!b.multiple&&(b.defaultValue!=null?Pt(_,!!b.multiple,b.defaultValue,!0):Pt(_,!!b.multiple,b.multiple?[]:"",!1))}_[Xo]=b}catch(xe){_t(i,i.return,xe)}}break;case 6:if(pr(l,i),Br(i),p&4){if(i.stateNode===null)throw Error(t(162));_=i.stateNode,b=i.memoizedProps;try{_.nodeValue=b}catch(xe){_t(i,i.return,xe)}}break;case 3:if(pr(l,i),Br(i),p&4&&d!==null&&d.memoizedState.isDehydrated)try{Uo(l.containerInfo)}catch(xe){_t(i,i.return,xe)}break;case 4:pr(l,i),Br(i);break;case 13:pr(l,i),Br(i),_=i.child,_.flags&8192&&(b=_.memoizedState!==null,_.stateNode.isHidden=b,!b||_.alternate!==null&&_.alternate.memoizedState!==null||(bp=bt())),p&4&&zv(i);break;case 22:if(te=d!==null&&d.memoizedState!==null,i.mode&1?(tn=(H=tn)||te,pr(l,i),tn=H):pr(l,i),Br(i),p&8192){if(H=i.memoizedState!==null,(i.stateNode.isHidden=H)&&!te&&i.mode&1)for(we=i,te=i.child;te!==null;){for(ne=we=te;we!==null;){switch(ee=we,me=ee.child,ee.tag){case 0:case 11:case 14:case 15:ll(4,ee,ee.return);break;case 1:ki(ee,ee.return);var be=ee.stateNode;if(typeof be.componentWillUnmount=="function"){p=ee,d=ee.return;try{l=p,be.props=l.memoizedProps,be.state=l.memoizedState,be.componentWillUnmount()}catch(xe){_t(p,d,xe)}}break;case 5:ki(ee,ee.return);break;case 22:if(ee.memoizedState!==null){Wv(ne);continue}}me!==null?(me.return=ee,we=me):Wv(ne)}te=te.sibling}e:for(te=null,ne=i;;){if(ne.tag===5){if(te===null){te=ne;try{_=ne.stateNode,H?(b=_.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(T=ne.stateNode,N=ne.memoizedProps.style,C=N!=null&&N.hasOwnProperty("display")?N.display:null,T.style.display=ln("display",C))}catch(xe){_t(i,i.return,xe)}}}else if(ne.tag===6){if(te===null)try{ne.stateNode.nodeValue=H?"":ne.memoizedProps}catch(xe){_t(i,i.return,xe)}}else if((ne.tag!==22&&ne.tag!==23||ne.memoizedState===null||ne===i)&&ne.child!==null){ne.child.return=ne,ne=ne.child;continue}if(ne===i)break e;for(;ne.sibling===null;){if(ne.return===null||ne.return===i)break e;te===ne&&(te=null),ne=ne.return}te===ne&&(te=null),ne.sibling.return=ne.return,ne=ne.sibling}}break;case 19:pr(l,i),Br(i),p&4&&zv(i);break;case 21:break;default:pr(l,i),Br(i)}}function Br(i){var l=i.flags;if(l&2){try{e:{for(var d=i.return;d!==null;){if(Dv(d)){var p=d;break e}d=d.return}throw Error(t(160))}switch(p.tag){case 5:var _=p.stateNode;p.flags&32&&(yt(_,""),p.flags&=-33);var b=Fv(i);yp(i,b,_);break;case 3:case 4:var C=p.stateNode.containerInfo,T=Fv(i);gp(i,T,C);break;default:throw Error(t(161))}}catch(N){_t(i,i.return,N)}i.flags&=-3}l&4096&&(i.flags&=-4097)}function fO(i,l,d){we=i,Hv(i)}function Hv(i,l,d){for(var p=(i.mode&1)!==0;we!==null;){var _=we,b=_.child;if(_.tag===22&&p){var C=_.memoizedState!==null||Cc;if(!C){var T=_.alternate,N=T!==null&&T.memoizedState!==null||tn;T=Cc;var H=tn;if(Cc=C,(tn=N)&&!H)for(we=_;we!==null;)C=we,N=C.child,C.tag===22&&C.memoizedState!==null?qv(_):N!==null?(N.return=C,we=N):qv(_);for(;b!==null;)we=b,Hv(b),b=b.sibling;we=_,Cc=T,tn=H}Vv(i)}else _.subtreeFlags&8772&&b!==null?(b.return=_,we=b):Vv(i)}}function Vv(i){for(;we!==null;){var l=we;if(l.flags&8772){var d=l.alternate;try{if(l.flags&8772)switch(l.tag){case 0:case 11:case 15:tn||Pc(5,l);break;case 1:var p=l.stateNode;if(l.flags&4&&!tn)if(d===null)p.componentDidMount();else{var _=l.elementType===l.type?d.memoizedProps:fr(l.type,d.memoizedProps);p.componentDidUpdate(_,d.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var b=l.updateQueue;b!==null&&Wb(l,b,p);break;case 3:var C=l.updateQueue;if(C!==null){if(d=null,l.child!==null)switch(l.child.tag){case 5:d=l.child.stateNode;break;case 1:d=l.child.stateNode}Wb(l,C,d)}break;case 5:var T=l.stateNode;if(d===null&&l.flags&4){d=T;var N=l.memoizedProps;switch(l.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&d.focus();break;case"img":N.src&&(d.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(l.memoizedState===null){var H=l.alternate;if(H!==null){var te=H.memoizedState;if(te!==null){var ne=te.dehydrated;ne!==null&&Uo(ne)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}tn||l.flags&512&&mp(l)}catch(ee){_t(l,l.return,ee)}}if(l===i){we=null;break}if(d=l.sibling,d!==null){d.return=l.return,we=d;break}we=l.return}}function Wv(i){for(;we!==null;){var l=we;if(l===i){we=null;break}var d=l.sibling;if(d!==null){d.return=l.return,we=d;break}we=l.return}}function qv(i){for(;we!==null;){var l=we;try{switch(l.tag){case 0:case 11:case 15:var d=l.return;try{Pc(4,l)}catch(N){_t(l,d,N)}break;case 1:var p=l.stateNode;if(typeof p.componentDidMount=="function"){var _=l.return;try{p.componentDidMount()}catch(N){_t(l,_,N)}}var b=l.return;try{mp(l)}catch(N){_t(l,b,N)}break;case 5:var C=l.return;try{mp(l)}catch(N){_t(l,C,N)}}}catch(N){_t(l,l.return,N)}if(l===i){we=null;break}var T=l.sibling;if(T!==null){T.return=l.return,we=T;break}we=l.return}}var hO=Math.ceil,kc=R.ReactCurrentDispatcher,_p=R.ReactCurrentOwner,Yn=R.ReactCurrentBatchConfig,Ve=0,Lt=null,St=null,Wt=0,Ln=0,Ri=Bs(0),Ot=0,ul=null,Ra=0,Rc=0,wp=0,cl=null,En=null,bp=0,Oi=1/0,ws=null,Oc=!1,vp=null,Gs=null,Tc=!1,Js=null,Ac=0,dl=0,xp=null,$c=-1,Ic=0;function cn(){return Ve&6?bt():$c!==-1?$c:$c=bt()}function Ks(i){return i.mode&1?Ve&2&&Wt!==0?Wt&-Wt:KR.transition!==null?(Ic===0&&(Ic=Fw()),Ic):(i=Je,i!==0||(i=window.event,i=i===void 0?16:Gw(i.type)),i):1}function mr(i,l,d,p){if(50<dl)throw dl=0,xp=null,Error(t(185));jo(i,d,p),(!(Ve&2)||i!==Lt)&&(i===Lt&&(!(Ve&2)&&(Rc|=d),Ot===4&&Xs(i,Wt)),Cn(i,p),d===1&&Ve===0&&!(l.mode&1)&&(Oi=bt()+500,oc&&Vs()))}function Cn(i,l){var d=i.callbackNode;Kk(i,l);var p=Bu(i,i===Lt?Wt:0);if(p===0)d!==null&&Lw(d),i.callbackNode=null,i.callbackPriority=0;else if(l=p&-p,i.callbackPriority!==l){if(d!=null&&Lw(d),l===1)i.tag===0?JR(Gv.bind(null,i)):Ib(Gv.bind(null,i)),WR(function(){!(Ve&6)&&Vs()}),d=null;else{switch(Uw(p)){case 1:d=th;break;case 4:d=Mw;break;case 16:d=Du;break;case 536870912:d=Dw;break;default:d=Du}d=n0(d,Zv.bind(null,i))}i.callbackPriority=l,i.callbackNode=d}}function Zv(i,l){if($c=-1,Ic=0,Ve&6)throw Error(t(327));var d=i.callbackNode;if(Ti()&&i.callbackNode!==d)return null;var p=Bu(i,i===Lt?Wt:0);if(p===0)return null;if(p&30||p&i.expiredLanes||l)l=Nc(i,p);else{l=p;var _=Ve;Ve|=2;var b=Kv();(Lt!==i||Wt!==l)&&(ws=null,Oi=bt()+500,Ta(i,l));do try{gO();break}catch(T){Jv(i,T)}while(!0);Uh(),kc.current=b,Ve=_,St!==null?l=0:(Lt=null,Wt=0,l=Ot)}if(l!==0){if(l===2&&(_=nh(i),_!==0&&(p=_,l=Sp(i,_))),l===1)throw d=ul,Ta(i,0),Xs(i,p),Cn(i,bt()),d;if(l===6)Xs(i,p);else{if(_=i.current.alternate,!(p&30)&&!pO(_)&&(l=Nc(i,p),l===2&&(b=nh(i),b!==0&&(p=b,l=Sp(i,b))),l===1))throw d=ul,Ta(i,0),Xs(i,p),Cn(i,bt()),d;switch(i.finishedWork=_,i.finishedLanes=p,l){case 0:case 1:throw Error(t(345));case 2:Aa(i,En,ws);break;case 3:if(Xs(i,p),(p&130023424)===p&&(l=bp+500-bt(),10<l)){if(Bu(i,0)!==0)break;if(_=i.suspendedLanes,(_&p)!==p){cn(),i.pingedLanes|=i.suspendedLanes&_;break}i.timeoutHandle=Oh(Aa.bind(null,i,En,ws),l);break}Aa(i,En,ws);break;case 4:if(Xs(i,p),(p&4194240)===p)break;for(l=i.eventTimes,_=-1;0<p;){var C=31-ur(p);b=1<<C,C=l[C],C>_&&(_=C),p&=~b}if(p=_,p=bt()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*hO(p/1960))-p,10<p){i.timeoutHandle=Oh(Aa.bind(null,i,En,ws),p);break}Aa(i,En,ws);break;case 5:Aa(i,En,ws);break;default:throw Error(t(329))}}}return Cn(i,bt()),i.callbackNode===d?Zv.bind(null,i):null}function Sp(i,l){var d=cl;return i.current.memoizedState.isDehydrated&&(Ta(i,l).flags|=256),i=Nc(i,l),i!==2&&(l=En,En=d,l!==null&&Ep(l)),i}function Ep(i){En===null?En=i:En.push.apply(En,i)}function pO(i){for(var l=i;;){if(l.flags&16384){var d=l.updateQueue;if(d!==null&&(d=d.stores,d!==null))for(var p=0;p<d.length;p++){var _=d[p],b=_.getSnapshot;_=_.value;try{if(!cr(b(),_))return!1}catch{return!1}}}if(d=l.child,l.subtreeFlags&16384&&d!==null)d.return=l,l=d;else{if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Xs(i,l){for(l&=~wp,l&=~Rc,i.suspendedLanes|=l,i.pingedLanes&=~l,i=i.expirationTimes;0<l;){var d=31-ur(l),p=1<<d;i[d]=-1,l&=~p}}function Gv(i){if(Ve&6)throw Error(t(327));Ti();var l=Bu(i,0);if(!(l&1))return Cn(i,bt()),null;var d=Nc(i,l);if(i.tag!==0&&d===2){var p=nh(i);p!==0&&(l=p,d=Sp(i,p))}if(d===1)throw d=ul,Ta(i,0),Xs(i,l),Cn(i,bt()),d;if(d===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=l,Aa(i,En,ws),Cn(i,bt()),null}function Cp(i,l){var d=Ve;Ve|=1;try{return i(l)}finally{Ve=d,Ve===0&&(Oi=bt()+500,oc&&Vs())}}function Oa(i){Js!==null&&Js.tag===0&&!(Ve&6)&&Ti();var l=Ve;Ve|=1;var d=Yn.transition,p=Je;try{if(Yn.transition=null,Je=1,i)return i()}finally{Je=p,Yn.transition=d,Ve=l,!(Ve&6)&&Vs()}}function Pp(){Ln=Ri.current,ut(Ri)}function Ta(i,l){i.finishedWork=null,i.finishedLanes=0;var d=i.timeoutHandle;if(d!==-1&&(i.timeoutHandle=-1,VR(d)),St!==null)for(d=St.return;d!==null;){var p=d;switch(jh(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&ac();break;case 3:Ci(),ut(vn),ut(Yt),Gh();break;case 5:qh(p);break;case 4:Ci();break;case 13:ut(ft);break;case 19:ut(ft);break;case 10:zh(p.type._context);break;case 22:case 23:Pp()}d=d.return}if(Lt=i,St=i=Ys(i.current,null),Wt=Ln=l,Ot=0,ul=null,wp=Rc=Ra=0,En=cl=null,Ca!==null){for(l=0;l<Ca.length;l++)if(d=Ca[l],p=d.interleaved,p!==null){d.interleaved=null;var _=p.next,b=d.pending;if(b!==null){var C=b.next;b.next=_,p.next=C}d.pending=p}Ca=null}return i}function Jv(i,l){do{var d=St;try{if(Uh(),yc.current=vc,_c){for(var p=ht.memoizedState;p!==null;){var _=p.queue;_!==null&&(_.pending=null),p=p.next}_c=!1}if(ka=0,jt=Rt=ht=null,rl=!1,sl=0,_p.current=null,d===null||d.return===null){Ot=1,ul=l,St=null;break}e:{var b=i,C=d.return,T=d,N=l;if(l=Wt,T.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var H=N,te=T,ne=te.tag;if(!(te.mode&1)&&(ne===0||ne===11||ne===15)){var ee=te.alternate;ee?(te.updateQueue=ee.updateQueue,te.memoizedState=ee.memoizedState,te.lanes=ee.lanes):(te.updateQueue=null,te.memoizedState=null)}var me=bv(C);if(me!==null){me.flags&=-257,vv(me,C,T,b,l),me.mode&1&&wv(b,H,l),l=me,N=H;var be=l.updateQueue;if(be===null){var xe=new Set;xe.add(N),l.updateQueue=xe}else be.add(N);break e}else{if(!(l&1)){wv(b,H,l),kp();break e}N=Error(t(426))}}else if(ct&&T.mode&1){var vt=bv(C);if(vt!==null){!(vt.flags&65536)&&(vt.flags|=256),vv(vt,C,T,b,l),Dh(Pi(N,T));break e}}b=N=Pi(N,T),Ot!==4&&(Ot=2),cl===null?cl=[b]:cl.push(b),b=C;do{switch(b.tag){case 3:b.flags|=65536,l&=-l,b.lanes|=l;var F=yv(b,N,l);Vb(b,F);break e;case 1:T=N;var L=b.type,z=b.stateNode;if(!(b.flags&128)&&(typeof L.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(Gs===null||!Gs.has(z)))){b.flags|=65536,l&=-l,b.lanes|=l;var ie=_v(b,T,l);Vb(b,ie);break e}}b=b.return}while(b!==null)}Yv(d)}catch(Se){l=Se,St===d&&d!==null&&(St=d=d.return);continue}break}while(!0)}function Kv(){var i=kc.current;return kc.current=vc,i===null?vc:i}function kp(){(Ot===0||Ot===3||Ot===2)&&(Ot=4),Lt===null||!(Ra&268435455)&&!(Rc&268435455)||Xs(Lt,Wt)}function Nc(i,l){var d=Ve;Ve|=2;var p=Kv();(Lt!==i||Wt!==l)&&(ws=null,Ta(i,l));do try{mO();break}catch(_){Jv(i,_)}while(!0);if(Uh(),Ve=d,kc.current=p,St!==null)throw Error(t(261));return Lt=null,Wt=0,Ot}function mO(){for(;St!==null;)Xv(St)}function gO(){for(;St!==null&&!zk();)Xv(St)}function Xv(i){var l=t0(i.alternate,i,Ln);i.memoizedProps=i.pendingProps,l===null?Yv(i):St=l,_p.current=null}function Yv(i){var l=i;do{var d=l.alternate;if(i=l.return,l.flags&32768){if(d=uO(d,l),d!==null){d.flags&=32767,St=d;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{Ot=6,St=null;return}}else if(d=lO(d,l,Ln),d!==null){St=d;return}if(l=l.sibling,l!==null){St=l;return}St=l=i}while(l!==null);Ot===0&&(Ot=5)}function Aa(i,l,d){var p=Je,_=Yn.transition;try{Yn.transition=null,Je=1,yO(i,l,d,p)}finally{Yn.transition=_,Je=p}return null}function yO(i,l,d,p){do Ti();while(Js!==null);if(Ve&6)throw Error(t(327));d=i.finishedWork;var _=i.finishedLanes;if(d===null)return null;if(i.finishedWork=null,i.finishedLanes=0,d===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var b=d.lanes|d.childLanes;if(Xk(i,b),i===Lt&&(St=Lt=null,Wt=0),!(d.subtreeFlags&2064)&&!(d.flags&2064)||Tc||(Tc=!0,n0(Du,function(){return Ti(),null})),b=(d.flags&15990)!==0,d.subtreeFlags&15990||b){b=Yn.transition,Yn.transition=null;var C=Je;Je=1;var T=Ve;Ve|=4,_p.current=null,dO(i,d),Bv(d,i),MR(kh),Wu=!!Ph,kh=Ph=null,i.current=d,fO(d),Bk(),Ve=T,Je=C,Yn.transition=b}else i.current=d;if(Tc&&(Tc=!1,Js=i,Ac=_),b=i.pendingLanes,b===0&&(Gs=null),Wk(d.stateNode),Cn(i,bt()),l!==null)for(p=i.onRecoverableError,d=0;d<l.length;d++)_=l[d],p(_.value,{componentStack:_.stack,digest:_.digest});if(Oc)throw Oc=!1,i=vp,vp=null,i;return Ac&1&&i.tag!==0&&Ti(),b=i.pendingLanes,b&1?i===xp?dl++:(dl=0,xp=i):dl=0,Vs(),null}function Ti(){if(Js!==null){var i=Uw(Ac),l=Yn.transition,d=Je;try{if(Yn.transition=null,Je=16>i?16:i,Js===null)var p=!1;else{if(i=Js,Js=null,Ac=0,Ve&6)throw Error(t(331));var _=Ve;for(Ve|=4,we=i.current;we!==null;){var b=we,C=b.child;if(we.flags&16){var T=b.deletions;if(T!==null){for(var N=0;N<T.length;N++){var H=T[N];for(we=H;we!==null;){var te=we;switch(te.tag){case 0:case 11:case 15:ll(8,te,b)}var ne=te.child;if(ne!==null)ne.return=te,we=ne;else for(;we!==null;){te=we;var ee=te.sibling,me=te.return;if(Mv(te),te===H){we=null;break}if(ee!==null){ee.return=me,we=ee;break}we=me}}}var be=b.alternate;if(be!==null){var xe=be.child;if(xe!==null){be.child=null;do{var vt=xe.sibling;xe.sibling=null,xe=vt}while(xe!==null)}}we=b}}if(b.subtreeFlags&2064&&C!==null)C.return=b,we=C;else e:for(;we!==null;){if(b=we,b.flags&2048)switch(b.tag){case 0:case 11:case 15:ll(9,b,b.return)}var F=b.sibling;if(F!==null){F.return=b.return,we=F;break e}we=b.return}}var L=i.current;for(we=L;we!==null;){C=we;var z=C.child;if(C.subtreeFlags&2064&&z!==null)z.return=C,we=z;else e:for(C=L;we!==null;){if(T=we,T.flags&2048)try{switch(T.tag){case 0:case 11:case 15:Pc(9,T)}}catch(Se){_t(T,T.return,Se)}if(T===C){we=null;break e}var ie=T.sibling;if(ie!==null){ie.return=T.return,we=ie;break e}we=T.return}}if(Ve=_,Vs(),Dr&&typeof Dr.onPostCommitFiberRoot=="function")try{Dr.onPostCommitFiberRoot(Fu,i)}catch{}p=!0}return p}finally{Je=d,Yn.transition=l}}return!1}function Qv(i,l,d){l=Pi(d,l),l=yv(i,l,1),i=qs(i,l,1),l=cn(),i!==null&&(jo(i,1,l),Cn(i,l))}function _t(i,l,d){if(i.tag===3)Qv(i,i,d);else for(;l!==null;){if(l.tag===3){Qv(l,i,d);break}else if(l.tag===1){var p=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Gs===null||!Gs.has(p))){i=Pi(d,i),i=_v(l,i,1),l=qs(l,i,1),i=cn(),l!==null&&(jo(l,1,i),Cn(l,i));break}}l=l.return}}function _O(i,l,d){var p=i.pingCache;p!==null&&p.delete(l),l=cn(),i.pingedLanes|=i.suspendedLanes&d,Lt===i&&(Wt&d)===d&&(Ot===4||Ot===3&&(Wt&130023424)===Wt&&500>bt()-bp?Ta(i,0):wp|=d),Cn(i,l)}function e0(i,l){l===0&&(i.mode&1?(l=zu,zu<<=1,!(zu&130023424)&&(zu=4194304)):l=1);var d=cn();i=gs(i,l),i!==null&&(jo(i,l,d),Cn(i,d))}function wO(i){var l=i.memoizedState,d=0;l!==null&&(d=l.retryLane),e0(i,d)}function bO(i,l){var d=0;switch(i.tag){case 13:var p=i.stateNode,_=i.memoizedState;_!==null&&(d=_.retryLane);break;case 19:p=i.stateNode;break;default:throw Error(t(314))}p!==null&&p.delete(l),e0(i,d)}var t0;t0=function(i,l,d){if(i!==null)if(i.memoizedProps!==l.pendingProps||vn.current)Sn=!0;else{if(!(i.lanes&d)&&!(l.flags&128))return Sn=!1,oO(i,l,d);Sn=!!(i.flags&131072)}else Sn=!1,ct&&l.flags&1048576&&Nb(l,uc,l.index);switch(l.lanes=0,l.tag){case 2:var p=l.type;Ec(i,l),i=l.pendingProps;var _=_i(l,Yt.current);Ei(l,d),_=Xh(null,l,p,i,_,d);var b=Yh();return l.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(l.tag=1,l.memoizedState=null,l.updateQueue=null,xn(p)?(b=!0,ic(l)):b=!1,l.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,Vh(l),_.updater=xc,l.stateNode=_,_._reactInternals=l,sp(l,p,i,d),l=lp(null,l,p,!0,b,d)):(l.tag=0,ct&&b&&Nh(l),un(null,l,_,d),l=l.child),l;case 16:p=l.elementType;e:{switch(Ec(i,l),i=l.pendingProps,_=p._init,p=_(p._payload),l.type=p,_=l.tag=xO(p),i=fr(p,i),_){case 0:l=op(null,l,p,i,d);break e;case 1:l=kv(null,l,p,i,d);break e;case 11:l=xv(null,l,p,i,d);break e;case 14:l=Sv(null,l,p,fr(p.type,i),d);break e}throw Error(t(306,p,""))}return l;case 0:return p=l.type,_=l.pendingProps,_=l.elementType===p?_:fr(p,_),op(i,l,p,_,d);case 1:return p=l.type,_=l.pendingProps,_=l.elementType===p?_:fr(p,_),kv(i,l,p,_,d);case 3:e:{if(Rv(l),i===null)throw Error(t(387));p=l.pendingProps,b=l.memoizedState,_=b.element,Hb(i,l),mc(l,p,null,d);var C=l.memoizedState;if(p=C.element,b.isDehydrated)if(b={element:p,isDehydrated:!1,cache:C.cache,pendingSuspenseBoundaries:C.pendingSuspenseBoundaries,transitions:C.transitions},l.updateQueue.baseState=b,l.memoizedState=b,l.flags&256){_=Pi(Error(t(423)),l),l=Ov(i,l,p,d,_);break e}else if(p!==_){_=Pi(Error(t(424)),l),l=Ov(i,l,p,d,_);break e}else for(jn=zs(l.stateNode.containerInfo.firstChild),Nn=l,ct=!0,dr=null,d=zb(l,null,p,d),l.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(vi(),p===_){l=_s(i,l,d);break e}un(i,l,p,d)}l=l.child}return l;case 5:return qb(l),i===null&&Mh(l),p=l.type,_=l.pendingProps,b=i!==null?i.memoizedProps:null,C=_.children,Rh(p,_)?C=null:b!==null&&Rh(p,b)&&(l.flags|=32),Pv(i,l),un(i,l,C,d),l.child;case 6:return i===null&&Mh(l),null;case 13:return Tv(i,l,d);case 4:return Wh(l,l.stateNode.containerInfo),p=l.pendingProps,i===null?l.child=xi(l,null,p,d):un(i,l,p,d),l.child;case 11:return p=l.type,_=l.pendingProps,_=l.elementType===p?_:fr(p,_),xv(i,l,p,_,d);case 7:return un(i,l,l.pendingProps,d),l.child;case 8:return un(i,l,l.pendingProps.children,d),l.child;case 12:return un(i,l,l.pendingProps.children,d),l.child;case 10:e:{if(p=l.type._context,_=l.pendingProps,b=l.memoizedProps,C=_.value,at(fc,p._currentValue),p._currentValue=C,b!==null)if(cr(b.value,C)){if(b.children===_.children&&!vn.current){l=_s(i,l,d);break e}}else for(b=l.child,b!==null&&(b.return=l);b!==null;){var T=b.dependencies;if(T!==null){C=b.child;for(var N=T.firstContext;N!==null;){if(N.context===p){if(b.tag===1){N=ys(-1,d&-d),N.tag=2;var H=b.updateQueue;if(H!==null){H=H.shared;var te=H.pending;te===null?N.next=N:(N.next=te.next,te.next=N),H.pending=N}}b.lanes|=d,N=b.alternate,N!==null&&(N.lanes|=d),Bh(b.return,d,l),T.lanes|=d;break}N=N.next}}else if(b.tag===10)C=b.type===l.type?null:b.child;else if(b.tag===18){if(C=b.return,C===null)throw Error(t(341));C.lanes|=d,T=C.alternate,T!==null&&(T.lanes|=d),Bh(C,d,l),C=b.sibling}else C=b.child;if(C!==null)C.return=b;else for(C=b;C!==null;){if(C===l){C=null;break}if(b=C.sibling,b!==null){b.return=C.return,C=b;break}C=C.return}b=C}un(i,l,_.children,d),l=l.child}return l;case 9:return _=l.type,p=l.pendingProps.children,Ei(l,d),_=Kn(_),p=p(_),l.flags|=1,un(i,l,p,d),l.child;case 14:return p=l.type,_=fr(p,l.pendingProps),_=fr(p.type,_),Sv(i,l,p,_,d);case 15:return Ev(i,l,l.type,l.pendingProps,d);case 17:return p=l.type,_=l.pendingProps,_=l.elementType===p?_:fr(p,_),Ec(i,l),l.tag=1,xn(p)?(i=!0,ic(l)):i=!1,Ei(l,d),mv(l,p,_),sp(l,p,_,d),lp(null,l,p,!0,i,d);case 19:return $v(i,l,d);case 22:return Cv(i,l,d)}throw Error(t(156,l.tag))};function n0(i,l){return jw(i,l)}function vO(i,l,d,p){this.tag=i,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qn(i,l,d,p){return new vO(i,l,d,p)}function Rp(i){return i=i.prototype,!(!i||!i.isReactComponent)}function xO(i){if(typeof i=="function")return Rp(i)?1:0;if(i!=null){if(i=i.$$typeof,i===he)return 11;if(i===G)return 14}return 2}function Ys(i,l){var d=i.alternate;return d===null?(d=Qn(i.tag,l,i.key,i.mode),d.elementType=i.elementType,d.type=i.type,d.stateNode=i.stateNode,d.alternate=i,i.alternate=d):(d.pendingProps=l,d.type=i.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=i.flags&14680064,d.childLanes=i.childLanes,d.lanes=i.lanes,d.child=i.child,d.memoizedProps=i.memoizedProps,d.memoizedState=i.memoizedState,d.updateQueue=i.updateQueue,l=i.dependencies,d.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},d.sibling=i.sibling,d.index=i.index,d.ref=i.ref,d}function jc(i,l,d,p,_,b){var C=2;if(p=i,typeof i=="function")Rp(i)&&(C=1);else if(typeof i=="string")C=5;else e:switch(i){case M:return $a(d.children,_,b,l);case D:C=8,_|=8;break;case K:return i=Qn(12,d,l,_|2),i.elementType=K,i.lanes=b,i;case ce:return i=Qn(13,d,l,_),i.elementType=ce,i.lanes=b,i;case W:return i=Qn(19,d,l,_),i.elementType=W,i.lanes=b,i;case J:return Lc(d,_,b,l);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case X:C=10;break e;case ae:C=9;break e;case he:C=11;break e;case G:C=14;break e;case q:C=16,p=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return l=Qn(C,d,l,_),l.elementType=i,l.type=p,l.lanes=b,l}function $a(i,l,d,p){return i=Qn(7,i,p,l),i.lanes=d,i}function Lc(i,l,d,p){return i=Qn(22,i,p,l),i.elementType=J,i.lanes=d,i.stateNode={isHidden:!1},i}function Op(i,l,d){return i=Qn(6,i,null,l),i.lanes=d,i}function Tp(i,l,d){return l=Qn(4,i.children!==null?i.children:[],i.key,l),l.lanes=d,l.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},l}function SO(i,l,d,p,_){this.tag=l,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=rh(0),this.expirationTimes=rh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rh(0),this.identifierPrefix=p,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function Ap(i,l,d,p,_,b,C,T,N){return i=new SO(i,l,d,T,N),l===1?(l=1,b===!0&&(l|=8)):l=0,b=Qn(3,null,null,l),i.current=b,b.stateNode=i,b.memoizedState={element:p,isDehydrated:d,cache:null,transitions:null,pendingSuspenseBoundaries:null},Vh(b),i}function EO(i,l,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:I,key:p==null?null:""+p,children:i,containerInfo:l,implementation:d}}function r0(i){if(!i)return Hs;i=i._reactInternals;e:{if(ba(i)!==i||i.tag!==1)throw Error(t(170));var l=i;do{switch(l.tag){case 3:l=l.stateNode.context;break e;case 1:if(xn(l.type)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break e}}l=l.return}while(l!==null);throw Error(t(171))}if(i.tag===1){var d=i.type;if(xn(d))return Ab(i,d,l)}return l}function s0(i,l,d,p,_,b,C,T,N){return i=Ap(d,p,!0,i,_,b,C,T,N),i.context=r0(null),d=i.current,p=cn(),_=Ks(d),b=ys(p,_),b.callback=l??null,qs(d,b,_),i.current.lanes=_,jo(i,_,p),Cn(i,p),i}function Mc(i,l,d,p){var _=l.current,b=cn(),C=Ks(_);return d=r0(d),l.context===null?l.context=d:l.pendingContext=d,l=ys(b,C),l.payload={element:i},p=p===void 0?null:p,p!==null&&(l.callback=p),i=qs(_,l,C),i!==null&&(mr(i,_,C,b),pc(i,_,C)),C}function Dc(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function a0(i,l){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var d=i.retryLane;i.retryLane=d!==0&&d<l?d:l}}function $p(i,l){a0(i,l),(i=i.alternate)&&a0(i,l)}function CO(){return null}var i0=typeof reportError=="function"?reportError:function(i){console.error(i)};function Ip(i){this._internalRoot=i}Fc.prototype.render=Ip.prototype.render=function(i){var l=this._internalRoot;if(l===null)throw Error(t(409));Mc(i,l,null,null)},Fc.prototype.unmount=Ip.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var l=i.containerInfo;Oa(function(){Mc(null,i,null,null)}),l[fs]=null}};function Fc(i){this._internalRoot=i}Fc.prototype.unstable_scheduleHydration=function(i){if(i){var l=Hw();i={blockedOn:null,target:i,priority:l};for(var d=0;d<Ds.length&&l!==0&&l<Ds[d].priority;d++);Ds.splice(d,0,i),d===0&&qw(i)}};function Np(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Uc(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function o0(){}function PO(i,l,d,p,_){if(_){if(typeof p=="function"){var b=p;p=function(){var H=Dc(C);b.call(H)}}var C=s0(l,p,i,0,null,!1,!1,"",o0);return i._reactRootContainer=C,i[fs]=C.current,Jo(i.nodeType===8?i.parentNode:i),Oa(),C}for(;_=i.lastChild;)i.removeChild(_);if(typeof p=="function"){var T=p;p=function(){var H=Dc(N);T.call(H)}}var N=Ap(i,0,!1,null,null,!1,!1,"",o0);return i._reactRootContainer=N,i[fs]=N.current,Jo(i.nodeType===8?i.parentNode:i),Oa(function(){Mc(l,N,d,p)}),N}function zc(i,l,d,p,_){var b=d._reactRootContainer;if(b){var C=b;if(typeof _=="function"){var T=_;_=function(){var N=Dc(C);T.call(N)}}Mc(l,C,i,_)}else C=PO(d,l,i,_,p);return Dc(C)}zw=function(i){switch(i.tag){case 3:var l=i.stateNode;if(l.current.memoizedState.isDehydrated){var d=No(l.pendingLanes);d!==0&&(sh(l,d|1),Cn(l,bt()),!(Ve&6)&&(Oi=bt()+500,Vs()))}break;case 13:Oa(function(){var p=gs(i,1);if(p!==null){var _=cn();mr(p,i,1,_)}}),$p(i,1)}},ah=function(i){if(i.tag===13){var l=gs(i,134217728);if(l!==null){var d=cn();mr(l,i,134217728,d)}$p(i,134217728)}},Bw=function(i){if(i.tag===13){var l=Ks(i),d=gs(i,l);if(d!==null){var p=cn();mr(d,i,l,p)}$p(i,l)}},Hw=function(){return Je},Vw=function(i,l){var d=Je;try{return Je=i,l()}finally{Je=d}},Xf=function(i,l,d){switch(l){case"input":if(st(i,d),l=d.name,d.type==="radio"&&l!=null){for(d=i;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll("input[name="+JSON.stringify(""+l)+'][type="radio"]'),l=0;l<d.length;l++){var p=d[l];if(p!==i&&p.form===i.form){var _=sc(p);if(!_)throw Error(t(90));Nt(p),st(p,_)}}}break;case"textarea":Ht(i,d);break;case"select":l=d.value,l!=null&&Pt(i,!!d.multiple,l,!1)}},Rw=Cp,Ow=Oa;var kO={usingClientEntryPoint:!1,Events:[Yo,gi,sc,Pw,kw,Cp]},fl={findFiberByHostInstance:va,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},RO={bundleType:fl.bundleType,version:fl.version,rendererPackageName:fl.rendererPackageName,rendererConfig:fl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Iw(i),i===null?null:i.stateNode},findFiberByHostInstance:fl.findFiberByHostInstance||CO,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bc.isDisabled&&Bc.supportsFiber)try{Fu=Bc.inject(RO),Dr=Bc}catch{}}return Pn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kO,Pn.createPortal=function(i,l){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Np(l))throw Error(t(200));return EO(i,l,null,d)},Pn.createRoot=function(i,l){if(!Np(i))throw Error(t(299));var d=!1,p="",_=i0;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onRecoverableError!==void 0&&(_=l.onRecoverableError)),l=Ap(i,1,!1,null,null,d,!1,p,_),i[fs]=l.current,Jo(i.nodeType===8?i.parentNode:i),new Ip(l)},Pn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var l=i._reactInternals;if(l===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=Iw(l),i=i===null?null:i.stateNode,i},Pn.flushSync=function(i){return Oa(i)},Pn.hydrate=function(i,l,d){if(!Uc(l))throw Error(t(200));return zc(null,i,l,!0,d)},Pn.hydrateRoot=function(i,l,d){if(!Np(i))throw Error(t(405));var p=d!=null&&d.hydratedSources||null,_=!1,b="",C=i0;if(d!=null&&(d.unstable_strictMode===!0&&(_=!0),d.identifierPrefix!==void 0&&(b=d.identifierPrefix),d.onRecoverableError!==void 0&&(C=d.onRecoverableError)),l=s0(l,null,i,1,d??null,_,!1,b,C),i[fs]=l.current,Jo(i),p)for(i=0;i<p.length;i++)d=p[i],_=d._getVersion,_=_(d._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[d,_]:l.mutableSourceEagerHydrationData.push(d,_);return new Fc(l)},Pn.render=function(i,l,d){if(!Uc(l))throw Error(t(200));return zc(null,i,l,!1,d)},Pn.unmountComponentAtNode=function(i){if(!Uc(i))throw Error(t(40));return i._reactRootContainer?(Oa(function(){zc(null,null,i,!1,function(){i._reactRootContainer=null,i[fs]=null})}),!0):!1},Pn.unstable_batchedUpdates=Cp,Pn.unstable_renderSubtreeIntoContainer=function(i,l,d,p){if(!Uc(d))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return zc(i,l,d,!1,p)},Pn.version="18.3.1-next-f1338f8080-20240426",Pn}var m0;function A1(){if(m0)return Mp.exports;m0=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Mp.exports=FO(),Mp.exports}var g0;function UO(){if(g0)return Hc;g0=1;var n=A1();return Hc.createRoot=n.createRoot,Hc.hydrateRoot=n.hydrateRoot,Hc}var zO=UO();function Kr(n){return Object.keys(n)}function Up(n){return n&&typeof n=="object"&&!Array.isArray(n)}function vy(n,e){const t={...n},r=e;return Up(n)&&Up(e)&&Object.keys(e).forEach(s=>{Up(r[s])&&s in n?t[s]=vy(t[s],r[s]):t[s]=r[s]}),t}function BO(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}function HO(n){var e;return typeof n!="string"||!n.includes("var(--mantine-scale)")?n:(e=n.match(/^calc\((.*?)\)$/))==null?void 0:e[1].split("*")[0].trim()}function VO(n){const e=HO(n);return typeof e=="number"?e:typeof e=="string"?e.includes("calc")||e.includes("var")?e:e.includes("px")?Number(e.replace("px","")):e.includes("rem")?Number(e.replace("rem",""))*16:e.includes("em")?Number(e.replace("em",""))*16:Number(e):NaN}function zp(n){return n==="0rem"?"0rem":`calc(${n} * var(--mantine-scale))`}function $1(n,{shouldScale:e=!1}={}){function t(r){if(r===0||r==="0")return`0${n}`;if(typeof r=="number"){const s=`${r/16}${n}`;return e?zp(s):s}if(typeof r=="string"){if(r===""||r.startsWith("calc(")||r.startsWith("clamp(")||r.includes("rgba("))return r;if(r.includes(","))return r.split(",").map(a=>t(a)).join(",");if(r.includes(" "))return r.split(" ").map(a=>t(a)).join(" ");if(r.includes(n))return e?zp(r):r;const s=r.replace("px","");if(!Number.isNaN(Number(s))){const a=`${Number(s)/16}${n}`;return e?zp(a):a}}return r}return t}const Q=$1("rem",{shouldScale:!0}),y0=$1("em");function tf(n){return Object.keys(n).reduce((e,t)=>(n[t]!==void 0&&(e[t]=n[t]),e),{})}function I1(n){if(typeof n=="number")return!0;if(typeof n=="string"){if(n.startsWith("calc(")||n.startsWith("var(")||n.includes(" ")&&n.trim()!=="")return!0;const e=/^[+-]?[0-9]+(\.[0-9]+)?(px|em|rem|ex|ch|lh|rlh|vw|vh|vmin|vmax|vb|vi|svw|svh|lvw|lvh|dvw|dvh|cm|mm|in|pt|pc|q|cqw|cqh|cqi|cqb|cqmin|cqmax|%)?$/;return n.trim().split(/\s+/).every(r=>e.test(r))}return!1}function du(n){return Array.isArray(n)||n===null?!1:typeof n=="object"?n.type!==P.Fragment:!1}function ni(n){const e=P.createContext(null);return[({children:s,value:a})=>O.jsx(e.Provider,{value:a,children:s}),()=>{const s=P.useContext(e);if(s===null)throw new Error(n);return s}]}function N1(n=null){const e=P.createContext(n);return[({children:s,value:a})=>O.jsx(e.Provider,{value:a,children:s}),()=>P.useContext(e)]}function _0(n,e){return t=>{if(typeof t!="string"||t.trim().length===0)throw new Error(e);return`${n}-${t}`}}function Rg(n,e){let t=n;for(;(t=t.parentElement)&&!t.matches(e););return t}function WO(n,e,t){for(let r=n-1;r>=0;r-=1)if(!e[r].disabled)return r;if(t){for(let r=e.length-1;r>-1;r-=1)if(!e[r].disabled)return r}return n}function qO(n,e,t){for(let r=n+1;r<e.length;r+=1)if(!e[r].disabled)return r;if(t){for(let r=0;r<e.length;r+=1)if(!e[r].disabled)return r}return n}function ZO(n,e,t){return Rg(n,t)===Rg(e,t)}function GO({parentSelector:n,siblingSelector:e,onKeyDown:t,loop:r=!0,activateOnFocus:s=!1,dir:a="rtl",orientation:o}){return u=>{var g;t==null||t(u);const c=Array.from(((g=Rg(u.currentTarget,n))==null?void 0:g.querySelectorAll(e))||[]).filter(y=>ZO(u.currentTarget,y,n)),f=c.findIndex(y=>u.currentTarget===y),h=qO(f,c,r),m=WO(f,c,r);switch(u.key){case"ArrowRight":break;case"ArrowLeft":break;case"ArrowUp":{u.stopPropagation(),u.preventDefault(),c[m].focus(),s&&c[m].click();break}case"ArrowDown":{u.stopPropagation(),u.preventDefault(),c[h].focus(),s&&c[h].click();break}case"Home":{u.stopPropagation(),u.preventDefault(),!c[0].disabled&&c[0].focus();break}case"End":{u.stopPropagation(),u.preventDefault();const y=c.length-1;!c[y].disabled&&c[y].focus();break}}}}const JO={app:100,modal:200,popover:300,overlay:400,max:9999};function j1(n){return JO[n]}const KO=()=>{};function XO(n,e={active:!0}){return typeof n!="function"||!e.active?e.onKeyDown||KO:t=>{var r;t.key==="Escape"&&(n(t),(r=e.onTrigger)==null||r.call(e))}}function xt(n,e="size",t=!0){if(n!==void 0)return I1(n)?t?Q(n):n:`var(--${e}-${n})`}function L1(n){return xt(n,"mantine-spacing")}function is(n){return n===void 0?"var(--mantine-radius-default)":xt(n,"mantine-radius")}function yn(n){return xt(n,"mantine-font-size")}function YO(n){return xt(n,"mantine-line-height",!1)}function M1(n){if(n)return xt(n,"mantine-shadow",!1)}function QO(n="mantine-"){return`${n}${Math.random().toString(36).slice(2,11)}`}function ja(n){const e=P.useRef(n);return P.useEffect(()=>{e.current=n}),P.useMemo(()=>(...t)=>{var r;return(r=e.current)==null?void 0:r.call(e,...t)},[])}const eT=()=>{};function nf(n,e){const t=typeof e=="number"?e:e.delay,r=typeof e=="number"?!1:e.flushOnUnmount,s=ja(n),a=P.useRef(0),o=Object.assign(P.useCallback((...u)=>{window.clearTimeout(a.current);const c=()=>{a.current!==0&&(a.current=0,s(...u))};o.flush=c,a.current=window.setTimeout(c,t)},[s,t]),{flush:eT});return P.useEffect(()=>()=>{window.clearTimeout(a.current),r&&o.flush()},[o,r]),o}const w0=["mousedown","touchstart"];function tT(n,e,t){const r=P.useRef(null);return P.useEffect(()=>{const s=a=>{const{target:o}=a??{};if(Array.isArray(t)){const u=(o==null?void 0:o.hasAttribute("data-ignore-outside-clicks"))||!document.body.contains(o)&&o.tagName!=="HTML";t.every(f=>!!f&&!a.composedPath().includes(f))&&!u&&n()}else r.current&&!r.current.contains(o)&&n()};return(e||w0).forEach(a=>document.addEventListener(a,s)),()=>{(e||w0).forEach(a=>document.removeEventListener(a,s))}},[r,n,t]),r}function nT(n,e){try{return n.addEventListener("change",e),()=>n.removeEventListener("change",e)}catch{return n.addListener(e),()=>n.removeListener(e)}}function rT(n,e){return typeof window<"u"&&"matchMedia"in window?window.matchMedia(n).matches:!1}function sT(n,e,{getInitialValueInEffect:t}={getInitialValueInEffect:!0}){const[r,s]=P.useState(t?e:rT(n)),a=P.useRef(null);return P.useEffect(()=>{if("matchMedia"in window)return a.current=window.matchMedia(n),s(a.current.matches),nT(a.current,o=>s(o.matches))},[n]),r}const fu=typeof document<"u"?P.useLayoutEffect:P.useEffect;function Wa(n,e){const t=P.useRef(!1);P.useEffect(()=>()=>{t.current=!1},[]),P.useEffect(()=>{if(t.current)return n();t.current=!0},e)}function aT({opened:n,shouldReturnFocus:e=!0}){const t=P.useRef(null),r=()=>{var s;t.current&&"focus"in t.current&&typeof t.current.focus=="function"&&((s=t.current)==null||s.focus({preventScroll:!0}))};return Wa(()=>{let s=-1;const a=o=>{o.key==="Tab"&&window.clearTimeout(s)};return document.addEventListener("keydown",a),n?t.current=document.activeElement:e&&(s=window.setTimeout(r,10)),()=>{window.clearTimeout(s),document.removeEventListener("keydown",a)}},[n,e]),r}const iT=/input|select|textarea|button|object/,D1="a, input, select, textarea, button, object, [tabindex]";function oT(n){return n.style.display==="none"}function lT(n){if(n.getAttribute("aria-hidden")||n.getAttribute("hidden")||n.getAttribute("type")==="hidden")return!1;let t=n;for(;t&&!(t===document.body||t.nodeType===11);){if(oT(t))return!1;t=t.parentNode}return!0}function F1(n){let e=n.getAttribute("tabindex");return e===null&&(e=void 0),parseInt(e,10)}function Og(n){const e=n.nodeName.toLowerCase(),t=!Number.isNaN(F1(n));return(iT.test(e)&&!n.disabled||n instanceof HTMLAnchorElement&&n.href||t)&&lT(n)}function U1(n){const e=F1(n);return(Number.isNaN(e)||e>=0)&&Og(n)}function uT(n){return Array.from(n.querySelectorAll(D1)).filter(U1)}function cT(n,e){const t=uT(n);if(!t.length){e.preventDefault();return}const r=t[e.shiftKey?0:t.length-1],s=n.getRootNode();let a=r===s.activeElement||n===s.activeElement;const o=s.activeElement;if(o.tagName==="INPUT"&&o.getAttribute("type")==="radio"&&(a=t.filter(h=>h.getAttribute("type")==="radio"&&h.getAttribute("name")===o.getAttribute("name")).includes(r)),!a)return;e.preventDefault();const c=t[e.shiftKey?t.length-1:0];c&&c.focus()}function dT(n=!0){const e=P.useRef(null),t=s=>{let a=s.querySelector("[data-autofocus]");if(!a){const o=Array.from(s.querySelectorAll(D1));a=o.find(U1)||o.find(Og)||null,!a&&Og(s)&&(a=s)}a&&a.focus({preventScroll:!0})},r=P.useCallback(s=>{n&&s!==null&&e.current!==s&&(s?(setTimeout(()=>{s.getRootNode()&&t(s)}),e.current=s):e.current=null)},[n]);return P.useEffect(()=>{if(!n)return;e.current&&setTimeout(()=>t(e.current));const s=a=>{a.key==="Tab"&&e.current&&cT(e.current,a)};return document.addEventListener("keydown",s),()=>document.removeEventListener("keydown",s)},[n]),r}const fT=Va.useId||(()=>{});function hT(){const n=fT();return n?`mantine-${n.replace(/:/g,"")}`:""}function uo(n){const e=hT(),[t,r]=P.useState(e);return fu(()=>{r(QO())},[]),typeof n=="string"?n:typeof window>"u"?e:t}function Pd(n,e){if(typeof n=="function")return n(e);typeof n=="object"&&n!==null&&"current"in n&&(n.current=e)}function z1(...n){const e=new Map;return t=>{if(n.forEach(r=>{const s=Pd(r,t);s&&e.set(r,s)}),e.size>0)return()=>{n.forEach(r=>{const s=e.get(r);s?s():Pd(r,null)}),e.clear()}}}function An(...n){return P.useCallback(z1(...n),n)}function qa({value:n,defaultValue:e,finalValue:t,onChange:r=()=>{}}){const[s,a]=P.useState(e!==void 0?e:t),o=(u,...c)=>{a(u),r==null||r(u,...c)};return n!==void 0?[n,r,!0]:[s,o,!1]}function B1(n,e){return sT("(prefers-reduced-motion: reduce)",n,e)}function pT(n){const e=P.useRef(void 0);return P.useEffect(()=>{e.current=n},[n]),e.current}var mT={};function gT(){return typeof process<"u"&&mT?"production":"development"}function H1(n){var t;const e=Va.version;return typeof Va.version!="string"||e.startsWith("18.")?n==null?void 0:n.ref:(t=n==null?void 0:n.props)==null?void 0:t.ref}function V1(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var s=n.length;for(e=0;e<s;e++)n[e]&&(t=V1(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function os(){for(var n,e,t=0,r="",s=arguments.length;t<s;t++)(n=arguments[t])&&(e=V1(n))&&(r&&(r+=" "),r+=e);return r}const yT={};function _T(n){const e={};return n.forEach(t=>{Object.entries(t).forEach(([r,s])=>{e[r]?e[r]=os(e[r],s):e[r]=s})}),e}function rf({theme:n,classNames:e,props:t,stylesCtx:r}){const a=(Array.isArray(e)?e:[e]).map(o=>typeof o=="function"?o(n,t,r):o||yT);return _T(a)}function kd({theme:n,styles:e,props:t,stylesCtx:r}){return(Array.isArray(e)?e:[e]).reduce((a,o)=>typeof o=="function"?{...a,...o(n,t,r)}:{...a,...o},{})}const W1=P.createContext(null);function ri(){const n=P.useContext(W1);if(!n)throw new Error("[@mantine/core] MantineProvider was not found in tree");return n}function wT(){return ri().cssVariablesResolver}function bT(){return ri().classNamesPrefix}function xy(){return ri().getStyleNonce}function vT(){return ri().withStaticClasses}function xT(){return ri().headless}function ST(){var n;return(n=ri().stylesTransform)==null?void 0:n.sx}function ET(){var n;return(n=ri().stylesTransform)==null?void 0:n.styles}function CT(n){return/^#?([0-9A-F]{3}){1,2}([0-9A-F]{2})?$/i.test(n)}function PT(n){let e=n.replace("#","");if(e.length===3){const o=e.split("");e=[o[0],o[0],o[1],o[1],o[2],o[2]].join("")}if(e.length===8){const o=parseInt(e.slice(6,8),16)/255;return{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16),a:o}}const t=parseInt(e,16),r=t>>16&255,s=t>>8&255,a=t&255;return{r,g:s,b:a,a:1}}function kT(n){const[e,t,r,s]=n.replace(/[^0-9,./]/g,"").split(/[/,]/).map(Number);return{r:e,g:t,b:r,a:s||1}}function RT(n){const e=/^hsla?\(\s*(\d+)\s*,\s*(\d+%)\s*,\s*(\d+%)\s*(,\s*(0?\.\d+|\d+(\.\d+)?))?\s*\)$/i,t=n.match(e);if(!t)return{r:0,g:0,b:0,a:1};const r=parseInt(t[1],10),s=parseInt(t[2],10)/100,a=parseInt(t[3],10)/100,o=t[5]?parseFloat(t[5]):void 0,u=(1-Math.abs(2*a-1))*s,c=r/60,f=u*(1-Math.abs(c%2-1)),h=a-u/2;let m,g,y;return c>=0&&c<1?(m=u,g=f,y=0):c>=1&&c<2?(m=f,g=u,y=0):c>=2&&c<3?(m=0,g=u,y=f):c>=3&&c<4?(m=0,g=f,y=u):c>=4&&c<5?(m=f,g=0,y=u):(m=u,g=0,y=f),{r:Math.round((m+h)*255),g:Math.round((g+h)*255),b:Math.round((y+h)*255),a:o||1}}function Sy(n){return CT(n)?PT(n):n.startsWith("rgb")?kT(n):n.startsWith("hsl")?RT(n):{r:0,g:0,b:0,a:1}}function Vc(n,e){if(n.startsWith("var("))return`color-mix(in srgb, ${n}, black ${e*100}%)`;const{r:t,g:r,b:s,a}=Sy(n),o=1-e,u=c=>Math.round(c*o);return`rgba(${u(t)}, ${u(r)}, ${u(s)}, ${a})`}function zl(n,e){return typeof n.primaryShade=="number"?n.primaryShade:e==="dark"?n.primaryShade.dark:n.primaryShade.light}function Bp(n){return n<=.03928?n/12.92:((n+.055)/1.055)**2.4}function OT(n){const e=n.match(/oklch\((.*?)%\s/);return e?parseFloat(e[1]):null}function TT(n){if(n.startsWith("oklch("))return(OT(n)||0)/100;const{r:e,g:t,b:r}=Sy(n),s=e/255,a=t/255,o=r/255,u=Bp(s),c=Bp(a),f=Bp(o);return .2126*u+.7152*c+.0722*f}function pl(n,e=.179){return n.startsWith("var(")?!1:TT(n)>e}function hu({color:n,theme:e,colorScheme:t}){if(typeof n!="string")throw new Error(`[@mantine/core] Failed to parse color. Expected color to be a string, instead got ${typeof n}`);if(n==="bright")return{color:n,value:t==="dark"?e.white:e.black,shade:void 0,isThemeColor:!1,isLight:pl(t==="dark"?e.white:e.black,e.luminanceThreshold),variable:"--mantine-color-bright"};if(n==="dimmed")return{color:n,value:t==="dark"?e.colors.dark[2]:e.colors.gray[7],shade:void 0,isThemeColor:!1,isLight:pl(t==="dark"?e.colors.dark[2]:e.colors.gray[6],e.luminanceThreshold),variable:"--mantine-color-dimmed"};if(n==="white"||n==="black")return{color:n,value:n==="white"?e.white:e.black,shade:void 0,isThemeColor:!1,isLight:pl(n==="white"?e.white:e.black,e.luminanceThreshold),variable:`--mantine-color-${n}`};const[r,s]=n.split("."),a=s?Number(s):void 0,o=r in e.colors;if(o){const u=a!==void 0?e.colors[r][a]:e.colors[r][zl(e,t||"light")];return{color:r,value:u,shade:a,isThemeColor:o,isLight:pl(u,e.luminanceThreshold),variable:s?`--mantine-color-${r}-${a}`:`--mantine-color-${r}-filled`}}return{color:n,value:n,isThemeColor:o,isLight:pl(n,e.luminanceThreshold),shade:a,variable:void 0}}function Bl(n,e){const t=hu({color:n||e.primaryColor,theme:e});return t.variable?`var(${t.variable})`:n}function Tg(n,e){const t={from:(n==null?void 0:n.from)||e.defaultGradient.from,to:(n==null?void 0:n.to)||e.defaultGradient.to,deg:(n==null?void 0:n.deg)||e.defaultGradient.deg||0},r=Bl(t.from,e),s=Bl(t.to,e);return`linear-gradient(${t.deg}deg, ${r} 0%, ${s} 100%)`}function Vr(n,e){if(typeof n!="string"||e>1||e<0)return"rgba(0, 0, 0, 1)";if(n.startsWith("var(")){const a=(1-e)*100;return`color-mix(in srgb, ${n}, transparent ${a}%)`}if(n.startsWith("oklch"))return n.includes("/")?n.replace(/\/\s*[\d.]+\s*\)/,`/ ${e})`):n.replace(")",` / ${e})`);const{r:t,g:r,b:s}=Sy(n);return`rgba(${t}, ${r}, ${s}, ${e})`}const Ai=Vr,AT=({color:n,theme:e,variant:t,gradient:r,autoContrast:s})=>{const a=hu({color:n,theme:e}),o=typeof s=="boolean"?s:e.autoContrast;if(t==="filled"){const u=o&&a.isLight?"var(--mantine-color-black)":"var(--mantine-color-white)";return a.isThemeColor?a.shade===void 0?{background:`var(--mantine-color-${n}-filled)`,hover:`var(--mantine-color-${n}-filled-hover)`,color:u,border:`${Q(1)} solid transparent`}:{background:`var(--mantine-color-${a.color}-${a.shade})`,hover:`var(--mantine-color-${a.color}-${a.shade===9?8:a.shade+1})`,color:u,border:`${Q(1)} solid transparent`}:{background:n,hover:Vc(n,.1),color:u,border:`${Q(1)} solid transparent`}}if(t==="light"){if(a.isThemeColor){if(a.shade===void 0)return{background:`var(--mantine-color-${n}-light)`,hover:`var(--mantine-color-${n}-light-hover)`,color:`var(--mantine-color-${n}-light-color)`,border:`${Q(1)} solid transparent`};const u=e.colors[a.color][a.shade];return{background:Vr(u,.1),hover:Vr(u,.12),color:`var(--mantine-color-${a.color}-${Math.min(a.shade,6)})`,border:`${Q(1)} solid transparent`}}return{background:Vr(n,.1),hover:Vr(n,.12),color:n,border:`${Q(1)} solid transparent`}}if(t==="outline")return a.isThemeColor?a.shade===void 0?{background:"transparent",hover:`var(--mantine-color-${n}-outline-hover)`,color:`var(--mantine-color-${n}-outline)`,border:`${Q(1)} solid var(--mantine-color-${n}-outline)`}:{background:"transparent",hover:Vr(e.colors[a.color][a.shade],.05),color:`var(--mantine-color-${a.color}-${a.shade})`,border:`${Q(1)} solid var(--mantine-color-${a.color}-${a.shade})`}:{background:"transparent",hover:Vr(n,.05),color:n,border:`${Q(1)} solid ${n}`};if(t==="subtle"){if(a.isThemeColor){if(a.shade===void 0)return{background:"transparent",hover:`var(--mantine-color-${n}-light-hover)`,color:`var(--mantine-color-${n}-light-color)`,border:`${Q(1)} solid transparent`};const u=e.colors[a.color][a.shade];return{background:"transparent",hover:Vr(u,.12),color:`var(--mantine-color-${a.color}-${Math.min(a.shade,6)})`,border:`${Q(1)} solid transparent`}}return{background:"transparent",hover:Vr(n,.12),color:n,border:`${Q(1)} solid transparent`}}return t==="transparent"?a.isThemeColor?a.shade===void 0?{background:"transparent",hover:"transparent",color:`var(--mantine-color-${n}-light-color)`,border:`${Q(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:`var(--mantine-color-${a.color}-${Math.min(a.shade,6)})`,border:`${Q(1)} solid transparent`}:{background:"transparent",hover:"transparent",color:n,border:`${Q(1)} solid transparent`}:t==="white"?a.isThemeColor?a.shade===void 0?{background:"var(--mantine-color-white)",hover:Vc(e.white,.01),color:`var(--mantine-color-${n}-filled)`,border:`${Q(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:Vc(e.white,.01),color:`var(--mantine-color-${a.color}-${a.shade})`,border:`${Q(1)} solid transparent`}:{background:"var(--mantine-color-white)",hover:Vc(e.white,.01),color:n,border:`${Q(1)} solid transparent`}:t==="gradient"?{background:Tg(r,e),hover:Tg(r,e),color:"var(--mantine-color-white)",border:"none"}:t==="default"?{background:"var(--mantine-color-default)",hover:"var(--mantine-color-default-hover)",color:"var(--mantine-color-default-color)",border:`${Q(1)} solid var(--mantine-color-default-border)`}:{}},$T={dark:["#C9C9C9","#b8b8b8","#828282","#696969","#424242","#3b3b3b","#2e2e2e","#242424","#1f1f1f","#141414"],gray:["#f8f9fa","#f1f3f5","#e9ecef","#dee2e6","#ced4da","#adb5bd","#868e96","#495057","#343a40","#212529"],red:["#fff5f5","#ffe3e3","#ffc9c9","#ffa8a8","#ff8787","#ff6b6b","#fa5252","#f03e3e","#e03131","#c92a2a"],pink:["#fff0f6","#ffdeeb","#fcc2d7","#faa2c1","#f783ac","#f06595","#e64980","#d6336c","#c2255c","#a61e4d"],grape:["#f8f0fc","#f3d9fa","#eebefa","#e599f7","#da77f2","#cc5de8","#be4bdb","#ae3ec9","#9c36b5","#862e9c"],violet:["#f3f0ff","#e5dbff","#d0bfff","#b197fc","#9775fa","#845ef7","#7950f2","#7048e8","#6741d9","#5f3dc4"],indigo:["#edf2ff","#dbe4ff","#bac8ff","#91a7ff","#748ffc","#5c7cfa","#4c6ef5","#4263eb","#3b5bdb","#364fc7"],blue:["#e7f5ff","#d0ebff","#a5d8ff","#74c0fc","#4dabf7","#339af0","#228be6","#1c7ed6","#1971c2","#1864ab"],cyan:["#e3fafc","#c5f6fa","#99e9f2","#66d9e8","#3bc9db","#22b8cf","#15aabf","#1098ad","#0c8599","#0b7285"],teal:["#e6fcf5","#c3fae8","#96f2d7","#63e6be","#38d9a9","#20c997","#12b886","#0ca678","#099268","#087f5b"],green:["#ebfbee","#d3f9d8","#b2f2bb","#8ce99a","#69db7c","#51cf66","#40c057","#37b24d","#2f9e44","#2b8a3e"],lime:["#f4fce3","#e9fac8","#d8f5a2","#c0eb75","#a9e34b","#94d82d","#82c91e","#74b816","#66a80f","#5c940d"],yellow:["#fff9db","#fff3bf","#ffec99","#ffe066","#ffd43b","#fcc419","#fab005","#f59f00","#f08c00","#e67700"],orange:["#fff4e6","#ffe8cc","#ffd8a8","#ffc078","#ffa94d","#ff922b","#fd7e14","#f76707","#e8590c","#d9480f"]},b0="-apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji",Ey={scale:1,fontSmoothing:!0,focusRing:"auto",white:"#fff",black:"#000",colors:$T,primaryShade:{light:6,dark:8},primaryColor:"blue",variantColorResolver:AT,autoContrast:!1,luminanceThreshold:.3,fontFamily:b0,fontFamilyMonospace:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, Liberation Mono, Courier New, monospace",respectReducedMotion:!1,cursorType:"default",defaultGradient:{from:"blue",to:"cyan",deg:45},defaultRadius:"sm",activeClassName:"mantine-active",focusClassName:"",headings:{fontFamily:b0,fontWeight:"700",textWrap:"wrap",sizes:{h1:{fontSize:Q(34),lineHeight:"1.3"},h2:{fontSize:Q(26),lineHeight:"1.35"},h3:{fontSize:Q(22),lineHeight:"1.4"},h4:{fontSize:Q(18),lineHeight:"1.45"},h5:{fontSize:Q(16),lineHeight:"1.5"},h6:{fontSize:Q(14),lineHeight:"1.5"}}},fontSizes:{xs:Q(12),sm:Q(14),md:Q(16),lg:Q(18),xl:Q(20)},lineHeights:{xs:"1.4",sm:"1.45",md:"1.55",lg:"1.6",xl:"1.65"},radius:{xs:Q(2),sm:Q(4),md:Q(8),lg:Q(16),xl:Q(32)},spacing:{xs:Q(10),sm:Q(12),md:Q(16),lg:Q(20),xl:Q(32)},breakpoints:{xs:"36em",sm:"48em",md:"62em",lg:"75em",xl:"88em"},shadows:{xs:`0 ${Q(1)} ${Q(3)} rgba(0, 0, 0, 0.05), 0 ${Q(1)} ${Q(2)} rgba(0, 0, 0, 0.1)`,sm:`0 ${Q(1)} ${Q(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Q(10)} ${Q(15)} ${Q(-5)}, rgba(0, 0, 0, 0.04) 0 ${Q(7)} ${Q(7)} ${Q(-5)}`,md:`0 ${Q(1)} ${Q(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Q(20)} ${Q(25)} ${Q(-5)}, rgba(0, 0, 0, 0.04) 0 ${Q(10)} ${Q(10)} ${Q(-5)}`,lg:`0 ${Q(1)} ${Q(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Q(28)} ${Q(23)} ${Q(-7)}, rgba(0, 0, 0, 0.04) 0 ${Q(12)} ${Q(12)} ${Q(-7)}`,xl:`0 ${Q(1)} ${Q(3)} rgba(0, 0, 0, 0.05), rgba(0, 0, 0, 0.05) 0 ${Q(36)} ${Q(28)} ${Q(-7)}, rgba(0, 0, 0, 0.04) 0 ${Q(17)} ${Q(17)} ${Q(-7)}`},other:{},components:{}};function v0(n){return n==="auto"||n==="dark"||n==="light"}function IT({key:n="mantine-color-scheme-value"}={}){let e;return{get:t=>{if(typeof window>"u")return t;try{const r=window.localStorage.getItem(n);return v0(r)?r:t}catch{return t}},set:t=>{try{window.localStorage.setItem(n,t)}catch(r){console.warn("[@mantine/core] Local storage color scheme manager was unable to save color scheme.",r)}},subscribe:t=>{e=r=>{r.storageArea===window.localStorage&&r.key===n&&v0(r.newValue)&&t(r.newValue)},window.addEventListener("storage",e)},unsubscribe:()=>{window.removeEventListener("storage",e)},clear:()=>{window.localStorage.removeItem(n)}}}const NT="[@mantine/core] MantineProvider: Invalid theme.primaryColor, it accepts only key of theme.colors, learn more  https://mantine.dev/theming/colors/#primary-color",x0="[@mantine/core] MantineProvider: Invalid theme.primaryShade, it accepts only 0-9 integers or an object { light: 0-9, dark: 0-9 }";function Hp(n){return n<0||n>9?!1:parseInt(n.toString(),10)===n}function S0(n){if(!(n.primaryColor in n.colors))throw new Error(NT);if(typeof n.primaryShade=="object"&&(!Hp(n.primaryShade.dark)||!Hp(n.primaryShade.light)))throw new Error(x0);if(typeof n.primaryShade=="number"&&!Hp(n.primaryShade))throw new Error(x0)}function jT(n,e){var r;if(!e)return S0(n),n;const t=vy(n,e);return e.fontFamily&&!((r=e.headings)!=null&&r.fontFamily)&&(t.headings.fontFamily=e.fontFamily),S0(t),t}const Cy=P.createContext(null),LT=()=>P.useContext(Cy)||Ey;function ls(){const n=P.useContext(Cy);if(!n)throw new Error("@mantine/core: MantineProvider was not found in component tree, make sure you have it in your app");return n}function q1({theme:n,children:e,inherit:t=!0}){const r=LT(),s=P.useMemo(()=>jT(t?r:Ey,n),[n,r,t]);return O.jsx(Cy.Provider,{value:s,children:e})}q1.displayName="@mantine/core/MantineThemeProvider";function MT(){const n=ls(),e=xy(),t=Kr(n.breakpoints).reduce((r,s)=>{const a=n.breakpoints[s].includes("px"),o=VO(n.breakpoints[s]),u=a?`${o-.1}px`:y0(o-.1),c=a?`${o}px`:y0(o);return`${r}@media (max-width: ${u}) {.mantine-visible-from-${s} {display: none !important;}}@media (min-width: ${c}) {.mantine-hidden-from-${s} {display: none !important;}}`},"");return O.jsx("style",{"data-mantine-styles":"classes",nonce:e==null?void 0:e(),dangerouslySetInnerHTML:{__html:t}})}function Vp(n){return Object.entries(n).map(([e,t])=>`${e}: ${t};`).join("")}function ml(n,e){return(Array.isArray(n)?n:[n]).reduce((r,s)=>`${s}{${r}}`,e)}function DT(n,e){const t=Vp(n.variables),r=t?ml(e,t):"",s=Vp(n.dark),a=Vp(n.light),o=s?ml(e===":host"?`${e}([data-mantine-color-scheme="dark"])`:`${e}[data-mantine-color-scheme="dark"]`,s):"",u=a?ml(e===":host"?`${e}([data-mantine-color-scheme="light"])`:`${e}[data-mantine-color-scheme="light"]`,a):"";return`${r}${o}${u}`}function FT({color:n,theme:e,autoContrast:t}){return e.autoContrast&&hu({color:n||e.primaryColor,theme:e}).isLight?"var(--mantine-color-black)":"var(--mantine-color-white)"}function E0(n,e){return FT({color:n.colors[n.primaryColor][zl(n,e)],theme:n,autoContrast:null})}function Wc({theme:n,color:e,colorScheme:t,name:r=e,withColorValues:s=!0}){if(!n.colors[e])return{};if(t==="light"){const u=zl(n,"light"),c={[`--mantine-color-${r}-text`]:`var(--mantine-color-${r}-filled)`,[`--mantine-color-${r}-filled`]:`var(--mantine-color-${r}-${u})`,[`--mantine-color-${r}-filled-hover`]:`var(--mantine-color-${r}-${u===9?8:u+1})`,[`--mantine-color-${r}-light`]:Ai(n.colors[e][u],.1),[`--mantine-color-${r}-light-hover`]:Ai(n.colors[e][u],.12),[`--mantine-color-${r}-light-color`]:`var(--mantine-color-${r}-${u})`,[`--mantine-color-${r}-outline`]:`var(--mantine-color-${r}-${u})`,[`--mantine-color-${r}-outline-hover`]:Ai(n.colors[e][u],.05)};return s?{[`--mantine-color-${r}-0`]:n.colors[e][0],[`--mantine-color-${r}-1`]:n.colors[e][1],[`--mantine-color-${r}-2`]:n.colors[e][2],[`--mantine-color-${r}-3`]:n.colors[e][3],[`--mantine-color-${r}-4`]:n.colors[e][4],[`--mantine-color-${r}-5`]:n.colors[e][5],[`--mantine-color-${r}-6`]:n.colors[e][6],[`--mantine-color-${r}-7`]:n.colors[e][7],[`--mantine-color-${r}-8`]:n.colors[e][8],[`--mantine-color-${r}-9`]:n.colors[e][9],...c}:c}const a=zl(n,"dark"),o={[`--mantine-color-${r}-text`]:`var(--mantine-color-${r}-4)`,[`--mantine-color-${r}-filled`]:`var(--mantine-color-${r}-${a})`,[`--mantine-color-${r}-filled-hover`]:`var(--mantine-color-${r}-${a===9?8:a+1})`,[`--mantine-color-${r}-light`]:Ai(n.colors[e][Math.max(0,a-2)],.15),[`--mantine-color-${r}-light-hover`]:Ai(n.colors[e][Math.max(0,a-2)],.2),[`--mantine-color-${r}-light-color`]:`var(--mantine-color-${r}-${Math.max(a-5,0)})`,[`--mantine-color-${r}-outline`]:`var(--mantine-color-${r}-${Math.max(a-4,0)})`,[`--mantine-color-${r}-outline-hover`]:Ai(n.colors[e][Math.max(a-4,0)],.05)};return s?{[`--mantine-color-${r}-0`]:n.colors[e][0],[`--mantine-color-${r}-1`]:n.colors[e][1],[`--mantine-color-${r}-2`]:n.colors[e][2],[`--mantine-color-${r}-3`]:n.colors[e][3],[`--mantine-color-${r}-4`]:n.colors[e][4],[`--mantine-color-${r}-5`]:n.colors[e][5],[`--mantine-color-${r}-6`]:n.colors[e][6],[`--mantine-color-${r}-7`]:n.colors[e][7],[`--mantine-color-${r}-8`]:n.colors[e][8],[`--mantine-color-${r}-9`]:n.colors[e][9],...o}:o}function UT(n){return!!n&&typeof n=="object"&&"mantine-virtual-color"in n}function $i(n,e,t){Kr(e).forEach(r=>Object.assign(n,{[`--mantine-${t}-${r}`]:e[r]}))}const Z1=n=>{const e=zl(n,"light"),t=n.defaultRadius in n.radius?n.radius[n.defaultRadius]:Q(n.defaultRadius),r={variables:{"--mantine-scale":n.scale.toString(),"--mantine-cursor-type":n.cursorType,"--mantine-color-scheme":"light dark","--mantine-webkit-font-smoothing":n.fontSmoothing?"antialiased":"unset","--mantine-moz-font-smoothing":n.fontSmoothing?"grayscale":"unset","--mantine-color-white":n.white,"--mantine-color-black":n.black,"--mantine-line-height":n.lineHeights.md,"--mantine-font-family":n.fontFamily,"--mantine-font-family-monospace":n.fontFamilyMonospace,"--mantine-font-family-headings":n.headings.fontFamily,"--mantine-heading-font-weight":n.headings.fontWeight,"--mantine-heading-text-wrap":n.headings.textWrap,"--mantine-radius-default":t,"--mantine-primary-color-filled":`var(--mantine-color-${n.primaryColor}-filled)`,"--mantine-primary-color-filled-hover":`var(--mantine-color-${n.primaryColor}-filled-hover)`,"--mantine-primary-color-light":`var(--mantine-color-${n.primaryColor}-light)`,"--mantine-primary-color-light-hover":`var(--mantine-color-${n.primaryColor}-light-hover)`,"--mantine-primary-color-light-color":`var(--mantine-color-${n.primaryColor}-light-color)`},light:{"--mantine-primary-color-contrast":E0(n,"light"),"--mantine-color-bright":"var(--mantine-color-black)","--mantine-color-text":n.black,"--mantine-color-body":n.white,"--mantine-color-error":"var(--mantine-color-red-6)","--mantine-color-placeholder":"var(--mantine-color-gray-5)","--mantine-color-anchor":`var(--mantine-color-${n.primaryColor}-${e})`,"--mantine-color-default":"var(--mantine-color-white)","--mantine-color-default-hover":"var(--mantine-color-gray-0)","--mantine-color-default-color":"var(--mantine-color-black)","--mantine-color-default-border":"var(--mantine-color-gray-4)","--mantine-color-dimmed":"var(--mantine-color-gray-6)"},dark:{"--mantine-primary-color-contrast":E0(n,"dark"),"--mantine-color-bright":"var(--mantine-color-white)","--mantine-color-text":"var(--mantine-color-dark-0)","--mantine-color-body":"var(--mantine-color-dark-7)","--mantine-color-error":"var(--mantine-color-red-8)","--mantine-color-placeholder":"var(--mantine-color-dark-3)","--mantine-color-anchor":`var(--mantine-color-${n.primaryColor}-4)`,"--mantine-color-default":"var(--mantine-color-dark-6)","--mantine-color-default-hover":"var(--mantine-color-dark-5)","--mantine-color-default-color":"var(--mantine-color-white)","--mantine-color-default-border":"var(--mantine-color-dark-4)","--mantine-color-dimmed":"var(--mantine-color-dark-2)"}};$i(r.variables,n.breakpoints,"breakpoint"),$i(r.variables,n.spacing,"spacing"),$i(r.variables,n.fontSizes,"font-size"),$i(r.variables,n.lineHeights,"line-height"),$i(r.variables,n.shadows,"shadow"),$i(r.variables,n.radius,"radius"),n.colors[n.primaryColor].forEach((a,o)=>{r.variables[`--mantine-primary-color-${o}`]=`var(--mantine-color-${n.primaryColor}-${o})`}),Kr(n.colors).forEach(a=>{const o=n.colors[a];if(UT(o)){Object.assign(r.light,Wc({theme:n,name:o.name,color:o.light,colorScheme:"light",withColorValues:!0})),Object.assign(r.dark,Wc({theme:n,name:o.name,color:o.dark,colorScheme:"dark",withColorValues:!0}));return}o.forEach((u,c)=>{r.variables[`--mantine-color-${a}-${c}`]=u}),Object.assign(r.light,Wc({theme:n,color:a,colorScheme:"light",withColorValues:!1})),Object.assign(r.dark,Wc({theme:n,color:a,colorScheme:"dark",withColorValues:!1}))});const s=n.headings.sizes;return Kr(s).forEach(a=>{r.variables[`--mantine-${a}-font-size`]=s[a].fontSize,r.variables[`--mantine-${a}-line-height`]=s[a].lineHeight,r.variables[`--mantine-${a}-font-weight`]=s[a].fontWeight||n.headings.fontWeight}),r};function zT({theme:n,generator:e}){const t=Z1(n),r=e==null?void 0:e(n);return r?vy(t,r):t}const Wp=Z1(Ey);function BT(n){const e={variables:{},light:{},dark:{}};return Kr(n.variables).forEach(t=>{Wp.variables[t]!==n.variables[t]&&(e.variables[t]=n.variables[t])}),Kr(n.light).forEach(t=>{Wp.light[t]!==n.light[t]&&(e.light[t]=n.light[t])}),Kr(n.dark).forEach(t=>{Wp.dark[t]!==n.dark[t]&&(e.dark[t]=n.dark[t])}),e}function HT(n){return`
  ${n}[data-mantine-color-scheme="dark"] { --mantine-color-scheme: dark; }
  ${n}[data-mantine-color-scheme="light"] { --mantine-color-scheme: light; }
`}function G1({cssVariablesSelector:n,deduplicateCssVariables:e}){const t=ls(),r=xy(),s=wT(),a=zT({theme:t,generator:s}),o=n===":root"&&e,u=o?BT(a):a,c=DT(u,n);return c?O.jsx("style",{"data-mantine-styles":!0,nonce:r==null?void 0:r(),dangerouslySetInnerHTML:{__html:`${c}${o?"":HT(n)}`}}):null}G1.displayName="@mantine/CssVariables";function VT(){const n=console.error;console.error=(...e)=>{e.length>1&&typeof e[0]=="string"&&e[0].toLowerCase().includes("extra attributes from the server")&&typeof e[1]=="string"&&e[1].toLowerCase().includes("data-mantine-color-scheme")||n(...e)}}function Ii(n,e){var s,a;const t=typeof window<"u"&&"matchMedia"in window&&((s=window.matchMedia("(prefers-color-scheme: dark)"))==null?void 0:s.matches),r=n!=="auto"?n:t?"dark":"light";(a=e())==null||a.setAttribute("data-mantine-color-scheme",r)}function WT({manager:n,defaultColorScheme:e,getRootElement:t,forceColorScheme:r}){const s=P.useRef(null),[a,o]=P.useState(()=>n.get(e)),u=r||a,c=P.useCallback(h=>{r||(Ii(h,t),o(h),n.set(h))},[n.set,u,r]),f=P.useCallback(()=>{o(e),Ii(e,t),n.clear()},[n.clear,e]);return P.useEffect(()=>(n.subscribe(c),n.unsubscribe),[n.subscribe,n.unsubscribe]),fu(()=>{Ii(n.get(e),t)},[]),P.useEffect(()=>{var m;if(r)return Ii(r,t),()=>{};r===void 0&&Ii(a,t),typeof window<"u"&&"matchMedia"in window&&(s.current=window.matchMedia("(prefers-color-scheme: dark)"));const h=g=>{a==="auto"&&Ii(g.matches?"dark":"light",t)};return(m=s.current)==null||m.addEventListener("change",h),()=>{var g;return(g=s.current)==null?void 0:g.removeEventListener("change",h)}},[a,r]),{colorScheme:u,setColorScheme:c,clearColorScheme:f}}function qT({respectReducedMotion:n,getRootElement:e}){fu(()=>{var t;n&&((t=e())==null||t.setAttribute("data-respect-reduced-motion","true"))},[n])}VT();function J1({theme:n,children:e,getStyleNonce:t,withStaticClasses:r=!0,withGlobalClasses:s=!0,deduplicateCssVariables:a=!0,withCssVariables:o=!0,cssVariablesSelector:u=":root",classNamesPrefix:c="mantine",colorSchemeManager:f=IT(),defaultColorScheme:h="light",getRootElement:m=()=>document.documentElement,cssVariablesResolver:g,forceColorScheme:y,stylesTransform:w}){const{colorScheme:v,setColorScheme:x,clearColorScheme:E}=WT({defaultColorScheme:h,forceColorScheme:y,manager:f,getRootElement:m});return qT({respectReducedMotion:(n==null?void 0:n.respectReducedMotion)||!1,getRootElement:m}),O.jsx(W1.Provider,{value:{colorScheme:v,setColorScheme:x,clearColorScheme:E,getRootElement:m,classNamesPrefix:c,getStyleNonce:t,cssVariablesResolver:g,cssVariablesSelector:u,withStaticClasses:r,stylesTransform:w},children:O.jsxs(q1,{theme:n,children:[o&&O.jsx(G1,{cssVariablesSelector:u,deduplicateCssVariables:a}),s&&O.jsx(MT,{}),e]})})}J1.displayName="@mantine/core/MantineProvider";function pu({classNames:n,styles:e,props:t,stylesCtx:r}){const s=ls();return{resolvedClassNames:rf({theme:s,classNames:n,props:t,stylesCtx:r||void 0}),resolvedStyles:kd({theme:s,styles:e,props:t,stylesCtx:r||void 0})}}const ZT={always:"mantine-focus-always",auto:"mantine-focus-auto",never:"mantine-focus-never"};function GT({theme:n,options:e,unstyled:t}){return os((e==null?void 0:e.focusable)&&!t&&(n.focusClassName||ZT[n.focusRing]),(e==null?void 0:e.active)&&!t&&n.activeClassName)}function JT({selector:n,stylesCtx:e,options:t,props:r,theme:s}){return rf({theme:s,classNames:t==null?void 0:t.classNames,props:(t==null?void 0:t.props)||r,stylesCtx:e})[n]}function C0({selector:n,stylesCtx:e,theme:t,classNames:r,props:s}){return rf({theme:t,classNames:r,props:s,stylesCtx:e})[n]}function KT({rootSelector:n,selector:e,className:t}){return n===e?t:void 0}function XT({selector:n,classes:e,unstyled:t}){return t?void 0:e[n]}function YT({themeName:n,classNamesPrefix:e,selector:t,withStaticClass:r}){return r===!1?[]:n.map(s=>`${e}-${s}-${t}`)}function QT({themeName:n,theme:e,selector:t,props:r,stylesCtx:s}){return n.map(a=>{var o,u;return(u=rf({theme:e,classNames:(o=e.components[a])==null?void 0:o.classNames,props:r,stylesCtx:s}))==null?void 0:u[t]})}function eA({options:n,classes:e,selector:t,unstyled:r}){return n!=null&&n.variant&&!r?e[`${t}--${n.variant}`]:void 0}function tA({theme:n,options:e,themeName:t,selector:r,classNamesPrefix:s,classNames:a,classes:o,unstyled:u,className:c,rootSelector:f,props:h,stylesCtx:m,withStaticClasses:g,headless:y,transformedStyles:w}){return os(GT({theme:n,options:e,unstyled:u||y}),QT({theme:n,themeName:t,selector:r,props:h,stylesCtx:m}),eA({options:e,classes:o,selector:r,unstyled:u}),C0({selector:r,stylesCtx:m,theme:n,classNames:a,props:h}),C0({selector:r,stylesCtx:m,theme:n,classNames:w,props:h}),JT({selector:r,stylesCtx:m,options:e,props:h,theme:n}),KT({rootSelector:f,selector:r,className:c}),XT({selector:r,classes:o,unstyled:u||y}),g&&!y&&YT({themeName:t,classNamesPrefix:s,selector:r,withStaticClass:e==null?void 0:e.withStaticClass}),e==null?void 0:e.className)}function nA({theme:n,themeName:e,props:t,stylesCtx:r,selector:s}){return e.map(a=>{var o;return kd({theme:n,styles:(o=n.components[a])==null?void 0:o.styles,props:t,stylesCtx:r})[s]}).reduce((a,o)=>({...a,...o}),{})}function Ag({style:n,theme:e}){return Array.isArray(n)?[...n].reduce((t,r)=>({...t,...Ag({style:r,theme:e})}),{}):typeof n=="function"?n(e):n??{}}function rA(n){return n.reduce((e,t)=>(t&&Object.keys(t).forEach(r=>{e[r]={...e[r],...tf(t[r])}}),e),{})}function sA({vars:n,varsResolver:e,theme:t,props:r,stylesCtx:s,selector:a,themeName:o,headless:u}){var c;return(c=rA([u?{}:e==null?void 0:e(t,r,s),...o.map(f=>{var h,m,g;return(g=(m=(h=t.components)==null?void 0:h[f])==null?void 0:m.vars)==null?void 0:g.call(m,t,r,s)}),n==null?void 0:n(t,r,s)]))==null?void 0:c[a]}function aA({theme:n,themeName:e,selector:t,options:r,props:s,stylesCtx:a,rootSelector:o,styles:u,style:c,vars:f,varsResolver:h,headless:m,withStylesTransform:g}){return{...!g&&nA({theme:n,themeName:e,props:s,stylesCtx:a,selector:t}),...!g&&kd({theme:n,styles:u,props:s,stylesCtx:a})[t],...!g&&kd({theme:n,styles:r==null?void 0:r.styles,props:(r==null?void 0:r.props)||s,stylesCtx:a})[t],...sA({theme:n,props:s,stylesCtx:a,vars:f,varsResolver:h,selector:t,themeName:e,headless:m}),...o===t?Ag({style:c,theme:n}):null,...Ag({style:r==null?void 0:r.style,theme:n})}}function iA({props:n,stylesCtx:e,themeName:t}){var o;const r=ls(),s=(o=ET())==null?void 0:o();return{getTransformedStyles:u=>s?[...u.map(f=>s(f,{props:n,theme:r,ctx:e})),...t.map(f=>{var h;return s((h=r.components[f])==null?void 0:h.styles,{props:n,theme:r,ctx:e})})].filter(Boolean):[],withStylesTransform:!!s}}function Ye({name:n,classes:e,props:t,stylesCtx:r,className:s,style:a,rootSelector:o="root",unstyled:u,classNames:c,styles:f,vars:h,varsResolver:m}){const g=ls(),y=bT(),w=vT(),v=xT(),x=(Array.isArray(n)?n:[n]).filter(S=>S),{withStylesTransform:E,getTransformedStyles:k}=iA({props:t,stylesCtx:r,themeName:x});return(S,R)=>({className:tA({theme:g,options:R,themeName:x,selector:S,classNamesPrefix:y,classNames:c,classes:e,unstyled:u,className:s,rootSelector:o,props:t,stylesCtx:r,withStaticClasses:w,headless:v,transformedStyles:k([R==null?void 0:R.styles,f])}),style:aA({theme:g,themeName:x,selector:S,options:R,props:t,stylesCtx:r,rootSelector:o,styles:f,style:a,vars:h,varsResolver:m,headless:v,withStylesTransform:E})})}function ve(n,e,t){var o;const r=ls(),s=(o=r.components[n])==null?void 0:o.defaultProps,a=typeof s=="function"?s(r):s;return{...e,...a,...tf(t)}}function qp(n){return Kr(n).reduce((e,t)=>n[t]!==void 0?`${e}${BO(t)}:${n[t]};`:e,"").trim()}function oA({selector:n,styles:e,media:t,container:r}){const s=e?qp(e):"",a=Array.isArray(t)?t.map(u=>`@media${u.query}{${n}{${qp(u.styles)}}}`):[],o=Array.isArray(r)?r.map(u=>`@container ${u.query}{${n}{${qp(u.styles)}}}`):[];return`${s?`${n}{${s}}`:""}${a.join("")}${o.join("")}`.trim()}function K1(n){const e=xy();return O.jsx("style",{"data-mantine-styles":"inline",nonce:e==null?void 0:e(),dangerouslySetInnerHTML:{__html:oA(n)}})}function sf(n){const{m:e,mx:t,my:r,mt:s,mb:a,ml:o,mr:u,me:c,ms:f,p:h,px:m,py:g,pt:y,pb:w,pl:v,pr:x,pe:E,ps:k,bd:S,bg:R,c:A,opacity:I,ff:M,fz:D,fw:K,lts:X,ta:ae,lh:he,fs:ce,tt:W,td:G,w:q,miw:J,maw:j,h:B,mih:V,mah:$,bgsz:U,bgp:re,bgr:pe,bga:de,pos:Y,top:oe,left:ue,bottom:ge,right:_e,inset:Ie,display:Nt,flex:Bt,hiddenFrom:Qe,visibleFrom:Ct,lightHidden:ot,darkHidden:st,sx:or,...nt}=n;return{styleProps:tf({m:e,mx:t,my:r,mt:s,mb:a,ml:o,mr:u,me:c,ms:f,p:h,px:m,py:g,pt:y,pb:w,pl:v,pr:x,pe:E,ps:k,bd:S,bg:R,c:A,opacity:I,ff:M,fz:D,fw:K,lts:X,ta:ae,lh:he,fs:ce,tt:W,td:G,w:q,miw:J,maw:j,h:B,mih:V,mah:$,bgsz:U,bgp:re,bgr:pe,bga:de,pos:Y,top:oe,left:ue,bottom:ge,right:_e,inset:Ie,display:Nt,flex:Bt,hiddenFrom:Qe,visibleFrom:Ct,lightHidden:ot,darkHidden:st,sx:or}),rest:nt}}const lA={m:{type:"spacing",property:"margin"},mt:{type:"spacing",property:"marginTop"},mb:{type:"spacing",property:"marginBottom"},ml:{type:"spacing",property:"marginLeft"},mr:{type:"spacing",property:"marginRight"},ms:{type:"spacing",property:"marginInlineStart"},me:{type:"spacing",property:"marginInlineEnd"},mx:{type:"spacing",property:"marginInline"},my:{type:"spacing",property:"marginBlock"},p:{type:"spacing",property:"padding"},pt:{type:"spacing",property:"paddingTop"},pb:{type:"spacing",property:"paddingBottom"},pl:{type:"spacing",property:"paddingLeft"},pr:{type:"spacing",property:"paddingRight"},ps:{type:"spacing",property:"paddingInlineStart"},pe:{type:"spacing",property:"paddingInlineEnd"},px:{type:"spacing",property:"paddingInline"},py:{type:"spacing",property:"paddingBlock"},bd:{type:"border",property:"border"},bg:{type:"color",property:"background"},c:{type:"textColor",property:"color"},opacity:{type:"identity",property:"opacity"},ff:{type:"fontFamily",property:"fontFamily"},fz:{type:"fontSize",property:"fontSize"},fw:{type:"identity",property:"fontWeight"},lts:{type:"size",property:"letterSpacing"},ta:{type:"identity",property:"textAlign"},lh:{type:"lineHeight",property:"lineHeight"},fs:{type:"identity",property:"fontStyle"},tt:{type:"identity",property:"textTransform"},td:{type:"identity",property:"textDecoration"},w:{type:"spacing",property:"width"},miw:{type:"spacing",property:"minWidth"},maw:{type:"spacing",property:"maxWidth"},h:{type:"spacing",property:"height"},mih:{type:"spacing",property:"minHeight"},mah:{type:"spacing",property:"maxHeight"},bgsz:{type:"size",property:"backgroundSize"},bgp:{type:"identity",property:"backgroundPosition"},bgr:{type:"identity",property:"backgroundRepeat"},bga:{type:"identity",property:"backgroundAttachment"},pos:{type:"identity",property:"position"},top:{type:"size",property:"top"},left:{type:"size",property:"left"},bottom:{type:"size",property:"bottom"},right:{type:"size",property:"right"},inset:{type:"size",property:"inset"},display:{type:"identity",property:"display"},flex:{type:"identity",property:"flex"}};function Py(n,e){const t=hu({color:n,theme:e});return t.color==="dimmed"?"var(--mantine-color-dimmed)":t.color==="bright"?"var(--mantine-color-bright)":t.variable?`var(${t.variable})`:t.color}function uA(n,e){const t=hu({color:n,theme:e});return t.isThemeColor&&t.shade===void 0?`var(--mantine-color-${t.color}-text)`:Py(n,e)}function cA(n,e){if(typeof n=="number")return Q(n);if(typeof n=="string"){const[t,r,...s]=n.split(" ").filter(o=>o.trim()!=="");let a=`${Q(t)}`;return r&&(a+=` ${r}`),s.length>0&&(a+=` ${Py(s.join(" "),e)}`),a.trim()}return n}const P0={text:"var(--mantine-font-family)",mono:"var(--mantine-font-family-monospace)",monospace:"var(--mantine-font-family-monospace)",heading:"var(--mantine-font-family-headings)",headings:"var(--mantine-font-family-headings)"};function dA(n){return typeof n=="string"&&n in P0?P0[n]:n}const fA=["h1","h2","h3","h4","h5","h6"];function hA(n,e){return typeof n=="string"&&n in e.fontSizes?`var(--mantine-font-size-${n})`:typeof n=="string"&&fA.includes(n)?`var(--mantine-${n}-font-size)`:typeof n=="number"||typeof n=="string"?Q(n):n}function pA(n){return n}const mA=["h1","h2","h3","h4","h5","h6"];function gA(n,e){return typeof n=="string"&&n in e.lineHeights?`var(--mantine-line-height-${n})`:typeof n=="string"&&mA.includes(n)?`var(--mantine-${n}-line-height)`:n}function yA(n){return typeof n=="number"?Q(n):n}function _A(n,e){if(typeof n=="number")return Q(n);if(typeof n=="string"){const t=n.replace("-","");if(!(t in e.spacing))return Q(n);const r=`--mantine-spacing-${t}`;return n.startsWith("-")?`calc(var(${r}) * -1)`:`var(${r})`}return n}const Zp={color:Py,textColor:uA,fontSize:hA,spacing:_A,identity:pA,size:yA,lineHeight:gA,fontFamily:dA,border:cA};function k0(n){return n.replace("(min-width: ","").replace("em)","")}function wA({media:n,...e}){const r=Object.keys(n).sort((s,a)=>Number(k0(s))-Number(k0(a))).map(s=>({query:s,styles:n[s]}));return{...e,media:r}}function bA(n){if(typeof n!="object"||n===null)return!1;const e=Object.keys(n);return!(e.length===1&&e[0]==="base")}function vA(n){return typeof n=="object"&&n!==null?"base"in n?n.base:void 0:n}function xA(n){return typeof n=="object"&&n!==null?Kr(n).filter(e=>e!=="base"):[]}function SA(n,e){return typeof n=="object"&&n!==null&&e in n?n[e]:n}function X1({styleProps:n,data:e,theme:t}){return wA(Kr(n).reduce((r,s)=>{if(s==="hiddenFrom"||s==="visibleFrom"||s==="sx")return r;const a=e[s],o=Array.isArray(a.property)?a.property:[a.property],u=vA(n[s]);if(!bA(n[s]))return o.forEach(f=>{r.inlineStyles[f]=Zp[a.type](u,t)}),r;r.hasResponsiveStyles=!0;const c=xA(n[s]);return o.forEach(f=>{u&&(r.styles[f]=Zp[a.type](u,t)),c.forEach(h=>{const m=`(min-width: ${t.breakpoints[h]})`;r.media[m]={...r.media[m],[f]:Zp[a.type](SA(n[s],h),t)}})}),r},{hasResponsiveStyles:!1,styles:{},inlineStyles:{},media:{}}))}function Y1(){return`__m__-${P.useId().replace(/:/g,"")}`}function Q1(n,e){return Array.isArray(n)?[...n].reduce((t,r)=>({...t,...Q1(r,e)}),{}):typeof n=="function"?n(e):n??{}}function eE(n){return n.startsWith("data-")?n:`data-${n}`}function EA(n){return Object.keys(n).reduce((e,t)=>{const r=n[t];return r===void 0||r===""||r===!1||r===null||(e[eE(t)]=n[t]),e},{})}function tE(n){return n?typeof n=="string"?{[eE(n)]:!0}:Array.isArray(n)?[...n].reduce((e,t)=>({...e,...tE(t)}),{}):EA(n):null}function $g(n,e){return Array.isArray(n)?[...n].reduce((t,r)=>({...t,...$g(r,e)}),{}):typeof n=="function"?n(e):n??{}}function CA({theme:n,style:e,vars:t,styleProps:r}){const s=$g(e,n),a=$g(t,n);return{...s,...a,...r}}const nE=P.forwardRef(({component:n,style:e,__vars:t,className:r,variant:s,mod:a,size:o,hiddenFrom:u,visibleFrom:c,lightHidden:f,darkHidden:h,renderRoot:m,__size:g,...y},w)=>{var D;const v=ls(),x=n||"div",{styleProps:E,rest:k}=sf(y),S=ST(),R=(D=S==null?void 0:S())==null?void 0:D(E.sx),A=Y1(),I=X1({styleProps:E,theme:v,data:lA}),M={ref:w,style:CA({theme:v,style:e,vars:t,styleProps:I.inlineStyles}),className:os(r,R,{[A]:I.hasResponsiveStyles,"mantine-light-hidden":f,"mantine-dark-hidden":h,[`mantine-hidden-from-${u}`]:u,[`mantine-visible-from-${c}`]:c}),"data-variant":s,"data-size":I1(o)?void 0:o||void 0,size:g,...tE(a),...k};return O.jsxs(O.Fragment,{children:[I.hasResponsiveStyles&&O.jsx(K1,{selector:`.${A}`,styles:I.styles,media:I.media}),typeof m=="function"?m(M):O.jsx(x,{...M})]})});nE.displayName="@mantine/core/Box";const ke=nE;function rE(n){return n}function PA(n){const e=n;return t=>{const r=P.forwardRef((s,a)=>O.jsx(e,{...t,...s,ref:a}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r}}function ze(n){const e=P.forwardRef(n);return e.extend=rE,e.withProps=t=>{const r=P.forwardRef((s,a)=>O.jsx(e,{...t,...s,ref:a}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r},e}function rr(n){const e=P.forwardRef(n);return e.withProps=t=>{const r=P.forwardRef((s,a)=>O.jsx(e,{...t,...s,ref:a}));return r.extend=e.extend,r.displayName=`WithProps(${e.displayName})`,r},e.extend=rE,e}const kA=P.createContext({dir:"ltr",toggleDirection:()=>{},setDirection:()=>{}});function ky(){return P.useContext(kA)}var af=A1();const RA=ti(af);function OA(n){if(!n||typeof n=="string")return 0;const e=n/36;return Math.round((4+15*e**.25+e/5)*10)}function Gp(n){return n!=null&&n.current?n.current.scrollHeight:"auto"}const gl=typeof window<"u"&&window.requestAnimationFrame;function TA({transitionDuration:n,transitionTimingFunction:e="ease",onTransitionEnd:t=()=>{},opened:r}){const s=P.useRef(null),a=0,o={display:"none",height:0,overflow:"hidden"},[u,c]=P.useState(r?{}:o),f=w=>{af.flushSync(()=>c(w))},h=w=>{f(v=>({...v,...w}))};function m(w){const v=n||OA(w);return{transition:`height ${v}ms ${e}, opacity ${v}ms ${e}`}}Wa(()=>{typeof gl=="function"&&gl(r?()=>{h({willChange:"height",display:"block",overflow:"hidden"}),gl(()=>{const w=Gp(s);h({...m(w),height:w})})}:()=>{const w=Gp(s);h({...m(w),willChange:"height",height:w}),gl(()=>h({height:a,overflow:"hidden"}))})},[r]);const g=w=>{if(!(w.target!==s.current||w.propertyName!=="height"))if(r){const v=Gp(s);v===u.height?f({}):h({height:v}),t()}else u.height===a&&(f(o),t())};function y({style:w={},refKey:v="ref",...x}={}){const E=x[v];return{"aria-hidden":!r,...x,[v]:z1(s,E),onTransitionEnd:g,style:{boxSizing:"border-box",...w,...u}}}return y}const AA={transitionDuration:200,transitionTimingFunction:"ease",animateOpacity:!0},sE=ze((n,e)=>{const{children:t,in:r,transitionDuration:s,transitionTimingFunction:a,style:o,onTransitionEnd:u,animateOpacity:c,...f}=ve("Collapse",AA,n),h=ls(),m=B1(),y=(h.respectReducedMotion?m:!1)?0:s,w=TA({opened:r,transitionDuration:y,transitionTimingFunction:a,onTransitionEnd:u});return y===0?r?O.jsx(ke,{...f,children:t}):null:O.jsx(ke,{...w({style:{opacity:r||!c?1:0,transition:c?`opacity ${y}ms ${a}`:"none",...Q1(o,h)},ref:e,...f}),children:t})});sE.displayName="@mantine/core/Collapse";const[$A,sr]=ni("ScrollArea.Root component was not found in tree");function Qi(n,e){const t=ja(e);fu(()=>{let r=0;if(n){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(t)});return s.observe(n),()=>{window.cancelAnimationFrame(r),s.unobserve(n)}}},[n,t])}const IA=P.forwardRef((n,e)=>{const{style:t,...r}=n,s=sr(),[a,o]=P.useState(0),[u,c]=P.useState(0),f=!!(a&&u);return Qi(s.scrollbarX,()=>{var m;const h=((m=s.scrollbarX)==null?void 0:m.offsetHeight)||0;s.onCornerHeightChange(h),c(h)}),Qi(s.scrollbarY,()=>{var m;const h=((m=s.scrollbarY)==null?void 0:m.offsetWidth)||0;s.onCornerWidthChange(h),o(h)}),f?O.jsx("div",{...r,ref:e,style:{...t,width:a,height:u}}):null}),NA=P.forwardRef((n,e)=>{const t=sr(),r=!!(t.scrollbarX&&t.scrollbarY);return t.type!=="scroll"&&r?O.jsx(IA,{...n,ref:e}):null}),jA={scrollHideDelay:1e3,type:"hover"},aE=P.forwardRef((n,e)=>{const t=ve("ScrollAreaRoot",jA,n),{type:r,scrollHideDelay:s,scrollbars:a,...o}=t,[u,c]=P.useState(null),[f,h]=P.useState(null),[m,g]=P.useState(null),[y,w]=P.useState(null),[v,x]=P.useState(null),[E,k]=P.useState(0),[S,R]=P.useState(0),[A,I]=P.useState(!1),[M,D]=P.useState(!1),K=An(e,X=>c(X));return O.jsx($A,{value:{type:r,scrollHideDelay:s,scrollArea:u,viewport:f,onViewportChange:h,content:m,onContentChange:g,scrollbarX:y,onScrollbarXChange:w,scrollbarXEnabled:A,onScrollbarXEnabledChange:I,scrollbarY:v,onScrollbarYChange:x,scrollbarYEnabled:M,onScrollbarYEnabledChange:D,onCornerWidthChange:k,onCornerHeightChange:R},children:O.jsx(ke,{...o,ref:K,__vars:{"--sa-corner-width":a!=="xy"?"0px":`${E}px`,"--sa-corner-height":a!=="xy"?"0px":`${S}px`}})})});aE.displayName="@mantine/core/ScrollAreaRoot";function iE(n,e){const t=n/e;return Number.isNaN(t)?0:t}function of(n){const e=iE(n.viewport,n.content),t=n.scrollbar.paddingStart+n.scrollbar.paddingEnd,r=(n.scrollbar.size-t)*e;return Math.max(r,18)}function oE(n,e){return t=>{if(n[0]===n[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(n[1]-n[0]);return e[0]+r*(t-n[0])}}function LA(n,[e,t]){return Math.min(t,Math.max(e,n))}function R0(n,e,t="ltr"){const r=of(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,a=e.scrollbar.size-s,o=e.content-e.viewport,u=a-r,c=t==="ltr"?[0,o]:[o*-1,0],f=LA(n,c);return oE([0,o],[0,u])(f)}function MA(n,e,t,r="ltr"){const s=of(t),a=s/2,o=e||a,u=s-o,c=t.scrollbar.paddingStart+o,f=t.scrollbar.size-t.scrollbar.paddingEnd-u,h=t.content-t.viewport,m=r==="ltr"?[0,h]:[h*-1,0];return oE([c,f],m)(n)}function lE(n,e){return n>0&&n<e}function Rd(n){return n?parseInt(n,10):0}function Ua(n,e,{checkForDefaultPrevented:t=!0}={}){return r=>{n==null||n(r),(t===!1||!r.defaultPrevented)&&(e==null||e(r))}}const[DA,uE]=ni("ScrollAreaScrollbar was not found in tree"),cE=P.forwardRef((n,e)=>{const{sizes:t,hasThumb:r,onThumbChange:s,onThumbPointerUp:a,onThumbPointerDown:o,onThumbPositionChange:u,onDragScroll:c,onWheelScroll:f,onResize:h,...m}=n,g=sr(),[y,w]=P.useState(null),v=An(e,D=>w(D)),x=P.useRef(null),E=P.useRef(""),{viewport:k}=g,S=t.content-t.viewport,R=ja(f),A=ja(u),I=nf(h,10),M=D=>{if(x.current){const K=D.clientX-x.current.left,X=D.clientY-x.current.top;c({x:K,y:X})}};return P.useEffect(()=>{const D=K=>{const X=K.target;(y==null?void 0:y.contains(X))&&R(K,S)};return document.addEventListener("wheel",D,{passive:!1}),()=>document.removeEventListener("wheel",D,{passive:!1})},[k,y,S,R]),P.useEffect(A,[t,A]),Qi(y,I),Qi(g.content,I),O.jsx(DA,{value:{scrollbar:y,hasThumb:r,onThumbChange:ja(s),onThumbPointerUp:ja(a),onThumbPositionChange:A,onThumbPointerDown:ja(o)},children:O.jsx("div",{...m,ref:v,"data-mantine-scrollbar":!0,style:{position:"absolute",...m.style},onPointerDown:Ua(n.onPointerDown,D=>{D.preventDefault(),D.button===0&&(D.target.setPointerCapture(D.pointerId),x.current=y.getBoundingClientRect(),E.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",M(D))}),onPointerMove:Ua(n.onPointerMove,M),onPointerUp:Ua(n.onPointerUp,D=>{D.preventDefault();const K=D.target;K.hasPointerCapture(D.pointerId)&&K.releasePointerCapture(D.pointerId),document.body.style.webkitUserSelect=E.current,x.current=null})})})}),dE=P.forwardRef((n,e)=>{const{sizes:t,onSizesChange:r,style:s,...a}=n,o=sr(),[u,c]=P.useState(),f=P.useRef(null),h=An(e,f,o.onScrollbarXChange);return P.useEffect(()=>{f.current&&c(getComputedStyle(f.current))},[f]),O.jsx(cE,{"data-orientation":"horizontal",...a,ref:h,sizes:t,style:{...s,"--sa-thumb-width":`${of(t)}px`},onThumbPointerDown:m=>n.onThumbPointerDown(m.x),onDragScroll:m=>n.onDragScroll(m.x),onWheelScroll:(m,g)=>{if(o.viewport){const y=o.viewport.scrollLeft+m.deltaX;n.onWheelScroll(y),lE(y,g)&&m.preventDefault()}},onResize:()=>{f.current&&o.viewport&&u&&r({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:f.current.clientWidth,paddingStart:Rd(u.paddingLeft),paddingEnd:Rd(u.paddingRight)}})}})});dE.displayName="@mantine/core/ScrollAreaScrollbarX";const fE=P.forwardRef((n,e)=>{const{sizes:t,onSizesChange:r,style:s,...a}=n,o=sr(),[u,c]=P.useState(),f=P.useRef(null),h=An(e,f,o.onScrollbarYChange);return P.useEffect(()=>{f.current&&c(window.getComputedStyle(f.current))},[]),O.jsx(cE,{...a,"data-orientation":"vertical",ref:h,sizes:t,style:{"--sa-thumb-height":`${of(t)}px`,...s},onThumbPointerDown:m=>n.onThumbPointerDown(m.y),onDragScroll:m=>n.onDragScroll(m.y),onWheelScroll:(m,g)=>{if(o.viewport){const y=o.viewport.scrollTop+m.deltaY;n.onWheelScroll(y),lE(y,g)&&m.preventDefault()}},onResize:()=>{f.current&&o.viewport&&u&&r({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:f.current.clientHeight,paddingStart:Rd(u.paddingTop),paddingEnd:Rd(u.paddingBottom)}})}})});fE.displayName="@mantine/core/ScrollAreaScrollbarY";const lf=P.forwardRef((n,e)=>{const{orientation:t="vertical",...r}=n,{dir:s}=ky(),a=sr(),o=P.useRef(null),u=P.useRef(0),[c,f]=P.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),h=iE(c.viewport,c.content),m={...r,sizes:c,onSizesChange:f,hasThumb:h>0&&h<1,onThumbChange:y=>{o.current=y},onThumbPointerUp:()=>{u.current=0},onThumbPointerDown:y=>{u.current=y}},g=(y,w)=>MA(y,u.current,c,w);return t==="horizontal"?O.jsx(dE,{...m,ref:e,onThumbPositionChange:()=>{if(a.viewport&&o.current){const y=a.viewport.scrollLeft,w=R0(y,c,s);o.current.style.transform=`translate3d(${w}px, 0, 0)`}},onWheelScroll:y=>{a.viewport&&(a.viewport.scrollLeft=y)},onDragScroll:y=>{a.viewport&&(a.viewport.scrollLeft=g(y,s))}}):t==="vertical"?O.jsx(fE,{...m,ref:e,onThumbPositionChange:()=>{if(a.viewport&&o.current){const y=a.viewport.scrollTop,w=R0(y,c);c.scrollbar.size===0?o.current.style.setProperty("--thumb-opacity","0"):o.current.style.setProperty("--thumb-opacity","1"),o.current.style.transform=`translate3d(0, ${w}px, 0)`}},onWheelScroll:y=>{a.viewport&&(a.viewport.scrollTop=y)},onDragScroll:y=>{a.viewport&&(a.viewport.scrollTop=g(y))}}):null});lf.displayName="@mantine/core/ScrollAreaScrollbarVisible";const Ry=P.forwardRef((n,e)=>{const t=sr(),{forceMount:r,...s}=n,[a,o]=P.useState(!1),u=n.orientation==="horizontal",c=nf(()=>{if(t.viewport){const f=t.viewport.offsetWidth<t.viewport.scrollWidth,h=t.viewport.offsetHeight<t.viewport.scrollHeight;o(u?f:h)}},10);return Qi(t.viewport,c),Qi(t.content,c),r||a?O.jsx(lf,{"data-state":a?"visible":"hidden",...s,ref:e}):null});Ry.displayName="@mantine/core/ScrollAreaScrollbarAuto";const hE=P.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=sr(),[a,o]=P.useState(!1);return P.useEffect(()=>{const{scrollArea:u}=s;let c=0;if(u){const f=()=>{window.clearTimeout(c),o(!0)},h=()=>{c=window.setTimeout(()=>o(!1),s.scrollHideDelay)};return u.addEventListener("pointerenter",f),u.addEventListener("pointerleave",h),()=>{window.clearTimeout(c),u.removeEventListener("pointerenter",f),u.removeEventListener("pointerleave",h)}}},[s.scrollArea,s.scrollHideDelay]),t||a?O.jsx(Ry,{"data-state":a?"visible":"hidden",...r,ref:e}):null});hE.displayName="@mantine/core/ScrollAreaScrollbarHover";const FA=P.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=sr(),a=n.orientation==="horizontal",[o,u]=P.useState("hidden"),c=nf(()=>u("idle"),100);return P.useEffect(()=>{if(o==="idle"){const f=window.setTimeout(()=>u("hidden"),s.scrollHideDelay);return()=>window.clearTimeout(f)}},[o,s.scrollHideDelay]),P.useEffect(()=>{const{viewport:f}=s,h=a?"scrollLeft":"scrollTop";if(f){let m=f[h];const g=()=>{const y=f[h];m!==y&&(u("scrolling"),c()),m=y};return f.addEventListener("scroll",g),()=>f.removeEventListener("scroll",g)}},[s.viewport,a,c]),t||o!=="hidden"?O.jsx(lf,{"data-state":o==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:Ua(n.onPointerEnter,()=>u("interacting")),onPointerLeave:Ua(n.onPointerLeave,()=>u("idle"))}):null}),Ig=P.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=sr(),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:o}=s,u=n.orientation==="horizontal";return P.useEffect(()=>(u?a(!0):o(!0),()=>{u?a(!1):o(!1)}),[u,a,o]),s.type==="hover"?O.jsx(hE,{...r,ref:e,forceMount:t}):s.type==="scroll"?O.jsx(FA,{...r,ref:e,forceMount:t}):s.type==="auto"?O.jsx(Ry,{...r,ref:e,forceMount:t}):s.type==="always"?O.jsx(lf,{...r,ref:e}):null});Ig.displayName="@mantine/core/ScrollAreaScrollbar";function UA(n,e=()=>{}){let t={left:n.scrollLeft,top:n.scrollTop},r=0;return function s(){const a={left:n.scrollLeft,top:n.scrollTop},o=t.left!==a.left,u=t.top!==a.top;(o||u)&&e(),t=a,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)}const pE=P.forwardRef((n,e)=>{const{style:t,...r}=n,s=sr(),a=uE(),{onThumbPositionChange:o}=a,u=An(e,h=>a.onThumbChange(h)),c=P.useRef(void 0),f=nf(()=>{c.current&&(c.current(),c.current=void 0)},100);return P.useEffect(()=>{const{viewport:h}=s;if(h){const m=()=>{if(f(),!c.current){const g=UA(h,o);c.current=g,o()}};return o(),h.addEventListener("scroll",m),()=>h.removeEventListener("scroll",m)}},[s.viewport,f,o]),O.jsx("div",{"data-state":a.hasThumb?"visible":"hidden",...r,ref:u,style:{width:"var(--sa-thumb-width)",height:"var(--sa-thumb-height)",...t},onPointerDownCapture:Ua(n.onPointerDownCapture,h=>{const g=h.target.getBoundingClientRect(),y=h.clientX-g.left,w=h.clientY-g.top;a.onThumbPointerDown({x:y,y:w})}),onPointerUp:Ua(n.onPointerUp,a.onThumbPointerUp)})});pE.displayName="@mantine/core/ScrollAreaThumb";const Ng=P.forwardRef((n,e)=>{const{forceMount:t,...r}=n,s=uE();return t||s.hasThumb?O.jsx(pE,{ref:e,...r}):null});Ng.displayName="@mantine/core/ScrollAreaThumb";const mE=P.forwardRef(({children:n,style:e,...t},r)=>{const s=sr(),a=An(r,s.onViewportChange);return O.jsx(ke,{...t,ref:a,style:{overflowX:s.scrollbarXEnabled?"scroll":"hidden",overflowY:s.scrollbarYEnabled?"scroll":"hidden",...e},children:O.jsx("div",{style:{minWidth:"100%",display:"table"},ref:s.onContentChange,children:n})})});mE.displayName="@mantine/core/ScrollAreaViewport";var Oy={root:"m_d57069b5",viewport:"m_c0783ff9",viewportInner:"m_f8f631dd",scrollbar:"m_c44ba933",thumb:"m_d8b5e363",corner:"m_21657268"};const gE={scrollHideDelay:1e3,type:"hover",scrollbars:"xy"},zA=(n,{scrollbarSize:e})=>({root:{"--scrollarea-scrollbar-size":Q(e)}}),si=ze((n,e)=>{const t=ve("ScrollArea",gE,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,scrollbarSize:c,vars:f,type:h,scrollHideDelay:m,viewportProps:g,viewportRef:y,onScrollPositionChange:w,children:v,offsetScrollbars:x,scrollbars:E,onBottomReached:k,onTopReached:S,...R}=t,[A,I]=P.useState(!1),M=Ye({name:"ScrollArea",props:t,classes:Oy,className:s,style:a,classNames:r,styles:o,unstyled:u,vars:f,varsResolver:zA});return O.jsxs(aE,{type:h==="never"?"always":h,scrollHideDelay:m,ref:e,scrollbars:E,...M("root"),...R,children:[O.jsx(mE,{...g,...M("viewport",{style:g==null?void 0:g.style}),ref:y,"data-offset-scrollbars":x===!0?"xy":x||void 0,"data-scrollbars":E||void 0,onScroll:D=>{var he;(he=g==null?void 0:g.onScroll)==null||he.call(g,D),w==null||w({x:D.currentTarget.scrollLeft,y:D.currentTarget.scrollTop});const{scrollTop:K,scrollHeight:X,clientHeight:ae}=D.currentTarget;K-(X-ae)>=0&&(k==null||k()),K===0&&(S==null||S())},children:v}),(E==="xy"||E==="x")&&O.jsx(Ig,{...M("scrollbar"),orientation:"horizontal","data-hidden":h==="never"||void 0,forceMount:!0,onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),children:O.jsx(Ng,{...M("thumb")})}),(E==="xy"||E==="y")&&O.jsx(Ig,{...M("scrollbar"),orientation:"vertical","data-hidden":h==="never"||void 0,forceMount:!0,onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),children:O.jsx(Ng,{...M("thumb")})}),O.jsx(NA,{...M("corner"),"data-hovered":A||void 0,"data-hidden":h==="never"||void 0})]})});si.displayName="@mantine/core/ScrollArea";const Ty=ze((n,e)=>{const{children:t,classNames:r,styles:s,scrollbarSize:a,scrollHideDelay:o,type:u,dir:c,offsetScrollbars:f,viewportRef:h,onScrollPositionChange:m,unstyled:g,variant:y,viewportProps:w,scrollbars:v,style:x,vars:E,onBottomReached:k,onTopReached:S,...R}=ve("ScrollAreaAutosize",gE,n);return O.jsx(ke,{...R,ref:e,style:[{display:"flex",overflow:"auto"},x],children:O.jsx(ke,{style:{display:"flex",flexDirection:"column",flex:1},children:O.jsx(si,{classNames:r,styles:s,scrollHideDelay:o,scrollbarSize:a,type:u,dir:c,offsetScrollbars:f,viewportRef:h,onScrollPositionChange:m,unstyled:g,variant:y,viewportProps:w,vars:E,scrollbars:v,onBottomReached:k,onTopReached:S,children:t})})})});si.classes=Oy;Ty.displayName="@mantine/core/ScrollAreaAutosize";Ty.classes=Oy;si.Autosize=Ty;var yE={root:"m_87cf2631"};const BA={__staticSelector:"UnstyledButton"},co=rr((n,e)=>{const t=ve("UnstyledButton",BA,n),{className:r,component:s="button",__staticSelector:a,unstyled:o,classNames:u,styles:c,style:f,...h}=t,m=Ye({name:a,props:t,classes:yE,className:r,style:f,classNames:u,styles:c,unstyled:o});return O.jsx(ke,{...m("root",{focusable:!0}),component:s,ref:e,type:s==="button"?"button":void 0,...h})});co.classes=yE;co.displayName="@mantine/core/UnstyledButton";var _E={root:"m_515a97f8"};const HA={},Ay=ze((n,e)=>{const t=ve("VisuallyHidden",HA,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,vars:c,...f}=t,h=Ye({name:"VisuallyHidden",classes:_E,props:t,className:s,style:a,classNames:r,styles:o,unstyled:u});return O.jsx(ke,{component:"span",ref:e,...h("root"),...f})});Ay.classes=_E;Ay.displayName="@mantine/core/VisuallyHidden";var wE={root:"m_1b7284a3"};const VA={},WA=(n,{radius:e,shadow:t})=>({root:{"--paper-radius":e===void 0?void 0:is(e),"--paper-shadow":M1(t)}}),$y=rr((n,e)=>{const t=ve("Paper",VA,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,withBorder:c,vars:f,radius:h,shadow:m,variant:g,mod:y,...w}=t,v=Ye({name:"Paper",props:t,classes:wE,className:s,style:a,classNames:r,styles:o,unstyled:u,vars:f,varsResolver:WA});return O.jsx(ke,{ref:e,mod:[{"data-with-border":c},y],...v("root"),variant:g,...w})});$y.classes=wE;$y.displayName="@mantine/core/Paper";function uf(){return typeof window<"u"}function fo(n){return bE(n)?(n.nodeName||"").toLowerCase():"#document"}function Hn(n){var e;return(n==null||(e=n.ownerDocument)==null?void 0:e.defaultView)||window}function us(n){var e;return(e=(bE(n)?n.ownerDocument:n.document)||window.document)==null?void 0:e.documentElement}function bE(n){return uf()?n instanceof Node||n instanceof Hn(n).Node:!1}function gn(n){return uf()?n instanceof Element||n instanceof Hn(n).Element:!1}function es(n){return uf()?n instanceof HTMLElement||n instanceof Hn(n).HTMLElement:!1}function O0(n){return!uf()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Hn(n).ShadowRoot}function mu(n){const{overflow:e,overflowX:t,overflowY:r,display:s}=Tr(n);return/auto|scroll|overlay|hidden|clip/.test(e+r+t)&&!["inline","contents"].includes(s)}function qA(n){return["table","td","th"].includes(fo(n))}function cf(n){return[":popover-open",":modal"].some(e=>{try{return n.matches(e)}catch{return!1}})}function Iy(n){const e=Ny(),t=gn(n)?Tr(n):n;return["transform","translate","scale","rotate","perspective"].some(r=>t[r]?t[r]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(t.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(t.contain||"").includes(r))}function ZA(n){let e=ua(n);for(;es(e)&&!eo(e);){if(Iy(e))return e;if(cf(e))return null;e=ua(e)}return null}function Ny(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function eo(n){return["html","body","#document"].includes(fo(n))}function Tr(n){return Hn(n).getComputedStyle(n)}function df(n){return gn(n)?{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}:{scrollLeft:n.scrollX,scrollTop:n.scrollY}}function ua(n){if(fo(n)==="html")return n;const e=n.assignedSlot||n.parentNode||O0(n)&&n.host||us(n);return O0(e)?e.host:e}function vE(n){const e=ua(n);return eo(e)?n.ownerDocument?n.ownerDocument.body:n.body:es(e)&&mu(e)?e:vE(e)}function Hl(n,e,t){var r;e===void 0&&(e=[]),t===void 0&&(t=!0);const s=vE(n),a=s===((r=n.ownerDocument)==null?void 0:r.body),o=Hn(s);if(a){const u=jg(o);return e.concat(o,o.visualViewport||[],mu(s)?s:[],u&&t?Hl(u):[])}return e.concat(s,Hl(s,[],t))}function jg(n){return n.parent&&Object.getPrototypeOf(n.parent)?n.frameElement:null}const Ar=Math.min,rn=Math.max,Od=Math.round,qc=Math.floor,Xr=n=>({x:n,y:n}),GA={left:"right",right:"left",bottom:"top",top:"bottom"},JA={start:"end",end:"start"};function Lg(n,e,t){return rn(n,Ar(e,t))}function Os(n,e){return typeof n=="function"?n(e):n}function $r(n){return n.split("-")[0]}function ho(n){return n.split("-")[1]}function jy(n){return n==="x"?"y":"x"}function Ly(n){return n==="y"?"height":"width"}function Ts(n){return["top","bottom"].includes($r(n))?"y":"x"}function My(n){return jy(Ts(n))}function KA(n,e,t){t===void 0&&(t=!1);const r=ho(n),s=My(n),a=Ly(s);let o=s==="x"?r===(t?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[a]>e.floating[a]&&(o=Td(o)),[o,Td(o)]}function XA(n){const e=Td(n);return[Mg(n),e,Mg(e)]}function Mg(n){return n.replace(/start|end/g,e=>JA[e])}function YA(n,e,t){const r=["left","right"],s=["right","left"],a=["top","bottom"],o=["bottom","top"];switch(n){case"top":case"bottom":return t?e?s:r:e?r:s;case"left":case"right":return e?a:o;default:return[]}}function QA(n,e,t,r){const s=ho(n);let a=YA($r(n),t==="start",r);return s&&(a=a.map(o=>o+"-"+s),e&&(a=a.concat(a.map(Mg)))),a}function Td(n){return n.replace(/left|right|bottom|top/g,e=>GA[e])}function e$(n){return{top:0,right:0,bottom:0,left:0,...n}}function Dy(n){return typeof n!="number"?e$(n):{top:n,right:n,bottom:n,left:n}}function to(n){const{x:e,y:t,width:r,height:s}=n;return{width:r,height:s,top:t,left:e,right:e+r,bottom:t+s,x:e,y:t}}function T0(n,e,t){let{reference:r,floating:s}=n;const a=Ts(e),o=My(e),u=Ly(o),c=$r(e),f=a==="y",h=r.x+r.width/2-s.width/2,m=r.y+r.height/2-s.height/2,g=r[u]/2-s[u]/2;let y;switch(c){case"top":y={x:h,y:r.y-s.height};break;case"bottom":y={x:h,y:r.y+r.height};break;case"right":y={x:r.x+r.width,y:m};break;case"left":y={x:r.x-s.width,y:m};break;default:y={x:r.x,y:r.y}}switch(ho(e)){case"start":y[o]-=g*(t&&f?-1:1);break;case"end":y[o]+=g*(t&&f?-1:1);break}return y}const t$=async(n,e,t)=>{const{placement:r="bottom",strategy:s="absolute",middleware:a=[],platform:o}=t,u=a.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let f=await o.getElementRects({reference:n,floating:e,strategy:s}),{x:h,y:m}=T0(f,r,c),g=r,y={},w=0;for(let v=0;v<u.length;v++){const{name:x,fn:E}=u[v],{x:k,y:S,data:R,reset:A}=await E({x:h,y:m,initialPlacement:r,placement:g,strategy:s,middlewareData:y,rects:f,platform:o,elements:{reference:n,floating:e}});h=k??h,m=S??m,y={...y,[x]:{...y[x],...R}},A&&w<=50&&(w++,typeof A=="object"&&(A.placement&&(g=A.placement),A.rects&&(f=A.rects===!0?await o.getElementRects({reference:n,floating:e,strategy:s}):A.rects),{x:h,y:m}=T0(f,g,c)),v=-1)}return{x:h,y:m,placement:g,strategy:s,middlewareData:y}};async function Fy(n,e){var t;e===void 0&&(e={});const{x:r,y:s,platform:a,rects:o,elements:u,strategy:c}=n,{boundary:f="clippingAncestors",rootBoundary:h="viewport",elementContext:m="floating",altBoundary:g=!1,padding:y=0}=Os(e,n),w=Dy(y),x=u[g?m==="floating"?"reference":"floating":m],E=to(await a.getClippingRect({element:(t=await(a.isElement==null?void 0:a.isElement(x)))==null||t?x:x.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(u.floating)),boundary:f,rootBoundary:h,strategy:c})),k=m==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,S=await(a.getOffsetParent==null?void 0:a.getOffsetParent(u.floating)),R=await(a.isElement==null?void 0:a.isElement(S))?await(a.getScale==null?void 0:a.getScale(S))||{x:1,y:1}:{x:1,y:1},A=to(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:k,offsetParent:S,strategy:c}):k);return{top:(E.top-A.top+w.top)/R.y,bottom:(A.bottom-E.bottom+w.bottom)/R.y,left:(E.left-A.left+w.left)/R.x,right:(A.right-E.right+w.right)/R.x}}const n$=n=>({name:"arrow",options:n,async fn(e){const{x:t,y:r,placement:s,rects:a,platform:o,elements:u,middlewareData:c}=e,{element:f,padding:h=0}=Os(n,e)||{};if(f==null)return{};const m=Dy(h),g={x:t,y:r},y=My(s),w=Ly(y),v=await o.getDimensions(f),x=y==="y",E=x?"top":"left",k=x?"bottom":"right",S=x?"clientHeight":"clientWidth",R=a.reference[w]+a.reference[y]-g[y]-a.floating[w],A=g[y]-a.reference[y],I=await(o.getOffsetParent==null?void 0:o.getOffsetParent(f));let M=I?I[S]:0;(!M||!await(o.isElement==null?void 0:o.isElement(I)))&&(M=u.floating[S]||a.floating[w]);const D=R/2-A/2,K=M/2-v[w]/2-1,X=Ar(m[E],K),ae=Ar(m[k],K),he=X,ce=M-v[w]-ae,W=M/2-v[w]/2+D,G=Lg(he,W,ce),q=!c.arrow&&ho(s)!=null&&W!==G&&a.reference[w]/2-(W<he?X:ae)-v[w]/2<0,J=q?W<he?W-he:W-ce:0;return{[y]:g[y]+J,data:{[y]:G,centerOffset:W-G-J,...q&&{alignmentOffset:J}},reset:q}}}),r$=function(n){return n===void 0&&(n={}),{name:"flip",options:n,async fn(e){var t,r;const{placement:s,middlewareData:a,rects:o,initialPlacement:u,platform:c,elements:f}=e,{mainAxis:h=!0,crossAxis:m=!0,fallbackPlacements:g,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:w="none",flipAlignment:v=!0,...x}=Os(n,e);if((t=a.arrow)!=null&&t.alignmentOffset)return{};const E=$r(s),k=Ts(u),S=$r(u)===u,R=await(c.isRTL==null?void 0:c.isRTL(f.floating)),A=g||(S||!v?[Td(u)]:XA(u)),I=w!=="none";!g&&I&&A.push(...QA(u,v,w,R));const M=[u,...A],D=await Fy(e,x),K=[];let X=((r=a.flip)==null?void 0:r.overflows)||[];if(h&&K.push(D[E]),m){const W=KA(s,o,R);K.push(D[W[0]],D[W[1]])}if(X=[...X,{placement:s,overflows:K}],!K.every(W=>W<=0)){var ae,he;const W=(((ae=a.flip)==null?void 0:ae.index)||0)+1,G=M[W];if(G)return{data:{index:W,overflows:X},reset:{placement:G}};let q=(he=X.filter(J=>J.overflows[0]<=0).sort((J,j)=>J.overflows[1]-j.overflows[1])[0])==null?void 0:he.placement;if(!q)switch(y){case"bestFit":{var ce;const J=(ce=X.filter(j=>{if(I){const B=Ts(j.placement);return B===k||B==="y"}return!0}).map(j=>[j.placement,j.overflows.filter(B=>B>0).reduce((B,V)=>B+V,0)]).sort((j,B)=>j[1]-B[1])[0])==null?void 0:ce[0];J&&(q=J);break}case"initialPlacement":q=u;break}if(s!==q)return{reset:{placement:q}}}return{}}}};function xE(n){const e=Ar(...n.map(a=>a.left)),t=Ar(...n.map(a=>a.top)),r=rn(...n.map(a=>a.right)),s=rn(...n.map(a=>a.bottom));return{x:e,y:t,width:r-e,height:s-t}}function s$(n){const e=n.slice().sort((s,a)=>s.y-a.y),t=[];let r=null;for(let s=0;s<e.length;s++){const a=e[s];!r||a.y-r.y>r.height/2?t.push([a]):t[t.length-1].push(a),r=a}return t.map(s=>to(xE(s)))}const a$=function(n){return n===void 0&&(n={}),{name:"inline",options:n,async fn(e){const{placement:t,elements:r,rects:s,platform:a,strategy:o}=e,{padding:u=2,x:c,y:f}=Os(n,e),h=Array.from(await(a.getClientRects==null?void 0:a.getClientRects(r.reference))||[]),m=s$(h),g=to(xE(h)),y=Dy(u);function w(){if(m.length===2&&m[0].left>m[1].right&&c!=null&&f!=null)return m.find(x=>c>x.left-y.left&&c<x.right+y.right&&f>x.top-y.top&&f<x.bottom+y.bottom)||g;if(m.length>=2){if(Ts(t)==="y"){const X=m[0],ae=m[m.length-1],he=$r(t)==="top",ce=X.top,W=ae.bottom,G=he?X.left:ae.left,q=he?X.right:ae.right,J=q-G,j=W-ce;return{top:ce,bottom:W,left:G,right:q,width:J,height:j,x:G,y:ce}}const x=$r(t)==="left",E=rn(...m.map(X=>X.right)),k=Ar(...m.map(X=>X.left)),S=m.filter(X=>x?X.left===k:X.right===E),R=S[0].top,A=S[S.length-1].bottom,I=k,M=E,D=M-I,K=A-R;return{top:R,bottom:A,left:I,right:M,width:D,height:K,x:I,y:R}}return g}const v=await a.getElementRects({reference:{getBoundingClientRect:w},floating:r.floating,strategy:o});return s.reference.x!==v.reference.x||s.reference.y!==v.reference.y||s.reference.width!==v.reference.width||s.reference.height!==v.reference.height?{reset:{rects:v}}:{}}}};async function i$(n,e){const{placement:t,platform:r,elements:s}=n,a=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=$r(t),u=ho(t),c=Ts(t)==="y",f=["left","top"].includes(o)?-1:1,h=a&&c?-1:1,m=Os(e,n);let{mainAxis:g,crossAxis:y,alignmentAxis:w}=typeof m=="number"?{mainAxis:m,crossAxis:0,alignmentAxis:null}:{mainAxis:m.mainAxis||0,crossAxis:m.crossAxis||0,alignmentAxis:m.alignmentAxis};return u&&typeof w=="number"&&(y=u==="end"?w*-1:w),c?{x:y*h,y:g*f}:{x:g*f,y:y*h}}const o$=function(n){return n===void 0&&(n=0),{name:"offset",options:n,async fn(e){var t,r;const{x:s,y:a,placement:o,middlewareData:u}=e,c=await i$(e,n);return o===((t=u.offset)==null?void 0:t.placement)&&(r=u.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:a+c.y,data:{...c,placement:o}}}}},l$=function(n){return n===void 0&&(n={}),{name:"shift",options:n,async fn(e){const{x:t,y:r,placement:s}=e,{mainAxis:a=!0,crossAxis:o=!1,limiter:u={fn:x=>{let{x:E,y:k}=x;return{x:E,y:k}}},...c}=Os(n,e),f={x:t,y:r},h=await Fy(e,c),m=Ts($r(s)),g=jy(m);let y=f[g],w=f[m];if(a){const x=g==="y"?"top":"left",E=g==="y"?"bottom":"right",k=y+h[x],S=y-h[E];y=Lg(k,y,S)}if(o){const x=m==="y"?"top":"left",E=m==="y"?"bottom":"right",k=w+h[x],S=w-h[E];w=Lg(k,w,S)}const v=u.fn({...e,[g]:y,[m]:w});return{...v,data:{x:v.x-t,y:v.y-r,enabled:{[g]:a,[m]:o}}}}}},u$=function(n){return n===void 0&&(n={}),{options:n,fn(e){const{x:t,y:r,placement:s,rects:a,middlewareData:o}=e,{offset:u=0,mainAxis:c=!0,crossAxis:f=!0}=Os(n,e),h={x:t,y:r},m=Ts(s),g=jy(m);let y=h[g],w=h[m];const v=Os(u,e),x=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(c){const S=g==="y"?"height":"width",R=a.reference[g]-a.floating[S]+x.mainAxis,A=a.reference[g]+a.reference[S]-x.mainAxis;y<R?y=R:y>A&&(y=A)}if(f){var E,k;const S=g==="y"?"width":"height",R=["top","left"].includes($r(s)),A=a.reference[m]-a.floating[S]+(R&&((E=o.offset)==null?void 0:E[m])||0)+(R?0:x.crossAxis),I=a.reference[m]+a.reference[S]+(R?0:((k=o.offset)==null?void 0:k[m])||0)-(R?x.crossAxis:0);w<A?w=A:w>I&&(w=I)}return{[g]:y,[m]:w}}}},c$=function(n){return n===void 0&&(n={}),{name:"size",options:n,async fn(e){var t,r;const{placement:s,rects:a,platform:o,elements:u}=e,{apply:c=()=>{},...f}=Os(n,e),h=await Fy(e,f),m=$r(s),g=ho(s),y=Ts(s)==="y",{width:w,height:v}=a.floating;let x,E;m==="top"||m==="bottom"?(x=m,E=g===(await(o.isRTL==null?void 0:o.isRTL(u.floating))?"start":"end")?"left":"right"):(E=m,x=g==="end"?"top":"bottom");const k=v-h.top-h.bottom,S=w-h.left-h.right,R=Ar(v-h[x],k),A=Ar(w-h[E],S),I=!e.middlewareData.shift;let M=R,D=A;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(D=S),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(M=k),I&&!g){const X=rn(h.left,0),ae=rn(h.right,0),he=rn(h.top,0),ce=rn(h.bottom,0);y?D=w-2*(X!==0||ae!==0?X+ae:rn(h.left,h.right)):M=v-2*(he!==0||ce!==0?he+ce:rn(h.top,h.bottom))}await c({...e,availableWidth:D,availableHeight:M});const K=await o.getDimensions(u.floating);return w!==K.width||v!==K.height?{reset:{rects:!0}}:{}}}};function SE(n){const e=Tr(n);let t=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=es(n),a=s?n.offsetWidth:t,o=s?n.offsetHeight:r,u=Od(t)!==a||Od(r)!==o;return u&&(t=a,r=o),{width:t,height:r,$:u}}function Uy(n){return gn(n)?n:n.contextElement}function Gi(n){const e=Uy(n);if(!es(e))return Xr(1);const t=e.getBoundingClientRect(),{width:r,height:s,$:a}=SE(e);let o=(a?Od(t.width):t.width)/r,u=(a?Od(t.height):t.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!u||!Number.isFinite(u))&&(u=1),{x:o,y:u}}const d$=Xr(0);function EE(n){const e=Hn(n);return!Ny()||!e.visualViewport?d$:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function f$(n,e,t){return e===void 0&&(e=!1),!t||e&&t!==Hn(n)?!1:e}function Za(n,e,t,r){e===void 0&&(e=!1),t===void 0&&(t=!1);const s=n.getBoundingClientRect(),a=Uy(n);let o=Xr(1);e&&(r?gn(r)&&(o=Gi(r)):o=Gi(n));const u=f$(a,t,r)?EE(a):Xr(0);let c=(s.left+u.x)/o.x,f=(s.top+u.y)/o.y,h=s.width/o.x,m=s.height/o.y;if(a){const g=Hn(a),y=r&&gn(r)?Hn(r):r;let w=g,v=jg(w);for(;v&&r&&y!==w;){const x=Gi(v),E=v.getBoundingClientRect(),k=Tr(v),S=E.left+(v.clientLeft+parseFloat(k.paddingLeft))*x.x,R=E.top+(v.clientTop+parseFloat(k.paddingTop))*x.y;c*=x.x,f*=x.y,h*=x.x,m*=x.y,c+=S,f+=R,w=Hn(v),v=jg(w)}}return to({width:h,height:m,x:c,y:f})}function zy(n,e){const t=df(n).scrollLeft;return e?e.left+t:Za(us(n)).left+t}function CE(n,e,t){t===void 0&&(t=!1);const r=n.getBoundingClientRect(),s=r.left+e.scrollLeft-(t?0:zy(n,r)),a=r.top+e.scrollTop;return{x:s,y:a}}function h$(n){let{elements:e,rect:t,offsetParent:r,strategy:s}=n;const a=s==="fixed",o=us(r),u=e?cf(e.floating):!1;if(r===o||u&&a)return t;let c={scrollLeft:0,scrollTop:0},f=Xr(1);const h=Xr(0),m=es(r);if((m||!m&&!a)&&((fo(r)!=="body"||mu(o))&&(c=df(r)),es(r))){const y=Za(r);f=Gi(r),h.x=y.x+r.clientLeft,h.y=y.y+r.clientTop}const g=o&&!m&&!a?CE(o,c,!0):Xr(0);return{width:t.width*f.x,height:t.height*f.y,x:t.x*f.x-c.scrollLeft*f.x+h.x+g.x,y:t.y*f.y-c.scrollTop*f.y+h.y+g.y}}function p$(n){return Array.from(n.getClientRects())}function m$(n){const e=us(n),t=df(n),r=n.ownerDocument.body,s=rn(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),a=rn(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-t.scrollLeft+zy(n);const u=-t.scrollTop;return Tr(r).direction==="rtl"&&(o+=rn(e.clientWidth,r.clientWidth)-s),{width:s,height:a,x:o,y:u}}function g$(n,e){const t=Hn(n),r=us(n),s=t.visualViewport;let a=r.clientWidth,o=r.clientHeight,u=0,c=0;if(s){a=s.width,o=s.height;const f=Ny();(!f||f&&e==="fixed")&&(u=s.offsetLeft,c=s.offsetTop)}return{width:a,height:o,x:u,y:c}}function y$(n,e){const t=Za(n,!0,e==="fixed"),r=t.top+n.clientTop,s=t.left+n.clientLeft,a=es(n)?Gi(n):Xr(1),o=n.clientWidth*a.x,u=n.clientHeight*a.y,c=s*a.x,f=r*a.y;return{width:o,height:u,x:c,y:f}}function A0(n,e,t){let r;if(e==="viewport")r=g$(n,t);else if(e==="document")r=m$(us(n));else if(gn(e))r=y$(e,t);else{const s=EE(n);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return to(r)}function PE(n,e){const t=ua(n);return t===e||!gn(t)||eo(t)?!1:Tr(t).position==="fixed"||PE(t,e)}function _$(n,e){const t=e.get(n);if(t)return t;let r=Hl(n,[],!1).filter(u=>gn(u)&&fo(u)!=="body"),s=null;const a=Tr(n).position==="fixed";let o=a?ua(n):n;for(;gn(o)&&!eo(o);){const u=Tr(o),c=Iy(o);!c&&u.position==="fixed"&&(s=null),(a?!c&&!s:!c&&u.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||mu(o)&&!c&&PE(n,o))?r=r.filter(h=>h!==o):s=u,o=ua(o)}return e.set(n,r),r}function w$(n){let{element:e,boundary:t,rootBoundary:r,strategy:s}=n;const o=[...t==="clippingAncestors"?cf(e)?[]:_$(e,this._c):[].concat(t),r],u=o[0],c=o.reduce((f,h)=>{const m=A0(e,h,s);return f.top=rn(m.top,f.top),f.right=Ar(m.right,f.right),f.bottom=Ar(m.bottom,f.bottom),f.left=rn(m.left,f.left),f},A0(e,u,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function b$(n){const{width:e,height:t}=SE(n);return{width:e,height:t}}function v$(n,e,t){const r=es(e),s=us(e),a=t==="fixed",o=Za(n,!0,a,e);let u={scrollLeft:0,scrollTop:0};const c=Xr(0);if(r||!r&&!a)if((fo(e)!=="body"||mu(s))&&(u=df(e)),r){const g=Za(e,!0,a,e);c.x=g.x+e.clientLeft,c.y=g.y+e.clientTop}else s&&(c.x=zy(s));const f=s&&!r&&!a?CE(s,u):Xr(0),h=o.left+u.scrollLeft-c.x-f.x,m=o.top+u.scrollTop-c.y-f.y;return{x:h,y:m,width:o.width,height:o.height}}function Jp(n){return Tr(n).position==="static"}function $0(n,e){if(!es(n)||Tr(n).position==="fixed")return null;if(e)return e(n);let t=n.offsetParent;return us(n)===t&&(t=t.ownerDocument.body),t}function kE(n,e){const t=Hn(n);if(cf(n))return t;if(!es(n)){let s=ua(n);for(;s&&!eo(s);){if(gn(s)&&!Jp(s))return s;s=ua(s)}return t}let r=$0(n,e);for(;r&&qA(r)&&Jp(r);)r=$0(r,e);return r&&eo(r)&&Jp(r)&&!Iy(r)?t:r||ZA(n)||t}const x$=async function(n){const e=this.getOffsetParent||kE,t=this.getDimensions,r=await t(n.floating);return{reference:v$(n.reference,await e(n.floating),n.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function S$(n){return Tr(n).direction==="rtl"}const E$={convertOffsetParentRelativeRectToViewportRelativeRect:h$,getDocumentElement:us,getClippingRect:w$,getOffsetParent:kE,getElementRects:x$,getClientRects:p$,getDimensions:b$,getScale:Gi,isElement:gn,isRTL:S$};function RE(n,e){return n.x===e.x&&n.y===e.y&&n.width===e.width&&n.height===e.height}function C$(n,e){let t=null,r;const s=us(n);function a(){var u;clearTimeout(r),(u=t)==null||u.disconnect(),t=null}function o(u,c){u===void 0&&(u=!1),c===void 0&&(c=1),a();const f=n.getBoundingClientRect(),{left:h,top:m,width:g,height:y}=f;if(u||e(),!g||!y)return;const w=qc(m),v=qc(s.clientWidth-(h+g)),x=qc(s.clientHeight-(m+y)),E=qc(h),S={rootMargin:-w+"px "+-v+"px "+-x+"px "+-E+"px",threshold:rn(0,Ar(1,c))||1};let R=!0;function A(I){const M=I[0].intersectionRatio;if(M!==c){if(!R)return o();M?o(!1,M):r=setTimeout(()=>{o(!1,1e-7)},1e3)}M===1&&!RE(f,n.getBoundingClientRect())&&o(),R=!1}try{t=new IntersectionObserver(A,{...S,root:s.ownerDocument})}catch{t=new IntersectionObserver(A,S)}t.observe(n)}return o(!0),a}function P$(n,e,t,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,f=Uy(n),h=s||a?[...f?Hl(f):[],...Hl(e)]:[];h.forEach(E=>{s&&E.addEventListener("scroll",t,{passive:!0}),a&&E.addEventListener("resize",t)});const m=f&&u?C$(f,t):null;let g=-1,y=null;o&&(y=new ResizeObserver(E=>{let[k]=E;k&&k.target===f&&y&&(y.unobserve(e),cancelAnimationFrame(g),g=requestAnimationFrame(()=>{var S;(S=y)==null||S.observe(e)})),t()}),f&&!c&&y.observe(f),y.observe(e));let w,v=c?Za(n):null;c&&x();function x(){const E=Za(n);v&&!RE(v,E)&&t(),v=E,w=requestAnimationFrame(x)}return t(),()=>{var E;h.forEach(k=>{s&&k.removeEventListener("scroll",t),a&&k.removeEventListener("resize",t)}),m==null||m(),(E=y)==null||E.disconnect(),y=null,c&&cancelAnimationFrame(w)}}const k$=o$,R$=l$,O$=r$,T$=c$,I0=n$,A$=a$,$$=u$,I$=(n,e,t)=>{const r=new Map,s={platform:E$,...t},a={...s.platform,_c:r};return t$(n,e,{...s,platform:a})};var md=typeof document<"u"?P.useLayoutEffect:P.useEffect;function Ad(n,e){if(n===e)return!0;if(typeof n!=typeof e)return!1;if(typeof n=="function"&&n.toString()===e.toString())return!0;let t,r,s;if(n&&e&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==e.length)return!1;for(r=t;r--!==0;)if(!Ad(n[r],e[r]))return!1;return!0}if(s=Object.keys(n),t=s.length,t!==Object.keys(e).length)return!1;for(r=t;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=t;r--!==0;){const a=s[r];if(!(a==="_owner"&&n.$$typeof)&&!Ad(n[a],e[a]))return!1}return!0}return n!==n&&e!==e}function OE(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function N0(n,e){const t=OE(n);return Math.round(e*t)/t}function Kp(n){const e=P.useRef(n);return md(()=>{e.current=n}),e}function N$(n){n===void 0&&(n={});const{placement:e="bottom",strategy:t="absolute",middleware:r=[],platform:s,elements:{reference:a,floating:o}={},transform:u=!0,whileElementsMounted:c,open:f}=n,[h,m]=P.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[g,y]=P.useState(r);Ad(g,r)||y(r);const[w,v]=P.useState(null),[x,E]=P.useState(null),k=P.useCallback(j=>{j!==I.current&&(I.current=j,v(j))},[]),S=P.useCallback(j=>{j!==M.current&&(M.current=j,E(j))},[]),R=a||w,A=o||x,I=P.useRef(null),M=P.useRef(null),D=P.useRef(h),K=c!=null,X=Kp(c),ae=Kp(s),he=Kp(f),ce=P.useCallback(()=>{if(!I.current||!M.current)return;const j={placement:e,strategy:t,middleware:g};ae.current&&(j.platform=ae.current),I$(I.current,M.current,j).then(B=>{const V={...B,isPositioned:he.current!==!1};W.current&&!Ad(D.current,V)&&(D.current=V,af.flushSync(()=>{m(V)}))})},[g,e,t,ae,he]);md(()=>{f===!1&&D.current.isPositioned&&(D.current.isPositioned=!1,m(j=>({...j,isPositioned:!1})))},[f]);const W=P.useRef(!1);md(()=>(W.current=!0,()=>{W.current=!1}),[]),md(()=>{if(R&&(I.current=R),A&&(M.current=A),R&&A){if(X.current)return X.current(R,A,ce);ce()}},[R,A,ce,X,K]);const G=P.useMemo(()=>({reference:I,floating:M,setReference:k,setFloating:S}),[k,S]),q=P.useMemo(()=>({reference:R,floating:A}),[R,A]),J=P.useMemo(()=>{const j={position:t,left:0,top:0};if(!q.floating)return j;const B=N0(q.floating,h.x),V=N0(q.floating,h.y);return u?{...j,transform:"translate("+B+"px, "+V+"px)",...OE(q.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:B,top:V}},[t,u,q.floating,h.x,h.y]);return P.useMemo(()=>({...h,update:ce,refs:G,elements:q,floatingStyles:J}),[h,ce,G,q,J])}const j$=n=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:n,fn(t){const{element:r,padding:s}=typeof n=="function"?n(t):n;return r&&e(r)?r.current!=null?I0({element:r.current,padding:s}).fn(t):{}:r?I0({element:r,padding:s}).fn(t):{}}}},L$=(n,e)=>({...k$(n),options:[n,e]}),M$=(n,e)=>({...R$(n),options:[n,e]}),j0=(n,e)=>({...$$(n),options:[n,e]}),L0=(n,e)=>({...O$(n),options:[n,e]}),D$=(n,e)=>({...T$(n),options:[n,e]}),M0=(n,e)=>({...A$(n),options:[n,e]}),F$=(n,e)=>({...j$(n),options:[n,e]}),TE={...LO},U$=TE.useInsertionEffect,z$=U$||(n=>n());function B$(n){const e=P.useRef(()=>{});return z$(()=>{e.current=n}),P.useCallback(function(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e.current==null?void 0:e.current(...r)},[])}var Dg=typeof document<"u"?P.useLayoutEffect:P.useEffect;let D0=!1,H$=0;const F0=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+H$++;function V$(){const[n,e]=P.useState(()=>D0?F0():void 0);return Dg(()=>{n==null&&e(F0())},[]),P.useEffect(()=>{D0=!0},[]),n}const W$=TE.useId,q$=W$||V$;function Z$(){const n=new Map;return{emit(e,t){var r;(r=n.get(e))==null||r.forEach(s=>s(t))},on(e,t){n.set(e,[...n.get(e)||[],t])},off(e,t){var r;n.set(e,((r=n.get(e))==null?void 0:r.filter(s=>s!==t))||[])}}}const G$=P.createContext(null),J$=P.createContext(null),K$=()=>{var n;return((n=P.useContext(G$))==null?void 0:n.id)||null},X$=()=>P.useContext(J$);function Y$(n){const{open:e=!1,onOpenChange:t,elements:r}=n,s=q$(),a=P.useRef({}),[o]=P.useState(()=>Z$()),u=K$()!=null,[c,f]=P.useState(r.reference),h=B$((y,w,v)=>{a.current.openEvent=y?w:void 0,o.emit("openchange",{open:y,event:w,reason:v,nested:u}),t==null||t(y,w,v)}),m=P.useMemo(()=>({setPositionReference:f}),[]),g=P.useMemo(()=>({reference:c||r.reference||null,floating:r.floating||null,domReference:r.reference}),[c,r.reference,r.floating]);return P.useMemo(()=>({dataRef:a,open:e,onOpenChange:h,elements:g,events:o,floatingId:s,refs:m}),[e,h,g,o,s,m])}function Q$(n){n===void 0&&(n={});const{nodeId:e}=n,t=Y$({...n,elements:{reference:null,floating:null,...n.elements}}),r=n.rootContext||t,s=r.elements,[a,o]=P.useState(null),[u,c]=P.useState(null),h=(s==null?void 0:s.domReference)||a,m=P.useRef(null),g=X$();Dg(()=>{h&&(m.current=h)},[h]);const y=N$({...n,elements:{...s,...u&&{reference:u}}}),w=P.useCallback(S=>{const R=gn(S)?{getBoundingClientRect:()=>S.getBoundingClientRect(),contextElement:S}:S;c(R),y.refs.setReference(R)},[y.refs]),v=P.useCallback(S=>{(gn(S)||S===null)&&(m.current=S,o(S)),(gn(y.refs.reference.current)||y.refs.reference.current===null||S!==null&&!gn(S))&&y.refs.setReference(S)},[y.refs]),x=P.useMemo(()=>({...y.refs,setReference:v,setPositionReference:w,domReference:m}),[y.refs,v,w]),E=P.useMemo(()=>({...y.elements,domReference:h}),[y.elements,h]),k=P.useMemo(()=>({...y,...r,refs:x,elements:E,nodeId:e}),[y,x,E,e,r]);return Dg(()=>{r.dataRef.current.floatingContext=k;const S=g==null?void 0:g.nodesRef.current.find(R=>R.id===e);S&&(S.context=k)}),P.useMemo(()=>({...y,context:k,refs:x,elements:E}),[y,x,E,k])}function eI(n,e){if(n==="rtl"&&(e.includes("right")||e.includes("left"))){const[t,r]=e.split("-"),s=t==="right"?"left":"right";return r===void 0?s:`${s}-${r}`}return e}function U0(n,e,t,r){return n==="center"||r==="center"?{top:e}:n==="end"?{bottom:t}:n==="start"?{top:t}:{}}function z0(n,e,t,r,s){return n==="center"||r==="center"?{left:e}:n==="end"?{[s==="ltr"?"right":"left"]:t}:n==="start"?{[s==="ltr"?"left":"right"]:t}:{}}const tI={bottom:"borderTopLeftRadius",left:"borderTopRightRadius",right:"borderBottomLeftRadius",top:"borderBottomRightRadius"};function nI({position:n,arrowSize:e,arrowOffset:t,arrowRadius:r,arrowPosition:s,arrowX:a,arrowY:o,dir:u}){const[c,f="center"]=n.split("-"),h={width:e,height:e,transform:"rotate(45deg)",position:"absolute",[tI[c]]:r},m=-e/2;return c==="left"?{...h,...U0(f,o,t,s),right:m,borderLeftColor:"transparent",borderBottomColor:"transparent",clipPath:"polygon(100% 0, 0 0, 100% 100%)"}:c==="right"?{...h,...U0(f,o,t,s),left:m,borderRightColor:"transparent",borderTopColor:"transparent",clipPath:"polygon(0 100%, 0 0, 100% 100%)"}:c==="top"?{...h,...z0(f,a,t,s,u),bottom:m,borderTopColor:"transparent",borderLeftColor:"transparent",clipPath:"polygon(0 100%, 100% 100%, 100% 0)"}:c==="bottom"?{...h,...z0(f,a,t,s,u),top:m,borderBottomColor:"transparent",borderRightColor:"transparent",clipPath:"polygon(0 100%, 0 0, 100% 0)"}:{}}const AE=P.forwardRef(({position:n,arrowSize:e,arrowOffset:t,arrowRadius:r,arrowPosition:s,visible:a,arrowX:o,arrowY:u,style:c,...f},h)=>{const{dir:m}=ky();return a?O.jsx("div",{...f,ref:h,style:{...c,...nI({position:n,arrowSize:e,arrowOffset:t,arrowRadius:r,arrowPosition:s,dir:m,arrowX:o,arrowY:u})}}):null});AE.displayName="@mantine/core/FloatingArrow";var $E={root:"m_9814e45f"};const rI={zIndex:j1("modal")},sI=(n,{gradient:e,color:t,backgroundOpacity:r,blur:s,radius:a,zIndex:o})=>({root:{"--overlay-bg":e||(t!==void 0||r!==void 0)&&Vr(t||"#000",r??.6)||void 0,"--overlay-filter":s?`blur(${Q(s)})`:void 0,"--overlay-radius":a===void 0?void 0:is(a),"--overlay-z-index":o==null?void 0:o.toString()}}),By=rr((n,e)=>{const t=ve("Overlay",rI,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,vars:c,fixed:f,center:h,children:m,radius:g,zIndex:y,gradient:w,blur:v,color:x,backgroundOpacity:E,mod:k,...S}=t,R=Ye({name:"Overlay",props:t,classes:$E,className:s,style:a,classNames:r,styles:o,unstyled:u,vars:c,varsResolver:sI});return O.jsx(ke,{ref:e,...R("root"),mod:[{center:h,fixed:f},k],...S,children:m})});By.classes=$E;By.displayName="@mantine/core/Overlay";function aI(n){const e=document.createElement("div");return e.setAttribute("data-portal","true"),typeof n.className=="string"&&e.classList.add(...n.className.split(" ").filter(Boolean)),typeof n.style=="object"&&Object.assign(e.style,n.style),typeof n.id=="string"&&e.setAttribute("id",n.id),e}const iI={},IE=P.forwardRef((n,e)=>{const{children:t,target:r,...s}=ve("Portal",iI,n),[a,o]=P.useState(!1),u=P.useRef(null);return fu(()=>(o(!0),u.current=r?typeof r=="string"?document.querySelector(r):r:aI(s),Pd(e,u.current),!r&&u.current&&document.body.appendChild(u.current),()=>{!r&&u.current&&document.body.removeChild(u.current)}),[r]),!a||!u.current?null:af.createPortal(O.jsx(O.Fragment,{children:t}),u.current)});IE.displayName="@mantine/core/Portal";function Hy({withinPortal:n=!0,children:e,...t}){return n?O.jsx(IE,{...t,children:e}):O.jsx(O.Fragment,{children:e})}Hy.displayName="@mantine/core/OptionalPortal";const yl=n=>({in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:`scale(.9) translateY(${n==="bottom"?10:-10}px)`},transitionProperty:"transform, opacity"}),Zc={fade:{in:{opacity:1},out:{opacity:0},transitionProperty:"opacity"},"fade-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(30px)"},transitionProperty:"opacity, transform"},"fade-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-30px)"},transitionProperty:"opacity, transform"},"fade-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(30px)"},transitionProperty:"opacity, transform"},"fade-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-30px)"},transitionProperty:"opacity, transform"},scale:{in:{opacity:1,transform:"scale(1)"},out:{opacity:0,transform:"scale(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-y":{in:{opacity:1,transform:"scaleY(1)"},out:{opacity:0,transform:"scaleY(0)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"scale-x":{in:{opacity:1,transform:"scaleX(1)"},out:{opacity:0,transform:"scaleX(0)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"skew-up":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(-20px) skew(-10deg, -5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"skew-down":{in:{opacity:1,transform:"translateY(0) skew(0deg, 0deg)"},out:{opacity:0,transform:"translateY(20px) skew(-10deg, -5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-left":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(-5deg)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"rotate-right":{in:{opacity:1,transform:"translateY(0) rotate(0deg)"},out:{opacity:0,transform:"translateY(20px) rotate(5deg)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-down":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(-100%)"},common:{transformOrigin:"top"},transitionProperty:"transform, opacity"},"slide-up":{in:{opacity:1,transform:"translateY(0)"},out:{opacity:0,transform:"translateY(100%)"},common:{transformOrigin:"bottom"},transitionProperty:"transform, opacity"},"slide-left":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(100%)"},common:{transformOrigin:"left"},transitionProperty:"transform, opacity"},"slide-right":{in:{opacity:1,transform:"translateX(0)"},out:{opacity:0,transform:"translateX(-100%)"},common:{transformOrigin:"right"},transitionProperty:"transform, opacity"},pop:{...yl("bottom"),common:{transformOrigin:"center center"}},"pop-bottom-left":{...yl("bottom"),common:{transformOrigin:"bottom left"}},"pop-bottom-right":{...yl("bottom"),common:{transformOrigin:"bottom right"}},"pop-top-left":{...yl("top"),common:{transformOrigin:"top left"}},"pop-top-right":{...yl("top"),common:{transformOrigin:"top right"}}},B0={entering:"in",entered:"in",exiting:"out",exited:"out","pre-exiting":"out","pre-entering":"out"};function oI({transition:n,state:e,duration:t,timingFunction:r}){const s={transitionDuration:`${t}ms`,transitionTimingFunction:r};return typeof n=="string"?n in Zc?{transitionProperty:Zc[n].transitionProperty,...s,...Zc[n].common,...Zc[n][B0[e]]}:{}:{transitionProperty:n.transitionProperty,...s,...n.common,...n[B0[e]]}}function lI({duration:n,exitDuration:e,timingFunction:t,mounted:r,onEnter:s,onExit:a,onEntered:o,onExited:u,enterDelay:c,exitDelay:f}){const h=ls(),m=B1(),g=h.respectReducedMotion?m:!1,[y,w]=P.useState(g?0:n),[v,x]=P.useState(r?"entered":"exited"),E=P.useRef(-1),k=P.useRef(-1),S=P.useRef(-1),R=I=>{const M=I?s:a,D=I?o:u;window.clearTimeout(E.current);const K=g?0:I?n:e;w(K),K===0?(typeof M=="function"&&M(),typeof D=="function"&&D(),x(I?"entered":"exited")):S.current=requestAnimationFrame(()=>{RA.flushSync(()=>{x(I?"pre-entering":"pre-exiting")}),S.current=requestAnimationFrame(()=>{typeof M=="function"&&M(),x(I?"entering":"exiting"),E.current=window.setTimeout(()=>{typeof D=="function"&&D(),x(I?"entered":"exited")},K)})})},A=I=>{if(window.clearTimeout(k.current),typeof(I?c:f)!="number"){R(I);return}k.current=window.setTimeout(()=>{R(I)},I?c:f)};return Wa(()=>{A(r)},[r]),P.useEffect(()=>()=>{window.clearTimeout(E.current),cancelAnimationFrame(S.current)},[]),{transitionDuration:y,transitionStatus:v,transitionTimingFunction:t||"ease"}}function gu({keepMounted:n,transition:e="fade",duration:t=250,exitDuration:r=t,mounted:s,children:a,timingFunction:o="ease",onExit:u,onEntered:c,onEnter:f,onExited:h,enterDelay:m,exitDelay:g}){const{transitionDuration:y,transitionStatus:w,transitionTimingFunction:v}=lI({mounted:s,exitDuration:r,duration:t,timingFunction:o,onExit:u,onEntered:c,onEnter:f,onExited:h,enterDelay:m,exitDelay:g});return y===0?s?O.jsx(O.Fragment,{children:a({})}):n?a({display:"none"}):null:w==="exited"?n?a({display:"none"}):null:O.jsx(O.Fragment,{children:a(oI({transition:e,duration:y,state:w,timingFunction:v}))})}gu.displayName="@mantine/core/Transition";const[uI,NE]=ni("Popover component was not found in the tree");function Vy({children:n,active:e=!0,refProp:t="ref",innerRef:r}){const s=dT(e),a=An(s,r);return du(n)?P.cloneElement(n,{[t]:a}):n}function jE(n){return O.jsx(Ay,{tabIndex:-1,"data-autofocus":!0,...n})}Vy.displayName="@mantine/core/FocusTrap";jE.displayName="@mantine/core/FocusTrapInitialFocus";Vy.InitialFocus=jE;var LE={dropdown:"m_38a85659",arrow:"m_a31dc6c1",overlay:"m_3d7bc908"};const cI={},Wy=ze((n,e)=>{var x,E,k,S;const t=ve("PopoverDropdown",cI,n),{className:r,style:s,vars:a,children:o,onKeyDownCapture:u,variant:c,classNames:f,styles:h,...m}=t,g=NE(),y=aT({opened:g.opened,shouldReturnFocus:g.returnFocus}),w=g.withRoles?{"aria-labelledby":g.getTargetId(),id:g.getDropdownId(),role:"dialog",tabIndex:-1}:{},v=An(e,g.floating);return g.disabled?null:O.jsx(Hy,{...g.portalProps,withinPortal:g.withinPortal,children:O.jsx(gu,{mounted:g.opened,...g.transitionProps,transition:((x=g.transitionProps)==null?void 0:x.transition)||"fade",duration:((E=g.transitionProps)==null?void 0:E.duration)??150,keepMounted:g.keepMounted,exitDuration:typeof((k=g.transitionProps)==null?void 0:k.exitDuration)=="number"?g.transitionProps.exitDuration:(S=g.transitionProps)==null?void 0:S.duration,children:R=>O.jsx(Vy,{active:g.trapFocus&&g.opened,innerRef:v,children:O.jsxs(ke,{...w,...m,variant:c,onKeyDownCapture:XO(g.onClose,{active:g.closeOnEscape,onTrigger:y,onKeyDown:u}),"data-position":g.placement,"data-fixed":g.floatingStrategy==="fixed"||void 0,...g.getStyles("dropdown",{className:r,props:t,classNames:f,styles:h,style:[{...R,zIndex:g.zIndex,top:g.y??0,left:g.x??0,width:g.width==="target"?void 0:Q(g.width)},g.resolvedStyles.dropdown,h==null?void 0:h.dropdown,s]}),children:[o,O.jsx(AE,{ref:g.arrowRef,arrowX:g.arrowX,arrowY:g.arrowY,visible:g.withArrow,position:g.placement,arrowSize:g.arrowSize,arrowRadius:g.arrowRadius,arrowOffset:g.arrowOffset,arrowPosition:g.arrowPosition,...g.getStyles("arrow",{props:t,classNames:f,styles:h})})]})})})})});Wy.classes=LE;Wy.displayName="@mantine/core/PopoverDropdown";const dI={refProp:"ref",popupType:"dialog"},ME=ze((n,e)=>{const{children:t,refProp:r,popupType:s,...a}=ve("PopoverTarget",dI,n);if(!du(t))throw new Error("Popover.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const o=a,u=NE(),c=An(u.reference,H1(t),e),f=u.withRoles?{"aria-haspopup":s,"aria-expanded":u.opened,"aria-controls":u.getDropdownId(),id:u.getTargetId()}:{};return P.cloneElement(t,{...o,...f,...u.targetProps,className:os(u.targetProps.className,o.className,t.props.className),[r]:c,...u.controlled?null:{onClick:u.onToggle}})});ME.displayName="@mantine/core/PopoverTarget";function fI({opened:n,floating:e,position:t,positionDependencies:r}){const[s,a]=P.useState(0);P.useEffect(()=>{if(e.refs.reference.current&&e.refs.floating.current&&n)return P$(e.refs.reference.current,e.refs.floating.current,e.update)},[e.refs.reference.current,e.refs.floating.current,n,s,t]),Wa(()=>{e.update()},r),Wa(()=>{a(o=>o+1)},[n])}function hI(n){if(n===void 0)return{shift:!0,flip:!0};const e={...n};return n.shift===void 0&&(e.shift=!0),n.flip===void 0&&(e.flip=!0),e}function pI(n,e){const t=hI(n.middlewares),r=[L$(n.offset)];return t.shift&&r.push(M$(typeof t.shift=="boolean"?{limiter:j0(),padding:5}:{limiter:j0(),padding:5,...t.shift})),t.flip&&r.push(typeof t.flip=="boolean"?L0():L0(t.flip)),t.inline&&r.push(typeof t.inline=="boolean"?M0():M0(t.inline)),r.push(F$({element:n.arrowRef,padding:n.arrowOffset})),(t.size||n.width==="target")&&r.push(D$({...typeof t.size=="boolean"?{}:t.size,apply({rects:s,availableWidth:a,availableHeight:o,...u}){var h;const f=((h=e().refs.floating.current)==null?void 0:h.style)??{};t.size&&(typeof t.size=="object"&&t.size.apply?t.size.apply({rects:s,availableWidth:a,availableHeight:o,...u}):Object.assign(f,{maxWidth:`${a}px`,maxHeight:`${o}px`})),n.width==="target"&&Object.assign(f,{width:`${s.reference.width}px`})}})),r}function mI(n){const[e,t]=qa({value:n.opened,defaultValue:n.defaultOpened,finalValue:!1,onChange:n.onChange}),r=P.useRef(e),s=()=>{e&&t(!1)},a=()=>t(!e),o=Q$({strategy:n.strategy,placement:n.position,middleware:pI(n,()=>o)});return fI({opened:e,position:n.position,positionDependencies:n.positionDependencies||[],floating:o}),Wa(()=>{var u;(u=n.onPositionChange)==null||u.call(n,o.placement)},[o.placement]),Wa(()=>{var u,c;e!==r.current&&(e?(c=n.onOpen)==null||c.call(n):(u=n.onClose)==null||u.call(n)),r.current=e},[e,n.onClose,n.onOpen]),{floating:o,controlled:typeof n.opened=="boolean",opened:e,onClose:s,onToggle:a}}const gI={position:"bottom",offset:8,positionDependencies:[],transitionProps:{transition:"fade",duration:150},middlewares:{flip:!0,shift:!0,inline:!1},arrowSize:7,arrowOffset:5,arrowRadius:0,arrowPosition:"side",closeOnClickOutside:!0,withinPortal:!0,closeOnEscape:!0,trapFocus:!1,withRoles:!0,returnFocus:!1,withOverlay:!1,clickOutsideEvents:["mousedown","touchstart"],zIndex:j1("popover"),__staticSelector:"Popover",width:"max-content"},yI=(n,{radius:e,shadow:t})=>({dropdown:{"--popover-radius":e===void 0?void 0:is(e),"--popover-shadow":M1(t)}});function ya(n){var Ht,qn,ds,$n,kt,Ns;const e=ve("Popover",gI,n),{children:t,position:r,offset:s,onPositionChange:a,positionDependencies:o,opened:u,transitionProps:c,onExitTransitionEnd:f,onEnterTransitionEnd:h,width:m,middlewares:g,withArrow:y,arrowSize:w,arrowOffset:v,arrowRadius:x,arrowPosition:E,unstyled:k,classNames:S,styles:R,closeOnClickOutside:A,withinPortal:I,portalProps:M,closeOnEscape:D,clickOutsideEvents:K,trapFocus:X,onClose:ae,onOpen:he,onChange:ce,zIndex:W,radius:G,shadow:q,id:J,defaultOpened:j,__staticSelector:B,withRoles:V,disabled:$,returnFocus:U,variant:re,keepMounted:pe,vars:de,floatingStrategy:Y,withOverlay:oe,overlayProps:ue,...ge}=e,_e=Ye({name:B,props:e,classes:LE,classNames:S,styles:R,unstyled:k,rootSelector:"dropdown",vars:de,varsResolver:yI}),{resolvedStyles:Ie}=pu({classNames:S,styles:R,props:e}),Nt=P.useRef(null),[Bt,Qe]=P.useState(null),[Ct,ot]=P.useState(null),{dir:st}=ky(),or=uo(J),nt=mI({middlewares:g,width:m,position:eI(st,r),offset:typeof s=="number"?s+(y?w/2:0):s,arrowRef:Nt,arrowOffset:v,onPositionChange:a,positionDependencies:o,opened:u,defaultOpened:j,onChange:ce,onOpen:he,onClose:ae,strategy:Y});tT(()=>A&&nt.onClose(),K,[Bt,Ct]);const lr=P.useCallback(yt=>{Qe(yt),nt.floating.refs.setReference(yt)},[nt.floating.refs.setReference]),Pt=P.useCallback(yt=>{ot(yt),nt.floating.refs.setFloating(yt)},[nt.floating.refs.setFloating]),Is=P.useCallback(()=>{var yt;(yt=c==null?void 0:c.onExited)==null||yt.call(c),f==null||f()},[c==null?void 0:c.onExited,f]),ii=P.useCallback(()=>{var yt;(yt=c==null?void 0:c.onEntered)==null||yt.call(c),h==null||h()},[c==null?void 0:c.onEntered,h]);return O.jsxs(uI,{value:{returnFocus:U,disabled:$,controlled:nt.controlled,reference:lr,floating:Pt,x:nt.floating.x,y:nt.floating.y,arrowX:(ds=(qn=(Ht=nt.floating)==null?void 0:Ht.middlewareData)==null?void 0:qn.arrow)==null?void 0:ds.x,arrowY:(Ns=(kt=($n=nt.floating)==null?void 0:$n.middlewareData)==null?void 0:kt.arrow)==null?void 0:Ns.y,opened:nt.opened,arrowRef:Nt,transitionProps:{...c,onExited:Is,onEntered:ii},width:m,withArrow:y,arrowSize:w,arrowOffset:v,arrowRadius:x,arrowPosition:E,placement:nt.floating.placement,trapFocus:X,withinPortal:I,portalProps:M,zIndex:W,radius:G,shadow:q,closeOnEscape:D,onClose:nt.onClose,onToggle:nt.onToggle,getTargetId:()=>`${or}-target`,getDropdownId:()=>`${or}-dropdown`,withRoles:V,targetProps:ge,__staticSelector:B,classNames:S,styles:R,unstyled:k,variant:re,keepMounted:pe,getStyles:_e,resolvedStyles:Ie,floatingStrategy:Y},children:[t,oe&&O.jsx(gu,{transition:"fade",mounted:nt.opened,duration:(c==null?void 0:c.duration)||250,exitDuration:(c==null?void 0:c.exitDuration)||250,children:yt=>O.jsx(Hy,{withinPortal:I,children:O.jsx(By,{...ue,..._e("overlay",{className:ue==null?void 0:ue.className,style:[yt,ue==null?void 0:ue.style]})})})})]})}ya.Target=ME;ya.Dropdown=Wy;ya.displayName="@mantine/core/Popover";ya.extend=n=>n;var Sr={root:"m_5ae2e3c",barsLoader:"m_7a2bd4cd",bar:"m_870bb79","bars-loader-animation":"m_5d2b3b9d",dotsLoader:"m_4e3f22d7",dot:"m_870c4af","loader-dots-animation":"m_aac34a1",ovalLoader:"m_b34414df","oval-loader-animation":"m_f8e89c4b"};const DE=P.forwardRef(({className:n,...e},t)=>O.jsxs(ke,{component:"span",className:os(Sr.barsLoader,n),...e,ref:t,children:[O.jsx("span",{className:Sr.bar}),O.jsx("span",{className:Sr.bar}),O.jsx("span",{className:Sr.bar})]}));DE.displayName="@mantine/core/Bars";const FE=P.forwardRef(({className:n,...e},t)=>O.jsxs(ke,{component:"span",className:os(Sr.dotsLoader,n),...e,ref:t,children:[O.jsx("span",{className:Sr.dot}),O.jsx("span",{className:Sr.dot}),O.jsx("span",{className:Sr.dot})]}));FE.displayName="@mantine/core/Dots";const UE=P.forwardRef(({className:n,...e},t)=>O.jsx(ke,{component:"span",className:os(Sr.ovalLoader,n),...e,ref:t}));UE.displayName="@mantine/core/Oval";const zE={bars:DE,oval:UE,dots:FE},_I={loaders:zE,type:"oval"},wI=(n,{size:e,color:t})=>({root:{"--loader-size":xt(e,"loader-size"),"--loader-color":t?Bl(t,n):void 0}}),Ga=ze((n,e)=>{const t=ve("Loader",_I,n),{size:r,color:s,type:a,vars:o,className:u,style:c,classNames:f,styles:h,unstyled:m,loaders:g,variant:y,children:w,...v}=t,x=Ye({name:"Loader",props:t,classes:Sr,className:u,style:c,classNames:f,styles:h,unstyled:m,vars:o,varsResolver:wI});return w?O.jsx(ke,{...x("root"),ref:e,...v,children:w}):O.jsx(ke,{...x("root"),ref:e,component:g[a],variant:y,size:r,...v})});Ga.defaultLoaders=zE;Ga.classes=Sr;Ga.displayName="@mantine/core/Loader";var po={root:"m_8d3f4000",icon:"m_8d3afb97",loader:"m_302b9fb1",group:"m_1a0f1b21",groupSection:"m_437b6484"};const H0={orientation:"horizontal"},bI=(n,{borderWidth:e})=>({group:{"--ai-border-width":Q(e)}}),qy=ze((n,e)=>{const t=ve("ActionIconGroup",H0,n),{className:r,style:s,classNames:a,styles:o,unstyled:u,orientation:c,vars:f,borderWidth:h,variant:m,mod:g,...y}=ve("ActionIconGroup",H0,n),w=Ye({name:"ActionIconGroup",props:t,classes:po,className:r,style:s,classNames:a,styles:o,unstyled:u,vars:f,varsResolver:bI,rootSelector:"group"});return O.jsx(ke,{...w("group"),ref:e,variant:m,mod:[{"data-orientation":c},g],role:"group",...y})});qy.classes=po;qy.displayName="@mantine/core/ActionIconGroup";const V0={},vI=(n,{radius:e,color:t,gradient:r,variant:s,autoContrast:a,size:o})=>{const u=n.variantColorResolver({color:t||n.primaryColor,theme:n,gradient:r,variant:s||"filled",autoContrast:a});return{groupSection:{"--section-height":xt(o,"section-height"),"--section-padding-x":xt(o,"section-padding-x"),"--section-fz":yn(o),"--section-radius":e===void 0?void 0:is(e),"--section-bg":t||s?u.background:void 0,"--section-color":u.color,"--section-bd":t||s?u.border:void 0}}},Zy=ze((n,e)=>{const t=ve("ActionIconGroupSection",V0,n),{className:r,style:s,classNames:a,styles:o,unstyled:u,vars:c,variant:f,gradient:h,radius:m,autoContrast:g,...y}=ve("ActionIconGroupSection",V0,n),w=Ye({name:"ActionIconGroupSection",props:t,classes:po,className:r,style:s,classNames:a,styles:o,unstyled:u,vars:c,varsResolver:vI,rootSelector:"groupSection"});return O.jsx(ke,{...w("groupSection"),ref:e,variant:f,...y})});Zy.classes=po;Zy.displayName="@mantine/core/ActionIconGroupSection";const xI={},SI=(n,{size:e,radius:t,variant:r,gradient:s,color:a,autoContrast:o})=>{const u=n.variantColorResolver({color:a||n.primaryColor,theme:n,gradient:s,variant:r||"filled",autoContrast:o});return{root:{"--ai-size":xt(e,"ai-size"),"--ai-radius":t===void 0?void 0:is(t),"--ai-bg":a||r?u.background:void 0,"--ai-hover":a||r?u.hover:void 0,"--ai-hover-color":a||r?u.hoverColor:void 0,"--ai-color":u.color,"--ai-bd":a||r?u.border:void 0}}},yu=rr((n,e)=>{const t=ve("ActionIcon",xI,n),{className:r,unstyled:s,variant:a,classNames:o,styles:u,style:c,loading:f,loaderProps:h,size:m,color:g,radius:y,__staticSelector:w,gradient:v,vars:x,children:E,disabled:k,"data-disabled":S,autoContrast:R,mod:A,...I}=t,M=Ye({name:["ActionIcon",w],props:t,className:r,style:c,classes:po,classNames:o,styles:u,unstyled:s,vars:x,varsResolver:SI});return O.jsxs(co,{...M("root",{active:!k&&!f&&!S}),...I,unstyled:s,variant:a,size:m,disabled:k||f,ref:e,mod:[{loading:f,disabled:k||S},A],children:[O.jsx(gu,{mounted:!!f,transition:"slide-down",duration:150,children:D=>O.jsx(ke,{component:"span",...M("loader",{style:D}),"aria-hidden":!0,children:O.jsx(Ga,{color:"var(--ai-color)",size:"calc(var(--ai-size) * 0.55)",...h})})}),O.jsx(ke,{component:"span",mod:{loading:f},...M("icon"),children:E})]})});yu.classes=po;yu.displayName="@mantine/core/ActionIcon";yu.Group=qy;yu.GroupSection=Zy;const BE=P.forwardRef(({size:n="var(--cb-icon-size, 70%)",style:e,...t},r)=>O.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...e,width:n,height:n},ref:r,...t,children:O.jsx("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})}));BE.displayName="@mantine/core/CloseIcon";var HE={root:"m_86a44da5","root--subtle":"m_220c80f2"};const EI={variant:"subtle"},CI=(n,{size:e,radius:t,iconSize:r})=>({root:{"--cb-size":xt(e,"cb-size"),"--cb-radius":t===void 0?void 0:is(t),"--cb-icon-size":Q(r)}}),ff=rr((n,e)=>{const t=ve("CloseButton",EI,n),{iconSize:r,children:s,vars:a,radius:o,className:u,classNames:c,style:f,styles:h,unstyled:m,"data-disabled":g,disabled:y,variant:w,icon:v,mod:x,__staticSelector:E,...k}=t,S=Ye({name:E||"CloseButton",props:t,className:u,style:f,classes:HE,classNames:c,styles:h,unstyled:m,vars:a,varsResolver:CI});return O.jsxs(co,{ref:e,...k,unstyled:m,variant:w,disabled:y,mod:[{disabled:y||g},x],...S("root",{variant:w,active:!y&&!g}),children:[v||O.jsx(BE,{}),s]})});ff.classes=HE;ff.displayName="@mantine/core/CloseButton";const[PI,kI]=N1({size:"sm"}),RI={},VE=ze((n,e)=>{const t=ve("InputClearButton",RI,n),{size:r,variant:s,vars:a,classNames:o,styles:u,...c}=t,f=kI(),{resolvedClassNames:h,resolvedStyles:m}=pu({classNames:o,styles:u,props:t});return O.jsx(ff,{variant:s||"transparent",ref:e,size:r||(f==null?void 0:f.size)||"sm",classNames:h,styles:m,__staticSelector:"InputClearButton",...c})});VE.displayName="@mantine/core/InputClearButton";const[OI,hf]=N1({offsetBottom:!1,offsetTop:!1,describedBy:void 0,getStyles:null,inputId:void 0,labelId:void 0});var ar={wrapper:"m_6c018570",input:"m_8fb7ebe7",section:"m_82577fc2",placeholder:"m_88bacfd0",root:"m_46b77525",label:"m_8fdc1311",required:"m_78a94662",error:"m_8f816625",description:"m_fe47ce59"};const W0={},TI=(n,{size:e})=>({description:{"--input-description-size":e===void 0?void 0:`calc(${yn(e)} - ${Q(2)})`}}),pf=ze((n,e)=>{const t=ve("InputDescription",W0,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,vars:c,size:f,__staticSelector:h,__inheritStyles:m=!0,variant:g,...y}=ve("InputDescription",W0,t),w=hf(),v=Ye({name:["InputWrapper",h],props:t,classes:ar,className:s,style:a,classNames:r,styles:o,unstyled:u,rootSelector:"description",vars:c,varsResolver:TI}),x=m&&(w==null?void 0:w.getStyles)||v;return O.jsx(ke,{component:"p",ref:e,variant:g,size:f,...x("description",w!=null&&w.getStyles?{className:s,style:a}:void 0),...y})});pf.classes=ar;pf.displayName="@mantine/core/InputDescription";const AI={},$I=(n,{size:e})=>({error:{"--input-error-size":e===void 0?void 0:`calc(${yn(e)} - ${Q(2)})`}}),mf=ze((n,e)=>{const t=ve("InputError",AI,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,vars:c,size:f,__staticSelector:h,__inheritStyles:m=!0,variant:g,...y}=t,w=Ye({name:["InputWrapper",h],props:t,classes:ar,className:s,style:a,classNames:r,styles:o,unstyled:u,rootSelector:"error",vars:c,varsResolver:$I}),v=hf(),x=m&&(v==null?void 0:v.getStyles)||w;return O.jsx(ke,{component:"p",ref:e,variant:g,size:f,...x("error",v!=null&&v.getStyles?{className:s,style:a}:void 0),...y})});mf.classes=ar;mf.displayName="@mantine/core/InputError";const q0={labelElement:"label"},II=(n,{size:e})=>({label:{"--input-label-size":yn(e),"--input-asterisk-color":void 0}}),gf=ze((n,e)=>{const t=ve("InputLabel",q0,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,vars:c,labelElement:f,size:h,required:m,htmlFor:g,onMouseDown:y,children:w,__staticSelector:v,variant:x,mod:E,...k}=ve("InputLabel",q0,t),S=Ye({name:["InputWrapper",v],props:t,classes:ar,className:s,style:a,classNames:r,styles:o,unstyled:u,rootSelector:"label",vars:c,varsResolver:II}),R=hf(),A=(R==null?void 0:R.getStyles)||S;return O.jsxs(ke,{...A("label",R!=null&&R.getStyles?{className:s,style:a}:void 0),component:f,variant:x,size:h,ref:e,htmlFor:f==="label"?g:void 0,mod:[{required:m},E],onMouseDown:I=>{y==null||y(I),!I.defaultPrevented&&I.detail>1&&I.preventDefault()},...k,children:[w,m&&O.jsx("span",{...A("required"),"aria-hidden":!0,children:" *"})]})});gf.classes=ar;gf.displayName="@mantine/core/InputLabel";const Z0={},Gy=ze((n,e)=>{const t=ve("InputPlaceholder",Z0,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,vars:c,__staticSelector:f,variant:h,error:m,mod:g,...y}=ve("InputPlaceholder",Z0,t),w=Ye({name:["InputPlaceholder",f],props:t,classes:ar,className:s,style:a,classNames:r,styles:o,unstyled:u,rootSelector:"placeholder"});return O.jsx(ke,{...w("placeholder"),mod:[{error:!!m},g],component:"span",variant:h,ref:e,...y})});Gy.classes=ar;Gy.displayName="@mantine/core/InputPlaceholder";function NI(n,{hasDescription:e,hasError:t}){const r=n.findIndex(c=>c==="input"),s=n.slice(0,r),a=n.slice(r+1),o=e&&s.includes("description")||t&&s.includes("error");return{offsetBottom:e&&a.includes("description")||t&&a.includes("error"),offsetTop:o}}const jI={labelElement:"label",inputContainer:n=>n,inputWrapperOrder:["label","description","input","error"]},LI=(n,{size:e})=>({label:{"--input-label-size":yn(e),"--input-asterisk-color":void 0},error:{"--input-error-size":e===void 0?void 0:`calc(${yn(e)} - ${Q(2)})`},description:{"--input-description-size":e===void 0?void 0:`calc(${yn(e)} - ${Q(2)})`}}),Jy=ze((n,e)=>{const t=ve("InputWrapper",jI,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,vars:c,size:f,variant:h,__staticSelector:m,inputContainer:g,inputWrapperOrder:y,label:w,error:v,description:x,labelProps:E,descriptionProps:k,errorProps:S,labelElement:R,children:A,withAsterisk:I,id:M,required:D,__stylesApiProps:K,mod:X,...ae}=t,he=Ye({name:["InputWrapper",m],props:K||t,classes:ar,className:s,style:a,classNames:r,styles:o,unstyled:u,vars:c,varsResolver:LI}),ce={size:f,variant:h,__staticSelector:m},W=uo(M),G=typeof I=="boolean"?I:D,q=(S==null?void 0:S.id)||`${W}-error`,J=(k==null?void 0:k.id)||`${W}-description`,j=W,B=!!v&&typeof v!="boolean",V=!!x,$=`${B?q:""} ${V?J:""}`,U=$.trim().length>0?$.trim():void 0,re=(E==null?void 0:E.id)||`${W}-label`,pe=w&&O.jsx(gf,{labelElement:R,id:re,htmlFor:j,required:G,...ce,...E,children:w},"label"),de=V&&O.jsx(pf,{...k,...ce,size:(k==null?void 0:k.size)||ce.size,id:(k==null?void 0:k.id)||J,children:x},"description"),Y=O.jsx(P.Fragment,{children:g(A)},"input"),oe=B&&P.createElement(mf,{...S,...ce,size:(S==null?void 0:S.size)||ce.size,key:"error",id:(S==null?void 0:S.id)||q},v),ue=y.map(ge=>{switch(ge){case"label":return pe;case"input":return Y;case"description":return de;case"error":return oe;default:return null}});return O.jsx(OI,{value:{getStyles:he,describedBy:U,inputId:j,labelId:re,...NI(y,{hasDescription:V,hasError:B})},children:O.jsx(ke,{ref:e,variant:h,size:f,mod:[{error:!!v},X],...he("root"),...ae,children:ue})})});Jy.classes=ar;Jy.displayName="@mantine/core/InputWrapper";const MI={variant:"default",leftSectionPointerEvents:"none",rightSectionPointerEvents:"none",withAria:!0,withErrorStyles:!0},DI=(n,e,t)=>({wrapper:{"--input-margin-top":t.offsetTop?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-margin-bottom":t.offsetBottom?"calc(var(--mantine-spacing-xs) / 2)":void 0,"--input-height":xt(e.size,"input-height"),"--input-fz":yn(e.size),"--input-radius":e.radius===void 0?void 0:is(e.radius),"--input-left-section-width":e.leftSectionWidth!==void 0?Q(e.leftSectionWidth):void 0,"--input-right-section-width":e.rightSectionWidth!==void 0?Q(e.rightSectionWidth):void 0,"--input-padding-y":e.multiline?xt(e.size,"input-padding-y"):void 0,"--input-left-section-pointer-events":e.leftSectionPointerEvents,"--input-right-section-pointer-events":e.rightSectionPointerEvents}}),Jt=rr((n,e)=>{const t=ve("Input",MI,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,required:c,__staticSelector:f,__stylesApiProps:h,size:m,wrapperProps:g,error:y,disabled:w,leftSection:v,leftSectionProps:x,leftSectionWidth:E,rightSection:k,rightSectionProps:S,rightSectionWidth:R,rightSectionPointerEvents:A,leftSectionPointerEvents:I,variant:M,vars:D,pointer:K,multiline:X,radius:ae,id:he,withAria:ce,withErrorStyles:W,mod:G,inputSize:q,__clearSection:J,__clearable:j,__defaultRightSection:B,...V}=t,{styleProps:$,rest:U}=sf(V),re=hf(),pe={offsetBottom:re==null?void 0:re.offsetBottom,offsetTop:re==null?void 0:re.offsetTop},de=Ye({name:["Input",f],props:h||t,classes:ar,className:s,style:a,classNames:r,styles:o,unstyled:u,stylesCtx:pe,rootSelector:"wrapper",vars:D,varsResolver:DI}),Y=ce?{required:c,disabled:w,"aria-invalid":!!y,"aria-describedby":re==null?void 0:re.describedBy,id:(re==null?void 0:re.inputId)||he}:{},oe=k||j&&J||B;return O.jsx(PI,{value:{size:m||"sm"},children:O.jsxs(ke,{...de("wrapper"),...$,...g,mod:[{error:!!y&&W,pointer:K,disabled:w,multiline:X,"data-with-right-section":!!k,"data-with-left-section":!!v},G],variant:M,size:m,children:[v&&O.jsx("div",{...x,"data-position":"left",...de("section",{className:x==null?void 0:x.className,style:x==null?void 0:x.style}),children:v}),O.jsx(ke,{component:"input",...U,...Y,ref:e,required:c,mod:{disabled:w,error:!!y&&W},variant:M,__size:q,...de("input")}),oe&&O.jsx("div",{...S,"data-position":"right",...de("section",{className:S==null?void 0:S.className,style:S==null?void 0:S.style}),children:oe})]})})});Jt.classes=ar;Jt.Wrapper=Jy;Jt.Label=gf;Jt.Error=mf;Jt.Description=pf;Jt.Placeholder=Gy;Jt.ClearButton=VE;Jt.displayName="@mantine/core/Input";function FI(n,e,t){const r=ve(n,e,t),{label:s,description:a,error:o,required:u,classNames:c,styles:f,className:h,unstyled:m,__staticSelector:g,__stylesApiProps:y,errorProps:w,labelProps:v,descriptionProps:x,wrapperProps:E,id:k,size:S,style:R,inputContainer:A,inputWrapperOrder:I,withAsterisk:M,variant:D,vars:K,mod:X,...ae}=r,{styleProps:he,rest:ce}=sf(ae),W={label:s,description:a,error:o,required:u,classNames:c,className:h,__staticSelector:g,__stylesApiProps:y||r,errorProps:w,labelProps:v,descriptionProps:x,unstyled:m,styles:f,size:S,style:R,inputContainer:A,inputWrapperOrder:I,withAsterisk:M,variant:D,id:k,mod:X,...E};return{...ce,classNames:c,styles:f,unstyled:m,wrapperProps:{...W,...he},inputProps:{required:u,classNames:c,styles:f,unstyled:m,size:S,__staticSelector:g,__stylesApiProps:y||r,error:o,variant:D,id:k}}}const UI={__staticSelector:"InputBase",withAria:!0},jr=rr((n,e)=>{const{inputProps:t,wrapperProps:r,...s}=FI("InputBase",UI,n);return O.jsx(Jt.Wrapper,{...r,children:O.jsx(Jt,{...t,...s,ref:e})})});jr.classes={...Jt.classes,...Jt.Wrapper.classes};jr.displayName="@mantine/core/InputBase";const zI={gap:{type:"spacing",property:"gap"},rowGap:{type:"spacing",property:"rowGap"},columnGap:{type:"spacing",property:"columnGap"},align:{type:"identity",property:"alignItems"},justify:{type:"identity",property:"justifyContent"},wrap:{type:"identity",property:"flexWrap"},direction:{type:"identity",property:"flexDirection"}};var WE={root:"m_8bffd616"};const BI={},mn=rr((n,e)=>{const t=ve("Flex",BI,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,vars:c,gap:f,rowGap:h,columnGap:m,align:g,justify:y,wrap:w,direction:v,...x}=t,E=Ye({name:"Flex",classes:WE,props:t,className:s,style:a,classNames:r,styles:o,unstyled:u,vars:c}),k=ls(),S=Y1(),R=X1({styleProps:{gap:f,rowGap:h,columnGap:m,align:g,justify:y,wrap:w,direction:v},theme:k,data:zI});return O.jsxs(O.Fragment,{children:[R.hasResponsiveStyles&&O.jsx(K1,{selector:`.${S}`,styles:R.styles,media:R.media}),O.jsx(ke,{ref:e,...E("root",{className:S,style:tf(R.inlineStyles)}),...x})]})});mn.classes=WE;mn.displayName="@mantine/core/Flex";const[HI,Ky]=ni("Accordion component was not found in the tree");function Xy({style:n,size:e=16,...t}){return O.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{...n,width:Q(e),height:Q(e),display:"block"},...t,children:O.jsx("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}Xy.displayName="@mantine/core/AccordionChevron";const[VI,qE]=ni("Accordion.Item component was not found in the tree");var _u={root:"m_9bdbb667",panel:"m_df78851f",content:"m_4ba554d4",itemTitle:"m_8fa820a0",control:"m_4ba585b8","control--default":"m_6939a5e9","control--contained":"m_4271d21b",label:"m_df3ffa0f",chevron:"m_3f35ae96",icon:"m_9bd771fe",item:"m_9bd7b098","item--default":"m_fe19b709","item--contained":"m_1f921b3b","item--filled":"m_2cdf939a","item--separated":"m_9f59b069"};const WI={},Yy=ze((n,e)=>{const{classNames:t,className:r,style:s,styles:a,vars:o,chevron:u,icon:c,onClick:f,onKeyDown:h,children:m,disabled:g,mod:y,...w}=ve("AccordionControl",WI,n),{value:v}=qE(),x=Ky(),E=x.isItemActive(v),k=typeof x.order=="number",S=`h${x.order}`,R=O.jsxs(co,{...w,...x.getStyles("control",{className:r,classNames:t,style:s,styles:a,variant:x.variant}),unstyled:x.unstyled,mod:["accordion-control",{active:E,"chevron-position":x.chevronPosition,disabled:g},y],ref:e,onClick:A=>{f==null||f(A),x.onChange(v)},type:"button",disabled:g,"aria-expanded":E,"aria-controls":x.getRegionId(v),id:x.getControlId(v),onKeyDown:GO({siblingSelector:"[data-accordion-control]",parentSelector:"[data-accordion]",activateOnFocus:!1,loop:x.loop,orientation:"vertical",onKeyDown:h}),children:[O.jsx(ke,{component:"span",mod:{rotate:!x.disableChevronRotation&&E,position:x.chevronPosition},...x.getStyles("chevron",{classNames:t,styles:a}),children:u||x.chevron}),O.jsx("span",{...x.getStyles("label",{classNames:t,styles:a}),children:m}),c&&O.jsx(ke,{component:"span",mod:{"chevron-position":x.chevronPosition},...x.getStyles("icon",{classNames:t,styles:a}),children:c})]});return k?O.jsx(S,{...x.getStyles("itemTitle",{classNames:t,styles:a}),children:R}):R});Yy.displayName="@mantine/core/AccordionControl";Yy.classes=_u;const qI={},Qy=ze((n,e)=>{const{classNames:t,className:r,style:s,styles:a,vars:o,value:u,mod:c,...f}=ve("AccordionItem",qI,n),h=Ky();return O.jsx(VI,{value:{value:u},children:O.jsx(ke,{ref:e,mod:[{active:h.isItemActive(u)},c],...h.getStyles("item",{className:r,classNames:t,styles:a,style:s,variant:h.variant}),...f})})});Qy.displayName="@mantine/core/AccordionItem";Qy.classes=_u;const ZI={},e_=ze((n,e)=>{const{classNames:t,className:r,style:s,styles:a,vars:o,children:u,...c}=ve("AccordionPanel",ZI,n),{value:f}=qE(),h=Ky();return O.jsx(sE,{ref:e,...h.getStyles("panel",{className:r,classNames:t,style:s,styles:a}),...c,in:h.isItemActive(f),transitionDuration:h.transitionDuration??200,role:"region",id:h.getRegionId(f),"aria-labelledby":h.getControlId(f),children:O.jsx("div",{...h.getStyles("content",{classNames:t,styles:a}),children:u})})});e_.displayName="@mantine/core/AccordionPanel";e_.classes=_u;const GI={multiple:!1,disableChevronRotation:!1,chevronPosition:"right",variant:"default",chevron:O.jsx(Xy,{})},JI=(n,{transitionDuration:e,chevronSize:t,radius:r})=>({root:{"--accordion-transition-duration":e===void 0?void 0:`${e}ms`,"--accordion-chevron-size":t===void 0?void 0:Q(t),"--accordion-radius":r===void 0?void 0:is(r)}});function dt(n){const e=ve("Accordion",GI,n),{classNames:t,className:r,style:s,styles:a,unstyled:o,vars:u,children:c,multiple:f,value:h,defaultValue:m,onChange:g,id:y,loop:w,transitionDuration:v,disableChevronRotation:x,chevronPosition:E,chevronSize:k,order:S,chevron:R,variant:A,radius:I,...M}=e,D=uo(y),[K,X]=qa({value:h,defaultValue:m,finalValue:f?[]:null,onChange:g}),ae=W=>Array.isArray(K)?K.includes(W):W===K,he=W=>{const G=Array.isArray(K)?K.includes(W)?K.filter(q=>q!==W):[...K,W]:W===K?null:W;X(G)},ce=Ye({name:"Accordion",classes:_u,props:e,className:r,style:s,classNames:t,styles:a,unstyled:o,vars:u,varsResolver:JI});return O.jsx(HI,{value:{isItemActive:ae,onChange:he,getControlId:_0(`${D}-control`,"Accordion.Item component was rendered with invalid value or without value"),getRegionId:_0(`${D}-panel`,"Accordion.Item component was rendered with invalid value or without value"),transitionDuration:v,disableChevronRotation:x,chevronPosition:E,order:S,chevron:R,loop:w,getStyles:ce,variant:A,unstyled:o},children:O.jsx(ke,{...ce("root"),id:D,...M,variant:A,"data-accordion":!0,children:c})})}const KI=n=>n;dt.extend=KI;dt.withProps=PA(dt);dt.classes=_u;dt.displayName="@mantine/core/Accordion";dt.Item=Qy;dt.Panel=e_;dt.Control=Yy;dt.Chevron=Xy;var ZE={root:"m_b6d8b162"};function XI(n){if(n==="start")return"start";if(n==="end"||n)return"end"}const YI={inherit:!1},QI=(n,{variant:e,lineClamp:t,gradient:r,size:s,color:a})=>({root:{"--text-fz":yn(s),"--text-lh":YO(s),"--text-gradient":e==="gradient"?Tg(r,n):void 0,"--text-line-clamp":typeof t=="number"?t.toString():void 0,"--text-color":a?Bl(a,n):void 0}}),t_=rr((n,e)=>{const t=ve("Text",YI,n),{lineClamp:r,truncate:s,inline:a,inherit:o,gradient:u,span:c,__staticSelector:f,vars:h,className:m,style:g,classNames:y,styles:w,unstyled:v,variant:x,mod:E,size:k,...S}=t,R=Ye({name:["Text",f],props:t,classes:ZE,className:m,style:g,classNames:y,styles:w,unstyled:v,vars:h,varsResolver:QI});return O.jsx(ke,{...R("root",{focusable:!0}),ref:e,component:c?"span":"p",variant:x,mod:[{"data-truncate":XI(s),"data-line-clamp":typeof r=="number","data-inline":a,"data-inherit":o},E],size:k,...S})});t_.classes=ZE;t_.displayName="@mantine/core/Text";function GE(n){return typeof n=="string"?{value:n,label:n}:"value"in n&&!("label"in n)?{value:n.value,label:n.value,disabled:n.disabled}:typeof n=="number"?{value:n.toString(),label:n.toString()}:"group"in n?{group:n.group,items:n.items.map(e=>GE(e))}:n}function eN(n){return n?n.map(e=>GE(e)):[]}function JE(n){return n.reduce((e,t)=>"group"in t?{...e,...JE(t.items)}:(e[t.value]=t,e),{})}var Tn={dropdown:"m_88b62a41",search:"m_985517d8",options:"m_b2821a6e",option:"m_92253aa5",empty:"m_2530cd1d",header:"m_858f94bd",footer:"m_82b967cb",group:"m_254f3e4f",groupLabel:"m_2bb2e9e5",chevron:"m_2943220b",optionsDropdownOption:"m_390b5f4",optionsDropdownCheckIcon:"m_8ee53fc2"};const tN={error:null},nN=(n,{size:e,color:t})=>({chevron:{"--combobox-chevron-size":xt(e,"combobox-chevron-size"),"--combobox-chevron-color":t?Bl(t,n):void 0}}),n_=ze((n,e)=>{const t=ve("ComboboxChevron",tN,n),{size:r,error:s,style:a,className:o,classNames:u,styles:c,unstyled:f,vars:h,mod:m,...g}=t,y=Ye({name:"ComboboxChevron",classes:Tn,props:t,style:a,className:o,classNames:u,styles:c,unstyled:f,vars:h,varsResolver:nN,rootSelector:"chevron"});return O.jsx(ke,{component:"svg",...g,...y("chevron"),size:r,viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",mod:["combobox-chevron",{error:s},m],ref:e,children:O.jsx("path",{d:"M4.93179 5.43179C4.75605 5.60753 4.75605 5.89245 4.93179 6.06819C5.10753 6.24392 5.39245 6.24392 5.56819 6.06819L7.49999 4.13638L9.43179 6.06819C9.60753 6.24392 9.89245 6.24392 10.0682 6.06819C10.2439 5.89245 10.2439 5.60753 10.0682 5.43179L7.81819 3.18179C7.73379 3.0974 7.61933 3.04999 7.49999 3.04999C7.38064 3.04999 7.26618 3.0974 7.18179 3.18179L4.93179 5.43179ZM10.0682 9.56819C10.2439 9.39245 10.2439 9.10753 10.0682 8.93179C9.89245 8.75606 9.60753 8.75606 9.43179 8.93179L7.49999 10.8636L5.56819 8.93179C5.39245 8.75606 5.10753 8.75606 4.93179 8.93179C4.75605 9.10753 4.75605 9.39245 4.93179 9.56819L7.18179 11.8182C7.35753 11.9939 7.64245 11.9939 7.81819 11.8182L10.0682 9.56819Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})});n_.classes=Tn;n_.displayName="@mantine/core/ComboboxChevron";const[rN,ir]=ni("Combobox component was not found in tree"),KE=P.forwardRef(({size:n,onMouseDown:e,onClick:t,onClear:r,...s},a)=>O.jsx(Jt.ClearButton,{ref:a,tabIndex:-1,"aria-hidden":!0,...s,onMouseDown:o=>{o.preventDefault(),e==null||e(o)},onClick:o=>{r(),t==null||t(o)}}));KE.displayName="@mantine/core/ComboboxClearButton";const sN={},r_=ze((n,e)=>{const{classNames:t,styles:r,className:s,style:a,hidden:o,...u}=ve("ComboboxDropdown",sN,n),c=ir();return O.jsx(ya.Dropdown,{...u,ref:e,role:"presentation","data-hidden":o||void 0,...c.getStyles("dropdown",{className:s,style:a,classNames:t,styles:r})})});r_.classes=Tn;r_.displayName="@mantine/core/ComboboxDropdown";const aN={refProp:"ref"},XE=ze((n,e)=>{const{children:t,refProp:r}=ve("ComboboxDropdownTarget",aN,n);if(ir(),!du(t))throw new Error("Combobox.DropdownTarget component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");return O.jsx(ya.Target,{ref:e,refProp:r,children:t})});XE.displayName="@mantine/core/ComboboxDropdownTarget";const iN={},s_=ze((n,e)=>{const{classNames:t,className:r,style:s,styles:a,vars:o,...u}=ve("ComboboxEmpty",iN,n),c=ir();return O.jsx(ke,{ref:e,...c.getStyles("empty",{className:r,classNames:t,styles:a,style:s}),...u})});s_.classes=Tn;s_.displayName="@mantine/core/ComboboxEmpty";function a_({onKeyDown:n,withKeyboardNavigation:e,withAriaAttributes:t,withExpandedAttribute:r,targetType:s,autoComplete:a}){const o=ir(),[u,c]=P.useState(null),f=m=>{if(n==null||n(m),!o.readOnly&&e){if(m.nativeEvent.isComposing)return;if(m.nativeEvent.code==="ArrowDown"&&(m.preventDefault(),o.store.dropdownOpened?c(o.store.selectNextOption()):(o.store.openDropdown("keyboard"),c(o.store.selectActiveOption()),o.store.updateSelectedOptionIndex("selected",{scrollIntoView:!0}))),m.nativeEvent.code==="ArrowUp"&&(m.preventDefault(),o.store.dropdownOpened?c(o.store.selectPreviousOption()):(o.store.openDropdown("keyboard"),c(o.store.selectActiveOption()),o.store.updateSelectedOptionIndex("selected",{scrollIntoView:!0}))),m.nativeEvent.code==="Enter"||m.nativeEvent.code==="NumpadEnter"){if(m.nativeEvent.keyCode===229)return;const g=o.store.getSelectedOptionIndex();o.store.dropdownOpened&&g!==-1?(m.preventDefault(),o.store.clickSelectedOption()):s==="button"&&(m.preventDefault(),o.store.openDropdown("keyboard"))}m.key==="Escape"&&o.store.closeDropdown("keyboard"),m.nativeEvent.code==="Space"&&s==="button"&&(m.preventDefault(),o.store.toggleDropdown("keyboard"))}};return{...t?{"aria-haspopup":"listbox","aria-expanded":r&&!!(o.store.listId&&o.store.dropdownOpened)||void 0,"aria-controls":o.store.dropdownOpened?o.store.listId:void 0,"aria-activedescendant":o.store.dropdownOpened&&u||void 0,autoComplete:a,"data-expanded":o.store.dropdownOpened||void 0,"data-mantine-stop-propagation":o.store.dropdownOpened||void 0}:{},onKeyDown:f}}const oN={refProp:"ref",targetType:"input",withKeyboardNavigation:!0,withAriaAttributes:!0,withExpandedAttribute:!1,autoComplete:"off"},YE=ze((n,e)=>{const{children:t,refProp:r,withKeyboardNavigation:s,withAriaAttributes:a,withExpandedAttribute:o,targetType:u,autoComplete:c,...f}=ve("ComboboxEventsTarget",oN,n);if(!du(t))throw new Error("Combobox.EventsTarget component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const h=ir(),m=a_({targetType:u,withAriaAttributes:a,withKeyboardNavigation:s,withExpandedAttribute:o,onKeyDown:t.props.onKeyDown,autoComplete:c});return P.cloneElement(t,{...m,...f,[r]:An(e,h.store.targetRef,H1(t))})});YE.displayName="@mantine/core/ComboboxEventsTarget";const lN={},i_=ze((n,e)=>{const{classNames:t,className:r,style:s,styles:a,vars:o,...u}=ve("ComboboxFooter",lN,n),c=ir();return O.jsx(ke,{ref:e,...c.getStyles("footer",{className:r,classNames:t,style:s,styles:a}),...u,onMouseDown:f=>{f.preventDefault()}})});i_.classes=Tn;i_.displayName="@mantine/core/ComboboxFooter";const uN={},o_=ze((n,e)=>{const{classNames:t,className:r,style:s,styles:a,vars:o,children:u,label:c,...f}=ve("ComboboxGroup",uN,n),h=ir();return O.jsxs(ke,{ref:e,...h.getStyles("group",{className:r,classNames:t,style:s,styles:a}),...f,children:[c&&O.jsx("div",{...h.getStyles("groupLabel",{classNames:t,styles:a}),children:c}),u]})});o_.classes=Tn;o_.displayName="@mantine/core/ComboboxGroup";const cN={},l_=ze((n,e)=>{const{classNames:t,className:r,style:s,styles:a,vars:o,...u}=ve("ComboboxHeader",cN,n),c=ir();return O.jsx(ke,{ref:e,...c.getStyles("header",{className:r,classNames:t,style:s,styles:a}),...u,onMouseDown:f=>{f.preventDefault()}})});l_.classes=Tn;l_.displayName="@mantine/core/ComboboxHeader";function QE({value:n,valuesDivider:e=",",...t}){return O.jsx("input",{type:"hidden",value:Array.isArray(n)?n.join(e):n||"",...t})}QE.displayName="@mantine/core/ComboboxHiddenInput";const dN={},u_=ze((n,e)=>{const t=ve("ComboboxOption",dN,n),{classNames:r,className:s,style:a,styles:o,vars:u,onClick:c,id:f,active:h,onMouseDown:m,onMouseOver:g,disabled:y,selected:w,mod:v,...x}=t,E=ir(),k=P.useId(),S=f||k;return O.jsx(ke,{...E.getStyles("option",{className:s,classNames:r,styles:o,style:a}),...x,ref:e,id:S,mod:["combobox-option",{"combobox-active":h,"combobox-disabled":y,"combobox-selected":w},v],role:"option",onClick:R=>{var A;y?R.preventDefault():((A=E.onOptionSubmit)==null||A.call(E,t.value,t),c==null||c(R))},onMouseDown:R=>{R.preventDefault(),m==null||m(R)},onMouseOver:R=>{E.resetSelectionOnOptionHover&&E.store.resetSelectedOption(),g==null||g(R)}})});u_.classes=Tn;u_.displayName="@mantine/core/ComboboxOption";const fN={},c_=ze((n,e)=>{const t=ve("ComboboxOptions",fN,n),{classNames:r,className:s,style:a,styles:o,id:u,onMouseDown:c,labelledBy:f,...h}=t,m=ir(),g=uo(u);return P.useEffect(()=>{m.store.setListId(g)},[g]),O.jsx(ke,{ref:e,...m.getStyles("options",{className:s,style:a,classNames:r,styles:o}),...h,id:g,role:"listbox","aria-labelledby":f,onMouseDown:y=>{y.preventDefault(),c==null||c(y)}})});c_.classes=Tn;c_.displayName="@mantine/core/ComboboxOptions";const hN={withAriaAttributes:!0,withKeyboardNavigation:!0},d_=ze((n,e)=>{const t=ve("ComboboxSearch",hN,n),{classNames:r,styles:s,unstyled:a,vars:o,withAriaAttributes:u,onKeyDown:c,withKeyboardNavigation:f,size:h,...m}=t,g=ir(),y=g.getStyles("search"),w=a_({targetType:"input",withAriaAttributes:u,withKeyboardNavigation:f,withExpandedAttribute:!1,onKeyDown:c,autoComplete:"off"});return O.jsx(Jt,{ref:An(e,g.store.searchRef),classNames:[{input:y.className},r],styles:[{input:y.style},s],size:h||g.size,...w,...m,__staticSelector:"Combobox"})});d_.classes=Tn;d_.displayName="@mantine/core/ComboboxSearch";const pN={refProp:"ref",targetType:"input",withKeyboardNavigation:!0,withAriaAttributes:!0,withExpandedAttribute:!1,autoComplete:"off"},eC=ze((n,e)=>{const{children:t,refProp:r,withKeyboardNavigation:s,withAriaAttributes:a,withExpandedAttribute:o,targetType:u,autoComplete:c,...f}=ve("ComboboxTarget",pN,n);if(!du(t))throw new Error("Combobox.Target component children should be an element or a component that accepts ref. Fragments, strings, numbers and other primitive values are not supported");const h=ir(),m=a_({targetType:u,withAriaAttributes:a,withKeyboardNavigation:s,withExpandedAttribute:o,onKeyDown:t.props.onKeyDown,autoComplete:c}),g=P.cloneElement(t,{...m,...f});return O.jsx(ya.Target,{ref:An(e,h.store.targetRef),children:g})});eC.displayName="@mantine/core/ComboboxTarget";function mN(n,e,t){for(let r=n-1;r>=0;r-=1)if(!e[r].hasAttribute("data-combobox-disabled"))return r;if(t){for(let r=e.length-1;r>-1;r-=1)if(!e[r].hasAttribute("data-combobox-disabled"))return r}return n}function gN(n,e,t){for(let r=n+1;r<e.length;r+=1)if(!e[r].hasAttribute("data-combobox-disabled"))return r;if(t){for(let r=0;r<e.length;r+=1)if(!e[r].hasAttribute("data-combobox-disabled"))return r}return n}function yN(n){for(let e=0;e<n.length;e+=1)if(!n[e].hasAttribute("data-combobox-disabled"))return e;return-1}function tC({defaultOpened:n,opened:e,onOpenedChange:t,onDropdownClose:r,onDropdownOpen:s,loop:a=!0,scrollBehavior:o="instant"}={}){const[u,c]=qa({value:e,defaultValue:n,finalValue:!1,onChange:t}),f=P.useRef(null),h=P.useRef(-1),m=P.useRef(null),g=P.useRef(null),y=P.useRef(-1),w=P.useRef(-1),v=P.useRef(-1),x=P.useCallback((q="unknown")=>{u||(c(!0),s==null||s(q))},[c,s,u]),E=P.useCallback((q="unknown")=>{u&&(c(!1),r==null||r(q))},[c,r,u]),k=P.useCallback((q="unknown")=>{u?E(q):x(q)},[E,x,u]),S=P.useCallback(()=>{const q=document.querySelector(`#${f.current} [data-combobox-selected]`);q==null||q.removeAttribute("data-combobox-selected"),q==null||q.removeAttribute("aria-selected")},[]),R=P.useCallback(q=>{const J=document.getElementById(f.current),j=J==null?void 0:J.querySelectorAll("[data-combobox-option]");if(!j)return null;const B=q>=j.length?0:q<0?j.length-1:q;return h.current=B,j!=null&&j[B]&&!j[B].hasAttribute("data-combobox-disabled")?(S(),j[B].setAttribute("data-combobox-selected","true"),j[B].setAttribute("aria-selected","true"),j[B].scrollIntoView({block:"nearest",behavior:o}),j[B].id):null},[o,S]),A=P.useCallback(()=>{const q=document.querySelector(`#${f.current} [data-combobox-active]`);if(q){const J=document.querySelectorAll(`#${f.current} [data-combobox-option]`),j=Array.from(J).findIndex(B=>B===q);return R(j)}return R(0)},[R]),I=P.useCallback(()=>R(gN(h.current,document.querySelectorAll(`#${f.current} [data-combobox-option]`),a)),[R,a]),M=P.useCallback(()=>R(mN(h.current,document.querySelectorAll(`#${f.current} [data-combobox-option]`),a)),[R,a]),D=P.useCallback(()=>R(yN(document.querySelectorAll(`#${f.current} [data-combobox-option]`))),[R]),K=P.useCallback((q="selected",J)=>{v.current=window.setTimeout(()=>{var V;const j=document.querySelectorAll(`#${f.current} [data-combobox-option]`),B=Array.from(j).findIndex($=>$.hasAttribute(`data-combobox-${q}`));h.current=B,J!=null&&J.scrollIntoView&&((V=j[B])==null||V.scrollIntoView({block:"nearest",behavior:o}))},0)},[]),X=P.useCallback(()=>{h.current=-1,S()},[S]),ae=P.useCallback(()=>{const q=document.querySelectorAll(`#${f.current} [data-combobox-option]`),J=q==null?void 0:q[h.current];J==null||J.click()},[]),he=P.useCallback(q=>{f.current=q},[]),ce=P.useCallback(()=>{y.current=window.setTimeout(()=>m.current.focus(),0)},[]),W=P.useCallback(()=>{w.current=window.setTimeout(()=>g.current.focus(),0)},[]),G=P.useCallback(()=>h.current,[]);return P.useEffect(()=>()=>{window.clearTimeout(y.current),window.clearTimeout(w.current),window.clearTimeout(v.current)},[]),{dropdownOpened:u,openDropdown:x,closeDropdown:E,toggleDropdown:k,selectedOptionIndex:h.current,getSelectedOptionIndex:G,selectOption:R,selectFirstOption:D,selectActiveOption:A,selectNextOption:I,selectPreviousOption:M,resetSelectedOption:X,updateSelectedOptionIndex:K,listId:f.current,setListId:he,clickSelectedOption:ae,searchRef:m,focusSearchInput:ce,targetRef:g,focusTarget:W}}const _N={keepMounted:!0,withinPortal:!0,resetSelectionOnOptionHover:!1,width:"target",transitionProps:{transition:"fade",duration:0}},wN=(n,{size:e,dropdownPadding:t})=>({options:{"--combobox-option-fz":yn(e),"--combobox-option-padding":xt(e,"combobox-option-padding")},dropdown:{"--combobox-padding":t===void 0?void 0:Q(t),"--combobox-option-fz":yn(e),"--combobox-option-padding":xt(e,"combobox-option-padding")}});function tt(n){const e=ve("Combobox",_N,n),{classNames:t,styles:r,unstyled:s,children:a,store:o,vars:u,onOptionSubmit:c,onClose:f,size:h,dropdownPadding:m,resetSelectionOnOptionHover:g,__staticSelector:y,readOnly:w,...v}=e,x=tC(),E=o||x,k=Ye({name:y||"Combobox",classes:Tn,props:e,classNames:t,styles:r,unstyled:s,vars:u,varsResolver:wN}),S=()=>{f==null||f(),E.closeDropdown()};return O.jsx(rN,{value:{getStyles:k,store:E,onOptionSubmit:c,size:h,resetSelectionOnOptionHover:g,readOnly:w},children:O.jsx(ya,{opened:E.dropdownOpened,...v,onChange:R=>!R&&S(),withRoles:!1,unstyled:s,children:a})})}const bN=n=>n;tt.extend=bN;tt.classes=Tn;tt.displayName="@mantine/core/Combobox";tt.Target=eC;tt.Dropdown=r_;tt.Options=c_;tt.Option=u_;tt.Search=d_;tt.Empty=s_;tt.Chevron=n_;tt.Footer=i_;tt.Header=l_;tt.EventsTarget=YE;tt.DropdownTarget=XE;tt.Group=o_;tt.ClearButton=KE;tt.HiddenInput=QE;function vN({size:n,style:e,...t}){const r=n!==void 0?{width:Q(n),height:Q(n),...e}:e;return O.jsx("svg",{viewBox:"0 0 10 7",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:r,"aria-hidden":!0,...t,children:O.jsx("path",{d:"M4 4.586L1.707 2.293A1 1 0 1 0 .293 3.707l3 3a.997.997 0 0 0 1.414 0l5-5A1 1 0 1 0 8.293.293L4 4.586z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})})}function Vl(n){return"group"in n}function nC({options:n,search:e,limit:t}){const r=e.trim().toLowerCase(),s=[];for(let a=0;a<n.length;a+=1){const o=n[a];if(s.length===t)return s;Vl(o)&&s.push({group:o.group,items:nC({options:o.items,search:e,limit:t-s.length})}),Vl(o)||o.label.toLowerCase().includes(r)&&s.push(o)}return s}function xN(n){if(n.length===0)return!0;for(const e of n)if(!("group"in e)||e.items.length>0)return!1;return!0}function rC(n,e=new Set){if(Array.isArray(n))for(const t of n)if(Vl(t))rC(t.items,e);else{if(typeof t.value>"u")throw new Error("[@mantine/core] Each option must have value property");if(typeof t.value!="string")throw new Error(`[@mantine/core] Option value must be a string, other data formats are not supported, got ${typeof t.value}`);if(e.has(t.value))throw new Error(`[@mantine/core] Duplicate options are not supported. Option with value "${t.value}" was provided more than once`);e.add(t.value)}}function SN(n,e){return Array.isArray(n)?n.includes(e):n===e}function sC({data:n,withCheckIcon:e,value:t,checkIconPosition:r,unstyled:s,renderOption:a}){if(!Vl(n)){const u=SN(t,n.value),c=e&&u&&O.jsx(vN,{className:Tn.optionsDropdownCheckIcon}),f=O.jsxs(O.Fragment,{children:[r==="left"&&c,O.jsx("span",{children:n.label}),r==="right"&&c]});return O.jsx(tt.Option,{value:n.value,disabled:n.disabled,className:os({[Tn.optionsDropdownOption]:!s}),"data-reverse":r==="right"||void 0,"data-checked":u||void 0,"aria-selected":u,active:u,children:typeof a=="function"?a({option:n,checked:u}):f})}const o=n.items.map(u=>O.jsx(sC,{data:u,value:t,unstyled:s,withCheckIcon:e,checkIconPosition:r,renderOption:a},u.value));return O.jsx(tt.Group,{label:n.group,children:o})}function EN({data:n,hidden:e,hiddenWhenEmpty:t,filter:r,search:s,limit:a,maxDropdownHeight:o,withScrollArea:u=!0,filterOptions:c=!0,withCheckIcon:f=!1,value:h,checkIconPosition:m,nothingFoundMessage:g,unstyled:y,labelId:w,renderOption:v,scrollAreaProps:x,"aria-label":E}){rC(n);const S=typeof s=="string"?(r||nC)({options:n,search:c?s:"",limit:a??1/0}):n,R=xN(S),A=S.map(I=>O.jsx(sC,{data:I,withCheckIcon:f,value:h,checkIconPosition:m,unstyled:y,renderOption:v},Vl(I)?I.group:I.value));return O.jsx(tt.Dropdown,{hidden:e||t&&R,children:O.jsxs(tt.Options,{labelledBy:w,"aria-label":E,children:[u?O.jsx(si.Autosize,{mah:o??220,type:"scroll",scrollbarSize:"var(--combobox-padding)",offsetScrollbars:"y",...x,children:A}):A,R&&g&&O.jsx(tt.Empty,{children:g})]})})}var mo={root:"m_77c9d27d",inner:"m_80f1301b",label:"m_811560b9",section:"m_a74036a",loader:"m_a25b86ee",group:"m_80d6d844",groupSection:"m_70be2a01"};const G0={orientation:"horizontal"},CN=(n,{borderWidth:e})=>({group:{"--button-border-width":Q(e)}}),f_=ze((n,e)=>{const t=ve("ButtonGroup",G0,n),{className:r,style:s,classNames:a,styles:o,unstyled:u,orientation:c,vars:f,borderWidth:h,variant:m,mod:g,...y}=ve("ButtonGroup",G0,n),w=Ye({name:"ButtonGroup",props:t,classes:mo,className:r,style:s,classNames:a,styles:o,unstyled:u,vars:f,varsResolver:CN,rootSelector:"group"});return O.jsx(ke,{...w("group"),ref:e,variant:m,mod:[{"data-orientation":c},g],role:"group",...y})});f_.classes=mo;f_.displayName="@mantine/core/ButtonGroup";const J0={},PN=(n,{radius:e,color:t,gradient:r,variant:s,autoContrast:a,size:o})=>{const u=n.variantColorResolver({color:t||n.primaryColor,theme:n,gradient:r,variant:s||"filled",autoContrast:a});return{groupSection:{"--section-height":xt(o,"section-height"),"--section-padding-x":xt(o,"section-padding-x"),"--section-fz":o!=null&&o.includes("compact")?yn(o.replace("compact-","")):yn(o),"--section-radius":e===void 0?void 0:is(e),"--section-bg":t||s?u.background:void 0,"--section-color":u.color,"--section-bd":t||s?u.border:void 0}}},h_=ze((n,e)=>{const t=ve("ButtonGroupSection",J0,n),{className:r,style:s,classNames:a,styles:o,unstyled:u,vars:c,variant:f,gradient:h,radius:m,autoContrast:g,...y}=ve("ButtonGroupSection",J0,n),w=Ye({name:"ButtonGroupSection",props:t,classes:mo,className:r,style:s,classNames:a,styles:o,unstyled:u,vars:c,varsResolver:PN,rootSelector:"groupSection"});return O.jsx(ke,{...w("groupSection"),ref:e,variant:f,...y})});h_.classes=mo;h_.displayName="@mantine/core/ButtonGroupSection";const kN={in:{opacity:1,transform:`translate(-50%, calc(-50% + ${Q(1)}))`},out:{opacity:0,transform:"translate(-50%, -200%)"},common:{transformOrigin:"center"},transitionProperty:"transform, opacity"},RN={},ON=(n,{radius:e,color:t,gradient:r,variant:s,size:a,justify:o,autoContrast:u})=>{const c=n.variantColorResolver({color:t||n.primaryColor,theme:n,gradient:r,variant:s||"filled",autoContrast:u});return{root:{"--button-justify":o,"--button-height":xt(a,"button-height"),"--button-padding-x":xt(a,"button-padding-x"),"--button-fz":a!=null&&a.includes("compact")?yn(a.replace("compact-","")):yn(a),"--button-radius":e===void 0?void 0:is(e),"--button-bg":t||s?c.background:void 0,"--button-hover":t||s?c.hover:void 0,"--button-color":c.color,"--button-bd":t||s?c.border:void 0,"--button-hover-color":t||s?c.hoverColor:void 0}}},Pr=rr((n,e)=>{const t=ve("Button",RN,n),{style:r,vars:s,className:a,color:o,disabled:u,children:c,leftSection:f,rightSection:h,fullWidth:m,variant:g,radius:y,loading:w,loaderProps:v,gradient:x,classNames:E,styles:k,unstyled:S,"data-disabled":R,autoContrast:A,mod:I,...M}=t,D=Ye({name:"Button",props:t,classes:mo,className:a,style:r,classNames:E,styles:k,unstyled:S,vars:s,varsResolver:ON}),K=!!f,X=!!h;return O.jsxs(co,{ref:e,...D("root",{active:!u&&!w&&!R}),unstyled:S,variant:g,disabled:u||w,mod:[{disabled:u||R,loading:w,block:m,"with-left-section":K,"with-right-section":X},I],...M,children:[O.jsx(gu,{mounted:!!w,transition:kN,duration:150,children:ae=>O.jsx(ke,{component:"span",...D("loader",{style:ae}),"aria-hidden":!0,children:O.jsx(Ga,{color:"var(--button-color)",size:"calc(var(--button-height) / 1.8)",...v})})}),O.jsxs("span",{...D("inner"),children:[f&&O.jsx(ke,{component:"span",...D("section"),mod:{position:"left"},children:f}),O.jsx(ke,{component:"span",mod:{loading:w},...D("label"),children:c}),h&&O.jsx(ke,{component:"span",...D("section"),mod:{position:"right"},children:h})]})]})});Pr.classes=mo;Pr.displayName="@mantine/core/Button";Pr.Group=f_;Pr.GroupSection=h_;const[TN,AN]=ni("Card component was not found in tree");var p_={root:"m_e615b15f",section:"m_599a2148"};const $N={},yf=rr((n,e)=>{const t=ve("CardSection",$N,n),{classNames:r,className:s,style:a,styles:o,vars:u,withBorder:c,inheritPadding:f,mod:h,...m}=t,g=AN();return O.jsx(ke,{ref:e,mod:[{"with-border":c,"inherit-padding":f},h],...g.getStyles("section",{className:s,style:a,styles:o,classNames:r}),...m})});yf.classes=p_;yf.displayName="@mantine/core/CardSection";const IN={},NN=(n,{padding:e})=>({root:{"--card-padding":L1(e)}}),_f=rr((n,e)=>{const t=ve("Card",IN,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,vars:c,children:f,padding:h,...m}=t,g=Ye({name:"Card",props:t,classes:p_,className:s,style:a,classNames:r,styles:o,unstyled:u,vars:c,varsResolver:NN}),y=P.Children.toArray(f),w=y.map((v,x)=>typeof v=="object"&&v&&"type"in v&&v.type===yf?P.cloneElement(v,{"data-first-section":x===0||void 0,"data-last-section":x===y.length-1||void 0}):v);return O.jsx(TN,{value:{getStyles:g},children:O.jsx($y,{ref:e,unstyled:u,...g("root"),...m,children:w})})});_f.classes=p_;_f.displayName="@mantine/core/Card";_f.Section=yf;const jN={multiple:!1},aC=P.forwardRef((n,e)=>{const{onChange:t,children:r,multiple:s,accept:a,name:o,form:u,resetRef:c,disabled:f,capture:h,inputProps:m,...g}=ve("FileButton",jN,n),y=P.useRef(null),w=()=>{var E;!f&&((E=y.current)==null||E.click())},v=E=>{t(s?Array.from(E.currentTarget.files):E.currentTarget.files[0]||null)};return Pd(c,()=>{y.current&&(y.current.value="")}),O.jsxs(O.Fragment,{children:[r({onClick:w,...g}),O.jsx("input",{style:{display:"none"},type:"file",accept:a,multiple:s,onChange:v,ref:An(e,y),name:o,form:u,capture:h,...m})]})});aC.displayName="@mantine/core/FileButton";const LN=({value:n})=>O.jsx("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:Array.isArray(n)?n.map(e=>e.name).join(", "):n==null?void 0:n.name}),MN={valueComponent:LN},m_=ze((n,e)=>{const t=ve("FileInput",MN,n),{unstyled:r,vars:s,onChange:a,value:o,defaultValue:u,multiple:c,accept:f,name:h,form:m,valueComponent:g,clearable:y,clearButtonProps:w,readOnly:v,capture:x,fileInputProps:E,rightSection:k,size:S,placeholder:R,component:A,resetRef:I,classNames:M,styles:D,...K}=t,X=P.useRef(null),{resolvedClassNames:ae,resolvedStyles:he}=pu({classNames:M,styles:D,props:t}),[ce,W]=qa({value:o,defaultValue:u,onChange:a,finalValue:c?[]:null}),G=Array.isArray(ce)?ce.length!==0:ce!==null,q=k||(y&&G&&!v?O.jsx(ff,{...w,variant:"subtle",onClick:()=>W(c?[]:null),size:S,unstyled:r}):null);P.useEffect(()=>{var j;(Array.isArray(ce)&&ce.length===0||ce===null)&&((j=X.current)==null||j.call(X))},[ce]);const J=g;return O.jsx(aC,{onChange:W,multiple:c,accept:f,name:h,form:m,resetRef:An(X,I),disabled:v,capture:x,inputProps:E,children:j=>O.jsx(jr,{component:A||"button",ref:e,rightSection:q,...j,...K,__staticSelector:"FileInput",multiline:!0,type:"button",pointer:!0,__stylesApiProps:t,unstyled:r,size:S,classNames:M,styles:D,children:G?O.jsx(J,{value:ce}):O.jsx(Jt.Placeholder,{__staticSelector:"FileInput",classNames:ae,styles:he,children:R})})})});m_.classes=jr.classes;m_.displayName="@mantine/core/FileInput";const DN=m_;function Fg(){return Fg=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Fg.apply(null,arguments)}function FN(n,e){if(n==null)return{};var t={};for(var r in n)if({}.hasOwnProperty.call(n,r)){if(e.indexOf(r)!==-1)continue;t[r]=n[r]}return t}var UN=P.useLayoutEffect,zN=function(e){var t=Va.useRef(e);return UN(function(){t.current=e}),t},K0=function(e,t){if(typeof e=="function"){e(t);return}e.current=t},BN=function(e,t){var r=Va.useRef();return Va.useCallback(function(s){e.current=s,r.current&&K0(r.current,null),r.current=t,t&&K0(t,s)},[t])},X0={"min-height":"0","max-height":"none",height:"0",visibility:"hidden",overflow:"hidden",position:"absolute","z-index":"-1000",top:"0",right:"0",display:"block"},HN=function(e){Object.keys(X0).forEach(function(t){e.style.setProperty(t,X0[t],"important")})},Y0=HN,dn=null,Q0=function(e,t){var r=e.scrollHeight;return t.sizingStyle.boxSizing==="border-box"?r+t.borderSize:r-t.paddingSize};function VN(n,e,t,r){t===void 0&&(t=1),r===void 0&&(r=1/0),dn||(dn=document.createElement("textarea"),dn.setAttribute("tabindex","-1"),dn.setAttribute("aria-hidden","true"),Y0(dn)),dn.parentNode===null&&document.body.appendChild(dn);var s=n.paddingSize,a=n.borderSize,o=n.sizingStyle,u=o.boxSizing;Object.keys(o).forEach(function(g){var y=g;dn.style[y]=o[y]}),Y0(dn),dn.value=e;var c=Q0(dn,n);dn.value=e,c=Q0(dn,n),dn.value="x";var f=dn.scrollHeight-s,h=f*t;u==="border-box"&&(h=h+s+a),c=Math.max(h,c);var m=f*r;return u==="border-box"&&(m=m+s+a),c=Math.min(m,c),[c,f]}var ex=function(){},WN=function(e,t){return e.reduce(function(r,s){return r[s]=t[s],r},{})},qN=["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth","boxSizing","fontFamily","fontSize","fontStyle","fontWeight","letterSpacing","lineHeight","paddingBottom","paddingLeft","paddingRight","paddingTop","tabSize","textIndent","textRendering","textTransform","width","wordBreak","wordSpacing","scrollbarGutter"],ZN=!!document.documentElement.currentStyle,GN=function(e){var t=window.getComputedStyle(e);if(t===null)return null;var r=WN(qN,t),s=r.boxSizing;if(s==="")return null;ZN&&s==="border-box"&&(r.width=parseFloat(r.width)+parseFloat(r.borderRightWidth)+parseFloat(r.borderLeftWidth)+parseFloat(r.paddingRight)+parseFloat(r.paddingLeft)+"px");var a=parseFloat(r.paddingBottom)+parseFloat(r.paddingTop),o=parseFloat(r.borderBottomWidth)+parseFloat(r.borderTopWidth);return{sizingStyle:r,paddingSize:a,borderSize:o}},JN=GN;function iC(n,e,t){var r=zN(t);P.useLayoutEffect(function(){var s=function(o){return r.current(o)};if(n)return n.addEventListener(e,s),function(){return n.removeEventListener(e,s)}},[])}var KN=function(e){iC(window,"resize",e)},XN=function(e){iC(document.fonts,"loadingdone",e)},YN=["cacheMeasurements","maxRows","minRows","onChange","onHeightChange"],QN=function(e,t){var r=e.cacheMeasurements,s=e.maxRows,a=e.minRows,o=e.onChange,u=o===void 0?ex:o,c=e.onHeightChange,f=c===void 0?ex:c,h=FN(e,YN),m=h.value!==void 0,g=P.useRef(null),y=BN(g,t),w=P.useRef(0),v=P.useRef(),x=function(){var S=g.current,R=r&&v.current?v.current:JN(S);if(R){v.current=R;var A=VN(R,S.value||S.placeholder||"x",a,s),I=A[0],M=A[1];w.current!==I&&(w.current=I,S.style.setProperty("height",I+"px","important"),f(I,{rowHeight:M}))}},E=function(S){m||x(),u(S)};return P.useLayoutEffect(x),KN(x),XN(x),P.createElement("textarea",Fg({},h,{onChange:E,ref:y}))},ej=P.forwardRef(QN);const tj={},it=ze((n,e)=>{const{autosize:t,maxRows:r,minRows:s,__staticSelector:a,resize:o,...u}=ve("Textarea",tj,n),c=t&&gT()!=="test",f=c?{maxRows:r,minRows:s}:{};return O.jsx(jr,{component:c?ej:"textarea",ref:e,...u,__staticSelector:a||"Textarea",multiline:!0,"data-no-overflow":t&&r===void 0||void 0,__vars:{"--input-resize":o},...f})});it.classes=jr.classes;it.displayName="@mantine/core/Textarea";const nj=({reveal:n})=>O.jsx("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{width:"var(--psi-icon-size)",height:"var(--psi-icon-size)"},children:O.jsx("path",{d:n?"M13.3536 2.35355C13.5488 2.15829 13.5488 1.84171 13.3536 1.64645C13.1583 1.45118 12.8417 1.45118 12.6464 1.64645L10.6828 3.61012C9.70652 3.21671 8.63759 3 7.5 3C4.30786 3 1.65639 4.70638 0.0760002 7.23501C-0.0253338 7.39715 -0.0253334 7.60288 0.0760014 7.76501C0.902945 9.08812 2.02314 10.1861 3.36061 10.9323L1.64645 12.6464C1.45118 12.8417 1.45118 13.1583 1.64645 13.3536C1.84171 13.5488 2.15829 13.5488 2.35355 13.3536L4.31723 11.3899C5.29348 11.7833 6.36241 12 7.5 12C10.6921 12 13.3436 10.2936 14.924 7.76501C15.0253 7.60288 15.0253 7.39715 14.924 7.23501C14.0971 5.9119 12.9769 4.81391 11.6394 4.06771L13.3536 2.35355ZM9.90428 4.38861C9.15332 4.1361 8.34759 4 7.5 4C4.80285 4 2.52952 5.37816 1.09622 7.50001C1.87284 8.6497 2.89609 9.58106 4.09974 10.1931L9.90428 4.38861ZM5.09572 10.6114L10.9003 4.80685C12.1039 5.41894 13.1272 6.35031 13.9038 7.50001C12.4705 9.62183 10.1971 11 7.5 11C6.65241 11 5.84668 10.8639 5.09572 10.6114Z":"M7.5 11C4.80285 11 2.52952 9.62184 1.09622 7.50001C2.52952 5.37816 4.80285 4 7.5 4C10.1971 4 12.4705 5.37816 13.9038 7.50001C12.4705 9.62183 10.1971 11 7.5 11ZM7.5 3C4.30786 3 1.65639 4.70638 0.0760002 7.23501C-0.0253338 7.39715 -0.0253334 7.60288 0.0760014 7.76501C1.65639 10.2936 4.30786 12 7.5 12C10.6921 12 13.3436 10.2936 14.924 7.76501C15.0253 7.60288 15.0253 7.39715 14.924 7.23501C13.3436 4.70638 10.6921 3 7.5 3ZM7.5 9.5C8.60457 9.5 9.5 8.60457 9.5 7.5C9.5 6.39543 8.60457 5.5 7.5 5.5C6.39543 5.5 5.5 6.39543 5.5 7.5C5.5 8.60457 6.39543 9.5 7.5 9.5Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"})});var Ug={root:"m_f61ca620",input:"m_ccf8da4c",innerInput:"m_f2d85dd2",visibilityToggle:"m_b1072d44"};const rj={visibilityToggleIcon:nj},sj=(n,{size:e})=>({root:{"--psi-icon-size":xt(e,"psi-icon-size"),"--psi-button-size":xt(e,"psi-button-size")}}),g_=ze((n,e)=>{const t=ve("PasswordInput",rj,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,vars:c,required:f,error:h,leftSection:m,disabled:g,id:y,variant:w,inputContainer:v,description:x,label:E,size:k,errorProps:S,descriptionProps:R,labelProps:A,withAsterisk:I,inputWrapperOrder:M,wrapperProps:D,radius:K,rightSection:X,rightSectionWidth:ae,rightSectionPointerEvents:he,leftSectionWidth:ce,visible:W,defaultVisible:G,onVisibilityChange:q,visibilityToggleIcon:J,visibilityToggleButtonProps:j,rightSectionProps:B,leftSectionProps:V,leftSectionPointerEvents:$,withErrorStyles:U,mod:re,...pe}=t,de=uo(y),[Y,oe]=qa({value:W,defaultValue:G,finalValue:!1,onChange:q}),ue=()=>oe(!Y),ge=Ye({name:"PasswordInput",classes:Ug,props:t,className:s,style:a,classNames:r,styles:o,unstyled:u,vars:c,varsResolver:sj}),{resolvedClassNames:_e,resolvedStyles:Ie}=pu({classNames:r,styles:o,props:t}),{styleProps:Nt,rest:Bt}=sf(pe),Qe=J,Ct=O.jsx(yu,{...ge("visibilityToggle"),disabled:g,radius:K,"aria-hidden":!j,tabIndex:-1,...j,variant:(j==null?void 0:j.variant)??"subtle",color:"gray",unstyled:u,onTouchEnd:ot=>{var st;ot.preventDefault(),(st=j==null?void 0:j.onTouchEnd)==null||st.call(j,ot),ue()},onMouseDown:ot=>{var st;ot.preventDefault(),(st=j==null?void 0:j.onMouseDown)==null||st.call(j,ot),ue()},onKeyDown:ot=>{var st;(st=j==null?void 0:j.onKeyDown)==null||st.call(j,ot),ot.key===" "&&(ot.preventDefault(),ue())},children:O.jsx(Qe,{reveal:Y})});return O.jsx(Jt.Wrapper,{required:f,id:de,label:E,error:h,description:x,size:k,classNames:_e,styles:Ie,__staticSelector:"PasswordInput",errorProps:S,descriptionProps:R,unstyled:u,withAsterisk:I,inputWrapperOrder:M,inputContainer:v,variant:w,labelProps:{...A,htmlFor:de},mod:re,...ge("root"),...Nt,...D,children:O.jsx(Jt,{component:"div",error:h,leftSection:m,size:k,classNames:{..._e,input:os(Ug.input,_e.input)},styles:Ie,radius:K,disabled:g,__staticSelector:"PasswordInput",rightSectionWidth:ae,rightSection:X??Ct,variant:w,unstyled:u,leftSectionWidth:ce,rightSectionPointerEvents:he||"all",rightSectionProps:B,leftSectionProps:V,leftSectionPointerEvents:$,withAria:!1,withErrorStyles:U,children:O.jsx("input",{required:f,"data-invalid":!!h||void 0,"data-with-left-section":!!m||void 0,...ge("innerInput"),disabled:g,id:de,ref:e,...Bt,autoComplete:Bt.autoComplete||"off",type:Y?"text":"password"})})})});g_.classes={...jr.classes,...Ug};g_.displayName="@mantine/core/PasswordInput";const aj={searchable:!1,withCheckIcon:!0,allowDeselect:!0,checkIconPosition:"left"},Il=ze((n,e)=>{const t=ve("Select",aj,n),{classNames:r,styles:s,unstyled:a,vars:o,dropdownOpened:u,defaultDropdownOpened:c,onDropdownClose:f,onDropdownOpen:h,onFocus:m,onBlur:g,onClick:y,onChange:w,data:v,value:x,defaultValue:E,selectFirstOptionOnChange:k,onOptionSubmit:S,comboboxProps:R,readOnly:A,disabled:I,filter:M,limit:D,withScrollArea:K,maxDropdownHeight:X,size:ae,searchable:he,rightSection:ce,checkIconPosition:W,withCheckIcon:G,nothingFoundMessage:q,name:J,form:j,searchValue:B,defaultSearchValue:V,onSearchChange:$,allowDeselect:U,error:re,rightSectionPointerEvents:pe,id:de,clearable:Y,clearButtonProps:oe,hiddenInputProps:ue,renderOption:ge,onClear:_e,autoComplete:Ie,scrollAreaProps:Nt,__defaultRightSection:Bt,__clearSection:Qe,__clearable:Ct,chevronColor:ot,...st}=t,or=P.useMemo(()=>eN(v),[v]),nt=P.useMemo(()=>JE(or),[or]),lr=uo(de),[Pt,Is,ii]=qa({value:x,defaultValue:E,finalValue:null,onChange:w}),Ht=typeof Pt=="string"?nt[Pt]:void 0,qn=pT(Ht),[ds,$n]=qa({value:B,defaultValue:V,finalValue:Ht?Ht.label:"",onChange:$}),kt=tC({opened:u,defaultOpened:c,onDropdownOpen:()=>{h==null||h(),kt.updateSelectedOptionIndex("active",{scrollIntoView:!0})},onDropdownClose:()=>{f==null||f(),kt.resetSelectedOption()}}),{resolvedClassNames:Ns,resolvedStyles:yt}=pu({props:t,styles:s,classNames:r});P.useEffect(()=>{k&&kt.selectFirstOption()},[k,Pt]),P.useEffect(()=>{x===null&&$n(""),typeof x=="string"&&Ht&&((qn==null?void 0:qn.value)!==Ht.value||(qn==null?void 0:qn.label)!==Ht.label)&&$n(Ht.label)},[x,Ht]);const wa=O.jsx(tt.ClearButton,{...oe,onClear:()=>{Is(null,null),$n(""),_e==null||_e()}}),ju=Y&&!!Pt&&!I&&!A;return O.jsxs(O.Fragment,{children:[O.jsxs(tt,{store:kt,__staticSelector:"Select",classNames:Ns,styles:yt,unstyled:a,readOnly:A,onOptionSubmit:ln=>{S==null||S(ln);const Zn=U&&nt[ln].value===Pt?null:nt[ln],To=Zn?Zn.value:null;To!==Pt&&Is(To,Zn),!ii&&$n(typeof To=="string"&&(Zn==null?void 0:Zn.label)||""),kt.closeDropdown()},size:ae,...R,children:[O.jsx(tt.Target,{targetType:he?"input":"button",autoComplete:Ie,children:O.jsx(jr,{id:lr,ref:e,__defaultRightSection:O.jsx(tt.Chevron,{size:ae,error:re,unstyled:a,color:ot}),__clearSection:wa,__clearable:ju,rightSection:ce,rightSectionPointerEvents:pe||(ju?"all":"none"),...st,size:ae,__staticSelector:"Select",disabled:I,readOnly:A||!he,value:ds,onChange:ln=>{$n(ln.currentTarget.value),kt.openDropdown(),k&&kt.selectFirstOption()},onFocus:ln=>{he&&kt.openDropdown(),m==null||m(ln)},onBlur:ln=>{var Zn;he&&kt.closeDropdown(),$n(Pt!=null&&((Zn=nt[Pt])==null?void 0:Zn.label)||""),g==null||g(ln)},onClick:ln=>{he?kt.openDropdown():kt.toggleDropdown(),y==null||y(ln)},classNames:Ns,styles:yt,unstyled:a,pointer:!he,error:re})}),O.jsx(EN,{data:or,hidden:A||I,filter:M,search:ds,limit:D,hiddenWhenEmpty:!q,withScrollArea:K,maxDropdownHeight:X,filterOptions:he&&(Ht==null?void 0:Ht.label)!==ds,value:Pt,checkIconPosition:W,withCheckIcon:G,nothingFoundMessage:q,unstyled:a,labelId:st.label?`${lr}-label`:void 0,"aria-label":st.label?void 0:st["aria-label"],renderOption:ge,scrollAreaProps:Nt})]}),O.jsx(tt.HiddenInput,{value:Pt,name:J,form:j,disabled:I,...ue})]})});Il.classes={...jr.classes,...tt.classes};Il.displayName="@mantine/core/Select";var oC={root:"m_6d731127"};const ij={gap:"md",align:"stretch",justify:"flex-start"},oj=(n,{gap:e,align:t,justify:r})=>({root:{"--stack-gap":L1(e),"--stack-align":t,"--stack-justify":r}}),za=ze((n,e)=>{const t=ve("Stack",ij,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,vars:c,align:f,justify:h,gap:m,variant:g,...y}=t,w=Ye({name:"Stack",props:t,classes:oC,className:s,style:a,classNames:r,styles:o,unstyled:u,vars:c,varsResolver:oj});return O.jsx(ke,{ref:e,...w("root"),variant:g,...y})});za.classes=oC;za.displayName="@mantine/core/Stack";const lj={},rt=ze((n,e)=>{const t=ve("TextInput",lj,n);return O.jsx(jr,{component:"input",ref:e,...t,__staticSelector:"TextInput"})});rt.classes=jr.classes;rt.displayName="@mantine/core/TextInput";const uj=["h1","h2","h3","h4","h5","h6"],cj=["xs","sm","md","lg","xl"];function dj(n,e){const t=e!==void 0?e:`h${n}`;return uj.includes(t)?{fontSize:`var(--mantine-${t}-font-size)`,fontWeight:`var(--mantine-${t}-font-weight)`,lineHeight:`var(--mantine-${t}-line-height)`}:cj.includes(t)?{fontSize:`var(--mantine-font-size-${t})`,fontWeight:`var(--mantine-h${n}-font-weight)`,lineHeight:`var(--mantine-h${n}-line-height)`}:{fontSize:Q(t),fontWeight:`var(--mantine-h${n}-font-weight)`,lineHeight:`var(--mantine-h${n}-line-height)`}}var lC={root:"m_8a5d1357"};const fj={order:1},hj=(n,{order:e,size:t,lineClamp:r,textWrap:s})=>{const a=dj(e,t);return{root:{"--title-fw":a.fontWeight,"--title-lh":a.lineHeight,"--title-fz":a.fontSize,"--title-line-clamp":typeof r=="number"?r.toString():void 0,"--title-text-wrap":s}}},tr=ze((n,e)=>{const t=ve("Title",fj,n),{classNames:r,className:s,style:a,styles:o,unstyled:u,order:c,vars:f,size:h,variant:m,lineClamp:g,textWrap:y,mod:w,...v}=t,x=Ye({name:"Title",props:t,classes:lC,className:s,style:a,classNames:r,styles:o,unstyled:u,vars:f,varsResolver:hj});return[1,2,3,4,5,6].includes(c)?O.jsx(ke,{...x("root"),component:`h${c}`,variant:m,ref:e,mod:[{order:c,"data-line-clamp":typeof g=="number"},w],size:h,...v}):null});tr.classes=lC;tr.displayName="@mantine/core/Title";var _l={},tx;function pj(){if(tx)return _l;tx=1,Object.defineProperty(_l,"__esModule",{value:!0}),_l.parse=o,_l.serialize=f;const n=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,t=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,s=Object.prototype.toString,a=(()=>{const g=function(){};return g.prototype=Object.create(null),g})();function o(g,y){const w=new a,v=g.length;if(v<2)return w;const x=(y==null?void 0:y.decode)||h;let E=0;do{const k=g.indexOf("=",E);if(k===-1)break;const S=g.indexOf(";",E),R=S===-1?v:S;if(k>R){E=g.lastIndexOf(";",k-1)+1;continue}const A=u(g,E,k),I=c(g,k,A),M=g.slice(A,I);if(w[M]===void 0){let D=u(g,k+1,R),K=c(g,R,D);const X=x(g.slice(D,K));w[M]=X}E=R+1}while(E<v);return w}function u(g,y,w){do{const v=g.charCodeAt(y);if(v!==32&&v!==9)return y}while(++y<w);return w}function c(g,y,w){for(;y>w;){const v=g.charCodeAt(--y);if(v!==32&&v!==9)return y+1}return w}function f(g,y,w){const v=(w==null?void 0:w.encode)||encodeURIComponent;if(!n.test(g))throw new TypeError(`argument name is invalid: ${g}`);const x=v(y);if(!e.test(x))throw new TypeError(`argument val is invalid: ${y}`);let E=g+"="+x;if(!w)return E;if(w.maxAge!==void 0){if(!Number.isInteger(w.maxAge))throw new TypeError(`option maxAge is invalid: ${w.maxAge}`);E+="; Max-Age="+w.maxAge}if(w.domain){if(!t.test(w.domain))throw new TypeError(`option domain is invalid: ${w.domain}`);E+="; Domain="+w.domain}if(w.path){if(!r.test(w.path))throw new TypeError(`option path is invalid: ${w.path}`);E+="; Path="+w.path}if(w.expires){if(!m(w.expires)||!Number.isFinite(w.expires.valueOf()))throw new TypeError(`option expires is invalid: ${w.expires}`);E+="; Expires="+w.expires.toUTCString()}if(w.httpOnly&&(E+="; HttpOnly"),w.secure&&(E+="; Secure"),w.partitioned&&(E+="; Partitioned"),w.priority)switch(typeof w.priority=="string"?w.priority.toLowerCase():void 0){case"low":E+="; Priority=Low";break;case"medium":E+="; Priority=Medium";break;case"high":E+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${w.priority}`)}if(w.sameSite)switch(typeof w.sameSite=="string"?w.sameSite.toLowerCase():w.sameSite){case!0:case"strict":E+="; SameSite=Strict";break;case"lax":E+="; SameSite=Lax";break;case"none":E+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${w.sameSite}`)}return E}function h(g){if(g.indexOf("%")===-1)return g;try{return decodeURIComponent(g)}catch{return g}}function m(g){return s.call(g)==="[object Date]"}return _l}pj();/**
 * react-router v7.1.5
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var nx="popstate";function mj(n={}){function e(r,s){let{pathname:a,search:o,hash:u}=r.location;return zg("",{pathname:a,search:o,hash:u},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:Wl(s)}return yj(e,t,null,n)}function gt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function ts(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function gj(){return Math.random().toString(36).substring(2,10)}function rx(n,e){return{usr:n.state,key:n.key,idx:e}}function zg(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?go(e):e,state:t,key:e&&e.key||r||gj()}}function Wl({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function go(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function yj(n,e,t,r={}){let{window:s=document.defaultView,v5Compat:a=!1}=r,o=s.history,u="POP",c=null,f=h();f==null&&(f=0,o.replaceState({...o.state,idx:f},""));function h(){return(o.state||{idx:null}).idx}function m(){u="POP";let x=h(),E=x==null?null:x-f;f=x,c&&c({action:u,location:v.location,delta:E})}function g(x,E){u="PUSH";let k=zg(v.location,x,E);f=h()+1;let S=rx(k,f),R=v.createHref(k);try{o.pushState(S,"",R)}catch(A){if(A instanceof DOMException&&A.name==="DataCloneError")throw A;s.location.assign(R)}a&&c&&c({action:u,location:v.location,delta:1})}function y(x,E){u="REPLACE";let k=zg(v.location,x,E);f=h();let S=rx(k,f),R=v.createHref(k);o.replaceState(S,"",R),a&&c&&c({action:u,location:v.location,delta:0})}function w(x){let E=s.location.origin!=="null"?s.location.origin:s.location.href,k=typeof x=="string"?x:Wl(x);return k=k.replace(/ $/,"%20"),gt(E,`No window.location.(origin|href) available to create URL for href: ${k}`),new URL(k,E)}let v={get action(){return u},get location(){return n(s,o)},listen(x){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(nx,m),c=x,()=>{s.removeEventListener(nx,m),c=null}},createHref(x){return e(s,x)},createURL:w,encodeLocation(x){let E=w(x);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:g,replace:y,go(x){return o.go(x)}};return v}function uC(n,e,t="/"){return _j(n,e,t,!1)}function _j(n,e,t,r){let s=typeof e=="string"?go(e):e,a=ca(s.pathname||"/",t);if(a==null)return null;let o=cC(n);wj(o);let u=null;for(let c=0;u==null&&c<o.length;++c){let f=Tj(a);u=Rj(o[c],f,r)}return u}function cC(n,e=[],t=[],r=""){let s=(a,o,u)=>{let c={relativePath:u===void 0?a.path||"":u,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(gt(c.relativePath.startsWith(r),`Absolute route path "${c.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),c.relativePath=c.relativePath.slice(r.length));let f=ks([r,c.relativePath]),h=t.concat(c);a.children&&a.children.length>0&&(gt(a.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),cC(a.children,e,h,f)),!(a.path==null&&!a.index)&&e.push({path:f,score:Pj(f,a.index),routesMeta:h})};return n.forEach((a,o)=>{var u;if(a.path===""||!((u=a.path)!=null&&u.includes("?")))s(a,o);else for(let c of dC(a.path))s(a,o,c)}),e}function dC(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let o=dC(r.join("/")),u=[];return u.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&u.push(...o),u.map(c=>n.startsWith("/")&&c===""?"/":c)}function wj(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:kj(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var bj=/^:[\w-]+$/,vj=3,xj=2,Sj=1,Ej=10,Cj=-2,sx=n=>n==="*";function Pj(n,e){let t=n.split("/"),r=t.length;return t.some(sx)&&(r+=Cj),e&&(r+=xj),t.filter(s=>!sx(s)).reduce((s,a)=>s+(bj.test(a)?vj:a===""?Sj:Ej),r)}function kj(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function Rj(n,e,t=!1){let{routesMeta:r}=n,s={},a="/",o=[];for(let u=0;u<r.length;++u){let c=r[u],f=u===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",m=$d({path:c.relativePath,caseSensitive:c.caseSensitive,end:f},h),g=c.route;if(!m&&f&&t&&!r[r.length-1].route.index&&(m=$d({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!m)return null;Object.assign(s,m.params),o.push({params:s,pathname:ks([a,m.pathname]),pathnameBase:Nj(ks([a,m.pathnameBase])),route:g}),m.pathnameBase!=="/"&&(a=ks([a,m.pathnameBase]))}return o}function $d(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=Oj(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),u=s.slice(1);return{params:r.reduce((f,{paramName:h,isOptional:m},g)=>{if(h==="*"){let w=u[g]||"";o=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const y=u[g];return m&&!y?f[h]=void 0:f[h]=(y||"").replace(/%2F/g,"/"),f},{}),pathname:a,pathnameBase:o,pattern:n}}function Oj(n,e=!1,t=!0){ts(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,u,c)=>(r.push({paramName:u,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function Tj(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return ts(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function ca(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}function Aj(n,e="/"){let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?go(n):n;return{pathname:t?t.startsWith("/")?t:$j(t,e):e,search:jj(r),hash:Lj(s)}}function $j(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Xp(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Ij(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function fC(n){let e=Ij(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function hC(n,e,t,r=!1){let s;typeof n=="string"?s=go(n):(s={...n},gt(!s.pathname||!s.pathname.includes("?"),Xp("?","pathname","search",s)),gt(!s.pathname||!s.pathname.includes("#"),Xp("#","pathname","hash",s)),gt(!s.search||!s.search.includes("#"),Xp("#","search","hash",s)));let a=n===""||s.pathname==="",o=a?"/":s.pathname,u;if(o==null)u=t;else{let m=e.length-1;if(!r&&o.startsWith("..")){let g=o.split("/");for(;g[0]==="..";)g.shift(),m-=1;s.pathname=g.join("/")}u=m>=0?e[m]:"/"}let c=Aj(s,u),f=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(f||h)&&(c.pathname+="/"),c}var ks=n=>n.join("/").replace(/\/\/+/g,"/"),Nj=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),jj=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Lj=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Mj(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}var pC=["POST","PUT","PATCH","DELETE"];new Set(pC);var Dj=["GET",...pC];new Set(Dj);var yo=P.createContext(null);yo.displayName="DataRouter";var wf=P.createContext(null);wf.displayName="DataRouterState";var mC=P.createContext({isTransitioning:!1});mC.displayName="ViewTransition";var Fj=P.createContext(new Map);Fj.displayName="Fetchers";var Uj=P.createContext(null);Uj.displayName="Await";var cs=P.createContext(null);cs.displayName="Navigation";var wu=P.createContext(null);wu.displayName="Location";var $s=P.createContext({outlet:null,matches:[],isDataRoute:!1});$s.displayName="Route";var y_=P.createContext(null);y_.displayName="RouteError";function zj(n,{relative:e}={}){gt(bu(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=P.useContext(cs),{hash:s,pathname:a,search:o}=vu(n,{relative:e}),u=a;return t!=="/"&&(u=a==="/"?t:ks([t,a])),r.createHref({pathname:u,search:o,hash:s})}function bu(){return P.useContext(wu)!=null}function ai(){return gt(bu(),"useLocation() may be used only in the context of a <Router> component."),P.useContext(wu).location}var gC="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function yC(n){P.useContext(cs).static||P.useLayoutEffect(n)}function Bj(){let{isDataRoute:n}=P.useContext($s);return n?tL():Hj()}function Hj(){gt(bu(),"useNavigate() may be used only in the context of a <Router> component.");let n=P.useContext(yo),{basename:e,navigator:t}=P.useContext(cs),{matches:r}=P.useContext($s),{pathname:s}=ai(),a=JSON.stringify(fC(r)),o=P.useRef(!1);return yC(()=>{o.current=!0}),P.useCallback((c,f={})=>{if(ts(o.current,gC),!o.current)return;if(typeof c=="number"){t.go(c);return}let h=hC(c,JSON.parse(a),s,f.relative==="path");n==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:ks([e,h.pathname])),(f.replace?t.replace:t.push)(h,f.state,f)},[e,t,a,s,n])}P.createContext(null);function vu(n,{relative:e}={}){let{matches:t}=P.useContext($s),{pathname:r}=ai(),s=JSON.stringify(fC(t));return P.useMemo(()=>hC(n,JSON.parse(s),r,e==="path"),[n,s,r,e])}function Vj(n,e){return _C(n,e)}function _C(n,e,t,r){var k;gt(bu(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s,static:a}=P.useContext(cs),{matches:o}=P.useContext($s),u=o[o.length-1],c=u?u.params:{},f=u?u.pathname:"/",h=u?u.pathnameBase:"/",m=u&&u.route;{let S=m&&m.path||"";wC(f,!m||S.endsWith("*")||S.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${S}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${S}"> to <Route path="${S==="/"?"*":`${S}/*`}">.`)}let g=ai(),y;if(e){let S=typeof e=="string"?go(e):e;gt(h==="/"||((k=S.pathname)==null?void 0:k.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${S.pathname}" was given in the \`location\` prop.`),y=S}else y=g;let w=y.pathname||"/",v=w;if(h!=="/"){let S=h.replace(/^\//,"").split("/");v="/"+w.replace(/^\//,"").split("/").slice(S.length).join("/")}let x=!a&&t&&t.matches&&t.matches.length>0?t.matches:uC(n,{pathname:v});ts(m||x!=null,`No routes matched location "${y.pathname}${y.search}${y.hash}" `),ts(x==null||x[x.length-1].route.element!==void 0||x[x.length-1].route.Component!==void 0||x[x.length-1].route.lazy!==void 0,`Matched leaf route at location "${y.pathname}${y.search}${y.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=Jj(x&&x.map(S=>Object.assign({},S,{params:Object.assign({},c,S.params),pathname:ks([h,s.encodeLocation?s.encodeLocation(S.pathname).pathname:S.pathname]),pathnameBase:S.pathnameBase==="/"?h:ks([h,s.encodeLocation?s.encodeLocation(S.pathnameBase).pathname:S.pathnameBase])})),o,t,r);return e&&E?P.createElement(wu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...y},navigationType:"POP"}},E):E}function Wj(){let n=eL(),e=Mj(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",n),o=P.createElement(P.Fragment,null,P.createElement("p",null," Hey developer "),P.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",P.createElement("code",{style:a},"ErrorBoundary")," or"," ",P.createElement("code",{style:a},"errorElement")," prop on your route.")),P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),t?P.createElement("pre",{style:s},t):null,o)}var qj=P.createElement(Wj,null),Zj=class extends P.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){console.error("React Router caught the following error during render",n,e)}render(){return this.state.error!==void 0?P.createElement($s.Provider,{value:this.props.routeContext},P.createElement(y_.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Gj({routeContext:n,match:e,children:t}){let r=P.useContext(yo);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),P.createElement($s.Provider,{value:n},t)}function Jj(n,e=[],t=null,r=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let s=n,a=t==null?void 0:t.errors;if(a!=null){let c=s.findIndex(f=>f.route.id&&(a==null?void 0:a[f.route.id])!==void 0);gt(c>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(a).join(",")}`),s=s.slice(0,Math.min(s.length,c+1))}let o=!1,u=-1;if(t)for(let c=0;c<s.length;c++){let f=s[c];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=c),f.route.id){let{loaderData:h,errors:m}=t,g=f.route.loader&&!h.hasOwnProperty(f.route.id)&&(!m||m[f.route.id]===void 0);if(f.route.lazy||g){o=!0,u>=0?s=s.slice(0,u+1):s=[s[0]];break}}}return s.reduceRight((c,f,h)=>{let m,g=!1,y=null,w=null;t&&(m=a&&f.route.id?a[f.route.id]:void 0,y=f.route.errorElement||qj,o&&(u<0&&h===0?(wC("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),g=!0,w=null):u===h&&(g=!0,w=f.route.hydrateFallbackElement||null)));let v=e.concat(s.slice(0,h+1)),x=()=>{let E;return m?E=y:g?E=w:f.route.Component?E=P.createElement(f.route.Component,null):f.route.element?E=f.route.element:E=c,P.createElement(Gj,{match:f,routeContext:{outlet:c,matches:v,isDataRoute:t!=null},children:E})};return t&&(f.route.ErrorBoundary||f.route.errorElement||h===0)?P.createElement(Zj,{location:t.location,revalidation:t.revalidation,component:y,error:m,children:x(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):x()},null)}function __(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Kj(n){let e=P.useContext(yo);return gt(e,__(n)),e}function Xj(n){let e=P.useContext(wf);return gt(e,__(n)),e}function Yj(n){let e=P.useContext($s);return gt(e,__(n)),e}function w_(n){let e=Yj(n),t=e.matches[e.matches.length-1];return gt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Qj(){return w_("useRouteId")}function eL(){var r;let n=P.useContext(y_),e=Xj("useRouteError"),t=w_("useRouteError");return n!==void 0?n:(r=e.errors)==null?void 0:r[t]}function tL(){let{router:n}=Kj("useNavigate"),e=w_("useNavigate"),t=P.useRef(!1);return yC(()=>{t.current=!0}),P.useCallback(async(s,a={})=>{ts(t.current,gC),t.current&&(typeof s=="number"?n.navigate(s):await n.navigate(s,{fromRouteId:e,...a}))},[n,e])}var ax={};function wC(n,e,t){!e&&!ax[n]&&(ax[n]=!0,ts(!1,t))}P.memo(nL);function nL({routes:n,future:e,state:t}){return _C(n,void 0,t,e)}function bC(n){gt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function rL({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:s,static:a=!1}){gt(!bu(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=n.replace(/^\/*/,"/"),u=P.useMemo(()=>({basename:o,navigator:s,static:a,future:{}}),[o,s,a]);typeof t=="string"&&(t=go(t));let{pathname:c="/",search:f="",hash:h="",state:m=null,key:g="default"}=t,y=P.useMemo(()=>{let w=ca(c,o);return w==null?null:{location:{pathname:w,search:f,hash:h,state:m,key:g},navigationType:r}},[o,c,f,h,m,g,r]);return ts(y!=null,`<Router basename="${o}"> is not able to match the URL "${c}${f}${h}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:P.createElement(cs.Provider,{value:u},P.createElement(wu.Provider,{children:e,value:y}))}function sL({children:n,location:e}){return Vj(Bg(n),e)}function Bg(n,e=[]){let t=[];return P.Children.forEach(n,(r,s)=>{if(!P.isValidElement(r))return;let a=[...e,s];if(r.type===P.Fragment){t.push.apply(t,Bg(r.props.children,a));return}gt(r.type===bC,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),gt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=Bg(r.props.children,a)),t.push(o)}),t}var gd="get",yd="application/x-www-form-urlencoded";function bf(n){return n!=null&&typeof n.tagName=="string"}function aL(n){return bf(n)&&n.tagName.toLowerCase()==="button"}function iL(n){return bf(n)&&n.tagName.toLowerCase()==="form"}function oL(n){return bf(n)&&n.tagName.toLowerCase()==="input"}function lL(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function uL(n,e){return n.button===0&&(!e||e==="_self")&&!lL(n)}var Gc=null;function cL(){if(Gc===null)try{new FormData(document.createElement("form"),0),Gc=!1}catch{Gc=!0}return Gc}var dL=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Yp(n){return n!=null&&!dL.has(n)?(ts(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${yd}"`),null):n}function fL(n,e){let t,r,s,a,o;if(iL(n)){let u=n.getAttribute("action");r=u?ca(u,e):null,t=n.getAttribute("method")||gd,s=Yp(n.getAttribute("enctype"))||yd,a=new FormData(n)}else if(aL(n)||oL(n)&&(n.type==="submit"||n.type==="image")){let u=n.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=n.getAttribute("formaction")||u.getAttribute("action");if(r=c?ca(c,e):null,t=n.getAttribute("formmethod")||u.getAttribute("method")||gd,s=Yp(n.getAttribute("formenctype"))||Yp(u.getAttribute("enctype"))||yd,a=new FormData(u,n),!cL()){let{name:f,type:h,value:m}=n;if(h==="image"){let g=f?`${f}.`:"";a.append(`${g}x`,"0"),a.append(`${g}y`,"0")}else f&&a.append(f,m)}}else{if(bf(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=gd,r=null,s=yd,o=n}return a&&s==="text/plain"&&(o=a,a=void 0),{action:r,method:t.toLowerCase(),encType:s,formData:a,body:o}}function b_(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}async function hL(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function pL(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function mL(n,e,t){let r=await Promise.all(n.map(async s=>{let a=e.routes[s.route.id];if(a){let o=await hL(a,t);return o.links?o.links():[]}return[]}));return wL(r.flat(1).filter(pL).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function ix(n,e,t,r,s,a){let o=(c,f)=>t[f]?c.route.id!==t[f].route.id:!0,u=(c,f)=>{var h;return t[f].pathname!==c.pathname||((h=t[f].route.path)==null?void 0:h.endsWith("*"))&&t[f].params["*"]!==c.params["*"]};return a==="assets"?e.filter((c,f)=>o(c,f)||u(c,f)):a==="data"?e.filter((c,f)=>{var m;let h=r.routes[c.route.id];if(!h||!h.hasLoader)return!1;if(o(c,f)||u(c,f))return!0;if(c.route.shouldRevalidate){let g=c.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((m=t[0])==null?void 0:m.params)||{},nextUrl:new URL(n,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function gL(n,e){return yL(n.map(t=>{let r=e.routes[t.route.id];if(!r)return[];let s=[r.module];return r.imports&&(s=s.concat(r.imports)),s}).flat(1))}function yL(n){return[...new Set(n)]}function _L(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function wL(n,e){let t=new Set;return new Set(e),n.reduce((r,s)=>{let a=JSON.stringify(_L(s));return t.has(a)||(t.add(a),r.push({key:a,link:s})),r},[])}function bL(n){let e=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function vL(){let n=P.useContext(yo);return b_(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function xL(){let n=P.useContext(wf);return b_(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var v_=P.createContext(void 0);v_.displayName="FrameworkContext";function vC(){let n=P.useContext(v_);return b_(n,"You must render this element inside a <HydratedRouter> element"),n}function SL(n,e){let t=P.useContext(v_),[r,s]=P.useState(!1),[a,o]=P.useState(!1),{onFocus:u,onBlur:c,onMouseEnter:f,onMouseLeave:h,onTouchStart:m}=e,g=P.useRef(null);P.useEffect(()=>{if(n==="render"&&o(!0),n==="viewport"){let v=E=>{E.forEach(k=>{o(k.isIntersecting)})},x=new IntersectionObserver(v,{threshold:.5});return g.current&&x.observe(g.current),()=>{x.disconnect()}}},[n]),P.useEffect(()=>{if(r){let v=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(v)}}},[r]);let y=()=>{s(!0)},w=()=>{s(!1),o(!1)};return t?n!=="intent"?[a,g,{}]:[a,g,{onFocus:wl(u,y),onBlur:wl(c,w),onMouseEnter:wl(f,y),onMouseLeave:wl(h,w),onTouchStart:wl(m,y)}]:[!1,g,{}]}function wl(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function EL({page:n,...e}){let{router:t}=vL(),r=P.useMemo(()=>uC(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?P.createElement(PL,{page:n,matches:r,...e}):null}function CL(n){let{manifest:e,routeModules:t}=vC(),[r,s]=P.useState([]);return P.useEffect(()=>{let a=!1;return mL(n,e,t).then(o=>{a||s(o)}),()=>{a=!0}},[n,e,t]),r}function PL({page:n,matches:e,...t}){let r=ai(),{manifest:s,routeModules:a}=vC(),{loaderData:o,matches:u}=xL(),c=P.useMemo(()=>ix(n,e,u,s,r,"data"),[n,e,u,s,r]),f=P.useMemo(()=>ix(n,e,u,s,r,"assets"),[n,e,u,s,r]),h=P.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let y=new Set,w=!1;if(e.forEach(x=>{var k;let E=s.routes[x.route.id];!E||!E.hasLoader||(!c.some(S=>S.route.id===x.route.id)&&x.route.id in o&&((k=a[x.route.id])!=null&&k.shouldRevalidate)||E.hasClientLoader?w=!0:y.add(x.route.id))}),y.size===0)return[];let v=bL(n);return w&&y.size>0&&v.searchParams.set("_routes",e.filter(x=>y.has(x.route.id)).map(x=>x.route.id).join(",")),[v.pathname+v.search]},[o,r,s,c,e,n,a]),m=P.useMemo(()=>gL(f,s),[f,s]),g=CL(f);return P.createElement(P.Fragment,null,h.map(y=>P.createElement("link",{key:y,rel:"prefetch",as:"fetch",href:y,...t})),m.map(y=>P.createElement("link",{key:y,rel:"modulepreload",href:y,...t})),g.map(({key:y,link:w})=>P.createElement("link",{key:y,...w})))}function kL(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var xC=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{xC&&(window.__reactRouterVersion="7.1.5")}catch{}function RL({basename:n,children:e,window:t}){let r=P.useRef();r.current==null&&(r.current=mj({window:t,v5Compat:!0}));let s=r.current,[a,o]=P.useState({action:s.action,location:s.location}),u=P.useCallback(c=>{P.startTransition(()=>o(c))},[o]);return P.useLayoutEffect(()=>s.listen(u),[s,u]),P.createElement(rL,{basename:n,children:e,location:a.location,navigationType:a.action,navigator:s})}var SC=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,EC=P.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:s,reloadDocument:a,replace:o,state:u,target:c,to:f,preventScrollReset:h,viewTransition:m,...g},y){let{basename:w}=P.useContext(cs),v=typeof f=="string"&&SC.test(f),x,E=!1;if(typeof f=="string"&&v&&(x=f,xC))try{let K=new URL(window.location.href),X=f.startsWith("//")?new URL(K.protocol+f):new URL(f),ae=ca(X.pathname,w);X.origin===K.origin&&ae!=null?f=ae+X.search+X.hash:E=!0}catch{ts(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let k=zj(f,{relative:s}),[S,R,A]=SL(r,g),I=$L(f,{replace:o,state:u,target:c,preventScrollReset:h,relative:s,viewTransition:m});function M(K){e&&e(K),K.defaultPrevented||I(K)}let D=P.createElement("a",{...g,...A,href:x||k,onClick:E||a?e:M,ref:kL(y,R),target:c,"data-discover":!v&&t==="render"?"true":void 0});return S&&!v?P.createElement(P.Fragment,null,D,P.createElement(EL,{page:k})):D});EC.displayName="Link";var OL=P.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:s=!1,style:a,to:o,viewTransition:u,children:c,...f},h){let m=vu(o,{relative:f.relative}),g=ai(),y=P.useContext(wf),{navigator:w,basename:v}=P.useContext(cs),x=y!=null&&ML(m)&&u===!0,E=w.encodeLocation?w.encodeLocation(m).pathname:m.pathname,k=g.pathname,S=y&&y.navigation&&y.navigation.location?y.navigation.location.pathname:null;t||(k=k.toLowerCase(),S=S?S.toLowerCase():null,E=E.toLowerCase()),S&&v&&(S=ca(S,v)||S);const R=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let A=k===E||!s&&k.startsWith(E)&&k.charAt(R)==="/",I=S!=null&&(S===E||!s&&S.startsWith(E)&&S.charAt(E.length)==="/"),M={isActive:A,isPending:I,isTransitioning:x},D=A?e:void 0,K;typeof r=="function"?K=r(M):K=[r,A?"active":null,I?"pending":null,x?"transitioning":null].filter(Boolean).join(" ");let X=typeof a=="function"?a(M):a;return P.createElement(EC,{...f,"aria-current":D,className:K,ref:h,style:X,to:o,viewTransition:u},typeof c=="function"?c(M):c)});OL.displayName="NavLink";var TL=P.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:s,state:a,method:o=gd,action:u,onSubmit:c,relative:f,preventScrollReset:h,viewTransition:m,...g},y)=>{let w=jL(),v=LL(u,{relative:f}),x=o.toLowerCase()==="get"?"get":"post",E=typeof u=="string"&&SC.test(u),k=S=>{if(c&&c(S),S.defaultPrevented)return;S.preventDefault();let R=S.nativeEvent.submitter,A=(R==null?void 0:R.getAttribute("formmethod"))||o;w(R||S.currentTarget,{fetcherKey:e,method:A,navigate:t,replace:s,state:a,relative:f,preventScrollReset:h,viewTransition:m})};return P.createElement("form",{ref:y,method:x,action:v,onSubmit:r?c:k,...g,"data-discover":!E&&n==="render"?"true":void 0})});TL.displayName="Form";function AL(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function CC(n){let e=P.useContext(yo);return gt(e,AL(n)),e}function $L(n,{target:e,replace:t,state:r,preventScrollReset:s,relative:a,viewTransition:o}={}){let u=Bj(),c=ai(),f=vu(n,{relative:a});return P.useCallback(h=>{if(uL(h,e)){h.preventDefault();let m=t!==void 0?t:Wl(c)===Wl(f);u(n,{replace:m,state:r,preventScrollReset:s,relative:a,viewTransition:o})}},[c,u,f,t,r,e,n,s,a,o])}var IL=0,NL=()=>`__${String(++IL)}__`;function jL(){let{router:n}=CC("useSubmit"),{basename:e}=P.useContext(cs),t=Qj();return P.useCallback(async(r,s={})=>{let{action:a,method:o,encType:u,formData:c,body:f}=fL(r,e);if(s.navigate===!1){let h=s.fetcherKey||NL();await n.fetch(h,t,s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:f,formMethod:s.method||o,formEncType:s.encType||u,flushSync:s.flushSync})}else await n.navigate(s.action||a,{preventScrollReset:s.preventScrollReset,formData:c,body:f,formMethod:s.method||o,formEncType:s.encType||u,replace:s.replace,state:s.state,fromRouteId:t,flushSync:s.flushSync,viewTransition:s.viewTransition})},[n,e,t])}function LL(n,{relative:e}={}){let{basename:t}=P.useContext(cs),r=P.useContext($s);gt(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),a={...vu(n||".",{relative:e})},o=ai();if(n==null){a.search=o.search;let u=new URLSearchParams(a.search),c=u.getAll("index");if(c.some(h=>h==="")){u.delete("index"),c.filter(m=>m).forEach(m=>u.append("index",m));let h=u.toString();a.search=h?`?${h}`:""}}return(!n||n===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:ks([t,a.pathname])),Wl(a)}function ML(n,e={}){let t=P.useContext(mC);gt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=CC("useViewTransitionState"),s=vu(n,{relative:e.relative});if(!t.isTransitioning)return!1;let a=ca(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=ca(t.nextLocation.pathname,r)||t.nextLocation.pathname;return $d(s.pathname,o)!=null||$d(s.pathname,a)!=null}new TextEncoder;function ox(n,e=x_){n=n.trim();const t=/```(json)?(.*)```/s.exec(n);return e(t?t[2]:n)}function x_(n){if(typeof n>"u")return null;try{return JSON.parse(n)}catch{}let e="";const t=[];let r=!1,s=!1;for(let a of n){if(r)a==='"'&&!s?r=!1:a===`
`&&!s?a="\\n":a==="\\"?s=!s:s=!1;else if(a==='"')r=!0,s=!1;else if(a==="{")t.push("}");else if(a==="[")t.push("]");else if(a==="}"||a==="]")if(t&&t[t.length-1]===a)t.pop();else return null;e+=a}r&&(e+='"');for(let a=t.length-1;a>=0;a-=1)e+=t[a];try{return JSON.parse(e)}catch{return null}}var Qp,lx;function DL(){return lx||(lx=1,Qp=function(n,e){if(typeof n!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,n.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()}),Qp}var FL=DL();const UL=ti(FL);var Jc={exports:{}},ux;function zL(){if(ux)return Jc.exports;ux=1;const n=/[\p{Lu}]/u,e=/[\p{Ll}]/u,t=/^[\p{Lu}](?![\p{Lu}])/gu,r=/([\p{Alpha}\p{N}_]|$)/u,s=/[_.\- ]+/,a=new RegExp("^"+s.source),o=new RegExp(s.source+r.source,"gu"),u=new RegExp("\\d+"+r.source,"gu"),c=(g,y,w)=>{let v=!1,x=!1,E=!1;for(let k=0;k<g.length;k++){const S=g[k];v&&n.test(S)?(g=g.slice(0,k)+"-"+g.slice(k),v=!1,E=x,x=!0,k++):x&&E&&e.test(S)?(g=g.slice(0,k-1)+"-"+g.slice(k-1),E=x,x=!1,v=!0):(v=y(S)===S&&w(S)!==S,E=x,x=w(S)===S&&y(S)!==S)}return g},f=(g,y)=>(t.lastIndex=0,g.replace(t,w=>y(w))),h=(g,y)=>(o.lastIndex=0,u.lastIndex=0,g.replace(o,(w,v)=>y(v)).replace(u,w=>y(w))),m=(g,y)=>{if(!(typeof g=="string"||Array.isArray(g)))throw new TypeError("Expected the input to be `string | string[]`");if(y={pascalCase:!1,preserveConsecutiveUppercase:!1,...y},Array.isArray(g)?g=g.map(E=>E.trim()).filter(E=>E.length).join("-"):g=g.trim(),g.length===0)return"";const w=y.locale===!1?E=>E.toLowerCase():E=>E.toLocaleLowerCase(y.locale),v=y.locale===!1?E=>E.toUpperCase():E=>E.toLocaleUpperCase(y.locale);return g.length===1?y.pascalCase?v(g):w(g):(g!==w(g)&&(g=c(g,w,v)),g=g.replace(a,""),y.preserveConsecutiveUppercase?g=f(g,w):g=w(g),y.pascalCase&&(g=v(g.charAt(0))+g.slice(1)),h(g,v))};return Jc.exports=m,Jc.exports.default=m,Jc.exports}zL();function BL(n,e){return(e==null?void 0:e[n])||UL(n)}function HL(n,e,t){const r={};for(const s in n)Object.hasOwn(n,s)&&(r[e(s,t)]=n[s]);return r}function cx(n){return Array.isArray(n)?[...n]:{...n}}function VL(n,e){const t=cx(n);for(const[r,s]of Object.entries(e)){const[a,...o]=r.split(".").reverse();let u=t;for(const c of o.reverse()){if(u[c]===void 0)break;u[c]=cx(u[c]),u=u[c]}u[a]!==void 0&&(u[a]={lc:1,type:"secret",id:[s]})}return t}function PC(n){const e=Object.getPrototypeOf(n);return typeof n.lc_name=="function"&&(typeof e.lc_name!="function"||n.lc_name()!==e.lc_name())?n.lc_name():n.name}class Ja{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,PC(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_serializable_keys!==void 0?this.lc_kwargs=Object.fromEntries(Object.entries(e||{}).filter(([r])=>{var s;return(s=this.lc_serializable_keys)==null?void 0:s.includes(r)})):this.lc_kwargs=e??{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof Ja||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},t={},r=Object.keys(this.lc_kwargs).reduce((s,a)=>(s[a]=a in this?this[a]:this.lc_kwargs[a],s),{});for(let s=Object.getPrototypeOf(this);s;s=Object.getPrototypeOf(s))Object.assign(e,Reflect.get(s,"lc_aliases",this)),Object.assign(t,Reflect.get(s,"lc_secrets",this)),Object.assign(r,Reflect.get(s,"lc_attributes",this));return Object.keys(t).forEach(s=>{let a=this,o=r;const[u,...c]=s.split(".").reverse();for(const f of c.reverse()){if(!(f in a)||a[f]===void 0)return;(!(f in o)||o[f]===void 0)&&(typeof a[f]=="object"&&a[f]!=null?o[f]={}:Array.isArray(a[f])&&(o[f]=[])),a=a[f],o=o[f]}u in a&&a[u]!==void 0&&(o[u]=o[u]||a[u])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:HL(Object.keys(t).length?VL(r,t):r,BL,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}function _o(n,e){return typeof n=="string"?n===""?e:typeof e=="string"?n+e:[{type:"text",text:n},...e]:Array.isArray(e)?vf(n,e)??[...n,...e]:e===""?n:[...n,{type:"text",text:e}]}function WL(n,e){return n==="error"||e==="error"?"error":"success"}function qL(n,e){function t(r,s){if(typeof r!="object"||r===null||r===void 0)return r;if(s>=e)return Array.isArray(r)?"[Array]":"[Object]";if(Array.isArray(r))return r.map(o=>t(o,s+1));const a={};for(const o of Object.keys(r))a[o]=t(r[o],s+1);return a}return JSON.stringify(t(n,0),null,2)}class wo extends Ja{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:Array.isArray(this.content)?this.content.map(e=>typeof e=="string"?e:e.type==="text"?e.text:"").join(""):""}getType(){return this._getType()}constructor(e,t){typeof e=="string"&&(e={content:e,additional_kwargs:t,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const t=qL(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${t}`}}function _n(n,e){const t={...n};for(const[r,s]of Object.entries(e))if(t[r]==null)t[r]=s;else{if(s==null)continue;if(typeof t[r]!=typeof s||Array.isArray(t[r])!==Array.isArray(s))throw new Error(`field[${r}] already exists in the message chunk, but with a different type.`);if(typeof t[r]=="string"){if(r==="type")continue;t[r]+=s}else if(typeof t[r]=="object"&&!Array.isArray(t[r]))t[r]=_n(t[r],s);else if(Array.isArray(t[r]))t[r]=vf(t[r],s);else{if(t[r]===s)continue;console.warn(`field[${r}] already exists in this message chunk and value has unsupported type.`)}}return t}function vf(n,e){if(!(n===void 0&&e===void 0)){if(n===void 0||e===void 0)return n||e;{const t=[...n];for(const r of e)if(typeof r=="object"&&"index"in r&&typeof r.index=="number"){const s=t.findIndex(a=>a.index===r.index);s!==-1?t[s]=_n(t[s],r):t.push(r)}else{if(typeof r=="object"&&"text"in r&&r.text==="")continue;t.push(r)}return t}}}function ZL(n,e){if(!n&&!e)throw new Error("Cannot merge two undefined objects.");if(!n||!e)return n||e;if(typeof n!=typeof e)throw new Error(`Cannot merge objects of different types.
Left ${typeof n}
Right ${typeof e}`);if(typeof n=="string"&&typeof e=="string")return n+e;if(Array.isArray(n)&&Array.isArray(e))return vf(n,e);if(typeof n=="object"&&typeof e=="object")return _n(n,e);if(n===e)return n;throw new Error(`Can not merge objects of different types.
Left ${n}
Right ${e}`)}class bo extends wo{}function GL(n){return typeof n.role=="string"}function xf(n){return typeof(n==null?void 0:n._getType)=="function"}function JL(n){return xf(n)&&typeof n.concat=="function"}class KL extends wo{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,t,r){typeof e=="string"&&(e={content:e,name:r,tool_call_id:t}),super(e),Object.defineProperty(this,"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}class S_ extends bo{constructor(e){super(e),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}static lc_name(){return"ToolMessageChunk"}_getType(){return"tool"}concat(e){return new S_({content:_o(this.content,e.content),additional_kwargs:_n(this.additional_kwargs,e.additional_kwargs),response_metadata:_n(this.response_metadata,e.response_metadata),artifact:ZL(this.artifact,e.artifact),tool_call_id:this.tool_call_id,id:this.id??e.id,status:WL(this.status,e.status)})}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function XL(n){const e=[],t=[];for(const r of n)if(r.function){const s=r.function.name;try{const a=JSON.parse(r.function.arguments),o={name:s||"",args:a||{},id:r.id};e.push(o)}catch{t.push({name:s,args:r.function.arguments,id:r.id,error:"Malformed args."})}}else continue;return[e,t]}class Ka extends wo{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,t){var s;let r;if(typeof e=="string")r={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:t??{}};else{r=e;const a=(s=r.additional_kwargs)==null?void 0:s.tool_calls,o=r.tool_calls;a!=null&&a.length>0&&(o===void 0||o.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(a!=null&&o===void 0){const[u,c]=XL(a);r.tool_calls=u??[],r.invalid_tool_calls=c??[]}else r.tool_calls=r.tool_calls??[],r.invalid_tool_calls=r.invalid_tool_calls??[]}catch{r.tool_calls=[],r.invalid_tool_calls=[]}}super(r),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r!="string"&&(this.tool_calls=r.tool_calls??this.tool_calls,this.invalid_tool_calls=r.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=r.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}function xu(n){return n._getType()==="ai"}function dx(n){return n._getType()==="ai"}class ns extends bo{constructor(e){let t;if(typeof e=="string")t={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)t={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{const r=[],s=[];for(const a of e.tool_call_chunks){let o={};try{if(o=x_(a.args||"{}"),o===null||typeof o!="object"||Array.isArray(o))throw new Error("Malformed tool call chunk args.");r.push({name:a.name??"",args:o,id:a.id,type:"tool_call"})}catch{s.push({name:a.name,args:a.args,id:a.id,error:"Malformed args.",type:"invalid_tool_call"})}}t={...e,tool_calls:r,invalid_tool_calls:s,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(t),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=t.tool_call_chunks??this.tool_call_chunks,this.tool_calls=t.tool_calls??this.tool_calls,this.invalid_tool_calls=t.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=t.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){var r,s,a,o,u,c,f,h,m,g,y,w,v,x,E,k,S,R,A,I,M,D,K,X,ae,he,ce,W,G,q,J,j,B,V,$,U,re,pe,de,Y;const t={content:_o(this.content,e.content),additional_kwargs:_n(this.additional_kwargs,e.additional_kwargs),response_metadata:_n(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const oe=vf(this.tool_call_chunks,e.tool_call_chunks);oe!==void 0&&oe.length>0&&(t.tool_call_chunks=oe)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){const oe={...(((s=(r=this.usage_metadata)==null?void 0:r.input_token_details)==null?void 0:s.audio)!==void 0||((o=(a=e.usage_metadata)==null?void 0:a.input_token_details)==null?void 0:o.audio)!==void 0)&&{audio:(((c=(u=this.usage_metadata)==null?void 0:u.input_token_details)==null?void 0:c.audio)??0)+(((h=(f=e.usage_metadata)==null?void 0:f.input_token_details)==null?void 0:h.audio)??0)},...(((g=(m=this.usage_metadata)==null?void 0:m.input_token_details)==null?void 0:g.cache_read)!==void 0||((w=(y=e.usage_metadata)==null?void 0:y.input_token_details)==null?void 0:w.cache_read)!==void 0)&&{cache_read:(((x=(v=this.usage_metadata)==null?void 0:v.input_token_details)==null?void 0:x.cache_read)??0)+(((k=(E=e.usage_metadata)==null?void 0:E.input_token_details)==null?void 0:k.cache_read)??0)},...(((R=(S=this.usage_metadata)==null?void 0:S.input_token_details)==null?void 0:R.cache_creation)!==void 0||((I=(A=e.usage_metadata)==null?void 0:A.input_token_details)==null?void 0:I.cache_creation)!==void 0)&&{cache_creation:(((D=(M=this.usage_metadata)==null?void 0:M.input_token_details)==null?void 0:D.cache_creation)??0)+(((X=(K=e.usage_metadata)==null?void 0:K.input_token_details)==null?void 0:X.cache_creation)??0)}},ue={...(((he=(ae=this.usage_metadata)==null?void 0:ae.output_token_details)==null?void 0:he.audio)!==void 0||((W=(ce=e.usage_metadata)==null?void 0:ce.output_token_details)==null?void 0:W.audio)!==void 0)&&{audio:(((q=(G=this.usage_metadata)==null?void 0:G.output_token_details)==null?void 0:q.audio)??0)+(((j=(J=e.usage_metadata)==null?void 0:J.output_token_details)==null?void 0:j.audio)??0)},...(((V=(B=this.usage_metadata)==null?void 0:B.output_token_details)==null?void 0:V.reasoning)!==void 0||((U=($=e.usage_metadata)==null?void 0:$.output_token_details)==null?void 0:U.reasoning)!==void 0)&&{reasoning:(((pe=(re=this.usage_metadata)==null?void 0:re.output_token_details)==null?void 0:pe.reasoning)??0)+(((Y=(de=e.usage_metadata)==null?void 0:de.output_token_details)==null?void 0:Y.reasoning)??0)}},ge=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},_e=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},Ie={input_tokens:ge.input_tokens+_e.input_tokens,output_tokens:ge.output_tokens+_e.output_tokens,total_tokens:ge.total_tokens+_e.total_tokens,...Object.keys(oe).length>0&&{input_token_details:oe},...Object.keys(ue).length>0&&{output_token_details:ue}};t.usage_metadata=Ie}return new ns(t)}}class Su extends wo{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return Su}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}}class Sf extends bo{static lc_name(){return"ChatMessageChunk"}constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new Sf({content:_o(this.content,e.content),additional_kwargs:_n(this.additional_kwargs,e.additional_kwargs),response_metadata:_n(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}class Ef extends bo{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new Ef({content:_o(this.content,e.content),additional_kwargs:_n(this.additional_kwargs,e.additional_kwargs),response_metadata:_n(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}}class no extends wo{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class Cf extends bo{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(e){return new Cf({content:_o(this.content,e.content),additional_kwargs:_n(this.additional_kwargs,e.additional_kwargs),response_metadata:_n(this.response_metadata,e.response_metadata),id:this.id??e.id})}}class Hg extends wo{static lc_name(){return"SystemMessage"}_getType(){return"system"}}class ql extends bo{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(e){return new ql({content:_o(this.content,e.content),additional_kwargs:_n(this.additional_kwargs,e.additional_kwargs),response_metadata:_n(this.response_metadata,e.response_metadata),id:this.id??e.id})}}function kC(n,e){return n.lc_error_code=e,n.message=`${n.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,n}function RC(n){return!!(n&&typeof n=="object"&&"type"in n&&n.type==="tool_call")}class YL extends Error{constructor(e,t){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=t}}function QL(n){return RC(n)?n:typeof n.id=="string"&&n.type==="function"&&typeof n.function=="object"&&n.function!==null&&"arguments"in n.function&&typeof n.function.arguments=="string"&&"name"in n.function&&typeof n.function.name=="string"?{id:n.id,args:JSON.parse(n.function.arguments),name:n.function.name,type:"tool_call"}:n}function e2(n){return typeof n=="object"&&n!=null&&n.lc===1&&Array.isArray(n.id)&&n.kwargs!=null&&typeof n.kwargs=="object"}function em(n){let e,t;if(e2(n)){const r=n.id.at(-1);r==="HumanMessage"||r==="HumanMessageChunk"?e="user":r==="AIMessage"||r==="AIMessageChunk"?e="assistant":r==="SystemMessage"||r==="SystemMessageChunk"?e="system":r==="FunctionMessage"||r==="FunctionMessageChunk"?e="function":r==="ToolMessage"||r==="ToolMessageChunk"?e="tool":e="unknown",t=n.kwargs}else{const{type:r,...s}=n;e=r,t=s}if(e==="human"||e==="user")return new no(t);if(e==="ai"||e==="assistant"){const{tool_calls:r,...s}=t;if(!Array.isArray(r))return new Ka(t);const a=r.map(QL);return new Ka({...s,tool_calls:a})}else{if(e==="system")return new Hg(t);if(e==="developer")return new Hg({...t,additional_kwargs:{...t.additional_kwargs,__openai_role__:"developer"}});if(e==="tool"&&"tool_call_id"in t)return new KL({...t,content:t.content,tool_call_id:t.tool_call_id,name:t.name});throw kC(new Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(n,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function El(n){if(typeof n=="string")return new no(n);if(xf(n))return n;if(Array.isArray(n)){const[e,t]=n;return em({type:e,content:t})}else if(GL(n)){const{role:e,...t}=n;return em({...t,type:e})}else return em(n)}function OC(n,e="Human",t="AI"){const r=[];for(const s of n){let a;if(s._getType()==="human")a=e;else if(s._getType()==="ai")a=t;else if(s._getType()==="system")a="System";else if(s._getType()==="function")a="Function";else if(s._getType()==="tool")a="Tool";else if(s._getType()==="generic")a=s.role;else throw new Error(`Got unsupported message type: ${s._getType()}`);const o=s.name?`${s.name}, `:"",u=typeof s.content=="string"?s.content:JSON.stringify(s.content,null,2);r.push(`${a}: ${o}${u}`)}return r.join(`
`)}function t2(n){var t;const e=n._getType();if(e==="human")return new Cf({...n});if(e==="ai"){let r={...n};return"tool_calls"in r&&(r={...r,tool_call_chunks:(t=r.tool_calls)==null?void 0:t.map(s=>({...s,type:"tool_call_chunk",index:void 0,args:JSON.stringify(s.args)}))}),new ns({...r})}else{if(e==="system")return new ql({...n});if(e==="function")return new Ef({...n});if(Su.isInstance(n))return new Sf({...n});throw new Error("Unknown message type.")}}var He;(function(n){n.assertEqual=s=>s;function e(s){}n.assertIs=e;function t(s){throw new Error}n.assertNever=t,n.arrayToEnum=s=>{const a={};for(const o of s)a[o]=o;return a},n.getValidEnumValues=s=>{const a=n.objectKeys(s).filter(u=>typeof s[s[u]]!="number"),o={};for(const u of a)o[u]=s[u];return n.objectValues(o)},n.objectValues=s=>n.objectKeys(s).map(function(a){return s[a]}),n.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&a.push(o);return a},n.find=(s,a)=>{for(const o of s)if(a(o))return o},n.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,a=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(a)}n.joinValues=r,n.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(He||(He={}));var Vg;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(Vg||(Vg={}));const ye=He.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Es=n=>{switch(typeof n){case"undefined":return ye.undefined;case"string":return ye.string;case"number":return isNaN(n)?ye.nan:ye.number;case"boolean":return ye.boolean;case"function":return ye.function;case"bigint":return ye.bigint;case"symbol":return ye.symbol;case"object":return Array.isArray(n)?ye.array:n===null?ye.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?ye.promise:typeof Map<"u"&&n instanceof Map?ye.map:typeof Set<"u"&&n instanceof Set?ye.set:typeof Date<"u"&&n instanceof Date?ye.date:ye.object;default:return ye.unknown}},se=He.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),n2=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:");class Vn extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(a){return a.message},r={_errors:[]},s=a=>{for(const o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(t(o));else{let u=r,c=0;for(;c<o.path.length;){const f=o.path[c];c===o.path.length-1?(u[f]=u[f]||{_errors:[]},u[f]._errors.push(t(o))):u[f]=u[f]||{_errors:[]},u=u[f],c++}}};return s(this),r}static assert(e){if(!(e instanceof Vn))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,He.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}Vn.create=n=>new Vn(n);const ro=(n,e)=>{let t;switch(n.code){case se.invalid_type:n.received===ye.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case se.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,He.jsonStringifyReplacer)}`;break;case se.unrecognized_keys:t=`Unrecognized key(s) in object: ${He.joinValues(n.keys,", ")}`;break;case se.invalid_union:t="Invalid input";break;case se.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${He.joinValues(n.options)}`;break;case se.invalid_enum_value:t=`Invalid enum value. Expected ${He.joinValues(n.options)}, received '${n.received}'`;break;case se.invalid_arguments:t="Invalid function arguments";break;case se.invalid_return_type:t="Invalid function return type";break;case se.invalid_date:t="Invalid date";break;case se.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:He.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case se.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case se.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case se.custom:t="Invalid input";break;case se.invalid_intersection_types:t="Intersection results could not be merged";break;case se.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case se.not_finite:t="Number must be finite";break;default:t=e.defaultError,He.assertNever(n)}return{message:t}};let TC=ro;function r2(n){TC=n}function Id(){return TC}const Nd=n=>{const{data:e,path:t,errorMaps:r,issueData:s}=n,a=[...t,...s.path||[]],o={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let u="";const c=r.filter(f=>!!f).slice().reverse();for(const f of c)u=f(o,{data:e,defaultError:u}).message;return{...s,path:a,message:u}},s2=[];function fe(n,e){const t=Id(),r=Nd({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===ro?void 0:ro].filter(s=>!!s)});n.common.issues.push(r)}class on{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const s of t){if(s.status==="aborted")return Ae;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const s of t){const a=await s.key,o=await s.value;r.push({key:a,value:o})}return on.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const s of t){const{key:a,value:o}=s;if(a.status==="aborted"||o.status==="aborted")return Ae;a.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[a.value]=o.value)}return{status:e.value,value:r}}}const Ae=Object.freeze({status:"aborted"}),Hi=n=>({status:"dirty",value:n}),wn=n=>({status:"valid",value:n}),Wg=n=>n.status==="aborted",qg=n=>n.status==="dirty",Xa=n=>n.status==="valid",Zl=n=>typeof Promise<"u"&&n instanceof Promise;function jd(n,e,t,r){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(n)}function AC(n,e,t,r,s){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,t),t}var Ee;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Ee||(Ee={}));var Cl,Pl;class rs{constructor(e,t,r,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const fx=(n,e)=>{if(Xa(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Vn(n.common.issues);return this._error=t,this._error}}};function Ne(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:s}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,u)=>{var c,f;const{message:h}=n;return o.code==="invalid_enum_value"?{message:h??u.defaultError}:typeof u.data>"u"?{message:(c=h??r)!==null&&c!==void 0?c:u.defaultError}:o.code!=="invalid_type"?{message:u.defaultError}:{message:(f=h??t)!==null&&f!==void 0?f:u.defaultError}},description:s}}class De{get description(){return this._def.description}_getType(e){return Es(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Es(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new on,ctx:{common:e.parent.common,data:e.data,parsedType:Es(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Zl(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const s={common:{issues:[],async:(r=t==null?void 0:t.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Es(e)},a=this._parseSync({data:e,path:s.path,parent:s});return fx(s,a)}"~validate"(e){var t,r;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Es(e)};if(!this["~standard"].async)try{const a=this._parseSync({data:e,path:[],parent:s});return Xa(a)?{value:a.value}:{issues:s.common.issues}}catch(a){!((r=(t=a==null?void 0:a.message)===null||t===void 0?void 0:t.toLowerCase())===null||r===void 0)&&r.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:s}).then(a=>Xa(a)?{value:a.value}:{issues:s.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Es(e)},s=this._parse({data:e,path:r.path,parent:r}),a=await(Zl(s)?s:Promise.resolve(s));return fx(r,a)}refine(e,t){const r=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,a)=>{const o=e(s),u=()=>a.addIssue({code:se.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(u(),!1)):o?!0:(u(),!1)})}refinement(e,t){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof t=="function"?t(r,s):t),!1))}_refinement(e){return new Ir({schema:this,typeName:Z.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Rr.create(this,this._def)}nullable(){return pa.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return kr.create(this)}promise(){return ao.create(this,this._def)}or(e){return Xl.create([this,e],this._def)}and(e){return Yl.create(this,e,this._def)}transform(e){return new Ir({...Ne(this._def),schema:this,typeName:Z.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new ru({...Ne(this._def),innerType:this,defaultValue:t,typeName:Z.ZodDefault})}brand(){return new E_({typeName:Z.ZodBranded,type:this,...Ne(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new su({...Ne(this._def),innerType:this,catchValue:t,typeName:Z.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Eu.create(this,e)}readonly(){return au.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const a2=/^c[^\s-]{8,}$/i,i2=/^[0-9a-z]+$/,o2=/^[0-9A-HJKMNP-TV-Z]{26}$/i,l2=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,u2=/^[a-z0-9_-]{21}$/i,c2=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,d2=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,f2=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,h2="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let tm;const p2=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,m2=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,g2=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,y2=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,_2=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,w2=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,$C="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",b2=new RegExp(`^${$C}$`);function IC(n){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`),e}function v2(n){return new RegExp(`^${IC(n)}$`)}function NC(n){let e=`${$C}T${IC(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function x2(n,e){return!!((e==="v4"||!e)&&p2.test(n)||(e==="v6"||!e)&&g2.test(n))}function S2(n,e){if(!c2.test(n))return!1;try{const[t]=n.split("."),r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||!s.typ||!s.alg||e&&s.alg!==e)}catch{return!1}}function E2(n,e){return!!((e==="v4"||!e)&&m2.test(n)||(e==="v6"||!e)&&y2.test(n))}class Er extends De{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ye.string){const a=this._getOrReturnCtx(e);return fe(a,{code:se.invalid_type,expected:ye.string,received:a.parsedType}),Ae}const r=new on;let s;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(s=this._getOrReturnCtx(e,s),fe(s,{code:se.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")e.data.length>a.value&&(s=this._getOrReturnCtx(e,s),fe(s,{code:se.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const o=e.data.length>a.value,u=e.data.length<a.value;(o||u)&&(s=this._getOrReturnCtx(e,s),o?fe(s,{code:se.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):u&&fe(s,{code:se.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")f2.test(e.data)||(s=this._getOrReturnCtx(e,s),fe(s,{validation:"email",code:se.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")tm||(tm=new RegExp(h2,"u")),tm.test(e.data)||(s=this._getOrReturnCtx(e,s),fe(s,{validation:"emoji",code:se.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")l2.test(e.data)||(s=this._getOrReturnCtx(e,s),fe(s,{validation:"uuid",code:se.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")u2.test(e.data)||(s=this._getOrReturnCtx(e,s),fe(s,{validation:"nanoid",code:se.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")a2.test(e.data)||(s=this._getOrReturnCtx(e,s),fe(s,{validation:"cuid",code:se.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")i2.test(e.data)||(s=this._getOrReturnCtx(e,s),fe(s,{validation:"cuid2",code:se.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")o2.test(e.data)||(s=this._getOrReturnCtx(e,s),fe(s,{validation:"ulid",code:se.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),fe(s,{validation:"url",code:se.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),fe(s,{validation:"regex",code:se.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(e,s),fe(s,{code:se.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(s=this._getOrReturnCtx(e,s),fe(s,{code:se.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(s=this._getOrReturnCtx(e,s),fe(s,{code:se.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?NC(a).test(e.data)||(s=this._getOrReturnCtx(e,s),fe(s,{code:se.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?b2.test(e.data)||(s=this._getOrReturnCtx(e,s),fe(s,{code:se.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?v2(a).test(e.data)||(s=this._getOrReturnCtx(e,s),fe(s,{code:se.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?d2.test(e.data)||(s=this._getOrReturnCtx(e,s),fe(s,{validation:"duration",code:se.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?x2(e.data,a.version)||(s=this._getOrReturnCtx(e,s),fe(s,{validation:"ip",code:se.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?S2(e.data,a.alg)||(s=this._getOrReturnCtx(e,s),fe(s,{validation:"jwt",code:se.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?E2(e.data,a.version)||(s=this._getOrReturnCtx(e,s),fe(s,{validation:"cidr",code:se.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?_2.test(e.data)||(s=this._getOrReturnCtx(e,s),fe(s,{validation:"base64",code:se.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?w2.test(e.data)||(s=this._getOrReturnCtx(e,s),fe(s,{validation:"base64url",code:se.invalid_string,message:a.message}),r.dirty()):He.assertNever(a);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(s=>e.test(s),{validation:t,code:se.invalid_string,...Ee.errToObj(r)})}_addCheck(e){return new Er({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Ee.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Ee.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Ee.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Ee.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Ee.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Ee.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Ee.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Ee.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Ee.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Ee.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Ee.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Ee.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Ee.errToObj(e)})}datetime(e){var t,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,local:(r=e==null?void 0:e.local)!==null&&r!==void 0?r:!1,...Ee.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Ee.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Ee.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Ee.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...Ee.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Ee.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Ee.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Ee.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Ee.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Ee.errToObj(t)})}nonempty(e){return this.min(1,Ee.errToObj(e))}trim(){return new Er({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Er({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Er({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Er.create=n=>{var e;return new Er({checks:[],typeName:Z.ZodString,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...Ne(n)})};function C2(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=t>r?t:r,a=parseInt(n.toFixed(s).replace(".","")),o=parseInt(e.toFixed(s).replace(".",""));return a%o/Math.pow(10,s)}class da extends De{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ye.number){const a=this._getOrReturnCtx(e);return fe(a,{code:se.invalid_type,expected:ye.number,received:a.parsedType}),Ae}let r;const s=new on;for(const a of this._def.checks)a.kind==="int"?He.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),fe(r,{code:se.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),fe(r,{code:se.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),fe(r,{code:se.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?C2(e.data,a.value)!==0&&(r=this._getOrReturnCtx(e,r),fe(r,{code:se.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),fe(r,{code:se.not_finite,message:a.message}),s.dirty()):He.assertNever(a);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Ee.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Ee.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Ee.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Ee.toString(t))}setLimit(e,t,r,s){return new da({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Ee.toString(s)}]})}_addCheck(e){return new da({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Ee.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Ee.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Ee.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Ee.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Ee.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Ee.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Ee.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Ee.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Ee.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&He.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}da.create=n=>new da({checks:[],typeName:Z.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...Ne(n)});class fa extends De{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ye.bigint)return this._getInvalidInput(e);let r;const s=new on;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),fe(r,{code:se.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),fe(r,{code:se.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),fe(r,{code:se.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):He.assertNever(a);return{status:s.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return fe(t,{code:se.invalid_type,expected:ye.bigint,received:t.parsedType}),Ae}gte(e,t){return this.setLimit("min",e,!0,Ee.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Ee.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Ee.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Ee.toString(t))}setLimit(e,t,r,s){return new fa({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Ee.toString(s)}]})}_addCheck(e){return new fa({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Ee.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Ee.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Ee.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Ee.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Ee.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}fa.create=n=>{var e;return new fa({checks:[],typeName:Z.ZodBigInt,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...Ne(n)})};class Gl extends De{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ye.boolean){const r=this._getOrReturnCtx(e);return fe(r,{code:se.invalid_type,expected:ye.boolean,received:r.parsedType}),Ae}return wn(e.data)}}Gl.create=n=>new Gl({typeName:Z.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...Ne(n)});class Ya extends De{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ye.date){const a=this._getOrReturnCtx(e);return fe(a,{code:se.invalid_type,expected:ye.date,received:a.parsedType}),Ae}if(isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return fe(a,{code:se.invalid_date}),Ae}const r=new on;let s;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(s=this._getOrReturnCtx(e,s),fe(s,{code:se.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(s=this._getOrReturnCtx(e,s),fe(s,{code:se.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):He.assertNever(a);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ya({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Ee.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Ee.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Ya.create=n=>new Ya({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:Z.ZodDate,...Ne(n)});class Ld extends De{_parse(e){if(this._getType(e)!==ye.symbol){const r=this._getOrReturnCtx(e);return fe(r,{code:se.invalid_type,expected:ye.symbol,received:r.parsedType}),Ae}return wn(e.data)}}Ld.create=n=>new Ld({typeName:Z.ZodSymbol,...Ne(n)});class Jl extends De{_parse(e){if(this._getType(e)!==ye.undefined){const r=this._getOrReturnCtx(e);return fe(r,{code:se.invalid_type,expected:ye.undefined,received:r.parsedType}),Ae}return wn(e.data)}}Jl.create=n=>new Jl({typeName:Z.ZodUndefined,...Ne(n)});class Kl extends De{_parse(e){if(this._getType(e)!==ye.null){const r=this._getOrReturnCtx(e);return fe(r,{code:se.invalid_type,expected:ye.null,received:r.parsedType}),Ae}return wn(e.data)}}Kl.create=n=>new Kl({typeName:Z.ZodNull,...Ne(n)});class so extends De{constructor(){super(...arguments),this._any=!0}_parse(e){return wn(e.data)}}so.create=n=>new so({typeName:Z.ZodAny,...Ne(n)});class Ba extends De{constructor(){super(...arguments),this._unknown=!0}_parse(e){return wn(e.data)}}Ba.create=n=>new Ba({typeName:Z.ZodUnknown,...Ne(n)});class As extends De{_parse(e){const t=this._getOrReturnCtx(e);return fe(t,{code:se.invalid_type,expected:ye.never,received:t.parsedType}),Ae}}As.create=n=>new As({typeName:Z.ZodNever,...Ne(n)});class Md extends De{_parse(e){if(this._getType(e)!==ye.undefined){const r=this._getOrReturnCtx(e);return fe(r,{code:se.invalid_type,expected:ye.void,received:r.parsedType}),Ae}return wn(e.data)}}Md.create=n=>new Md({typeName:Z.ZodVoid,...Ne(n)});class kr extends De{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),s=this._def;if(t.parsedType!==ye.array)return fe(t,{code:se.invalid_type,expected:ye.array,received:t.parsedType}),Ae;if(s.exactLength!==null){const o=t.data.length>s.exactLength.value,u=t.data.length<s.exactLength.value;(o||u)&&(fe(t,{code:o?se.too_big:se.too_small,minimum:u?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(fe(t,{code:se.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(fe(t,{code:se.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((o,u)=>s.type._parseAsync(new rs(t,o,t.path,u)))).then(o=>on.mergeArray(r,o));const a=[...t.data].map((o,u)=>s.type._parseSync(new rs(t,o,t.path,u)));return on.mergeArray(r,a)}get element(){return this._def.type}min(e,t){return new kr({...this._def,minLength:{value:e,message:Ee.toString(t)}})}max(e,t){return new kr({...this._def,maxLength:{value:e,message:Ee.toString(t)}})}length(e,t){return new kr({...this._def,exactLength:{value:e,message:Ee.toString(t)}})}nonempty(e){return this.min(1,e)}}kr.create=(n,e)=>new kr({type:n,minLength:null,maxLength:null,exactLength:null,typeName:Z.ZodArray,...Ne(e)});function Ui(n){if(n instanceof mt){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=Rr.create(Ui(r))}return new mt({...n._def,shape:()=>e})}else return n instanceof kr?new kr({...n._def,type:Ui(n.element)}):n instanceof Rr?Rr.create(Ui(n.unwrap())):n instanceof pa?pa.create(Ui(n.unwrap())):n instanceof ss?ss.create(n.items.map(e=>Ui(e))):n}class mt extends De{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=He.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==ye.object){const f=this._getOrReturnCtx(e);return fe(f,{code:se.invalid_type,expected:ye.object,received:f.parsedType}),Ae}const{status:r,ctx:s}=this._processInputParams(e),{shape:a,keys:o}=this._getCached(),u=[];if(!(this._def.catchall instanceof As&&this._def.unknownKeys==="strip"))for(const f in s.data)o.includes(f)||u.push(f);const c=[];for(const f of o){const h=a[f],m=s.data[f];c.push({key:{status:"valid",value:f},value:h._parse(new rs(s,m,s.path,f)),alwaysSet:f in s.data})}if(this._def.catchall instanceof As){const f=this._def.unknownKeys;if(f==="passthrough")for(const h of u)c.push({key:{status:"valid",value:h},value:{status:"valid",value:s.data[h]}});else if(f==="strict")u.length>0&&(fe(s,{code:se.unrecognized_keys,keys:u}),r.dirty());else if(f!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const f=this._def.catchall;for(const h of u){const m=s.data[h];c.push({key:{status:"valid",value:h},value:f._parse(new rs(s,m,s.path,h)),alwaysSet:h in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const f=[];for(const h of c){const m=await h.key,g=await h.value;f.push({key:m,value:g,alwaysSet:h.alwaysSet})}return f}).then(f=>on.mergeObjectSync(r,f)):on.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return Ee.errToObj,new mt({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{var s,a,o,u;const c=(o=(a=(s=this._def).errorMap)===null||a===void 0?void 0:a.call(s,t,r).message)!==null&&o!==void 0?o:r.defaultError;return t.code==="unrecognized_keys"?{message:(u=Ee.errToObj(e).message)!==null&&u!==void 0?u:c}:{message:c}}}:{}})}strip(){return new mt({...this._def,unknownKeys:"strip"})}passthrough(){return new mt({...this._def,unknownKeys:"passthrough"})}extend(e){return new mt({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new mt({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Z.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new mt({...this._def,catchall:e})}pick(e){const t={};return He.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new mt({...this._def,shape:()=>t})}omit(e){const t={};return He.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new mt({...this._def,shape:()=>t})}deepPartial(){return Ui(this)}partial(e){const t={};return He.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?t[r]=s:t[r]=s.optional()}),new mt({...this._def,shape:()=>t})}required(e){const t={};return He.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof Rr;)a=a._def.innerType;t[r]=a}}),new mt({...this._def,shape:()=>t})}keyof(){return jC(He.objectKeys(this.shape))}}mt.create=(n,e)=>new mt({shape:()=>n,unknownKeys:"strip",catchall:As.create(),typeName:Z.ZodObject,...Ne(e)});mt.strictCreate=(n,e)=>new mt({shape:()=>n,unknownKeys:"strict",catchall:As.create(),typeName:Z.ZodObject,...Ne(e)});mt.lazycreate=(n,e)=>new mt({shape:n,unknownKeys:"strip",catchall:As.create(),typeName:Z.ZodObject,...Ne(e)});class Xl extends De{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function s(a){for(const u of a)if(u.result.status==="valid")return u.result;for(const u of a)if(u.result.status==="dirty")return t.common.issues.push(...u.ctx.common.issues),u.result;const o=a.map(u=>new Vn(u.ctx.common.issues));return fe(t,{code:se.invalid_union,unionErrors:o}),Ae}if(t.common.async)return Promise.all(r.map(async a=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(s);{let a;const o=[];for(const c of r){const f={...t,common:{...t.common,issues:[]},parent:null},h=c._parseSync({data:t.data,path:t.path,parent:f});if(h.status==="valid")return h;h.status==="dirty"&&!a&&(a={result:h,ctx:f}),f.common.issues.length&&o.push(f.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;const u=o.map(c=>new Vn(c));return fe(t,{code:se.invalid_union,unionErrors:u}),Ae}}get options(){return this._def.options}}Xl.create=(n,e)=>new Xl({options:n,typeName:Z.ZodUnion,...Ne(e)});const xs=n=>n instanceof eu?xs(n.schema):n instanceof Ir?xs(n.innerType()):n instanceof tu?[n.value]:n instanceof ha?n.options:n instanceof nu?He.objectValues(n.enum):n instanceof ru?xs(n._def.innerType):n instanceof Jl?[void 0]:n instanceof Kl?[null]:n instanceof Rr?[void 0,...xs(n.unwrap())]:n instanceof pa?[null,...xs(n.unwrap())]:n instanceof E_||n instanceof au?xs(n.unwrap()):n instanceof su?xs(n._def.innerType):[];class Pf extends De{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ye.object)return fe(t,{code:se.invalid_type,expected:ye.object,received:t.parsedType}),Ae;const r=this.discriminator,s=t.data[r],a=this.optionsMap.get(s);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(fe(t,{code:se.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),Ae)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const s=new Map;for(const a of t){const o=xs(a.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const u of o){if(s.has(u))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(u)}`);s.set(u,a)}}return new Pf({typeName:Z.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...Ne(r)})}}function Zg(n,e){const t=Es(n),r=Es(e);if(n===e)return{valid:!0,data:n};if(t===ye.object&&r===ye.object){const s=He.objectKeys(e),a=He.objectKeys(n).filter(u=>s.indexOf(u)!==-1),o={...n,...e};for(const u of a){const c=Zg(n[u],e[u]);if(!c.valid)return{valid:!1};o[u]=c.data}return{valid:!0,data:o}}else if(t===ye.array&&r===ye.array){if(n.length!==e.length)return{valid:!1};const s=[];for(let a=0;a<n.length;a++){const o=n[a],u=e[a],c=Zg(o,u);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return t===ye.date&&r===ye.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class Yl extends De{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=(a,o)=>{if(Wg(a)||Wg(o))return Ae;const u=Zg(a.value,o.value);return u.valid?((qg(a)||qg(o))&&t.dirty(),{status:t.value,value:u.data}):(fe(r,{code:se.invalid_intersection_types}),Ae)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,o])=>s(a,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Yl.create=(n,e,t)=>new Yl({left:n,right:e,typeName:Z.ZodIntersection,...Ne(t)});class ss extends De{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ye.array)return fe(r,{code:se.invalid_type,expected:ye.array,received:r.parsedType}),Ae;if(r.data.length<this._def.items.length)return fe(r,{code:se.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ae;!this._def.rest&&r.data.length>this._def.items.length&&(fe(r,{code:se.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...r.data].map((o,u)=>{const c=this._def.items[u]||this._def.rest;return c?c._parse(new rs(r,o,r.path,u)):null}).filter(o=>!!o);return r.common.async?Promise.all(a).then(o=>on.mergeArray(t,o)):on.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new ss({...this._def,rest:e})}}ss.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ss({items:n,typeName:Z.ZodTuple,rest:null,...Ne(e)})};class Ql extends De{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ye.object)return fe(r,{code:se.invalid_type,expected:ye.object,received:r.parsedType}),Ae;const s=[],a=this._def.keyType,o=this._def.valueType;for(const u in r.data)s.push({key:a._parse(new rs(r,u,r.path,u)),value:o._parse(new rs(r,r.data[u],r.path,u)),alwaysSet:u in r.data});return r.common.async?on.mergeObjectAsync(t,s):on.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof De?new Ql({keyType:e,valueType:t,typeName:Z.ZodRecord,...Ne(r)}):new Ql({keyType:Er.create(),valueType:e,typeName:Z.ZodRecord,...Ne(t)})}}class Dd extends De{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ye.map)return fe(r,{code:se.invalid_type,expected:ye.map,received:r.parsedType}),Ae;const s=this._def.keyType,a=this._def.valueType,o=[...r.data.entries()].map(([u,c],f)=>({key:s._parse(new rs(r,u,r.path,[f,"key"])),value:a._parse(new rs(r,c,r.path,[f,"value"]))}));if(r.common.async){const u=new Map;return Promise.resolve().then(async()=>{for(const c of o){const f=await c.key,h=await c.value;if(f.status==="aborted"||h.status==="aborted")return Ae;(f.status==="dirty"||h.status==="dirty")&&t.dirty(),u.set(f.value,h.value)}return{status:t.value,value:u}})}else{const u=new Map;for(const c of o){const f=c.key,h=c.value;if(f.status==="aborted"||h.status==="aborted")return Ae;(f.status==="dirty"||h.status==="dirty")&&t.dirty(),u.set(f.value,h.value)}return{status:t.value,value:u}}}}Dd.create=(n,e,t)=>new Dd({valueType:e,keyType:n,typeName:Z.ZodMap,...Ne(t)});class Qa extends De{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ye.set)return fe(r,{code:se.invalid_type,expected:ye.set,received:r.parsedType}),Ae;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(fe(r,{code:se.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(fe(r,{code:se.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const a=this._def.valueType;function o(c){const f=new Set;for(const h of c){if(h.status==="aborted")return Ae;h.status==="dirty"&&t.dirty(),f.add(h.value)}return{status:t.value,value:f}}const u=[...r.data.values()].map((c,f)=>a._parse(new rs(r,c,r.path,f)));return r.common.async?Promise.all(u).then(c=>o(c)):o(u)}min(e,t){return new Qa({...this._def,minSize:{value:e,message:Ee.toString(t)}})}max(e,t){return new Qa({...this._def,maxSize:{value:e,message:Ee.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Qa.create=(n,e)=>new Qa({valueType:n,minSize:null,maxSize:null,typeName:Z.ZodSet,...Ne(e)});class Ji extends De{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ye.function)return fe(t,{code:se.invalid_type,expected:ye.function,received:t.parsedType}),Ae;function r(u,c){return Nd({data:u,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Id(),ro].filter(f=>!!f),issueData:{code:se.invalid_arguments,argumentsError:c}})}function s(u,c){return Nd({data:u,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Id(),ro].filter(f=>!!f),issueData:{code:se.invalid_return_type,returnTypeError:c}})}const a={errorMap:t.common.contextualErrorMap},o=t.data;if(this._def.returns instanceof ao){const u=this;return wn(async function(...c){const f=new Vn([]),h=await u._def.args.parseAsync(c,a).catch(y=>{throw f.addIssue(r(c,y)),f}),m=await Reflect.apply(o,this,h);return await u._def.returns._def.type.parseAsync(m,a).catch(y=>{throw f.addIssue(s(m,y)),f})})}else{const u=this;return wn(function(...c){const f=u._def.args.safeParse(c,a);if(!f.success)throw new Vn([r(c,f.error)]);const h=Reflect.apply(o,this,f.data),m=u._def.returns.safeParse(h,a);if(!m.success)throw new Vn([s(h,m.error)]);return m.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Ji({...this._def,args:ss.create(e).rest(Ba.create())})}returns(e){return new Ji({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new Ji({args:e||ss.create([]).rest(Ba.create()),returns:t||Ba.create(),typeName:Z.ZodFunction,...Ne(r)})}}class eu extends De{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}eu.create=(n,e)=>new eu({getter:n,typeName:Z.ZodLazy,...Ne(e)});class tu extends De{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return fe(t,{received:t.data,code:se.invalid_literal,expected:this._def.value}),Ae}return{status:"valid",value:e.data}}get value(){return this._def.value}}tu.create=(n,e)=>new tu({value:n,typeName:Z.ZodLiteral,...Ne(e)});function jC(n,e){return new ha({values:n,typeName:Z.ZodEnum,...Ne(e)})}class ha extends De{constructor(){super(...arguments),Cl.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return fe(t,{expected:He.joinValues(r),received:t.parsedType,code:se.invalid_type}),Ae}if(jd(this,Cl)||AC(this,Cl,new Set(this._def.values)),!jd(this,Cl).has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return fe(t,{received:t.data,code:se.invalid_enum_value,options:r}),Ae}return wn(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return ha.create(e,{...this._def,...t})}exclude(e,t=this._def){return ha.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}Cl=new WeakMap;ha.create=jC;class nu extends De{constructor(){super(...arguments),Pl.set(this,void 0)}_parse(e){const t=He.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ye.string&&r.parsedType!==ye.number){const s=He.objectValues(t);return fe(r,{expected:He.joinValues(s),received:r.parsedType,code:se.invalid_type}),Ae}if(jd(this,Pl)||AC(this,Pl,new Set(He.getValidEnumValues(this._def.values))),!jd(this,Pl).has(e.data)){const s=He.objectValues(t);return fe(r,{received:r.data,code:se.invalid_enum_value,options:s}),Ae}return wn(e.data)}get enum(){return this._def.values}}Pl=new WeakMap;nu.create=(n,e)=>new nu({values:n,typeName:Z.ZodNativeEnum,...Ne(e)});class ao extends De{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ye.promise&&t.common.async===!1)return fe(t,{code:se.invalid_type,expected:ye.promise,received:t.parsedType}),Ae;const r=t.parsedType===ye.promise?t.data:Promise.resolve(t.data);return wn(r.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}ao.create=(n,e)=>new ao({type:n,typeName:Z.ZodPromise,...Ne(e)});class Ir extends De{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Z.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:o=>{fe(r,o),o.fatal?t.abort():t.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const o=s.transform(r.data,a);if(r.common.async)return Promise.resolve(o).then(async u=>{if(t.value==="aborted")return Ae;const c=await this._def.schema._parseAsync({data:u,path:r.path,parent:r});return c.status==="aborted"?Ae:c.status==="dirty"||t.value==="dirty"?Hi(c.value):c});{if(t.value==="aborted")return Ae;const u=this._def.schema._parseSync({data:o,path:r.path,parent:r});return u.status==="aborted"?Ae:u.status==="dirty"||t.value==="dirty"?Hi(u.value):u}}if(s.type==="refinement"){const o=u=>{const c=s.refinement(u,a);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return u};if(r.common.async===!1){const u=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return u.status==="aborted"?Ae:(u.status==="dirty"&&t.dirty(),o(u.value),{status:t.value,value:u.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(u=>u.status==="aborted"?Ae:(u.status==="dirty"&&t.dirty(),o(u.value).then(()=>({status:t.value,value:u.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Xa(o))return o;const u=s.transform(o.value,a);if(u instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:u}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Xa(o)?Promise.resolve(s.transform(o.value,a)).then(u=>({status:t.value,value:u})):o);He.assertNever(s)}}Ir.create=(n,e,t)=>new Ir({schema:n,typeName:Z.ZodEffects,effect:e,...Ne(t)});Ir.createWithPreprocess=(n,e,t)=>new Ir({schema:e,effect:{type:"preprocess",transform:n},typeName:Z.ZodEffects,...Ne(t)});class Rr extends De{_parse(e){return this._getType(e)===ye.undefined?wn(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Rr.create=(n,e)=>new Rr({innerType:n,typeName:Z.ZodOptional,...Ne(e)});class pa extends De{_parse(e){return this._getType(e)===ye.null?wn(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}pa.create=(n,e)=>new pa({innerType:n,typeName:Z.ZodNullable,...Ne(e)});class ru extends De{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===ye.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}ru.create=(n,e)=>new ru({innerType:n,typeName:Z.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Ne(e)});class su extends De{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Zl(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Vn(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Vn(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}su.create=(n,e)=>new su({innerType:n,typeName:Z.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Ne(e)});class Fd extends De{_parse(e){if(this._getType(e)!==ye.nan){const r=this._getOrReturnCtx(e);return fe(r,{code:se.invalid_type,expected:ye.nan,received:r.parsedType}),Ae}return{status:"valid",value:e.data}}}Fd.create=n=>new Fd({typeName:Z.ZodNaN,...Ne(n)});const P2=Symbol("zod_brand");class E_ extends De{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class Eu extends De{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Ae:a.status==="dirty"?(t.dirty(),Hi(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Ae:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,t){return new Eu({in:e,out:t,typeName:Z.ZodPipeline})}}class au extends De{_parse(e){const t=this._def.innerType._parse(e),r=s=>(Xa(s)&&(s.value=Object.freeze(s.value)),s);return Zl(t)?t.then(s=>r(s)):r(t)}unwrap(){return this._def.innerType}}au.create=(n,e)=>new au({innerType:n,typeName:Z.ZodReadonly,...Ne(e)});function LC(n,e={},t){return n?so.create().superRefine((r,s)=>{var a,o;if(!n(r)){const u=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,c=(o=(a=u.fatal)!==null&&a!==void 0?a:t)!==null&&o!==void 0?o:!0,f=typeof u=="string"?{message:u}:u;s.addIssue({code:"custom",...f,fatal:c})}}):so.create()}const k2={object:mt.lazycreate};var Z;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(Z||(Z={}));const R2=(n,e={message:`Input not instance of ${n.name}`})=>LC(t=>t instanceof n,e),MC=Er.create,DC=da.create,O2=Fd.create,T2=fa.create,FC=Gl.create,A2=Ya.create,$2=Ld.create,I2=Jl.create,N2=Kl.create,j2=so.create,L2=Ba.create,M2=As.create,D2=Md.create,F2=kr.create,U2=mt.create,z2=mt.strictCreate,B2=Xl.create,H2=Pf.create,V2=Yl.create,W2=ss.create,q2=Ql.create,Z2=Dd.create,G2=Qa.create,J2=Ji.create,K2=eu.create,X2=tu.create,Y2=ha.create,Q2=nu.create,e4=ao.create,hx=Ir.create,t4=Rr.create,n4=pa.create,r4=Ir.createWithPreprocess,s4=Eu.create,a4=()=>MC().optional(),i4=()=>DC().optional(),o4=()=>FC().optional(),l4={string:n=>Er.create({...n,coerce:!0}),number:n=>da.create({...n,coerce:!0}),boolean:n=>Gl.create({...n,coerce:!0}),bigint:n=>fa.create({...n,coerce:!0}),date:n=>Ya.create({...n,coerce:!0})},u4=Ae;var le=Object.freeze({__proto__:null,defaultErrorMap:ro,setErrorMap:r2,getErrorMap:Id,makeIssue:Nd,EMPTY_PATH:s2,addIssueToContext:fe,ParseStatus:on,INVALID:Ae,DIRTY:Hi,OK:wn,isAborted:Wg,isDirty:qg,isValid:Xa,isAsync:Zl,get util(){return He},get objectUtil(){return Vg},ZodParsedType:ye,getParsedType:Es,ZodType:De,datetimeRegex:NC,ZodString:Er,ZodNumber:da,ZodBigInt:fa,ZodBoolean:Gl,ZodDate:Ya,ZodSymbol:Ld,ZodUndefined:Jl,ZodNull:Kl,ZodAny:so,ZodUnknown:Ba,ZodNever:As,ZodVoid:Md,ZodArray:kr,ZodObject:mt,ZodUnion:Xl,ZodDiscriminatedUnion:Pf,ZodIntersection:Yl,ZodTuple:ss,ZodRecord:Ql,ZodMap:Dd,ZodSet:Qa,ZodFunction:Ji,ZodLazy:eu,ZodLiteral:tu,ZodEnum:ha,ZodNativeEnum:nu,ZodPromise:ao,ZodEffects:Ir,ZodTransformer:Ir,ZodOptional:Rr,ZodNullable:pa,ZodDefault:ru,ZodCatch:su,ZodNaN:Fd,BRAND:P2,ZodBranded:E_,ZodPipeline:Eu,ZodReadonly:au,custom:LC,Schema:De,ZodSchema:De,late:k2,get ZodFirstPartyTypeKind(){return Z},coerce:l4,any:j2,array:F2,bigint:T2,boolean:FC,date:A2,discriminatedUnion:H2,effect:hx,enum:Y2,function:J2,instanceof:R2,intersection:V2,lazy:K2,literal:X2,map:Z2,nan:O2,nativeEnum:Q2,never:M2,null:N2,nullable:n4,number:DC,object:U2,oboolean:o4,onumber:i4,optional:t4,ostring:a4,pipeline:s4,preprocess:r4,promise:e4,record:q2,set:G2,strictObject:z2,string:MC,symbol:$2,transformer:hx,tuple:W2,undefined:I2,union:B2,unknown:L2,void:D2,NEVER:u4,ZodIssueCode:se,quotelessJson:n2,ZodError:Vn}),bl={exports:{}},nm={},rm,px;function c4(){if(px)return rm;px=1;function n(e,t){typeof t=="boolean"&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}return rm=n,n.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},n.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},n.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=new Date().getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.push(e),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var r=this._timeouts.shift();if(r===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);else return!1;var s=this;return this._timer=setTimeout(function(){s._attempts++,s._operationTimeoutCb&&(s._timeout=setTimeout(function(){s._operationTimeoutCb(s._attempts)},s._operationTimeout),s._options.unref&&s._timeout.unref()),s._fn(s._attempts)},r),this._options.unref&&this._timer.unref(),!0},n.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},n.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},n.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},n.prototype.start=n.prototype.try,n.prototype.errors=function(){return this._errors},n.prototype.attempts=function(){return this._attempts},n.prototype.mainError=function(){if(this._errors.length===0)return null;for(var e={},t=null,r=0,s=0;s<this._errors.length;s++){var a=this._errors[s],o=a.message,u=(e[o]||0)+1;e[o]=u,u>=r&&(t=a,r=u)}return t},rm}var mx;function d4(){return mx||(mx=1,function(n){var e=c4();n.operation=function(t){var r=n.timeouts(t);return new e(r,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},n.timeouts=function(t){if(t instanceof Array)return[].concat(t);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var s in t)r[s]=t[s];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var a=[],o=0;o<r.retries;o++)a.push(this.createTimeout(o,r));return t&&t.forever&&!a.length&&a.push(this.createTimeout(o,r)),a.sort(function(u,c){return u-c}),a},n.createTimeout=function(t,r){var s=r.randomize?Math.random()+1:1,a=Math.round(s*Math.max(r.minTimeout,1)*Math.pow(r.factor,t));return a=Math.min(a,r.maxTimeout),a},n.wrap=function(t,r,s){if(r instanceof Array&&(s=r,r=null),!s){s=[];for(var a in t)typeof t[a]=="function"&&s.push(a)}for(var o=0;o<s.length;o++){var u=s[o],c=t[u];t[u]=(function(h){var m=n.operation(r),g=Array.prototype.slice.call(arguments,1),y=g.pop();g.push(function(w){m.retry(w)||(w&&(arguments[0]=m.mainError()),y.apply(this,arguments))}),m.attempt(function(){h.apply(t,g)})}).bind(t,c),t[u].options=r}}}(nm)),nm}var sm,gx;function f4(){return gx||(gx=1,sm=d4()),sm}var yx;function h4(){if(yx)return bl.exports;yx=1;const n=f4(),e=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class t extends Error{constructor(u){super(),u instanceof Error?(this.originalError=u,{message:u}=u):(this.originalError=new Error(u),this.originalError.stack=this.stack),this.name="AbortError",this.message=u}}const r=(o,u,c)=>{const f=c.retries-(u-1);return o.attemptNumber=u,o.retriesLeft=f,o},s=o=>e.includes(o),a=(o,u)=>new Promise((c,f)=>{u={onFailedAttempt:()=>{},retries:10,...u};const h=n.operation(u);h.attempt(async m=>{try{c(await o(m))}catch(g){if(!(g instanceof Error)){f(new TypeError(`Non-error was thrown: "${g}". You should only throw errors.`));return}if(g instanceof t)h.stop(),f(g.originalError);else if(g instanceof TypeError&&!s(g.message))h.stop(),f(g);else{r(g,m,u);try{await u.onFailedAttempt(g)}catch(y){f(y);return}h.retry(g)||f(h.mainError())}}})});return bl.exports=a,bl.exports.default=a,bl.exports.AbortError=t,bl.exports}var p4=h4();const Ud=ti(p4),m4=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function Nl(n){return typeof n=="string"&&m4.test(n)}var qt=[];for(var am=0;am<256;++am)qt.push((am+256).toString(16).slice(1));function g4(n,e=0){return(qt[n[e+0]]+qt[n[e+1]]+qt[n[e+2]]+qt[n[e+3]]+"-"+qt[n[e+4]]+qt[n[e+5]]+"-"+qt[n[e+6]]+qt[n[e+7]]+"-"+qt[n[e+8]]+qt[n[e+9]]+"-"+qt[n[e+10]]+qt[n[e+11]]+qt[n[e+12]]+qt[n[e+13]]+qt[n[e+14]]+qt[n[e+15]]).toLowerCase()}var Kc,y4=new Uint8Array(16);function _4(){if(!Kc&&(Kc=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Kc))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Kc(y4)}var w4=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const _x={randomUUID:w4};function sn(n,e,t){if(_x.randomUUID&&!n)return _x.randomUUID();n=n||{};var r=n.random||(n.rng||_4)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,g4(r)}var Xc={},im={exports:{}},wx;function b4(){return wx||(wx=1,function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function s(c,f,h){this.fn=c,this.context=f,this.once=h||!1}function a(c,f,h,m,g){if(typeof h!="function")throw new TypeError("The listener must be a function");var y=new s(h,m||c,g),w=t?t+f:f;return c._events[w]?c._events[w].fn?c._events[w]=[c._events[w],y]:c._events[w].push(y):(c._events[w]=y,c._eventsCount++),c}function o(c,f){--c._eventsCount===0?c._events=new r:delete c._events[f]}function u(){this._events=new r,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],h,m;if(this._eventsCount===0)return f;for(m in h=this._events)e.call(h,m)&&f.push(t?m.slice(1):m);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(h)):f},u.prototype.listeners=function(f){var h=t?t+f:f,m=this._events[h];if(!m)return[];if(m.fn)return[m.fn];for(var g=0,y=m.length,w=new Array(y);g<y;g++)w[g]=m[g].fn;return w},u.prototype.listenerCount=function(f){var h=t?t+f:f,m=this._events[h];return m?m.fn?1:m.length:0},u.prototype.emit=function(f,h,m,g,y,w){var v=t?t+f:f;if(!this._events[v])return!1;var x=this._events[v],E=arguments.length,k,S;if(x.fn){switch(x.once&&this.removeListener(f,x.fn,void 0,!0),E){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,h),!0;case 3:return x.fn.call(x.context,h,m),!0;case 4:return x.fn.call(x.context,h,m,g),!0;case 5:return x.fn.call(x.context,h,m,g,y),!0;case 6:return x.fn.call(x.context,h,m,g,y,w),!0}for(S=1,k=new Array(E-1);S<E;S++)k[S-1]=arguments[S];x.fn.apply(x.context,k)}else{var R=x.length,A;for(S=0;S<R;S++)switch(x[S].once&&this.removeListener(f,x[S].fn,void 0,!0),E){case 1:x[S].fn.call(x[S].context);break;case 2:x[S].fn.call(x[S].context,h);break;case 3:x[S].fn.call(x[S].context,h,m);break;case 4:x[S].fn.call(x[S].context,h,m,g);break;default:if(!k)for(A=1,k=new Array(E-1);A<E;A++)k[A-1]=arguments[A];x[S].fn.apply(x[S].context,k)}}return!0},u.prototype.on=function(f,h,m){return a(this,f,h,m,!1)},u.prototype.once=function(f,h,m){return a(this,f,h,m,!0)},u.prototype.removeListener=function(f,h,m,g){var y=t?t+f:f;if(!this._events[y])return this;if(!h)return o(this,y),this;var w=this._events[y];if(w.fn)w.fn===h&&(!g||w.once)&&(!m||w.context===m)&&o(this,y);else{for(var v=0,x=[],E=w.length;v<E;v++)(w[v].fn!==h||g&&!w[v].once||m&&w[v].context!==m)&&x.push(w[v]);x.length?this._events[y]=x.length===1?x[0]:x:o(this,y)}return this},u.prototype.removeAllListeners=function(f){var h;return f?(h=t?t+f:f,this._events[h]&&o(this,h)):(this._events=new r,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=t,u.EventEmitter=u,n.exports=u}(im)),im.exports}var vl={exports:{}},om,bx;function v4(){return bx||(bx=1,om=(n,e)=>(e=e||(()=>{}),n.then(t=>new Promise(r=>{r(e())}).then(()=>t),t=>new Promise(r=>{r(e())}).then(()=>{throw t})))),om}var vx;function x4(){if(vx)return vl.exports;vx=1;const n=v4();class e extends Error{constructor(s){super(s),this.name="TimeoutError"}}const t=(r,s,a)=>new Promise((o,u)=>{if(typeof s!="number"||s<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(s===1/0){o(r);return}const c=setTimeout(()=>{if(typeof a=="function"){try{o(a())}catch(m){u(m)}return}const f=typeof a=="string"?a:`Promise timed out after ${s} milliseconds`,h=a instanceof Error?a:new e(f);typeof r.cancel=="function"&&r.cancel(),u(h)},s);n(r.then(o,u),()=>{clearTimeout(c)})});return vl.exports=t,vl.exports.default=t,vl.exports.TimeoutError=e,vl.exports}var Yc={},Qc={},xx;function S4(){if(xx)return Qc;xx=1,Object.defineProperty(Qc,"__esModule",{value:!0});function n(e,t,r){let s=0,a=e.length;for(;a>0;){const o=a/2|0;let u=s+o;r(e[u],t)<=0?(s=++u,a-=o+1):a=o}return s}return Qc.default=n,Qc}var Sx;function E4(){if(Sx)return Yc;Sx=1,Object.defineProperty(Yc,"__esModule",{value:!0});const n=S4();class e{constructor(){this._queue=[]}enqueue(r,s){s=Object.assign({priority:0},s);const a={priority:s.priority,run:r};if(this.size&&this._queue[this.size-1].priority>=s.priority){this._queue.push(a);return}const o=n.default(this._queue,a,(u,c)=>c.priority-u.priority);this._queue.splice(o,0,a)}dequeue(){const r=this._queue.shift();return r==null?void 0:r.run}filter(r){return this._queue.filter(s=>s.priority===r.priority).map(s=>s.run)}get size(){return this._queue.length}}return Yc.default=e,Yc}var Ex;function C4(){if(Ex)return Xc;Ex=1,Object.defineProperty(Xc,"__esModule",{value:!0});const n=b4(),e=x4(),t=E4(),r=()=>{},s=new e.TimeoutError;class a extends n{constructor(u){var c,f,h,m;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=r,this._resolveIdle=r,u=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:t.default},u),!(typeof u.intervalCap=="number"&&u.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(f=(c=u.intervalCap)===null||c===void 0?void 0:c.toString())!==null&&f!==void 0?f:""}\` (${typeof u.intervalCap})`);if(u.interval===void 0||!(Number.isFinite(u.interval)&&u.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(m=(h=u.interval)===null||h===void 0?void 0:h.toString())!==null&&m!==void 0?m:""}\` (${typeof u.interval})`);this._carryoverConcurrencyCount=u.carryoverConcurrencyCount,this._isIntervalIgnored=u.intervalCap===1/0||u.interval===0,this._intervalCap=u.intervalCap,this._interval=u.interval,this._queue=new u.queueClass,this._queueClass=u.queueClass,this.concurrency=u.concurrency,this._timeout=u.timeout,this._throwOnTimeout=u.throwOnTimeout===!0,this._isPaused=u.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=r,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=r,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const u=Date.now();if(this._intervalId===void 0){const c=this._intervalEnd-u;if(c<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},c)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const u=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const c=this._queue.dequeue();return c?(this.emit("active"),c(),u&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(u){if(!(typeof u=="number"&&u>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${u}\` (${typeof u})`);this._concurrency=u,this._processQueue()}async add(u,c={}){return new Promise((f,h)=>{const m=async()=>{this._pendingCount++,this._intervalCount++;try{const g=this._timeout===void 0&&c.timeout===void 0?u():e.default(Promise.resolve(u()),c.timeout===void 0?this._timeout:c.timeout,()=>{(c.throwOnTimeout===void 0?this._throwOnTimeout:c.throwOnTimeout)&&h(s)});f(await g)}catch(g){h(g)}this._next()};this._queue.enqueue(m,c),this._tryToStartAnother(),this.emit("add")})}async addAll(u,c){return Promise.all(u.map(async f=>this.add(f,c)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(u=>{const c=this._resolveEmpty;this._resolveEmpty=()=>{c(),u()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(u=>{const c=this._resolveIdle;this._resolveIdle=()=>{c(),u()}})}get size(){return this._queue.size}sizeBy(u){return this._queue.filter(u).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(u){this._timeout=u}}return Xc.default=a,Xc}var P4=C4();const Rs=ti(P4),k4=(...n)=>fetch(...n),R4=Symbol.for("ls:fetch_implementation"),Pe=n=>async(...e)=>{if(n||Zr("DEBUG")==="true"){const[r,s]=e;console.log(` ${(s==null?void 0:s.method)||"GET"} ${r}`)}const t=await(globalThis[R4]??k4)(...e);return(n||Zr("DEBUG")==="true")&&console.log(` ${t.status} ${t.statusText} ${t.url}`),t},O4=[400,401,403,404,405,406,407,408],T4=[409];let Cx=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.debug=e.debug,"default"in Rs?this.queue=new Rs.default({concurrency:this.maxConcurrency}):this.queue=new Rs({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e==null?void 0:e.onFailedResponseHook}call(e,...t){const r=this.onFailedResponseHook;return this.queue.add(()=>Ud(()=>e(...t).catch(s=>{throw s instanceof Error?s:new Error(s)}),{async onFailedAttempt(s){if(s.message.startsWith("Cancel")||s.message.startsWith("TimeoutError")||s.message.startsWith("AbortError")||(s==null?void 0:s.code)==="ECONNABORTED")throw s;const a=s==null?void 0:s.response,o=a==null?void 0:a.status;if(o){if(O4.includes(+o))throw s;if(T4.includes(+o))return;r&&await r(a)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((s,a)=>{var o;(o=e.signal)==null||o.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>Pe(this.debug)(...e).then(t=>t.ok?t:Promise.reject(t)))}};function Px(n){return typeof(n==null?void 0:n._getType)=="function"}function kx(n){const e={type:n._getType(),data:{content:n.content}};return n!=null&&n.additional_kwargs&&Object.keys(n.additional_kwargs).length>0&&(e.data.additional_kwargs={...n.additional_kwargs}),e}function je(n,e){if(!Nl(n)){const t=e!==void 0?`Invalid UUID for ${e}: ${n}`:`Invalid UUID: ${n}`;throw new Error(t)}return n}const Rx={};function UC(n){Rx[n]||(console.warn(n),Rx[n]=!0)}var ed={exports:{}},lm,Ox;function kf(){if(Ox)return lm;Ox=1;const n="2.0.0",e=256,t=Number.MAX_SAFE_INTEGER||9007199254740991,r=16,s=e-6;return lm={MAX_LENGTH:e,MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:s,MAX_SAFE_INTEGER:t,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:n,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},lm}var um,Tx;function Rf(){if(Tx)return um;Tx=1;var n={};return um=typeof process=="object"&&n&&n.NODE_DEBUG&&/\bsemver\b/i.test(n.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{},um}var Ax;function Cu(){return Ax||(Ax=1,function(n,e){const{MAX_SAFE_COMPONENT_LENGTH:t,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:s}=kf(),a=Rf();e=n.exports={};const o=e.re=[],u=e.safeRe=[],c=e.src=[],f=e.safeSrc=[],h=e.t={};let m=0;const g="[a-zA-Z0-9-]",y=[["\\s",1],["\\d",s],[g,r]],w=x=>{for(const[E,k]of y)x=x.split(`${E}*`).join(`${E}{0,${k}}`).split(`${E}+`).join(`${E}{1,${k}}`);return x},v=(x,E,k)=>{const S=w(E),R=m++;a(x,R,E),h[x]=R,c[R]=E,f[R]=S,o[R]=new RegExp(E,k?"g":void 0),u[R]=new RegExp(S,k?"g":void 0)};v("NUMERICIDENTIFIER","0|[1-9]\\d*"),v("NUMERICIDENTIFIERLOOSE","\\d+"),v("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${g}*`),v("MAINVERSION",`(${c[h.NUMERICIDENTIFIER]})\\.(${c[h.NUMERICIDENTIFIER]})\\.(${c[h.NUMERICIDENTIFIER]})`),v("MAINVERSIONLOOSE",`(${c[h.NUMERICIDENTIFIERLOOSE]})\\.(${c[h.NUMERICIDENTIFIERLOOSE]})\\.(${c[h.NUMERICIDENTIFIERLOOSE]})`),v("PRERELEASEIDENTIFIER",`(?:${c[h.NUMERICIDENTIFIER]}|${c[h.NONNUMERICIDENTIFIER]})`),v("PRERELEASEIDENTIFIERLOOSE",`(?:${c[h.NUMERICIDENTIFIERLOOSE]}|${c[h.NONNUMERICIDENTIFIER]})`),v("PRERELEASE",`(?:-(${c[h.PRERELEASEIDENTIFIER]}(?:\\.${c[h.PRERELEASEIDENTIFIER]})*))`),v("PRERELEASELOOSE",`(?:-?(${c[h.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${c[h.PRERELEASEIDENTIFIERLOOSE]})*))`),v("BUILDIDENTIFIER",`${g}+`),v("BUILD",`(?:\\+(${c[h.BUILDIDENTIFIER]}(?:\\.${c[h.BUILDIDENTIFIER]})*))`),v("FULLPLAIN",`v?${c[h.MAINVERSION]}${c[h.PRERELEASE]}?${c[h.BUILD]}?`),v("FULL",`^${c[h.FULLPLAIN]}$`),v("LOOSEPLAIN",`[v=\\s]*${c[h.MAINVERSIONLOOSE]}${c[h.PRERELEASELOOSE]}?${c[h.BUILD]}?`),v("LOOSE",`^${c[h.LOOSEPLAIN]}$`),v("GTLT","((?:<|>)?=?)"),v("XRANGEIDENTIFIERLOOSE",`${c[h.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),v("XRANGEIDENTIFIER",`${c[h.NUMERICIDENTIFIER]}|x|X|\\*`),v("XRANGEPLAIN",`[v=\\s]*(${c[h.XRANGEIDENTIFIER]})(?:\\.(${c[h.XRANGEIDENTIFIER]})(?:\\.(${c[h.XRANGEIDENTIFIER]})(?:${c[h.PRERELEASE]})?${c[h.BUILD]}?)?)?`),v("XRANGEPLAINLOOSE",`[v=\\s]*(${c[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[h.XRANGEIDENTIFIERLOOSE]})(?:\\.(${c[h.XRANGEIDENTIFIERLOOSE]})(?:${c[h.PRERELEASELOOSE]})?${c[h.BUILD]}?)?)?`),v("XRANGE",`^${c[h.GTLT]}\\s*${c[h.XRANGEPLAIN]}$`),v("XRANGELOOSE",`^${c[h.GTLT]}\\s*${c[h.XRANGEPLAINLOOSE]}$`),v("COERCEPLAIN",`(^|[^\\d])(\\d{1,${t}})(?:\\.(\\d{1,${t}}))?(?:\\.(\\d{1,${t}}))?`),v("COERCE",`${c[h.COERCEPLAIN]}(?:$|[^\\d])`),v("COERCEFULL",c[h.COERCEPLAIN]+`(?:${c[h.PRERELEASE]})?(?:${c[h.BUILD]})?(?:$|[^\\d])`),v("COERCERTL",c[h.COERCE],!0),v("COERCERTLFULL",c[h.COERCEFULL],!0),v("LONETILDE","(?:~>?)"),v("TILDETRIM",`(\\s*)${c[h.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",v("TILDE",`^${c[h.LONETILDE]}${c[h.XRANGEPLAIN]}$`),v("TILDELOOSE",`^${c[h.LONETILDE]}${c[h.XRANGEPLAINLOOSE]}$`),v("LONECARET","(?:\\^)"),v("CARETTRIM",`(\\s*)${c[h.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",v("CARET",`^${c[h.LONECARET]}${c[h.XRANGEPLAIN]}$`),v("CARETLOOSE",`^${c[h.LONECARET]}${c[h.XRANGEPLAINLOOSE]}$`),v("COMPARATORLOOSE",`^${c[h.GTLT]}\\s*(${c[h.LOOSEPLAIN]})$|^$`),v("COMPARATOR",`^${c[h.GTLT]}\\s*(${c[h.FULLPLAIN]})$|^$`),v("COMPARATORTRIM",`(\\s*)${c[h.GTLT]}\\s*(${c[h.LOOSEPLAIN]}|${c[h.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",v("HYPHENRANGE",`^\\s*(${c[h.XRANGEPLAIN]})\\s+-\\s+(${c[h.XRANGEPLAIN]})\\s*$`),v("HYPHENRANGELOOSE",`^\\s*(${c[h.XRANGEPLAINLOOSE]})\\s+-\\s+(${c[h.XRANGEPLAINLOOSE]})\\s*$`),v("STAR","(<|>)?=?\\s*\\*"),v("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),v("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(ed,ed.exports)),ed.exports}var cm,$x;function C_(){if($x)return cm;$x=1;const n=Object.freeze({loose:!0}),e=Object.freeze({});return cm=r=>r?typeof r!="object"?n:r:e,cm}var dm,Ix;function zC(){if(Ix)return dm;Ix=1;const n=/^[0-9]+$/,e=(r,s)=>{const a=n.test(r),o=n.test(s);return a&&o&&(r=+r,s=+s),r===s?0:a&&!o?-1:o&&!a?1:r<s?-1:1};return dm={compareIdentifiers:e,rcompareIdentifiers:(r,s)=>e(s,r)},dm}var fm,Nx;function bn(){if(Nx)return fm;Nx=1;const n=Rf(),{MAX_LENGTH:e,MAX_SAFE_INTEGER:t}=kf(),{safeRe:r,safeSrc:s,t:a}=Cu(),o=C_(),{compareIdentifiers:u}=zC();class c{constructor(h,m){if(m=o(m),h instanceof c){if(h.loose===!!m.loose&&h.includePrerelease===!!m.includePrerelease)return h;h=h.version}else if(typeof h!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof h}".`);if(h.length>e)throw new TypeError(`version is longer than ${e} characters`);n("SemVer",h,m),this.options=m,this.loose=!!m.loose,this.includePrerelease=!!m.includePrerelease;const g=h.trim().match(m.loose?r[a.LOOSE]:r[a.FULL]);if(!g)throw new TypeError(`Invalid Version: ${h}`);if(this.raw=h,this.major=+g[1],this.minor=+g[2],this.patch=+g[3],this.major>t||this.major<0)throw new TypeError("Invalid major version");if(this.minor>t||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>t||this.patch<0)throw new TypeError("Invalid patch version");g[4]?this.prerelease=g[4].split(".").map(y=>{if(/^[0-9]+$/.test(y)){const w=+y;if(w>=0&&w<t)return w}return y}):this.prerelease=[],this.build=g[5]?g[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(h){if(n("SemVer.compare",this.version,this.options,h),!(h instanceof c)){if(typeof h=="string"&&h===this.version)return 0;h=new c(h,this.options)}return h.version===this.version?0:this.compareMain(h)||this.comparePre(h)}compareMain(h){return h instanceof c||(h=new c(h,this.options)),u(this.major,h.major)||u(this.minor,h.minor)||u(this.patch,h.patch)}comparePre(h){if(h instanceof c||(h=new c(h,this.options)),this.prerelease.length&&!h.prerelease.length)return-1;if(!this.prerelease.length&&h.prerelease.length)return 1;if(!this.prerelease.length&&!h.prerelease.length)return 0;let m=0;do{const g=this.prerelease[m],y=h.prerelease[m];if(n("prerelease compare",m,g,y),g===void 0&&y===void 0)return 0;if(y===void 0)return 1;if(g===void 0)return-1;if(g===y)continue;return u(g,y)}while(++m)}compareBuild(h){h instanceof c||(h=new c(h,this.options));let m=0;do{const g=this.build[m],y=h.build[m];if(n("build compare",m,g,y),g===void 0&&y===void 0)return 0;if(y===void 0)return 1;if(g===void 0)return-1;if(g===y)continue;return u(g,y)}while(++m)}inc(h,m,g){if(h.startsWith("pre")){if(!m&&g===!1)throw new Error("invalid increment argument: identifier is empty");if(m){const y=new RegExp(`^${this.options.loose?s[a.PRERELEASELOOSE]:s[a.PRERELEASE]}$`),w=`-${m}`.match(y);if(!w||w[1]!==m)throw new Error(`invalid identifier: ${m}`)}}switch(h){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",m,g);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",m,g);break;case"prepatch":this.prerelease.length=0,this.inc("patch",m,g),this.inc("pre",m,g);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",m,g),this.inc("pre",m,g);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const y=Number(g)?1:0;if(this.prerelease.length===0)this.prerelease=[y];else{let w=this.prerelease.length;for(;--w>=0;)typeof this.prerelease[w]=="number"&&(this.prerelease[w]++,w=-2);if(w===-1){if(m===this.prerelease.join(".")&&g===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(y)}}if(m){let w=[m,y];g===!1&&(w=[m]),u(this.prerelease[0],m)===0?isNaN(this.prerelease[1])&&(this.prerelease=w):this.prerelease=w}break}default:throw new Error(`invalid increment argument: ${h}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}}return fm=c,fm}var hm,jx;function vo(){if(jx)return hm;jx=1;const n=bn();return hm=(t,r,s=!1)=>{if(t instanceof n)return t;try{return new n(t,r)}catch(a){if(!s)return null;throw a}},hm}var pm,Lx;function A4(){if(Lx)return pm;Lx=1;const n=vo();return pm=(t,r)=>{const s=n(t,r);return s?s.version:null},pm}var mm,Mx;function $4(){if(Mx)return mm;Mx=1;const n=vo();return mm=(t,r)=>{const s=n(t.trim().replace(/^[=v]+/,""),r);return s?s.version:null},mm}var gm,Dx;function I4(){if(Dx)return gm;Dx=1;const n=bn();return gm=(t,r,s,a,o)=>{typeof s=="string"&&(o=a,a=s,s=void 0);try{return new n(t instanceof n?t.version:t,s).inc(r,a,o).version}catch{return null}},gm}var ym,Fx;function N4(){if(Fx)return ym;Fx=1;const n=vo();return ym=(t,r)=>{const s=n(t,null,!0),a=n(r,null,!0),o=s.compare(a);if(o===0)return null;const u=o>0,c=u?s:a,f=u?a:s,h=!!c.prerelease.length;if(!!f.prerelease.length&&!h){if(!f.patch&&!f.minor)return"major";if(f.compareMain(c)===0)return f.minor&&!f.patch?"minor":"patch"}const g=h?"pre":"";return s.major!==a.major?g+"major":s.minor!==a.minor?g+"minor":s.patch!==a.patch?g+"patch":"prerelease"},ym}var _m,Ux;function j4(){if(Ux)return _m;Ux=1;const n=bn();return _m=(t,r)=>new n(t,r).major,_m}var wm,zx;function L4(){if(zx)return wm;zx=1;const n=bn();return wm=(t,r)=>new n(t,r).minor,wm}var bm,Bx;function M4(){if(Bx)return bm;Bx=1;const n=bn();return bm=(t,r)=>new n(t,r).patch,bm}var vm,Hx;function D4(){if(Hx)return vm;Hx=1;const n=vo();return vm=(t,r)=>{const s=n(t,r);return s&&s.prerelease.length?s.prerelease:null},vm}var xm,Vx;function Lr(){if(Vx)return xm;Vx=1;const n=bn();return xm=(t,r,s)=>new n(t,s).compare(new n(r,s)),xm}var Sm,Wx;function F4(){if(Wx)return Sm;Wx=1;const n=Lr();return Sm=(t,r,s)=>n(r,t,s),Sm}var Em,qx;function U4(){if(qx)return Em;qx=1;const n=Lr();return Em=(t,r)=>n(t,r,!0),Em}var Cm,Zx;function P_(){if(Zx)return Cm;Zx=1;const n=bn();return Cm=(t,r,s)=>{const a=new n(t,s),o=new n(r,s);return a.compare(o)||a.compareBuild(o)},Cm}var Pm,Gx;function z4(){if(Gx)return Pm;Gx=1;const n=P_();return Pm=(t,r)=>t.sort((s,a)=>n(s,a,r)),Pm}var km,Jx;function B4(){if(Jx)return km;Jx=1;const n=P_();return km=(t,r)=>t.sort((s,a)=>n(a,s,r)),km}var Rm,Kx;function Of(){if(Kx)return Rm;Kx=1;const n=Lr();return Rm=(t,r,s)=>n(t,r,s)>0,Rm}var Om,Xx;function k_(){if(Xx)return Om;Xx=1;const n=Lr();return Om=(t,r,s)=>n(t,r,s)<0,Om}var Tm,Yx;function BC(){if(Yx)return Tm;Yx=1;const n=Lr();return Tm=(t,r,s)=>n(t,r,s)===0,Tm}var Am,Qx;function HC(){if(Qx)return Am;Qx=1;const n=Lr();return Am=(t,r,s)=>n(t,r,s)!==0,Am}var $m,eS;function R_(){if(eS)return $m;eS=1;const n=Lr();return $m=(t,r,s)=>n(t,r,s)>=0,$m}var Im,tS;function O_(){if(tS)return Im;tS=1;const n=Lr();return Im=(t,r,s)=>n(t,r,s)<=0,Im}var Nm,nS;function VC(){if(nS)return Nm;nS=1;const n=BC(),e=HC(),t=Of(),r=R_(),s=k_(),a=O_();return Nm=(u,c,f,h)=>{switch(c){case"===":return typeof u=="object"&&(u=u.version),typeof f=="object"&&(f=f.version),u===f;case"!==":return typeof u=="object"&&(u=u.version),typeof f=="object"&&(f=f.version),u!==f;case"":case"=":case"==":return n(u,f,h);case"!=":return e(u,f,h);case">":return t(u,f,h);case">=":return r(u,f,h);case"<":return s(u,f,h);case"<=":return a(u,f,h);default:throw new TypeError(`Invalid operator: ${c}`)}},Nm}var jm,rS;function H4(){if(rS)return jm;rS=1;const n=bn(),e=vo(),{safeRe:t,t:r}=Cu();return jm=(a,o)=>{if(a instanceof n)return a;if(typeof a=="number"&&(a=String(a)),typeof a!="string")return null;o=o||{};let u=null;if(!o.rtl)u=a.match(o.includePrerelease?t[r.COERCEFULL]:t[r.COERCE]);else{const y=o.includePrerelease?t[r.COERCERTLFULL]:t[r.COERCERTL];let w;for(;(w=y.exec(a))&&(!u||u.index+u[0].length!==a.length);)(!u||w.index+w[0].length!==u.index+u[0].length)&&(u=w),y.lastIndex=w.index+w[1].length+w[2].length;y.lastIndex=-1}if(u===null)return null;const c=u[2],f=u[3]||"0",h=u[4]||"0",m=o.includePrerelease&&u[5]?`-${u[5]}`:"",g=o.includePrerelease&&u[6]?`+${u[6]}`:"";return e(`${c}.${f}.${h}${m}${g}`,o)},jm}var Lm,sS;function V4(){if(sS)return Lm;sS=1;class n{constructor(){this.max=1e3,this.map=new Map}get(t){const r=this.map.get(t);if(r!==void 0)return this.map.delete(t),this.map.set(t,r),r}delete(t){return this.map.delete(t)}set(t,r){if(!this.delete(t)&&r!==void 0){if(this.map.size>=this.max){const a=this.map.keys().next().value;this.delete(a)}this.map.set(t,r)}return this}}return Lm=n,Lm}var Mm,aS;function Mr(){if(aS)return Mm;aS=1;const n=/\s+/g;class e{constructor(G,q){if(q=s(q),G instanceof e)return G.loose===!!q.loose&&G.includePrerelease===!!q.includePrerelease?G:new e(G.raw,q);if(G instanceof a)return this.raw=G.value,this.set=[[G]],this.formatted=void 0,this;if(this.options=q,this.loose=!!q.loose,this.includePrerelease=!!q.includePrerelease,this.raw=G.trim().replace(n," "),this.set=this.raw.split("||").map(J=>this.parseRange(J.trim())).filter(J=>J.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const J=this.set[0];if(this.set=this.set.filter(j=>!v(j[0])),this.set.length===0)this.set=[J];else if(this.set.length>1){for(const j of this.set)if(j.length===1&&x(j[0])){this.set=[j];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let G=0;G<this.set.length;G++){G>0&&(this.formatted+="||");const q=this.set[G];for(let J=0;J<q.length;J++)J>0&&(this.formatted+=" "),this.formatted+=q[J].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(G){const J=((this.options.includePrerelease&&y)|(this.options.loose&&w))+":"+G,j=r.get(J);if(j)return j;const B=this.options.loose,V=B?c[f.HYPHENRANGELOOSE]:c[f.HYPHENRANGE];G=G.replace(V,he(this.options.includePrerelease)),o("hyphen replace",G),G=G.replace(c[f.COMPARATORTRIM],h),o("comparator trim",G),G=G.replace(c[f.TILDETRIM],m),o("tilde trim",G),G=G.replace(c[f.CARETTRIM],g),o("caret trim",G);let $=G.split(" ").map(de=>k(de,this.options)).join(" ").split(/\s+/).map(de=>ae(de,this.options));B&&($=$.filter(de=>(o("loose invalid filter",de,this.options),!!de.match(c[f.COMPARATORLOOSE])))),o("range list",$);const U=new Map,re=$.map(de=>new a(de,this.options));for(const de of re){if(v(de))return[de];U.set(de.value,de)}U.size>1&&U.has("")&&U.delete("");const pe=[...U.values()];return r.set(J,pe),pe}intersects(G,q){if(!(G instanceof e))throw new TypeError("a Range is required");return this.set.some(J=>E(J,q)&&G.set.some(j=>E(j,q)&&J.every(B=>j.every(V=>B.intersects(V,q)))))}test(G){if(!G)return!1;if(typeof G=="string")try{G=new u(G,this.options)}catch{return!1}for(let q=0;q<this.set.length;q++)if(ce(this.set[q],G,this.options))return!0;return!1}}Mm=e;const t=V4(),r=new t,s=C_(),a=Tf(),o=Rf(),u=bn(),{safeRe:c,t:f,comparatorTrimReplace:h,tildeTrimReplace:m,caretTrimReplace:g}=Cu(),{FLAG_INCLUDE_PRERELEASE:y,FLAG_LOOSE:w}=kf(),v=W=>W.value==="<0.0.0-0",x=W=>W.value==="",E=(W,G)=>{let q=!0;const J=W.slice();let j=J.pop();for(;q&&J.length;)q=J.every(B=>j.intersects(B,G)),j=J.pop();return q},k=(W,G)=>(o("comp",W,G),W=I(W,G),o("caret",W),W=R(W,G),o("tildes",W),W=D(W,G),o("xrange",W),W=X(W,G),o("stars",W),W),S=W=>!W||W.toLowerCase()==="x"||W==="*",R=(W,G)=>W.trim().split(/\s+/).map(q=>A(q,G)).join(" "),A=(W,G)=>{const q=G.loose?c[f.TILDELOOSE]:c[f.TILDE];return W.replace(q,(J,j,B,V,$)=>{o("tilde",W,J,j,B,V,$);let U;return S(j)?U="":S(B)?U=`>=${j}.0.0 <${+j+1}.0.0-0`:S(V)?U=`>=${j}.${B}.0 <${j}.${+B+1}.0-0`:$?(o("replaceTilde pr",$),U=`>=${j}.${B}.${V}-${$} <${j}.${+B+1}.0-0`):U=`>=${j}.${B}.${V} <${j}.${+B+1}.0-0`,o("tilde return",U),U})},I=(W,G)=>W.trim().split(/\s+/).map(q=>M(q,G)).join(" "),M=(W,G)=>{o("caret",W,G);const q=G.loose?c[f.CARETLOOSE]:c[f.CARET],J=G.includePrerelease?"-0":"";return W.replace(q,(j,B,V,$,U)=>{o("caret",W,j,B,V,$,U);let re;return S(B)?re="":S(V)?re=`>=${B}.0.0${J} <${+B+1}.0.0-0`:S($)?B==="0"?re=`>=${B}.${V}.0${J} <${B}.${+V+1}.0-0`:re=`>=${B}.${V}.0${J} <${+B+1}.0.0-0`:U?(o("replaceCaret pr",U),B==="0"?V==="0"?re=`>=${B}.${V}.${$}-${U} <${B}.${V}.${+$+1}-0`:re=`>=${B}.${V}.${$}-${U} <${B}.${+V+1}.0-0`:re=`>=${B}.${V}.${$}-${U} <${+B+1}.0.0-0`):(o("no pr"),B==="0"?V==="0"?re=`>=${B}.${V}.${$}${J} <${B}.${V}.${+$+1}-0`:re=`>=${B}.${V}.${$}${J} <${B}.${+V+1}.0-0`:re=`>=${B}.${V}.${$} <${+B+1}.0.0-0`),o("caret return",re),re})},D=(W,G)=>(o("replaceXRanges",W,G),W.split(/\s+/).map(q=>K(q,G)).join(" ")),K=(W,G)=>{W=W.trim();const q=G.loose?c[f.XRANGELOOSE]:c[f.XRANGE];return W.replace(q,(J,j,B,V,$,U)=>{o("xRange",W,J,j,B,V,$,U);const re=S(B),pe=re||S(V),de=pe||S($),Y=de;return j==="="&&Y&&(j=""),U=G.includePrerelease?"-0":"",re?j===">"||j==="<"?J="<0.0.0-0":J="*":j&&Y?(pe&&(V=0),$=0,j===">"?(j=">=",pe?(B=+B+1,V=0,$=0):(V=+V+1,$=0)):j==="<="&&(j="<",pe?B=+B+1:V=+V+1),j==="<"&&(U="-0"),J=`${j+B}.${V}.${$}${U}`):pe?J=`>=${B}.0.0${U} <${+B+1}.0.0-0`:de&&(J=`>=${B}.${V}.0${U} <${B}.${+V+1}.0-0`),o("xRange return",J),J})},X=(W,G)=>(o("replaceStars",W,G),W.trim().replace(c[f.STAR],"")),ae=(W,G)=>(o("replaceGTE0",W,G),W.trim().replace(c[G.includePrerelease?f.GTE0PRE:f.GTE0],"")),he=W=>(G,q,J,j,B,V,$,U,re,pe,de,Y)=>(S(J)?q="":S(j)?q=`>=${J}.0.0${W?"-0":""}`:S(B)?q=`>=${J}.${j}.0${W?"-0":""}`:V?q=`>=${q}`:q=`>=${q}${W?"-0":""}`,S(re)?U="":S(pe)?U=`<${+re+1}.0.0-0`:S(de)?U=`<${re}.${+pe+1}.0-0`:Y?U=`<=${re}.${pe}.${de}-${Y}`:W?U=`<${re}.${pe}.${+de+1}-0`:U=`<=${U}`,`${q} ${U}`.trim()),ce=(W,G,q)=>{for(let J=0;J<W.length;J++)if(!W[J].test(G))return!1;if(G.prerelease.length&&!q.includePrerelease){for(let J=0;J<W.length;J++)if(o(W[J].semver),W[J].semver!==a.ANY&&W[J].semver.prerelease.length>0){const j=W[J].semver;if(j.major===G.major&&j.minor===G.minor&&j.patch===G.patch)return!0}return!1}return!0};return Mm}var Dm,iS;function Tf(){if(iS)return Dm;iS=1;const n=Symbol("SemVer ANY");class e{static get ANY(){return n}constructor(h,m){if(m=t(m),h instanceof e){if(h.loose===!!m.loose)return h;h=h.value}h=h.trim().split(/\s+/).join(" "),o("comparator",h,m),this.options=m,this.loose=!!m.loose,this.parse(h),this.semver===n?this.value="":this.value=this.operator+this.semver.version,o("comp",this)}parse(h){const m=this.options.loose?r[s.COMPARATORLOOSE]:r[s.COMPARATOR],g=h.match(m);if(!g)throw new TypeError(`Invalid comparator: ${h}`);this.operator=g[1]!==void 0?g[1]:"",this.operator==="="&&(this.operator=""),g[2]?this.semver=new u(g[2],this.options.loose):this.semver=n}toString(){return this.value}test(h){if(o("Comparator.test",h,this.options.loose),this.semver===n||h===n)return!0;if(typeof h=="string")try{h=new u(h,this.options)}catch{return!1}return a(h,this.operator,this.semver,this.options)}intersects(h,m){if(!(h instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new c(h.value,m).test(this.value):h.operator===""?h.value===""?!0:new c(this.value,m).test(h.semver):(m=t(m),m.includePrerelease&&(this.value==="<0.0.0-0"||h.value==="<0.0.0-0")||!m.includePrerelease&&(this.value.startsWith("<0.0.0")||h.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&h.operator.startsWith(">")||this.operator.startsWith("<")&&h.operator.startsWith("<")||this.semver.version===h.semver.version&&this.operator.includes("=")&&h.operator.includes("=")||a(this.semver,"<",h.semver,m)&&this.operator.startsWith(">")&&h.operator.startsWith("<")||a(this.semver,">",h.semver,m)&&this.operator.startsWith("<")&&h.operator.startsWith(">")))}}Dm=e;const t=C_(),{safeRe:r,t:s}=Cu(),a=VC(),o=Rf(),u=bn(),c=Mr();return Dm}var Fm,oS;function Af(){if(oS)return Fm;oS=1;const n=Mr();return Fm=(t,r,s)=>{try{r=new n(r,s)}catch{return!1}return r.test(t)},Fm}var Um,lS;function W4(){if(lS)return Um;lS=1;const n=Mr();return Um=(t,r)=>new n(t,r).set.map(s=>s.map(a=>a.value).join(" ").trim().split(" ")),Um}var zm,uS;function q4(){if(uS)return zm;uS=1;const n=bn(),e=Mr();return zm=(r,s,a)=>{let o=null,u=null,c=null;try{c=new e(s,a)}catch{return null}return r.forEach(f=>{c.test(f)&&(!o||u.compare(f)===-1)&&(o=f,u=new n(o,a))}),o},zm}var Bm,cS;function Z4(){if(cS)return Bm;cS=1;const n=bn(),e=Mr();return Bm=(r,s,a)=>{let o=null,u=null,c=null;try{c=new e(s,a)}catch{return null}return r.forEach(f=>{c.test(f)&&(!o||u.compare(f)===1)&&(o=f,u=new n(o,a))}),o},Bm}var Hm,dS;function G4(){if(dS)return Hm;dS=1;const n=bn(),e=Mr(),t=Of();return Hm=(s,a)=>{s=new e(s,a);let o=new n("0.0.0");if(s.test(o)||(o=new n("0.0.0-0"),s.test(o)))return o;o=null;for(let u=0;u<s.set.length;++u){const c=s.set[u];let f=null;c.forEach(h=>{const m=new n(h.semver.version);switch(h.operator){case">":m.prerelease.length===0?m.patch++:m.prerelease.push(0),m.raw=m.format();case"":case">=":(!f||t(m,f))&&(f=m);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${h.operator}`)}}),f&&(!o||t(o,f))&&(o=f)}return o&&s.test(o)?o:null},Hm}var Vm,fS;function J4(){if(fS)return Vm;fS=1;const n=Mr();return Vm=(t,r)=>{try{return new n(t,r).range||"*"}catch{return null}},Vm}var Wm,hS;function T_(){if(hS)return Wm;hS=1;const n=bn(),e=Tf(),{ANY:t}=e,r=Mr(),s=Af(),a=Of(),o=k_(),u=O_(),c=R_();return Wm=(h,m,g,y)=>{h=new n(h,y),m=new r(m,y);let w,v,x,E,k;switch(g){case">":w=a,v=u,x=o,E=">",k=">=";break;case"<":w=o,v=c,x=a,E="<",k="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(s(h,m,y))return!1;for(let S=0;S<m.set.length;++S){const R=m.set[S];let A=null,I=null;if(R.forEach(M=>{M.semver===t&&(M=new e(">=0.0.0")),A=A||M,I=I||M,w(M.semver,A.semver,y)?A=M:x(M.semver,I.semver,y)&&(I=M)}),A.operator===E||A.operator===k||(!I.operator||I.operator===E)&&v(h,I.semver))return!1;if(I.operator===k&&x(h,I.semver))return!1}return!0},Wm}var qm,pS;function K4(){if(pS)return qm;pS=1;const n=T_();return qm=(t,r,s)=>n(t,r,">",s),qm}var Zm,mS;function X4(){if(mS)return Zm;mS=1;const n=T_();return Zm=(t,r,s)=>n(t,r,"<",s),Zm}var Gm,gS;function Y4(){if(gS)return Gm;gS=1;const n=Mr();return Gm=(t,r,s)=>(t=new n(t,s),r=new n(r,s),t.intersects(r,s)),Gm}var Jm,yS;function Q4(){if(yS)return Jm;yS=1;const n=Af(),e=Lr();return Jm=(t,r,s)=>{const a=[];let o=null,u=null;const c=t.sort((g,y)=>e(g,y,s));for(const g of c)n(g,r,s)?(u=g,o||(o=g)):(u&&a.push([o,u]),u=null,o=null);o&&a.push([o,null]);const f=[];for(const[g,y]of a)g===y?f.push(g):!y&&g===c[0]?f.push("*"):y?g===c[0]?f.push(`<=${y}`):f.push(`${g} - ${y}`):f.push(`>=${g}`);const h=f.join(" || "),m=typeof r.raw=="string"?r.raw:String(r);return h.length<m.length?h:r},Jm}var Km,_S;function e3(){if(_S)return Km;_S=1;const n=Mr(),e=Tf(),{ANY:t}=e,r=Af(),s=Lr(),a=(m,g,y={})=>{if(m===g)return!0;m=new n(m,y),g=new n(g,y);let w=!1;e:for(const v of m.set){for(const x of g.set){const E=c(v,x,y);if(w=w||E!==null,E)continue e}if(w)return!1}return!0},o=[new e(">=0.0.0-0")],u=[new e(">=0.0.0")],c=(m,g,y)=>{if(m===g)return!0;if(m.length===1&&m[0].semver===t){if(g.length===1&&g[0].semver===t)return!0;y.includePrerelease?m=o:m=u}if(g.length===1&&g[0].semver===t){if(y.includePrerelease)return!0;g=u}const w=new Set;let v,x;for(const D of m)D.operator===">"||D.operator===">="?v=f(v,D,y):D.operator==="<"||D.operator==="<="?x=h(x,D,y):w.add(D.semver);if(w.size>1)return null;let E;if(v&&x){if(E=s(v.semver,x.semver,y),E>0)return null;if(E===0&&(v.operator!==">="||x.operator!=="<="))return null}for(const D of w){if(v&&!r(D,String(v),y)||x&&!r(D,String(x),y))return null;for(const K of g)if(!r(D,String(K),y))return!1;return!0}let k,S,R,A,I=x&&!y.includePrerelease&&x.semver.prerelease.length?x.semver:!1,M=v&&!y.includePrerelease&&v.semver.prerelease.length?v.semver:!1;I&&I.prerelease.length===1&&x.operator==="<"&&I.prerelease[0]===0&&(I=!1);for(const D of g){if(A=A||D.operator===">"||D.operator===">=",R=R||D.operator==="<"||D.operator==="<=",v){if(M&&D.semver.prerelease&&D.semver.prerelease.length&&D.semver.major===M.major&&D.semver.minor===M.minor&&D.semver.patch===M.patch&&(M=!1),D.operator===">"||D.operator===">="){if(k=f(v,D,y),k===D&&k!==v)return!1}else if(v.operator===">="&&!r(v.semver,String(D),y))return!1}if(x){if(I&&D.semver.prerelease&&D.semver.prerelease.length&&D.semver.major===I.major&&D.semver.minor===I.minor&&D.semver.patch===I.patch&&(I=!1),D.operator==="<"||D.operator==="<="){if(S=h(x,D,y),S===D&&S!==x)return!1}else if(x.operator==="<="&&!r(x.semver,String(D),y))return!1}if(!D.operator&&(x||v)&&E!==0)return!1}return!(v&&R&&!x&&E!==0||x&&A&&!v&&E!==0||M||I)},f=(m,g,y)=>{if(!m)return g;const w=s(m.semver,g.semver,y);return w>0?m:w<0||g.operator===">"&&m.operator===">="?g:m},h=(m,g,y)=>{if(!m)return g;const w=s(m.semver,g.semver,y);return w<0?m:w>0||g.operator==="<"&&m.operator==="<="?g:m};return Km=a,Km}var Xm,wS;function t3(){if(wS)return Xm;wS=1;const n=Cu(),e=kf(),t=bn(),r=zC(),s=vo(),a=A4(),o=$4(),u=I4(),c=N4(),f=j4(),h=L4(),m=M4(),g=D4(),y=Lr(),w=F4(),v=U4(),x=P_(),E=z4(),k=B4(),S=Of(),R=k_(),A=BC(),I=HC(),M=R_(),D=O_(),K=VC(),X=H4(),ae=Tf(),he=Mr(),ce=Af(),W=W4(),G=q4(),q=Z4(),J=G4(),j=J4(),B=T_(),V=K4(),$=X4(),U=Y4(),re=Q4(),pe=e3();return Xm={parse:s,valid:a,clean:o,inc:u,diff:c,major:f,minor:h,patch:m,prerelease:g,compare:y,rcompare:w,compareLoose:v,compareBuild:x,sort:E,rsort:k,gt:S,lt:R,eq:A,neq:I,gte:M,lte:D,cmp:K,coerce:X,Comparator:ae,Range:he,satisfies:ce,toComparators:W,maxSatisfying:G,minSatisfying:q,minVersion:J,validRange:j,outside:B,gtr:V,ltr:$,intersects:U,simplifyRange:re,subset:pe,SemVer:t,re:n.re,src:n.src,tokens:n.t,SEMVER_SPEC_VERSION:e.SEMVER_SPEC_VERSION,RELEASE_TYPES:e.RELEASE_TYPES,compareIdentifiers:r.compareIdentifiers,rcompareIdentifiers:r.rcompareIdentifiers},Xm}t3();function ta(n){if(!n||n.split("/").length>2||n.startsWith("/")||n.endsWith("/")||n.split(":").length>2)throw new Error(`Invalid identifier format: ${n}`);const[e,t]=n.split(":"),r=t||"latest";if(e.includes("/")){const[s,a]=e.split("/",2);if(!s||!a)throw new Error(`Invalid identifier format: ${n}`);return[s,a,r]}else{if(!e)throw new Error(`Invalid identifier format: ${n}`);return["-",e,r]}}class n3 extends Error{constructor(e){super(e),this.name="LangSmithConflictError"}}async function Ue(n,e,t){let r;if(n.ok){t&&(r=await n.text());return}r=await n.text();const s=`Failed to ${e}. Received status [${n.status}]: ${n.statusText}. Server response: ${r}`;throw n.status===409?new n3(s):new Error(s)}var bS="[...]",r3={result:"[Circular]"},zd=[],Vi=[];const s3=new TextEncoder;function a3(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function td(n){return s3.encode(n)}function Dn(n,e,t,r){var s;try{const a=JSON.stringify(n,e,t);return td(a)}catch(a){if(!((s=a.message)!=null&&s.includes("Converting circular structure to JSON")))return console.warn("[WARNING]: LangSmith received unserializable value."),td("[Unserializable]");console.warn("[WARNING]: LangSmith received circular JSON. This will decrease tracer performance."),typeof r>"u"&&(r=a3()),Gg(n,"",0,[],void 0,0,r);let o;try{Vi.length===0?o=JSON.stringify(n,e,t):o=JSON.stringify(n,i3(e),t)}catch{return td("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;zd.length!==0;){const u=zd.pop();u.length===4?Object.defineProperty(u[0],u[1],u[3]):u[0][u[1]]=u[2]}}return td(o)}}function Ym(n,e,t,r){var s=Object.getOwnPropertyDescriptor(r,t);s.get!==void 0?s.configurable?(Object.defineProperty(r,t,{value:n}),zd.push([r,t,e,s])):Vi.push([e,t,n]):(r[t]=n,zd.push([r,t,e]))}function Gg(n,e,t,r,s,a,o){a+=1;var u;if(typeof n=="object"&&n!==null){for(u=0;u<r.length;u++)if(r[u]===n){Ym(r3,n,e,s);return}if(typeof o.depthLimit<"u"&&a>o.depthLimit){Ym(bS,n,e,s);return}if(typeof o.edgesLimit<"u"&&t+1>o.edgesLimit){Ym(bS,n,e,s);return}if(r.push(n),Array.isArray(n))for(u=0;u<n.length;u++)Gg(n[u],u,u,r,n,a,o);else{var c=Object.keys(n);for(u=0;u<c.length;u++){var f=c[u];Gg(n[f],f,u,r,n,a,o)}}r.pop()}}function i3(n){return n=typeof n<"u"?n:function(e,t){return t},function(e,t){if(Vi.length>0)for(var r=0;r<Vi.length;r++){var s=Vi[r];if(s[1]===e&&s[0]===t){t=s[2],Vi.splice(r,1);break}}return n.call(this,e,t)}}function vS(n){const e=ZC(),t=w3(),r=n.extra??{},s=r.metadata;return n.extra={...r,runtime:{...e,...r==null?void 0:r.runtime},metadata:{...t,...t.revision_id||n.revision_id?{revision_id:n.revision_id??t.revision_id}:{},...s}},n}const o3=n=>{const e=(n==null?void 0:n.toString())??Zr("TRACING_SAMPLING_RATE");if(e===void 0)return;const t=parseFloat(e);if(t<0||t>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${t}`);return t},l3=n=>{const t=n.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return t==="localhost"||t==="127.0.0.1"||t==="::1"};async function u3(n){const e=[];for await(const t of n)e.push(t);return e}function Qm(n){if(n!==void 0)return n.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const c3=async n=>{if((n==null?void 0:n.status)===429){const e=parseInt(n.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(t=>setTimeout(t,e)),!0}return!1};function xS(n){return typeof n=="number"?Number(n.toFixed(4)):n}class d3{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let t;const r=new Promise(a=>{t=a}),s=Dn(e.item).length;return this.items.push({action:e.action,payload:e.item,itemPromiseResolve:t,itemPromise:r,size:s}),this.sizeBytes+=s,r}pop(e){var s;if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const t=[];let r=0;for(;r+(((s=this.peek())==null?void 0:s.size)??0)<e&&this.items.length>0;){const a=this.items.shift();a&&(t.push(a),r+=a.size,this.sizeBytes-=a.size)}if(t.length===0&&this.items.length>0){const a=this.items.shift();t.push(a),r+=a.size,this.sizeBytes-=a.size}return[t.map(a=>({action:a.action,item:a.payload})),()=>t.forEach(a=>a.itemPromiseResolve())]}}const f3=20971520,h3=2500;class iu{constructor(e={}){var r;Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new d3}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:oa("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"debug",{enumerable:!0,configurable:!0,writable:!0,value:oa("LANGSMITH_DEBUG")==="true"});const t=iu.getDefaultClientConfig();if(this.tracingSampleRate=o3(e.tracingSamplingRate),this.apiUrl=Qm(e.apiUrl??t.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=Qm(e.apiKey??t.apiKey),this.webUrl=Qm(e.webUrl??t.webUrl),(r=this.webUrl)!=null&&r.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??9e4,this.caller=new Cx({...e.callerOptions??{},debug:e.debug??this.debug}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.debug=e.debug??this.debug,this.batchIngestCaller=new Cx({maxRetries:2,maxConcurrency:this.traceBatchConcurrency,...e.callerOptions??{},onFailedResponseHook:c3,debug:e.debug??this.debug}),this.hideInputs=e.hideInputs??e.anonymizer??t.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??t.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{},this.manualFlushMode=e.manualFlushMode??this.manualFlushMode}static getDefaultClientConfig(){const e=Zr("API_KEY"),t=Zr("ENDPOINT")??"https://api.smith.langchain.com",r=Zr("HIDE_INPUTS")==="true",s=Zr("HIDE_OUTPUTS")==="true";return{apiUrl:t,apiKey:e,webUrl:void 0,hideInputs:r,hideOutputs:s}}getHostUrl(){return this.webUrl?this.webUrl:l3(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.endsWith("/api/v1")?(this.webUrl=this.apiUrl.replace("/api/v1",""),this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("beta")?(this.webUrl="https://beta.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${WC}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}prepareRunCreateOrUpdateInputs(e){const t={...e};return t.inputs!==void 0&&(t.inputs=this.processInputs(t.inputs)),t.outputs!==void 0&&(t.outputs=this.processOutputs(t.outputs)),t}async _getResponse(e,t){const r=(t==null?void 0:t.toString())??"",s=`${this.apiUrl}${e}?${r}`,a=await this.caller.call(Pe(this.debug),s,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ue(a,`Failed to fetch ${e}`),a}async _get(e,t){return(await this._getResponse(e,t)).json()}async*_getPaginated(e,t=new URLSearchParams,r){let s=Number(t.get("offset"))||0;const a=Number(t.get("limit"))||100;for(;;){t.set("offset",String(s)),t.set("limit",String(a));const o=`${this.apiUrl}${e}?${t}`,u=await this.caller.call(Pe(this.debug),o,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(u,`Failed to fetch ${e}`);const c=r?r(await u.json()):await u.json();if(c.length===0||(yield c,c.length<a))break;s+=c.length}}async*_getCursorPaginatedList(e,t=null,r="POST",s="runs"){const a=t?{...t}:{};for(;;){const u=await(await this.caller.call(Pe(this.debug),`${this.apiUrl}${e}`,{method:r,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(a)})).json();if(!u||!u[s])break;yield u[s];const c=u.cursors;if(!c||!c.next)break;a.cursor=c.next}}_shouldSample(){return this.tracingSampleRate===void 0?!0:Math.random()<this.tracingSampleRate}_filterForSampling(e,t=!1){if(this.tracingSampleRate===void 0)return e;if(t){const r=[];for(const s of e)this.filteredPostUuids.has(s.id)?this.filteredPostUuids.delete(s.id):r.push(s);return r}else{const r=[];for(const s of e){const a=s.trace_id??s.id;this.filteredPostUuids.has(a)||(s.id===a?this._shouldSample()?r.push(s):this.filteredPostUuids.add(a):r.push(s))}return r}}async _getBatchSizeLimitBytes(){var t;const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??((t=e.batch_ingest_config)==null?void 0:t.size_limit_bytes)??f3}async _getMultiPartSupport(){var t;return((t=(await this._ensureServerInfo()).instance_flags)==null?void 0:t.dataset_examples_multipart_enabled)??!1}drainAutoBatchQueue(e){const t=[];for(;this.autoBatchQueue.items.length>0;){const[r,s]=this.autoBatchQueue.pop(e);if(!r.length){s();break}const a=this._processBatch(r,s).catch(console.error);t.push(a)}return Promise.all(t)}async _processBatch(e,t){var r;if(!e.length){t();return}try{const s={runCreates:e.filter(o=>o.action==="create").map(o=>o.item),runUpdates:e.filter(o=>o.action==="update").map(o=>o.item)},a=await this._ensureServerInfo();(r=a==null?void 0:a.batch_ingest_config)!=null&&r.use_multipart_endpoint?await this.multipartIngestRuns(s):await this.batchIngestRuns(s)}finally{t()}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.action==="create"&&(e.item=vS(e.item));const t=this.autoBatchQueue.push(e);if(this.manualFlushMode)return t;const r=await this._getBatchSizeLimitBytes();return this.autoBatchQueue.sizeBytes>r&&this.drainAutoBatchQueue(r),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue(r)},this.autoBatchAggregationDelayMs)),t}async _getServerInfo(){const e=await Pe(this.debug)(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(h3),...this.fetchOptions});await Ue(e,"get server info");const t=await e.json();return this.debug&&console.log(`
=== LangSmith Server Configuration ===
`+JSON.stringify(t,null,2)+`
`),t}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch{console.warn("[WARNING]: LangSmith failed to fetch info on supported operations. Falling back to batch operations and default limits.")}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){const e=await this._getBatchSizeLimitBytes();await this.drainAutoBatchQueue(e)}async createRun(e){if(!this._filterForSampling([e]).length)return;const t={...this.headers,"Content-Type":"application/json"},r=e.project_name;delete e.project_name;const s=this.prepareRunCreateOrUpdateInputs({session_name:r,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&s.trace_id!==void 0&&s.dotted_order!==void 0){this.processRunOperation({action:"create",item:s}).catch(console.error);return}const a=vS(s),o=await this.caller.call(Pe(this.debug),`${this.apiUrl}/runs`,{method:"POST",headers:t,body:Dn(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(o,"create run",!0)}async batchIngestRuns({runCreates:e,runUpdates:t}){if(e===void 0&&t===void 0)return;let r=(e==null?void 0:e.map(u=>this.prepareRunCreateOrUpdateInputs(u)))??[],s=(t==null?void 0:t.map(u=>this.prepareRunCreateOrUpdateInputs(u)))??[];if(r.length>0&&s.length>0){const u=r.reduce((f,h)=>(h.id&&(f[h.id]=h),f),{}),c=[];for(const f of s)f.id!==void 0&&u[f.id]?u[f.id]={...u[f.id],...f}:c.push(f);r=Object.values(u),s=c}const a={post:r,patch:s};if(!a.post.length&&!a.patch.length)return;const o={post:[],patch:[]};for(const u of["post","patch"]){const c=u,f=a[c].reverse();let h=f.pop();for(;h!==void 0;)o[c].push(h),h=f.pop()}(o.post.length>0||o.patch.length>0)&&await this._postBatchIngestRuns(Dn(o))}async _postBatchIngestRuns(e){const t={...this.headers,"Content-Type":"application/json",Accept:"application/json"},r=await this.batchIngestCaller.call(Pe(this.debug),`${this.apiUrl}/runs/batch`,{method:"POST",headers:t,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(r,"batch create run",!0)}async multipartIngestRuns({runCreates:e,runUpdates:t}){if(e===void 0&&t===void 0)return;const r={};let s=[];for(const h of e??[]){const m=this.prepareRunCreateOrUpdateInputs(h);m.id!==void 0&&m.attachments!==void 0&&(r[m.id]=m.attachments),delete m.attachments,s.push(m)}let a=[];for(const h of t??[])a.push(this.prepareRunCreateOrUpdateInputs(h));if(s.find(h=>h.trace_id===void 0||h.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(a.find(h=>h.trace_id===void 0||h.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(s.length>0&&a.length>0){const h=s.reduce((g,y)=>(y.id&&(g[y.id]=y),g),{}),m=[];for(const g of a)g.id!==void 0&&h[g.id]?h[g.id]={...h[g.id],...g}:m.push(g);s=Object.values(h),a=m}if(s.length===0&&a.length===0)return;const c=[],f=[];for(const[h,m]of[["post",s],["patch",a]])for(const g of m){const{inputs:y,outputs:w,events:v,attachments:x,...E}=g,k={inputs:y,outputs:w,events:v},S=Dn(E);f.push({name:`${h}.${E.id}`,payload:new Blob([S],{type:`application/json; length=${S.length}`})});for(const[R,A]of Object.entries(k)){if(A===void 0)continue;const I=Dn(A);f.push({name:`${h}.${E.id}.${R}`,payload:new Blob([I],{type:`application/json; length=${I.length}`})})}if(E.id!==void 0){const R=r[E.id];if(R){delete r[E.id];for(const[A,I]of Object.entries(R)){let M,D;if(Array.isArray(I)?[M,D]=I:(M=I.mimeType,D=I.data),A.includes(".")){console.warn(`Skipping attachment '${A}' for run ${E.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}f.push({name:`attachment.${E.id}.${A}`,payload:new Blob([D],{type:`${M}; length=${D.byteLength}`})})}}}c.push(`trace=${E.trace_id},id=${E.id}`)}await this._sendMultipartRequest(f,c.join("; "))}async _sendMultipartRequest(e,t){try{const r="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),s=[];for(const c of e)s.push(new Blob([`--${r}\r
`])),s.push(new Blob([`Content-Disposition: form-data; name="${c.name}"\r
`,`Content-Type: ${c.payload.type}\r
\r
`])),s.push(c.payload),s.push(new Blob([`\r
`]));s.push(new Blob([`--${r}--\r
`]));const o=await new Blob(s).arrayBuffer(),u=await this.batchIngestCaller.call(Pe(this.debug),`${this.apiUrl}/runs/multipart`,{method:"POST",headers:{...this.headers,"Content-Type":`multipart/form-data; boundary=${r}`},body:o,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(u,"ingest multipart runs",!0)}catch(r){console.warn(`${r.message.trim()}

Context: ${t}`)}}async updateRun(e,t){je(e),t.inputs&&(t.inputs=this.processInputs(t.inputs)),t.outputs&&(t.outputs=this.processOutputs(t.outputs));const r={...t,id:e};if(!this._filterForSampling([r],!0).length)return;if(this.autoBatchTracing&&r.trace_id!==void 0&&r.dotted_order!==void 0){if(t.end_time!==void 0&&r.parent_run_id===void 0&&this.blockOnRootRunFinalization&&!this.manualFlushMode){await this.processRunOperation({action:"update",item:r}).catch(console.error);return}else this.processRunOperation({action:"update",item:r}).catch(console.error);return}const s={...this.headers,"Content-Type":"application/json"},a=await this.caller.call(Pe(this.debug),`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:s,body:Dn(t),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(a,"update run",!0)}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){je(e);let r=await this._get(`/runs/${e}`);return t&&r.child_run_ids&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:e,run:t,projectOpts:r}){if(t!==void 0){let s;t.session_id?s=t.session_id:r!=null&&r.projectName?s=(await this.readProject({projectName:r==null?void 0:r.projectName})).id:r!=null&&r.projectId?s=r==null?void 0:r.projectId:s=(await this.readProject({projectName:Zr("PROJECT")||"default"})).id;const a=await this._getTenantId();return`${this.getHostUrl()}/o/${a}/projects/p/${s}/r/${t.id}?poll=true`}else if(e!==void 0){const s=await this.readRun(e);if(!s.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${s.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const t=await u3(this.listRuns({id:e.child_run_ids})),r={},s={};t.sort((a,o)=>((a==null?void 0:a.dotted_order)??"").localeCompare((o==null?void 0:o.dotted_order)??""));for(const a of t){if(a.parent_run_id===null||a.parent_run_id===void 0)throw new Error(`Child run ${a.id} has no parent`);a.parent_run_id in r||(r[a.parent_run_id]=[]),r[a.parent_run_id].push(a),s[a.id]=a}e.child_runs=r[e.id]||[];for(const a in r)a!==e.id&&(s[a].child_runs=r[a]);return e}async*listRuns(e){const{projectId:t,projectName:r,parentRunId:s,traceId:a,referenceExampleId:o,startTime:u,executionOrder:c,isRoot:f,runType:h,error:m,id:g,query:y,filter:w,traceFilter:v,treeFilter:x,limit:E,select:k}=e;let S=[];if(t&&(S=Array.isArray(t)?t:[t]),r){const M=Array.isArray(r)?r:[r],D=await Promise.all(M.map(K=>this.readProject({projectName:K}).then(X=>X.id)));S.push(...D)}const R=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],A={session:S.length?S:null,run_type:h,reference_example:o,query:y,filter:w,trace_filter:v,tree_filter:x,execution_order:c,parent_run:s,start_time:u?u.toISOString():null,error:m,id:g,limit:E,trace:a,select:k||R,is_root:f};let I=0;for await(const M of this._getCursorPaginatedList("/runs/query",A))if(E){if(I>=E)break;if(M.length+I>E){yield*M.slice(0,E-I);break}I+=M.length,yield*M}else yield*M}async getRunStats({id:e,trace:t,parentRun:r,runType:s,projectNames:a,projectIds:o,referenceExampleIds:u,startTime:c,endTime:f,error:h,query:m,filter:g,traceFilter:y,treeFilter:w,isRoot:v,dataSourceType:x}){let E=o||[];a&&(E=[...o||[],...await Promise.all(a.map(I=>this.readProject({projectName:I}).then(M=>M.id)))]);const S=Object.fromEntries(Object.entries({id:e,trace:t,parent_run:r,run_type:s,session:E,reference_example:u,start_time:c,end_time:f,error:h,query:m,filter:g,trace_filter:y,tree_filter:w,is_root:v,data_source_type:x}).filter(([I,M])=>M!==void 0));return await(await this.caller.call(Pe(this.debug),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(S),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async shareRun(e,{shareId:t}={}){const r={run_id:e,share_token:t||sn()};je(e);const a=await(await this.caller.call(Pe(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(a===null||!("share_token"in a))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${a.share_token}/r`}async unshareRun(e){je(e);const t=await this.caller.call(Pe(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(t,"unshare run",!0)}async readRunSharedLink(e){je(e);const r=await(await this.caller.call(Pe(this.debug),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(r===null||!("share_token"in r)))return`${this.getHostUrl()}/public/${r.share_token}/r`}async listSharedRuns(e,{runIds:t}={}){const r=new URLSearchParams({share_token:e});if(t!==void 0)for(const o of t)r.append("id",o);return je(e),await(await this.caller.call(Pe(this.debug),`${this.apiUrl}/public/${e}/runs${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id),je(e);const s=await(await this.caller.call(Pe(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return s.url=`${this.getHostUrl()}/public/${s.share_token}/d`,s}async shareDataset(e,t){if(!e&&!t)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:t})).id);const r={dataset_id:e};je(e);const a=await(await this.caller.call(Pe(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return a.url=`${this.getHostUrl()}/public/${a.share_token}/d`,a}async unshareDataset(e){je(e);const t=await this.caller.call(Pe(this.debug),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(t,"unshare dataset",!0)}async readSharedDataset(e){return je(e),await(await this.caller.call(Pe(this.debug),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async listSharedExamples(e,t){const r={};t!=null&&t.exampleIds&&(r.id=t.exampleIds);const s=new URLSearchParams;Object.entries(r).forEach(([u,c])=>{Array.isArray(c)?c.forEach(f=>s.append(u,f)):s.append(u,c)});const a=await this.caller.call(Pe(this.debug),`${this.apiUrl}/public/${e}/examples?${s.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),o=await a.json();if(!a.ok)throw"detail"in o?new Error(`Failed to list shared examples.
Status: ${a.status}
Message: ${o.detail.join(`
`)}`):new Error(`Failed to list shared examples: ${a.status} ${a.statusText}`);return o.map(u=>({...u,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:t=null,metadata:r=null,upsert:s=!1,projectExtra:a=null,referenceDatasetId:o=null}){const u=s?"?upsert=true":"",c=`${this.apiUrl}/sessions${u}`,f=a||{};r&&(f.metadata=r);const h={name:e,extra:f,description:t};o!==null&&(h.reference_dataset_id=o);const m=await this.caller.call(Pe(this.debug),c,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(h),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ue(m,"create project"),await m.json()}async updateProject(e,{name:t=null,description:r=null,metadata:s=null,projectExtra:a=null,endTime:o=null}){const u=`${this.apiUrl}/sessions/${e}`;let c=a;s&&(c={...c||{},metadata:s});const f={name:t,extra:c,description:r,end_time:o?new Date(o).toISOString():null},h=await this.caller.call(Pe(this.debug),u,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(f),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ue(h,"update project"),await h.json()}async hasProject({projectId:e,projectName:t}){let r="/sessions";const s=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)je(e),r+=`/${e}`;else if(t!==void 0)s.append("name",t);else throw new Error("Must provide projectName or projectId");const a=await this.caller.call(Pe(this.debug),`${this.apiUrl}${r}?${s}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const o=await a.json();return a.ok?Array.isArray(o)?o.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:t,includeStats:r}){let s="/sessions";const a=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)je(e),s+=`/${e}`;else if(t!==void 0)a.append("name",t);else throw new Error("Must provide projectName or projectId");r!==void 0&&a.append("include_stats",r.toString());const o=await this._get(s,a);let u;if(Array.isArray(o)){if(o.length===0)throw new Error(`Project[id=${e}, name=${t}] not found`);u=o[0]}else u=o;return u}async getProjectUrl({projectId:e,projectName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either projectName or projectId");const r=await this.readProject({projectId:e,projectName:t}),s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/projects/p/${r.id}`}async getDatasetUrl({datasetId:e,datasetName:t}){if(e===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");const r=await this.readDataset({datasetId:e,datasetName:t}),s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/datasets/${r.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const t of this._getPaginated("/sessions",e))return this._tenantId=t[0].tenant_id,t[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:t,nameContains:r,referenceDatasetId:s,referenceDatasetName:a,referenceFree:o,metadata:u}={}){const c=new URLSearchParams;if(e!==void 0)for(const f of e)c.append("id",f);if(t!==void 0&&c.append("name",t),r!==void 0&&c.append("name_contains",r),s!==void 0)c.append("reference_dataset",s);else if(a!==void 0){const f=await this.readDataset({datasetName:a});c.append("reference_dataset",f.id)}o!==void 0&&c.append("reference_free",o.toString()),u!==void 0&&c.append("metadata",JSON.stringify(u));for await(const f of this._getPaginated("/sessions",c))yield*f}async deleteProject({projectId:e,projectName:t}){let r;if(e===void 0&&t===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?r=(await this.readProject({projectName:t})).id:r=e,je(r);const s=await this.caller.call(Pe(this.debug),`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(s,`delete session ${r} (${t})`,!0)}async uploadCsv({csvFile:e,fileName:t,inputKeys:r,outputKeys:s,description:a,dataType:o,name:u}){const c=`${this.apiUrl}/datasets/upload`,f=new FormData;f.append("file",e,t),r.forEach(g=>{f.append("input_keys",g)}),s.forEach(g=>{f.append("output_keys",g)}),a&&f.append("description",a),o&&f.append("data_type",o),u&&f.append("name",u);const h=await this.caller.call(Pe(this.debug),c,{method:"POST",headers:this.headers,body:f,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ue(h,"upload CSV"),await h.json()}async createDataset(e,{description:t,dataType:r,inputsSchema:s,outputsSchema:a,metadata:o}={}){const u={name:e,description:t,extra:o?{metadata:o}:void 0};r&&(u.data_type=r),s&&(u.inputs_schema_definition=s),a&&(u.outputs_schema_definition=a);const c=await this.caller.call(Pe(this.debug),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ue(c,"create dataset"),await c.json()}async readDataset({datasetId:e,datasetName:t}){let r="/datasets";const s=new URLSearchParams({limit:"1"});if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)je(e),r+=`/${e}`;else if(t!==void 0)s.append("name",t);else throw new Error("Must provide datasetName or datasetId");const a=await this._get(r,s);let o;if(Array.isArray(a)){if(a.length===0)throw new Error(`Dataset[id=${e}, name=${t}] not found`);o=a[0]}else o=a;return o}async hasDataset({datasetId:e,datasetName:t}){try{return await this.readDataset({datasetId:e,datasetName:t}),!0}catch(r){if(r instanceof Error&&r.message.toLocaleLowerCase().includes("not found"))return!1;throw r}}async diffDatasetVersions({datasetId:e,datasetName:t,fromVersion:r,toVersion:s}){let a=e;if(a===void 0&&t===void 0)throw new Error("Must provide either datasetName or datasetId");if(a!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");a===void 0&&(a=(await this.readDataset({datasetName:t})).id);const o=new URLSearchParams({from_version:typeof r=="string"?r:r.toISOString(),to_version:typeof s=="string"?s:s.toISOString()});return await this._get(`/datasets/${a}/versions/diff`,o)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:t}){const r="/datasets";if(e===void 0)if(t!==void 0)e=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide either datasetName or datasetId");return(await(await this._getResponse(`${r}/${e}/openai_ft`)).text()).trim().split(`
`).map(u=>JSON.parse(u))}async*listDatasets({limit:e=100,offset:t=0,datasetIds:r,datasetName:s,datasetNameContains:a,metadata:o}={}){const u="/datasets",c=new URLSearchParams({limit:e.toString(),offset:t.toString()});if(r!==void 0)for(const f of r)c.append("id",f);s!==void 0&&c.append("name",s),a!==void 0&&c.append("name_contains",a),o!==void 0&&c.append("metadata",JSON.stringify(o));for await(const f of this._getPaginated(u,c))yield*f}async updateDataset(e){const{datasetId:t,datasetName:r,...s}=e;if(!t&&!r)throw new Error("Must provide either datasetName or datasetId");const a=t??(await this.readDataset({datasetName:r})).id;je(a);const o=await this.caller.call(Pe(this.debug),`${this.apiUrl}/datasets/${a}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ue(o,"update dataset"),await o.json()}async updateDatasetTag(e){const{datasetId:t,datasetName:r,asOf:s,tag:a}=e;if(!t&&!r)throw new Error("Must provide either datasetName or datasetId");const o=t??(await this.readDataset({datasetName:r})).id;je(o);const u=await this.caller.call(Pe(this.debug),`${this.apiUrl}/datasets/${o}/tags`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({as_of:typeof s=="string"?s:s.toISOString(),tag:a}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(u,"update dataset tags")}async deleteDataset({datasetId:e,datasetName:t}){let r="/datasets",s=e;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(t!==void 0&&(s=(await this.readDataset({datasetName:t})).id),s!==void 0)je(s),r+=`/${s}`;else throw new Error("Must provide datasetName or datasetId");const a=await this.caller.call(Pe(this.debug),this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(a,`delete ${r}`),await a.json()}async indexDataset({datasetId:e,datasetName:t,tag:r}){let s=e;if(!s&&!t)throw new Error("Must provide either datasetName or datasetId");if(s&&t)throw new Error("Must provide either datasetName or datasetId, not both");s||(s=(await this.readDataset({datasetName:t})).id),je(s);const a={tag:r},o=await this.caller.call(Pe(this.debug),`${this.apiUrl}/datasets/${s}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(o,"index dataset"),await o.json()}async similarExamples(e,t,r,{filter:s}={}){const a={limit:r,inputs:e};s!==void 0&&(a.filter=s),je(t);const o=await this.caller.call(Pe(this.debug),`${this.apiUrl}/datasets/${t}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ue(o,"fetch similar examples"),(await o.json()).examples}async createExample(e,t,r){var h;if(SS(e)&&(t!==void 0||r!==void 0))throw new Error("Cannot provide outputs or options when using ExampleCreate object");let s=t?r==null?void 0:r.datasetId:e.dataset_id;const a=t?r==null?void 0:r.datasetName:e.dataset_name;if(s===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");if(s!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");s===void 0&&(s=(await this.readDataset({datasetName:a})).id);const o=(t?r==null?void 0:r.createdAt:e.created_at)||new Date;let u;SS(e)?u=e:u={inputs:e,outputs:t,created_at:o==null?void 0:o.toISOString(),id:r==null?void 0:r.exampleId,metadata:r==null?void 0:r.metadata,split:r==null?void 0:r.split,source_run_id:r==null?void 0:r.sourceRunId,use_source_run_io:r==null?void 0:r.useSourceRunIO,use_source_run_attachments:r==null?void 0:r.useSourceRunAttachments,attachments:r==null?void 0:r.attachments};const c=await this._uploadExamplesMultipart(s,[u]);return await this.readExample(((h=c.example_ids)==null?void 0:h[0])??sn())}async createExamples(e){if(Array.isArray(e)){if(e.length===0)return[];const k=e;let S=k[0].dataset_id;const R=k[0].dataset_name;if(S===void 0&&R===void 0)throw new Error("Must provide either datasetName or datasetId");if(S!==void 0&&R!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");S===void 0&&(S=(await this.readDataset({datasetName:R})).id);const A=await this._uploadExamplesMultipart(S,k);return await Promise.all(A.example_ids.map(M=>this.readExample(M)))}const{inputs:t,outputs:r,metadata:s,splits:a,sourceRunIds:o,useSourceRunIOs:u,useSourceRunAttachments:c,attachments:f,exampleIds:h,datasetId:m,datasetName:g}=e;if(t===void 0)throw new Error("Must provide inputs when using legacy parameters");let y=m;const w=g;if(y===void 0&&w===void 0)throw new Error("Must provide either datasetName or datasetId");if(y!==void 0&&w!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");y===void 0&&(y=(await this.readDataset({datasetName:w})).id);const v=t.map((k,S)=>({dataset_id:y,inputs:k,outputs:r==null?void 0:r[S],metadata:s==null?void 0:s[S],split:a==null?void 0:a[S],id:h==null?void 0:h[S],attachments:f==null?void 0:f[S],source_run_id:o==null?void 0:o[S],use_source_run_io:u==null?void 0:u[S],use_source_run_attachments:c==null?void 0:c[S]})),x=await this._uploadExamplesMultipart(y,v);return await Promise.all(x.example_ids.map(k=>this.readExample(k)))}async createLLMExample(e,t,r){return this.createExample({input:e},{output:t},r)}async createChatExample(e,t,r){const s=e.map(o=>Px(o)?kx(o):o),a=Px(t)?kx(t):t;return this.createExample({input:s},{output:a},r)}async readExample(e){je(e);const t=`/examples/${e}`,r=await this._get(t),{attachment_urls:s,...a}=r,o=a;return s&&(o.attachments=Object.entries(s).reduce((u,[c,f])=>(u[c.slice(11)]={presigned_url:f.presigned_url,mime_type:f.mime_type},u),{})),o}async*listExamples({datasetId:e,datasetName:t,exampleIds:r,asOf:s,splits:a,inlineS3Urls:o,metadata:u,limit:c,offset:f,filter:h,includeAttachments:m}={}){let g;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)g=e;else if(t!==void 0)g=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide a datasetName or datasetId");const y=new URLSearchParams({dataset:g}),w=s?typeof s=="string"?s:s==null?void 0:s.toISOString():void 0;w&&y.append("as_of",w);const v=o??!0;if(y.append("inline_s3_urls",v.toString()),r!==void 0)for(const E of r)y.append("id",E);if(a!==void 0)for(const E of a)y.append("splits",E);if(u!==void 0){const E=JSON.stringify(u);y.append("metadata",E)}c!==void 0&&y.append("limit",c.toString()),f!==void 0&&y.append("offset",f.toString()),h!==void 0&&y.append("filter",h),m===!0&&["attachment_urls","outputs","metadata"].forEach(E=>y.append("select",E));let x=0;for await(const E of this._getPaginated("/examples",y)){for(const k of E){const{attachment_urls:S,...R}=k,A=R;S&&(A.attachments=Object.entries(S).reduce((I,[M,D])=>(I[M.slice(11)]={presigned_url:D.presigned_url,mime_type:D.mime_type||void 0},I),{})),yield A,x++}if(c!==void 0&&x>=c)break}}async deleteExample(e){je(e);const t=`/examples/${e}`,r=await this.caller.call(Pe(this.debug),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(r,`delete ${t}`),await r.json()}async updateExample(e,t){let r;t?r=e:r=e.id,je(r);let s;t?s={id:r,...t}:s=e;let a;return s.dataset_id!==void 0?a=s.dataset_id:a=(await this.readExample(r)).dataset_id,this._updateExamplesMultipart(a,[s])}async updateExamples(e){let t;return e[0].dataset_id===void 0?t=(await this.readExample(e[0].id)).dataset_id:t=e[0].dataset_id,this._updateExamplesMultipart(t,e)}async readDatasetVersion({datasetId:e,datasetName:t,asOf:r,tag:s}){let a;if(e?a=e:a=(await this.readDataset({datasetName:t})).id,je(a),r&&s||!r&&!s)throw new Error("Exactly one of asOf and tag must be specified.");const o=new URLSearchParams;r!==void 0&&o.append("as_of",typeof r=="string"?r:r.toISOString()),s!==void 0&&o.append("tag",s);const u=await this.caller.call(Pe(this.debug),`${this.apiUrl}/datasets/${a}/version?${o.toString()}`,{method:"GET",headers:{...this.headers},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ue(u,"read dataset version"),await u.json()}async listDatasetSplits({datasetId:e,datasetName:t,asOf:r}){let s;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?s=(await this.readDataset({datasetName:t})).id:s=e,je(s);const a=new URLSearchParams,o=r?typeof r=="string"?r:r==null?void 0:r.toISOString():void 0;return o&&a.append("as_of",o),await this._get(`/datasets/${s}/splits`,a)}async updateDatasetSplits({datasetId:e,datasetName:t,splitName:r,exampleIds:s,remove:a=!1}){let o;if(e===void 0&&t===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?o=(await this.readDataset({datasetName:t})).id:o=e,je(o);const u={split_name:r,examples:s.map(f=>(je(f),f)),remove:a},c=await this.caller.call(Pe(this.debug),`${this.apiUrl}/datasets/${o}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(c,"update dataset splits",!0)}async evaluateRun(e,t,{sourceInfo:r,loadChildRuns:s,referenceExample:a}={loadChildRuns:!1}){UC("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let o;if(typeof e=="string")o=await this.readRun(e,{loadChildRuns:s});else if(typeof e=="object"&&"id"in e)o=e;else throw new Error(`Invalid run type: ${typeof e}`);o.reference_example_id!==null&&o.reference_example_id!==void 0&&(a=await this.readExample(o.reference_example_id));const u=await t.evaluateRun(o,a),[c,f]=await this._logEvaluationFeedback(u,o,r);return f[0]}async createFeedback(e,t,{score:r,value:s,correction:a,comment:o,sourceInfo:u,feedbackSourceType:c="api",sourceRunId:f,feedbackId:h,feedbackConfig:m,projectId:g,comparativeExperimentId:y}){var k;if(!e&&!g)throw new Error("One of runId or projectId must be provided");if(e&&g)throw new Error("Only one of runId or projectId can be provided");const w={type:c??"api",metadata:u??{}};f!==void 0&&(w==null?void 0:w.metadata)!==void 0&&!w.metadata.__run&&(w.metadata.__run={run_id:f}),(w==null?void 0:w.metadata)!==void 0&&((k=w.metadata.__run)==null?void 0:k.run_id)!==void 0&&je(w.metadata.__run.run_id);const v={id:h??sn(),run_id:e,key:t,score:xS(r),value:s,correction:a,comment:o,feedback_source:w,comparative_experiment_id:y,feedbackConfig:m,session_id:g},x=`${this.apiUrl}/feedback`,E=await this.caller.call(Pe(this.debug),x,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(v),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ue(E,"create feedback",!0),v}async updateFeedback(e,{score:t,value:r,correction:s,comment:a}){const o={};t!=null&&(o.score=xS(t)),r!=null&&(o.value=r),s!=null&&(o.correction=s),a!=null&&(o.comment=a),je(e);const u=await this.caller.call(Pe(this.debug),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(u,"update feedback",!0)}async readFeedback(e){je(e);const t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){je(e);const t=`/feedback/${e}`,r=await this.caller.call(Pe(this.debug),this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(r,`delete ${t}`),await r.json()}async*listFeedback({runIds:e,feedbackKeys:t,feedbackSourceTypes:r}={}){const s=new URLSearchParams;if(e&&s.append("run",e.join(",")),t)for(const a of t)s.append("key",a);if(r)for(const a of r)s.append("source",a);for await(const a of this._getPaginated("/feedback",s))yield*a}async createPresignedFeedbackToken(e,t,{expiration:r,feedbackConfig:s}={}){const a={run_id:e,feedback_key:t,feedback_config:s};return r?typeof r=="string"?a.expires_at=r:(r!=null&&r.hours||r!=null&&r.minutes||r!=null&&r.days)&&(a.expires_in=r):a.expires_in={hours:3},await(await this.caller.call(Pe(this.debug),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createComparativeExperiment({name:e,experimentIds:t,referenceDatasetId:r,createdAt:s,description:a,metadata:o,id:u}){var h;if(t.length===0)throw new Error("At least one experiment is required");if(r||(r=(await this.readProject({projectId:t[0]})).reference_dataset_id),!r==null)throw new Error("A reference dataset is required");const c={id:u,name:e,experiment_ids:t,reference_dataset_id:r,description:a,created_at:(h=s??new Date)==null?void 0:h.toISOString(),extra:{}};return o&&(c.extra.metadata=o),await(await this.caller.call(Pe(this.debug),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){je(e);const t=new URLSearchParams({run_id:e});for await(const r of this._getPaginated("/feedback/tokens",t))yield*r}_selectEvalResults(e){let t;return"results"in e?t=e.results:Array.isArray(e)?t=e:t=[e],t}async _logEvaluationFeedback(e,t,r){const s=this._selectEvalResults(e),a=[];for(const o of s){let u=r||{};o.evaluatorInfo&&(u={...o.evaluatorInfo,...u});let c=null;o.targetRunId?c=o.targetRunId:t&&(c=t.id),a.push(await this.createFeedback(c,o.key,{score:o.score,value:o.value,comment:o.comment,correction:o.correction,sourceInfo:u,sourceRunId:o.sourceRunId,feedbackConfig:o.feedbackConfig,feedbackSourceType:"model"}))}return[s,a]}async logEvaluationFeedback(e,t,r){const[s]=await this._logEvaluationFeedback(e,t,r);return s}async*listAnnotationQueues(e={}){const{queueIds:t,name:r,nameContains:s,limit:a}=e,o=new URLSearchParams;t&&t.forEach((c,f)=>{je(c,`queueIds[${f}]`),o.append("ids",c)}),r&&o.append("name",r),s&&o.append("name_contains",s),o.append("limit",(a!==void 0?Math.min(a,100):100).toString());let u=0;for await(const c of this._getPaginated("/annotation-queues",o))if(yield*c,u++,a!==void 0&&u>=a)break}async createAnnotationQueue(e){const{name:t,description:r,queueId:s}=e,a={name:t,description:r,id:s||sn()},o=await this.caller.call(Pe(this.debug),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(a).filter(([c,f])=>f!==void 0))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ue(o,"create annotation queue"),await o.json()}async readAnnotationQueue(e){const t=await this.listAnnotationQueues({queueIds:[e]}).next();if(t.done)throw new Error(`Annotation queue with ID ${e} not found`);return t.value}async updateAnnotationQueue(e,t){const{name:r,description:s}=t,a=await this.caller.call(Pe(this.debug),`${this.apiUrl}/annotation-queues/${je(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:r,description:s}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(a,"update annotation queue")}async deleteAnnotationQueue(e){const t=await this.caller.call(Pe(this.debug),`${this.apiUrl}/annotation-queues/${je(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(t,"delete annotation queue")}async addRunsToAnnotationQueue(e,t){const r=await this.caller.call(Pe(this.debug),`${this.apiUrl}/annotation-queues/${je(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t.map((s,a)=>je(s,`runIds[${a}]`).toString())),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(r,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,t){const r=`/annotation-queues/${je(e,"queueId")}/run`,s=await this.caller.call(Pe(this.debug),`${this.apiUrl}${r}/${t}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ue(s,"get run from annotation queue"),await s.json()}async deleteRunFromAnnotationQueue(e,t){const r=await this.caller.call(Pe(this.debug),`${this.apiUrl}/annotation-queues/${je(e,"queueId")}/runs/${je(t,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(r,"delete run from annotation queue")}async getSizeFromAnnotationQueue(e){const t=await this.caller.call(Pe(this.debug),`${this.apiUrl}/annotation-queues/${je(e,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ue(t,"get size from annotation queue"),await t.json()}async _currentTenantIsOwner(e){const t=await this._getSettings();return e=="-"||t.tenant_handle===e}async _ownerConflictError(e,t){const r=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${r.tenant_handle}

      Requested tenant: ${t}`)}async _getLatestCommitHash(e){const t=await this.caller.call(Pe(this.debug),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),r=await t.json();if(!t.ok){const s=typeof r.detail=="string"?r.detail:JSON.stringify(r.detail),a=new Error(`Error ${t.status}: ${t.statusText}
${s}`);throw a.statusCode=t.status,a}if(r.commits.length!==0)return r.commits[0].commit_hash}async _likeOrUnlikePrompt(e,t){const[r,s,a]=ta(e),o=await this.caller.call(Pe(this.debug),`${this.apiUrl}/likes/${r}/${s}`,{method:"POST",body:JSON.stringify({like:t}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ue(o,`${t?"like":"unlike"} prompt`),await o.json()}async _getPromptUrl(e){const[t,r,s]=ta(e);if(await this._currentTenantIsOwner(t)){const a=await this._getSettings();return s!=="latest"?`${this.getHostUrl()}/prompts/${r}/${s.substring(0,8)}?organizationId=${a.id}`:`${this.getHostUrl()}/prompts/${r}?organizationId=${a.id}`}else return s!=="latest"?`${this.getHostUrl()}/hub/${t}/${r}/${s.substring(0,8)}`:`${this.getHostUrl()}/hub/${t}/${r}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const t of this._getPaginated(`/commits/${e}/`,new URLSearchParams,r=>r.commits))yield*t}async*listPrompts(e){const t=new URLSearchParams;t.append("sort_field",(e==null?void 0:e.sortField)??"updated_at"),t.append("sort_direction","desc"),t.append("is_archived",(!!(e!=null&&e.isArchived)).toString()),(e==null?void 0:e.isPublic)!==void 0&&t.append("is_public",e.isPublic.toString()),e!=null&&e.query&&t.append("query",e.query);for await(const r of this._getPaginated("/repos",t,s=>s.repos))yield*r}async getPrompt(e){const[t,r,s]=ta(e),a=await this.caller.call(Pe(this.debug),`${this.apiUrl}/repos/${t}/${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(a.status===404)return null;await Ue(a,"get prompt");const o=await a.json();return o.repo?o.repo:null}async createPrompt(e,t){const r=await this._getSettings();if(t!=null&&t.isPublic&&!r.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle. 
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[s,a,o]=ta(e);if(!await this._currentTenantIsOwner(s))throw await this._ownerConflictError("create a prompt",s);const u={repo_handle:a,...(t==null?void 0:t.description)&&{description:t.description},...(t==null?void 0:t.readme)&&{readme:t.readme},...(t==null?void 0:t.tags)&&{tags:t.tags},is_public:!!(t!=null&&t.isPublic)},c=await this.caller.call(Pe(this.debug),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(c,"create prompt");const{repo:f}=await c.json();return f}async createCommit(e,t,r){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[s,a,o]=ta(e),u=(r==null?void 0:r.parentCommitHash)==="latest"||!(r!=null&&r.parentCommitHash)?await this._getLatestCommitHash(`${s}/${a}`):r==null?void 0:r.parentCommitHash,c={manifest:JSON.parse(JSON.stringify(t)),parent_commit:u},f=await this.caller.call(Pe(this.debug),`${this.apiUrl}/commits/${s}/${a}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(f,"create commit");const h=await f.json();return this._getPromptUrl(`${s}/${a}${h.commit_hash?`:${h.commit_hash}`:""}`)}async updateExamplesMultipart(e,t=[]){return this._updateExamplesMultipart(e,t)}async _updateExamplesMultipart(e,t=[]){var u;if(!await this._getMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const r=new FormData;for(const c of t){const f=c.id,h={...c.metadata&&{metadata:c.metadata},...c.split&&{split:c.split}},m=Dn(h),g=new Blob([m],{type:"application/json"});if(r.append(f,g),c.inputs){const y=Dn(c.inputs),w=new Blob([y],{type:"application/json"});r.append(`${f}.inputs`,w)}if(c.outputs){const y=Dn(c.outputs),w=new Blob([y],{type:"application/json"});r.append(`${f}.outputs`,w)}if(c.attachments)for(const[y,w]of Object.entries(c.attachments)){let v,x;Array.isArray(w)?[v,x]=w:(v=w.mimeType,x=w.data);const E=new Blob([x],{type:`${v}; length=${x.byteLength}`});r.append(`${f}.attachment.${y}`,E)}if(c.attachments_operations){const y=Dn(c.attachments_operations),w=new Blob([y],{type:"application/json"});r.append(`${f}.attachments_operations`,w)}}const s=e??((u=t[0])==null?void 0:u.dataset_id);return await(await this.caller.call(Pe(this.debug),`${this.apiUrl}/v1/platform/datasets/${s}/examples`,{method:"PATCH",headers:this.headers,body:r})).json()}async uploadExamplesMultipart(e,t=[]){return this._uploadExamplesMultipart(e,t)}async _uploadExamplesMultipart(e,t=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith deployment does not allow using the multipart examples endpoint, please upgrade your deployment to the latest version.");const r=new FormData;for(const o of t){const u=(o.id??sn()).toString(),c={created_at:o.created_at,...o.metadata&&{metadata:o.metadata},...o.split&&{split:o.split},...o.source_run_id&&{source_run_id:o.source_run_id},...o.use_source_run_io&&{use_source_run_io:o.use_source_run_io},...o.use_source_run_attachments&&{use_source_run_attachments:o.use_source_run_attachments}},f=Dn(c),h=new Blob([f],{type:"application/json"});if(r.append(u,h),o.inputs){const m=Dn(o.inputs),g=new Blob([m],{type:"application/json"});r.append(`${u}.inputs`,g)}if(o.outputs){const m=Dn(o.outputs),g=new Blob([m],{type:"application/json"});r.append(`${u}.outputs`,g)}if(o.attachments)for(const[m,g]of Object.entries(o.attachments)){let y,w;Array.isArray(g)?[y,w]=g:(y=g.mimeType,w=g.data);const v=new Blob([w],{type:`${y}; length=${w.byteLength}`});r.append(`${u}.attachment.${m}`,v)}}const s=await this.caller.call(Pe(this.debug),`${this.apiUrl}/v1/platform/datasets/${e}/examples`,{method:"POST",headers:this.headers,body:r});return await Ue(s,"upload examples"),await s.json()}async updatePrompt(e,t){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,s]=ta(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("update a prompt",r);const a={};if((t==null?void 0:t.description)!==void 0&&(a.description=t.description),(t==null?void 0:t.readme)!==void 0&&(a.readme=t.readme),(t==null?void 0:t.tags)!==void 0&&(a.tags=t.tags),(t==null?void 0:t.isPublic)!==void 0&&(a.is_public=t.isPublic),(t==null?void 0:t.isArchived)!==void 0&&(a.is_archived=t.isArchived),Object.keys(a).length===0)throw new Error("No valid update options provided");const o=await this.caller.call(Pe(this.debug),`${this.apiUrl}/repos/${r}/${s}`,{method:"PATCH",body:JSON.stringify(a),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await Ue(o,"update prompt"),o.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[t,r,s]=ta(e);if(!await this._currentTenantIsOwner(t))throw await this._ownerConflictError("delete a prompt",t);return await(await this.caller.call(Pe(this.debug),`${this.apiUrl}/repos/${t}/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async pullPromptCommit(e,t){const[r,s,a]=ta(e),o=await this.caller.call(Pe(this.debug),`${this.apiUrl}/commits/${r}/${s}/${a}${t!=null&&t.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await Ue(o,"pull prompt commit");const u=await o.json();return{owner:r,repo:s,commit_hash:u.commit_hash,manifest:u.manifest,examples:u.examples}}async _pullPrompt(e,t){const r=await this.pullPromptCommit(e,{includeModel:t==null?void 0:t.includeModel});return JSON.stringify(r.manifest)}async pushPrompt(e,t){return await this.promptExists(e)?t&&Object.keys(t).some(s=>s!=="object")&&await this.updatePrompt(e,{description:t==null?void 0:t.description,readme:t==null?void 0:t.readme,tags:t==null?void 0:t.tags,isPublic:t==null?void 0:t.isPublic}):await this.createPrompt(e,{description:t==null?void 0:t.description,readme:t==null?void 0:t.readme,tags:t==null?void 0:t.tags,isPublic:t==null?void 0:t.isPublic}),t!=null&&t.object?await this.createCommit(e,t==null?void 0:t.object,{parentCommitHash:t==null?void 0:t.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,t={}){const{sourceApiUrl:r=this.apiUrl,datasetName:s}=t,[a,o]=this.parseTokenOrUrl(e,r),u=new iu({apiUrl:a,apiKey:"placeholder"}),c=await u.readSharedDataset(o),f=s||c.name;try{if(await this.hasDataset({datasetId:f})){console.log(`Dataset ${f} already exists in your tenant. Skipping.`);return}}catch{}const h=await u.listSharedExamples(o),m=await this.createDataset(f,{description:c.description,dataType:c.data_type||"kv",inputsSchema:c.inputs_schema_definition??void 0,outputsSchema:c.outputs_schema_definition??void 0});try{await this.createExamples({inputs:h.map(g=>g.inputs),outputs:h.flatMap(g=>g.outputs?[g.outputs]:[]),datasetId:m.id})}catch(g){throw console.error(`An error occurred while creating dataset ${f}. You should delete it manually.`),g}}parseTokenOrUrl(e,t,r=2,s="dataset"){try{return je(e),[t,e]}catch{}try{const o=new URL(e).pathname.split("/").filter(u=>u!=="");if(o.length>=r){const u=o[o.length-r];return[t,u]}else throw new Error(`Invalid public ${s} URL: ${e}`)}catch{throw new Error(`Invalid public ${s} URL or token: ${e}`)}}awaitPendingTraceBatches(){return this.manualFlushMode?(console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve()):Promise.all([...this.autoBatchQueue.items.map(({itemPromise:e})=>e),this.batchIngestCaller.queue.onIdle()])}}function SS(n){return"dataset_id"in n||"dataset_name"in n}const WC="0.3.19";var jl={};let bs;const p3=()=>typeof window<"u"&&typeof window.document<"u",m3=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",g3=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),qC=()=>typeof Deno<"u",y3=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!qC(),_3=()=>bs||(p3()?bs="browser":y3()?bs="node":m3()?bs="webworker":g3()?bs="jsdom":qC()?bs="deno":bs="other",bs);let eg;function ZC(){if(eg===void 0){const n=_3(),e=v3();eg={library:"langsmith",runtime:n,sdk:"langsmith-js",sdk_version:WC,...e}}return eg}function w3(){const n=b3()||{},e={},t=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(const[r,s]of Object.entries(n))(r.startsWith("LANGCHAIN_")||r.startsWith("LANGSMITH_"))&&typeof s=="string"&&!t.includes(r)&&!r.toLowerCase().includes("key")&&!r.toLowerCase().includes("secret")&&!r.toLowerCase().includes("token")&&(r==="LANGCHAIN_REVISION_ID"?e.revision_id=s:e[r]=s);return e}function b3(){try{return typeof process<"u"&&jl?Object.entries(jl).reduce((n,[e,t])=>(n[e]=String(t),n),{}):void 0}catch{return}}function oa(n){try{return typeof process<"u"?jl==null?void 0:jl[n]:void 0}catch{return}}function Zr(n){return oa(`LANGSMITH_${n}`)||oa(`LANGCHAIN_${n}`)}let tg;function v3(){if(tg!==void 0)return tg;const n=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const t of n){const r=oa(t);r!==void 0&&(e[t]=r)}return tg=e,e}const x3=n=>!!["TRACING_V2","TRACING"].find(t=>Zr(t)==="true"),ng=Symbol.for("lc:context_variables");function S3(n){return n.replace(/[-:.]/g,"")}function E3(n,e,t=1){const r=t.toFixed(0).slice(0,3).padStart(3,"0");return S3(`${new Date(n).toISOString().slice(0,-1)}${r}Z`)+e}class Bd{constructor(e,t,r){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=t,this.project_name=r}static fromHeader(e){const t=e.split(",");let r={},s=[],a;for(const o of t){const[u,c]=o.split("="),f=decodeURIComponent(c);u==="langsmith-metadata"?r=JSON.parse(f):u==="langsmith-tags"?s=f.split(","):u==="langsmith-project"&&(a=f)}return new Bd(r,s,a)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),this.project_name&&e.push(`langsmith-project=${encodeURIComponent(this.project_name)}`),e.join(",")}}class zn{constructor(e){var u;if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),GC(e)){Object.assign(this,{...e});return}const t=zn.getDefaultConfig(),{metadata:r,...s}=e,a=s.client??zn.getSharedClient(),o={...r,...(u=s==null?void 0:s.extra)==null?void 0:u.metadata};if(s.extra={...s.extra,metadata:o},Object.assign(this,{...t,...s,client:a}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.execution_order??(this.execution_order=1),this.child_execution_order??(this.child_execution_order=1),!this.dotted_order){const c=E3(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+c:this.dotted_order=c}}static getDefaultConfig(){return{id:sn(),run_type:"chain",project_name:Zr("PROJECT")??oa("LANGCHAIN_SESSION")??"default",child_runs:[],api_url:oa("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:oa("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return zn.sharedClient||(zn.sharedClient=new iu),zn.sharedClient}createChild(e){var c,f,h,m,g,y;const t=this.child_execution_order+1,r=new zn({...e,parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:t,child_execution_order:t});ng in this&&(r[ng]=this[ng]);const s=Symbol.for("lc:child_config"),a=((c=e.extra)==null?void 0:c[s])??this.extra[s];if(P3(a)){const w={...a},v=C3(w.callbacks)?(h=(f=w.callbacks).copy)==null?void 0:h.call(f):void 0;v&&(Object.assign(v,{_parentRunId:r.id}),(y=(g=(m=v.handlers)==null?void 0:m.find(JC))==null?void 0:g.updateFromRunTree)==null||y.call(g,r),w.callbacks=v),r.extra[s]=w}const o=new Set;let u=this;for(;u!=null&&!o.has(u.id);)o.add(u.id),u.child_execution_order=Math.max(u.child_execution_order,t),u=u.parent_run;return this.child_runs.push(r),r}async end(e,t,r=Date.now(),s){this.outputs=this.outputs??e,this.error=this.error??t,this.end_time=this.end_time??r,s&&Object.keys(s).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...s}}:{metadata:s})}_convertToCreate(e,t,r=!0){var c;const s=e.extra??{};if(s.runtime||(s.runtime={}),t)for(const[f,h]of Object.entries(t))s.runtime[f]||(s.runtime[f]=h);let a,o;return r?(o=(c=e.parent_run)==null?void 0:c.id,a=[]):(a=e.child_runs.map(f=>this._convertToCreate(f,t,r)),o=void 0),{id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:s,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:a,parent_run_id:o,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments}}async postRun(e=!0){try{const t=ZC(),r=await this._convertToCreate(this,t,!0);if(await this.client.createRun(r),!e){UC("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const s of this.child_runs)await s.postRun(!1)}}catch(t){console.error(`Error in postRun for run ${this.id}:`,t)}}async patchRun(){var e;try{const t={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:(e=this.parent_run)==null?void 0:e.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments,session_name:this.project_name};await this.client.updateRun(this.id,t)}catch(t){console.error(`Error in patchRun for run ${this.id}`,t)}}toJSON(){return this._convertToCreate(this,void 0,!1)}addEvent(e){this.events||(this.events=[]),typeof e=="string"?this.events.push({name:"event",time:new Date().toISOString(),message:e}):this.events.push({...e,time:e.time??new Date().toISOString()})}static fromRunnableConfig(e,t){var f,h,m,g;const r=e==null?void 0:e.callbacks;let s,a,o,u=x3();if(r){const y=((f=r==null?void 0:r.getParentRunId)==null?void 0:f.call(r))??"",w=(h=r==null?void 0:r.handlers)==null?void 0:h.find(v=>(v==null?void 0:v.name)=="langchain_tracer");s=(m=w==null?void 0:w.getRun)==null?void 0:m.call(w,y),a=w==null?void 0:w.projectName,o=w==null?void 0:w.client,u=u||!!w}return s?new zn({name:s.name,id:s.id,trace_id:s.trace_id,dotted_order:s.dotted_order,client:o,tracingEnabled:u,project_name:a,tags:[...new Set(((s==null?void 0:s.tags)??[]).concat((e==null?void 0:e.tags)??[]))],extra:{metadata:{...(g=s==null?void 0:s.extra)==null?void 0:g.metadata,...e==null?void 0:e.metadata}}}).createChild(t):new zn({...t,client:o,tracingEnabled:u,project_name:a})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,t){var f;const r="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,s=r["langsmith-trace"];if(!s||typeof s!="string")return;const a=s.trim(),o=a.split(".").map(h=>{const[m,g]=h.split("Z");return{strTime:m,time:Date.parse(m+"Z"),uuid:g}}),u=o[0].uuid,c={...t,name:(t==null?void 0:t.name)??"parent",run_type:(t==null?void 0:t.run_type)??"chain",start_time:(t==null?void 0:t.start_time)??Date.now(),id:(f=o.at(-1))==null?void 0:f.uuid,trace_id:u,dotted_order:a};if(r.baggage&&typeof r.baggage=="string"){const h=Bd.fromHeader(r.baggage);c.metadata=h.metadata,c.tags=h.tags,c.project_name=h.project_name}return new zn(c)}toHeaders(e){var r;const t={"langsmith-trace":this.dotted_order,baggage:new Bd((r=this.extra)==null?void 0:r.metadata,this.tags,this.project_name).toHeader()};if(e)for(const[s,a]of Object.entries(t))e.set(s,a);return t}}Object.defineProperty(zn,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function GC(n){return n!==void 0&&typeof n.createChild=="function"&&typeof n.postRun=="function"}function JC(n){return typeof n=="object"&&n!=null&&typeof n.name=="string"&&n.name==="langchain_tracer"}function ES(n){return Array.isArray(n)&&n.some(e=>JC(e))}function C3(n){return typeof n=="object"&&n!=null&&Array.isArray(n.handlers)}function P3(n){var e;return n!==void 0&&typeof n.callbacks=="object"&&(ES((e=n.callbacks)==null?void 0:e.handlers)||ES(n.callbacks))}let k3=class{getStore(){}run(e,t){return t()}};const rg=Symbol.for("ls:tracing_async_local_storage"),R3=new k3;let O3=class{getInstance(){return globalThis[rg]??R3}initializeGlobalInstance(e){globalThis[rg]===void 0&&(globalThis[rg]=e)}};const T3=new O3,A3=()=>{const n=T3.getInstance().getStore();if(!GC(n))throw new Error(["Could not get the current run tree.","","Please make sure you are calling this method within a traceable function and that tracing is enabled."].join(`
`));return n};function A_(n){return typeof n=="function"&&"langsmith:traceable"in n}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const $3=Object.prototype.hasOwnProperty;function Jg(n,e){return $3.call(n,e)}function Kg(n){if(Array.isArray(n)){const t=new Array(n.length);for(let r=0;r<t.length;r++)t[r]=""+r;return t}if(Object.keys)return Object.keys(n);let e=[];for(let t in n)Jg(n,t)&&e.push(t);return e}function Gr(n){switch(typeof n){case"object":return JSON.parse(JSON.stringify(n));case"undefined":return null;default:return n}}function Xg(n){let e=0;const t=n.length;let r;for(;e<t;){if(r=n.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function Ni(n){return n.indexOf("/")===-1&&n.indexOf("~")===-1?n:n.replace(/~/g,"~0").replace(/\//g,"~1")}function I3(n){return n.replace(/~1/g,"/").replace(/~0/g,"~")}function Yg(n){if(n===void 0)return!0;if(n){if(Array.isArray(n)){for(let t=0,r=n.length;t<r;t++)if(Yg(n[t]))return!0}else if(typeof n=="object"){const t=Kg(n),r=t.length;for(var e=0;e<r;e++)if(Yg(n[t[e]]))return!0}}return!1}function CS(n,e){const t=[n];for(const r in e){const s=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof s<"u"&&t.push(`${r}: ${s}`)}return t.join(`
`)}class N3 extends Error{constructor(e,t,r,s,a){super(CS(e,{name:t,index:r,operation:s,tree:a})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.setPrototypeOf(this,new.target.prototype),this.message=CS(e,{name:t,index:r,operation:s,tree:a})}}const Et=N3,Wi={add:function(n,e,t){return n[e]=this.value,{newDocument:t}},remove:function(n,e,t){var r=n[e];return delete n[e],{newDocument:t,removed:r}},replace:function(n,e,t){var r=n[e];return n[e]=this.value,{newDocument:t,removed:r}},move:function(n,e,t){let r=Qg(t,this.path);r&&(r=Gr(r));const s=Ll(t,{op:"remove",path:this.from}).removed;return Ll(t,{op:"add",path:this.path,value:s}),{newDocument:t,removed:r}},copy:function(n,e,t){const r=Qg(t,this.from);return Ll(t,{op:"add",path:this.path,value:Gr(r)}),{newDocument:t}},test:function(n,e,t){return{newDocument:t,test:Vd(n[e],this.value)}},_get:function(n,e,t){return this.value=n[e],{newDocument:t}}};var j3={add:function(n,e,t){return Xg(e)?n.splice(e,0,this.value):n[e]=this.value,{newDocument:t,index:e}},remove:function(n,e,t){var r=n.splice(e,1);return{newDocument:t,removed:r[0]}},replace:function(n,e,t){var r=n[e];return n[e]=this.value,{newDocument:t,removed:r}},move:Wi.move,copy:Wi.copy,test:Wi.test,_get:Wi._get};function Qg(n,e){if(e=="")return n;var t={op:"_get",path:e};return Ll(n,t),t.value}function Ll(n,e,t=!1,r=!0,s=!0,a=0){if(t&&(typeof t=="function"?t(e,0,n,e.path):ey(e,0)),e.path===""){let o={newDocument:n};if(e.op==="add")return o.newDocument=e.value,o;if(e.op==="replace")return o.newDocument=e.value,o.removed=n,o;if(e.op==="move"||e.op==="copy")return o.newDocument=Qg(n,e.from),e.op==="move"&&(o.removed=n),o;if(e.op==="test"){if(o.test=Vd(n,e.value),o.test===!1)throw new Et("Test operation failed","TEST_OPERATION_FAILED",a,e,n);return o.newDocument=n,o}else{if(e.op==="remove")return o.removed=n,o.newDocument=null,o;if(e.op==="_get")return e.value=n,o;if(t)throw new Et("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",a,e,n);return o}}else{r||(n=Gr(n));const u=(e.path||"").split("/");let c=n,f=1,h=u.length,m,g,y;for(typeof t=="function"?y=t:y=ey;;){if(g=u[f],g&&g.indexOf("~")!=-1&&(g=I3(g)),s&&(g=="__proto__"||g=="prototype"&&f>0&&u[f-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(t&&m===void 0&&(c[g]===void 0?m=u.slice(0,f).join("/"):f==h-1&&(m=e.path),m!==void 0&&y(e,0,n,m)),f++,Array.isArray(c)){if(g==="-")g=c.length;else{if(t&&!Xg(g))throw new Et("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",a,e,n);Xg(g)&&(g=~~g)}if(f>=h){if(t&&e.op==="add"&&g>c.length)throw new Et("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",a,e,n);const w=j3[e.op].call(e,c,g,n);if(w.test===!1)throw new Et("Test operation failed","TEST_OPERATION_FAILED",a,e,n);return w}}else if(f>=h){const w=Wi[e.op].call(e,c,g,n);if(w.test===!1)throw new Et("Test operation failed","TEST_OPERATION_FAILED",a,e,n);return w}if(c=c[g],t&&f<h&&(!c||typeof c!="object"))throw new Et("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",a,e,n)}}}function Hd(n,e,t,r=!0,s=!0){if(t&&!Array.isArray(e))throw new Et("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(n=Gr(n));const a=new Array(e.length);for(let o=0,u=e.length;o<u;o++)a[o]=Ll(n,e[o],t,!0,s,o),n=a[o].newDocument;return a.newDocument=n,a}function ey(n,e,t,r){if(typeof n!="object"||n===null||Array.isArray(n))throw new Et("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,n,t);if(Wi[n.op]){if(typeof n.path!="string")throw new Et("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,n,t);if(n.path.indexOf("/")!==0&&n.path.length>0)throw new Et('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,n,t);if((n.op==="move"||n.op==="copy")&&typeof n.from!="string")throw new Et("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,n,t);if((n.op==="add"||n.op==="replace"||n.op==="test")&&n.value===void 0)throw new Et("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,n,t);if((n.op==="add"||n.op==="replace"||n.op==="test")&&Yg(n.value))throw new Et("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,n,t);if(t){if(n.op=="add"){var s=n.path.split("/").length,a=r.split("/").length;if(s!==a+1&&s!==a)throw new Et("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,n,t)}else if(n.op==="replace"||n.op==="remove"||n.op==="_get"){if(n.path!==r)throw new Et("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,n,t)}else if(n.op==="move"||n.op==="copy"){var o={op:"_get",path:n.from,value:void 0},u=L3([o],t);if(u&&u.name==="OPERATION_PATH_UNRESOLVABLE")throw new Et("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,n,t)}}}else throw new Et("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,n,t)}function L3(n,e,t){try{if(!Array.isArray(n))throw new Et("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)Hd(Gr(e),Gr(n),t||!0);else{t=t||ey;for(var r=0;r<n.length;r++)t(n[r],r,e,void 0)}}catch(s){if(s instanceof Et)return s;throw s}}function Vd(n,e){if(n===e)return!0;if(n&&e&&typeof n=="object"&&typeof e=="object"){var t=Array.isArray(n),r=Array.isArray(e),s,a,o;if(t&&r){if(a=n.length,a!=e.length)return!1;for(s=a;s--!==0;)if(!Vd(n[s],e[s]))return!1;return!0}if(t!=r)return!1;var u=Object.keys(n);if(a=u.length,a!==Object.keys(e).length)return!1;for(s=a;s--!==0;)if(!e.hasOwnProperty(u[s]))return!1;for(s=a;s--!==0;)if(o=u[s],!Vd(n[o],e[o]))return!1;return!0}return n!==n&&e!==e}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2013-2021 Joachim Wester
 * MIT license
 */function KC(n,e,t,r,s){if(e!==n){typeof e.toJSON=="function"&&(e=e.toJSON());for(var a=Kg(e),o=Kg(n),u=!1,c=o.length-1;c>=0;c--){var f=o[c],h=n[f];if(Jg(e,f)&&!(e[f]===void 0&&h!==void 0&&Array.isArray(e)===!1)){var m=e[f];typeof h=="object"&&h!=null&&typeof m=="object"&&m!=null&&Array.isArray(h)===Array.isArray(m)?KC(h,m,t,r+"/"+Ni(f),s):h!==m&&(s&&t.push({op:"test",path:r+"/"+Ni(f),value:Gr(h)}),t.push({op:"replace",path:r+"/"+Ni(f),value:Gr(m)}))}else Array.isArray(n)===Array.isArray(e)?(s&&t.push({op:"test",path:r+"/"+Ni(f),value:Gr(h)}),t.push({op:"remove",path:r+"/"+Ni(f)}),u=!0):(s&&t.push({op:"test",path:r,value:n}),t.push({op:"replace",path:r,value:e}))}if(!(!u&&a.length==o.length))for(var c=0;c<a.length;c++){var f=a[c];!Jg(n,f)&&e[f]!==void 0&&t.push({op:"add",path:r+"/"+Ni(f),value:Gr(e[f])})}}}function M3(n,e,t=!1){var r=[];return KC(n,e,r,"",t),r}var sg={};const D3=()=>typeof window<"u"&&typeof window.document<"u",F3=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",U3=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),$_=()=>typeof Deno<"u",z3=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!$_(),B3=()=>{let n;return D3()?n="browser":z3()?n="node":F3()?n="webworker":U3()?n="jsdom":$_()?n="deno":n="other",n};let ag;async function H3(){return ag===void 0&&(ag={library:"langchain-js",runtime:B3()}),ag}function Yr(n){try{return typeof process<"u"?sg==null?void 0:sg[n]:$_()?Deno==null?void 0:Deno.env.get(n):void 0}catch{return}}class V3{}function W3(n){return"lc_prefer_streaming"in n&&n.lc_prefer_streaming}class Pu extends V3{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}get lc_serializable_keys(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,PC(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:Yr("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return Ja.prototype.toJSON.call(this)}toJSONNotImplemented(){return Ja.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class t extends Pu{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:sn()}),Object.assign(this,e)}}return new t}}const q3=n=>{const e=n;return e!==void 0&&typeof e.copy=="function"&&typeof e.name=="string"&&typeof e.awaitHandlers=="boolean"};function ig(n,e){return n&&!Array.isArray(n)&&typeof n=="object"?n:{[e]:n}}function Z3(n){return n.replace(/[-:.]/g,"")}function G3(n,e,t){const r=t.toFixed(0).slice(0,3).padStart(3,"0");return Z3(`${new Date(n).toISOString().slice(0,-1)}${r}Z`)+e}function xl(n){return typeof n._addRunToRunMap=="function"}class ku extends Pu{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e!=null&&e.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,t){e.child_runs.push(t)}_addRunToRunMap(e){const t=G3(e.start_time,e.id,e.execution_order),r={...e};if(r.parent_run_id!==void 0){const s=this.runMap.get(r.parent_run_id);s&&(this._addChildRun(s,r),s.child_execution_order=Math.max(s.child_execution_order,r.child_execution_order),r.trace_id=s.trace_id,s.dotted_order!==void 0&&(r.dotted_order=[s.dotted_order,t].join(".")))}else r.trace_id=r.id,r.dotted_order=t;return this.runMap.set(r.id,r),r}async _endTrace(e){var r;const t=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await((r=this.onRunUpdate)==null?void 0:r.call(this,e))}_getExecutionOrder(e){const t=e!==void 0&&this.runMap.get(e);return t?t.child_execution_order+1:1}_createRunForLLMStart(e,t,r,s,a,o,u,c){const f=this._getExecutionOrder(s),h=Date.now(),m=u?{...a,metadata:u}:a,g={id:r,name:c??e.id[e.id.length-1],parent_run_id:s,start_time:h,serialized:e,events:[{name:"start",time:new Date(h).toISOString()}],inputs:{prompts:t},execution_order:f,child_runs:[],child_execution_order:f,run_type:"llm",extra:m??{},tags:o||[]};return this._addRunToRunMap(g)}async handleLLMStart(e,t,r,s,a,o,u,c){var h,m;const f=this.runMap.get(r)??this._createRunForLLMStart(e,t,r,s,a,o,u,c);return await((h=this.onRunCreate)==null?void 0:h.call(this,f)),await((m=this.onLLMStart)==null?void 0:m.call(this,f)),f}_createRunForChatModelStart(e,t,r,s,a,o,u,c){const f=this._getExecutionOrder(s),h=Date.now(),m=u?{...a,metadata:u}:a,g={id:r,name:c??e.id[e.id.length-1],parent_run_id:s,start_time:h,serialized:e,events:[{name:"start",time:new Date(h).toISOString()}],inputs:{messages:t},execution_order:f,child_runs:[],child_execution_order:f,run_type:"llm",extra:m??{},tags:o||[]};return this._addRunToRunMap(g)}async handleChatModelStart(e,t,r,s,a,o,u,c){var h,m;const f=this.runMap.get(r)??this._createRunForChatModelStart(e,t,r,s,a,o,u,c);return await((h=this.onRunCreate)==null?void 0:h.call(this,f)),await((m=this.onLLMStart)==null?void 0:m.call(this,f)),f}async handleLLMEnd(e,t,r,s,a){var u;const o=this.runMap.get(t);if(!o||(o==null?void 0:o.run_type)!=="llm")throw new Error("No LLM run to end.");return o.end_time=Date.now(),o.outputs=e,o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),o.extra={...o.extra,...a},await((u=this.onLLMEnd)==null?void 0:u.call(this,o)),await this._endTrace(o),o}async handleLLMError(e,t,r,s,a){var u;const o=this.runMap.get(t);if(!o||(o==null?void 0:o.run_type)!=="llm")throw new Error("No LLM run to end.");return o.end_time=Date.now(),o.error=this.stringifyError(e),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),o.extra={...o.extra,...a},await((u=this.onLLMError)==null?void 0:u.call(this,o)),await this._endTrace(o),o}_createRunForChainStart(e,t,r,s,a,o,u,c){const f=this._getExecutionOrder(s),h=Date.now(),m={id:r,name:c??e.id[e.id.length-1],parent_run_id:s,start_time:h,serialized:e,events:[{name:"start",time:new Date(h).toISOString()}],inputs:t,execution_order:f,child_execution_order:f,run_type:u??"chain",child_runs:[],extra:o?{metadata:o}:{},tags:a||[]};return this._addRunToRunMap(m)}async handleChainStart(e,t,r,s,a,o,u,c){var h,m;const f=this.runMap.get(r)??this._createRunForChainStart(e,t,r,s,a,o,u,c);return await((h=this.onRunCreate)==null?void 0:h.call(this,f)),await((m=this.onChainStart)==null?void 0:m.call(this,f)),f}async handleChainEnd(e,t,r,s,a){var u;const o=this.runMap.get(t);if(!o)throw new Error("No chain run to end.");return o.end_time=Date.now(),o.outputs=ig(e,"output"),o.events.push({name:"end",time:new Date(o.end_time).toISOString()}),(a==null?void 0:a.inputs)!==void 0&&(o.inputs=ig(a.inputs,"input")),await((u=this.onChainEnd)==null?void 0:u.call(this,o)),await this._endTrace(o),o}async handleChainError(e,t,r,s,a){var u;const o=this.runMap.get(t);if(!o)throw new Error("No chain run to end.");return o.end_time=Date.now(),o.error=this.stringifyError(e),o.events.push({name:"error",time:new Date(o.end_time).toISOString()}),(a==null?void 0:a.inputs)!==void 0&&(o.inputs=ig(a.inputs,"input")),await((u=this.onChainError)==null?void 0:u.call(this,o)),await this._endTrace(o),o}_createRunForToolStart(e,t,r,s,a,o,u){const c=this._getExecutionOrder(s),f=Date.now(),h={id:r,name:u??e.id[e.id.length-1],parent_run_id:s,start_time:f,serialized:e,events:[{name:"start",time:new Date(f).toISOString()}],inputs:{input:t},execution_order:c,child_execution_order:c,run_type:"tool",child_runs:[],extra:o?{metadata:o}:{},tags:a||[]};return this._addRunToRunMap(h)}async handleToolStart(e,t,r,s,a,o,u){var f,h;const c=this.runMap.get(r)??this._createRunForToolStart(e,t,r,s,a,o,u);return await((f=this.onRunCreate)==null?void 0:f.call(this,c)),await((h=this.onToolStart)==null?void 0:h.call(this,c)),c}async handleToolEnd(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((s=this.onToolEnd)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleToolError(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((s=this.onToolError)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleAgentAction(e,t){var a;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="chain")return;const s=r;s.actions=s.actions||[],s.actions.push(e),s.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await((a=this.onAgentAction)==null?void 0:a.call(this,r))}async handleAgentEnd(e,t){var s;const r=this.runMap.get(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await((s=this.onAgentEnd)==null?void 0:s.call(this,r)))}_createRunForRetrieverStart(e,t,r,s,a,o,u){const c=this._getExecutionOrder(s),f=Date.now(),h={id:r,name:u??e.id[e.id.length-1],parent_run_id:s,start_time:f,serialized:e,events:[{name:"start",time:new Date(f).toISOString()}],inputs:{query:t},execution_order:c,child_execution_order:c,run_type:"retriever",child_runs:[],extra:o?{metadata:o}:{},tags:a||[]};return this._addRunToRunMap(h)}async handleRetrieverStart(e,t,r,s,a,o,u){var f,h;const c=this.runMap.get(r)??this._createRunForRetrieverStart(e,t,r,s,a,o,u);return await((f=this.onRunCreate)==null?void 0:f.call(this,c)),await((h=this.onRetrieverStart)==null?void 0:h.call(this,c)),c}async handleRetrieverEnd(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await((s=this.onRetrieverEnd)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleRetrieverError(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await((s=this.onRetrieverError)==null?void 0:s.call(this,r)),await this._endTrace(r),r}async handleText(e,t){var s;const r=this.runMap.get(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await((s=this.onText)==null?void 0:s.call(this,r)))}async handleLLMNewToken(e,t,r,s,a,o){var c;const u=this.runMap.get(r);if(!u||(u==null?void 0:u.run_type)!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return u.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:t,chunk:o==null?void 0:o.chunk}}),await((c=this.onLLMNewToken)==null?void 0:c.call(this,u,e,{chunk:o==null?void 0:o.chunk})),u}}var _d={exports:{}};_d.exports;var PS;function J3(){return PS||(PS=1,function(n){const t=(a=0)=>o=>`\x1B[${38+a};5;${o}m`,r=(a=0)=>(o,u,c)=>`\x1B[${38+a};2;${o};${u};${c}m`;function s(){const a=new Map,o={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};o.color.gray=o.color.blackBright,o.bgColor.bgGray=o.bgColor.bgBlackBright,o.color.grey=o.color.blackBright,o.bgColor.bgGrey=o.bgColor.bgBlackBright;for(const[u,c]of Object.entries(o)){for(const[f,h]of Object.entries(c))o[f]={open:`\x1B[${h[0]}m`,close:`\x1B[${h[1]}m`},c[f]=o[f],a.set(h[0],h[1]);Object.defineProperty(o,u,{value:c,enumerable:!1})}return Object.defineProperty(o,"codes",{value:a,enumerable:!1}),o.color.close="\x1B[39m",o.bgColor.close="\x1B[49m",o.color.ansi256=t(),o.color.ansi16m=r(),o.bgColor.ansi256=t(10),o.bgColor.ansi16m=r(10),Object.defineProperties(o,{rgbToAnsi256:{value:(u,c,f)=>u===c&&c===f?u<8?16:u>248?231:Math.round((u-8)/247*24)+232:16+36*Math.round(u/255*5)+6*Math.round(c/255*5)+Math.round(f/255*5),enumerable:!1},hexToRgb:{value:u=>{const c=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(u.toString(16));if(!c)return[0,0,0];let{colorString:f}=c.groups;f.length===3&&(f=f.split("").map(m=>m+m).join(""));const h=Number.parseInt(f,16);return[h>>16&255,h>>8&255,h&255]},enumerable:!1},hexToAnsi256:{value:u=>o.rgbToAnsi256(...o.hexToRgb(u)),enumerable:!1}}),o}Object.defineProperty(n,"exports",{enumerable:!0,get:s})}(_d)),_d.exports}var K3=J3();const XC=ti(K3);function fn(n,e){return`${n.open}${e}${n.close}`}function er(n,e){try{return JSON.stringify(n,null,2)}catch{return e}}function kS(n){return typeof n=="string"?n.trim():n==null?n:er(n,n.toString())}function na(n){if(!n.end_time)return"";const e=n.end_time-n.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:kn}=XC;class RS extends ku{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const t=[];let r=e;for(;r.parent_run_id;){const s=this.runMap.get(r.parent_run_id);if(s)t.push(s),r=s;else break}return t}getBreadcrumbs(e){const r=[...this.getParents(e).reverse(),e].map((s,a,o)=>{const u=`${s.execution_order}:${s.run_type}:${s.name}`;return a===o.length-1?fn(XC.bold,u):u}).join(" > ");return fn(kn.grey,r)}onChainStart(e){const t=this.getBreadcrumbs(e);console.log(`${fn(kn.green,"[chain/start]")} [${t}] Entering Chain run with input: ${er(e.inputs,"[inputs]")}`)}onChainEnd(e){const t=this.getBreadcrumbs(e);console.log(`${fn(kn.cyan,"[chain/end]")} [${t}] [${na(e)}] Exiting Chain run with output: ${er(e.outputs,"[outputs]")}`)}onChainError(e){const t=this.getBreadcrumbs(e);console.log(`${fn(kn.red,"[chain/error]")} [${t}] [${na(e)}] Chain run errored with error: ${er(e.error,"[error]")}`)}onLLMStart(e){const t=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(s=>s.trim())}:e.inputs;console.log(`${fn(kn.green,"[llm/start]")} [${t}] Entering LLM run with input: ${er(r,"[inputs]")}`)}onLLMEnd(e){const t=this.getBreadcrumbs(e);console.log(`${fn(kn.cyan,"[llm/end]")} [${t}] [${na(e)}] Exiting LLM run with output: ${er(e.outputs,"[response]")}`)}onLLMError(e){const t=this.getBreadcrumbs(e);console.log(`${fn(kn.red,"[llm/error]")} [${t}] [${na(e)}] LLM run errored with error: ${er(e.error,"[error]")}`)}onToolStart(e){const t=this.getBreadcrumbs(e);console.log(`${fn(kn.green,"[tool/start]")} [${t}] Entering Tool run with input: "${kS(e.inputs.input)}"`)}onToolEnd(e){var r;const t=this.getBreadcrumbs(e);console.log(`${fn(kn.cyan,"[tool/end]")} [${t}] [${na(e)}] Exiting Tool run with output: "${kS((r=e.outputs)==null?void 0:r.output)}"`)}onToolError(e){const t=this.getBreadcrumbs(e);console.log(`${fn(kn.red,"[tool/error]")} [${t}] [${na(e)}] Tool run errored with error: ${er(e.error,"[error]")}`)}onRetrieverStart(e){const t=this.getBreadcrumbs(e);console.log(`${fn(kn.green,"[retriever/start]")} [${t}] Entering Retriever run with input: ${er(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const t=this.getBreadcrumbs(e);console.log(`${fn(kn.cyan,"[retriever/end]")} [${t}] [${na(e)}] Exiting Retriever run with output: ${er(e.outputs,"[outputs]")}`)}onRetrieverError(e){const t=this.getBreadcrumbs(e);console.log(`${fn(kn.red,"[retriever/error]")} [${t}] [${na(e)}] Retriever run errored with error: ${er(e.error,"[error]")}`)}onAgentAction(e){const t=e,r=this.getBreadcrumbs(e);console.log(`${fn(kn.blue,"[agent/action]")} [${r}] Agent selected action: ${er(t.actions[t.actions.length-1],"[action]")}`)}}let og;const X3=()=>{if(og===void 0){const n=Yr("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{};og=new iu(n)}return og};class Ml extends ku{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:t,projectName:r,client:s}=e;this.projectName=r??Yr("LANGCHAIN_PROJECT")??Yr("LANGCHAIN_SESSION"),this.exampleId=t,this.client=s??X3();const a=Ml.getTraceableRunTree();a&&this.updateFromRunTree(a)}async _convertToCreate(e,t=void 0){return{...e,extra:{...e.extra,runtime:await H3()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:t}}async persistRun(e){}async onRunCreate(e){const t=await this._convertToCreate(e,this.exampleId);await this.client.createRun(t)}async onRunUpdate(e){const t={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id,extra:e.extra,session_name:this.projectName};await this.client.updateRun(e.id,t)}getRun(e){return this.runMap.get(e)}updateFromRunTree(e){let t=e;const r=new Set;for(;t.parent_run&&!(r.has(t.id)||(r.add(t.id),!t.parent_run));)t=t.parent_run;r.clear();const s=[t];for(;s.length>0;){const a=s.shift();!a||r.has(a.id)||(r.add(a.id),this.runMap.set(a.id,a),a.child_runs&&s.push(...a.child_runs))}this.client=e.client??this.client,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}convertToRunTree(e){const t={},r=[];for(const[s,a]of this.runMap){const o=new zn({...a,child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0});t[s]=o,r.push([s,a.dotted_order])}r.sort((s,a)=>!s[1]||!a[1]?0:s[1].localeCompare(a[1]));for(const[s]of r){const a=this.runMap.get(s),o=t[s];if(!(!a||!o)&&a.parent_run_id){const u=t[a.parent_run_id];u&&(u.child_runs.push(o),o.parent_run=u)}}return t[e]}static getTraceableRunTree(){try{return A3()}catch{return}}}const YC=Symbol.for("ls:tracing_async_local_storage"),wd=Symbol.for("lc:context_variables"),Y3=n=>{globalThis[YC]=n},ou=()=>globalThis[YC];let Dl;function Q3(){const n="default"in Rs?Rs.default:Rs;return new n({autoStart:!0,concurrency:1})}function eM(){return typeof Dl>"u"&&(Dl=Q3()),Dl}async function $t(n,e){if(e===!0){const t=ou();t!==void 0?await t.run(void 0,async()=>n()):await n()}else Dl=eM(),Dl.add(async()=>{const t=ou();t!==void 0?await t.run(void 0,async()=>n()):await n()})}const tM=n=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(t=>Yr(t)==="true");function QC(n){var r;const e=ou();if(e===void 0)return;const t=e.getStore();return(r=t==null?void 0:t[wd])==null?void 0:r[n]}const nM=Symbol("lc:configure_hooks"),rM=()=>QC(nM)||[];class sM{setHandler(e){return this.setHandlers([e])}}class $f{constructor(e,t,r,s,a,o,u,c){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:u}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:c})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(t=>$t(async()=>{var r;try{await((r=t.handleText)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleText: ${s}`),t.raiseError)throw s}},t.awaitHandlers)))}async handleCustomEvent(e,t,r,s,a){await Promise.all(this.handlers.map(o=>$t(async()=>{var u;try{await((u=o.handleCustomEvent)==null?void 0:u.call(o,e,t,this.runId,this.tags,this.metadata))}catch(c){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleCustomEvent: ${c}`),o.raiseError)throw c}},o.awaitHandlers)))}}class aM extends $f{getChild(e){const t=new On(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(t=>$t(async()=>{var r;if(!t.ignoreRetriever)try{await((r=t.handleRetrieverEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetriever`),t.raiseError)throw s}},t.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(t=>$t(async()=>{var r;if(!t.ignoreRetriever)try{await((r=t.handleRetrieverError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleRetrieverError: ${s}`),t.raiseError)throw e}},t.awaitHandlers)))}}class OS extends $f{async handleLLMNewToken(e,t,r,s,a,o){await Promise.all(this.handlers.map(u=>$t(async()=>{var c;if(!u.ignoreLLM)try{await((c=u.handleLLMNewToken)==null?void 0:c.call(u,e,t??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,o))}catch(f){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleLLMNewToken: ${f}`),u.raiseError)throw f}},u.awaitHandlers)))}async handleLLMError(e,t,r,s,a){await Promise.all(this.handlers.map(o=>$t(async()=>{var u;if(!o.ignoreLLM)try{await((u=o.handleLLMError)==null?void 0:u.call(o,e,this.runId,this._parentRunId,this.tags,a))}catch(c){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleLLMError: ${c}`),o.raiseError)throw c}},o.awaitHandlers)))}async handleLLMEnd(e,t,r,s,a){await Promise.all(this.handlers.map(o=>$t(async()=>{var u;if(!o.ignoreLLM)try{await((u=o.handleLLMEnd)==null?void 0:u.call(o,e,this.runId,this._parentRunId,this.tags,a))}catch(c){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleLLMEnd: ${c}`),o.raiseError)throw c}},o.awaitHandlers)))}}class iM extends $f{getChild(e){const t=new On(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e,t,r,s,a){await Promise.all(this.handlers.map(o=>$t(async()=>{var u;if(!o.ignoreChain)try{await((u=o.handleChainError)==null?void 0:u.call(o,e,this.runId,this._parentRunId,this.tags,a))}catch(c){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleChainError: ${c}`),o.raiseError)throw c}},o.awaitHandlers)))}async handleChainEnd(e,t,r,s,a){await Promise.all(this.handlers.map(o=>$t(async()=>{var u;if(!o.ignoreChain)try{await((u=o.handleChainEnd)==null?void 0:u.call(o,e,this.runId,this._parentRunId,this.tags,a))}catch(c){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleChainEnd: ${c}`),o.raiseError)throw c}},o.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>$t(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentAction)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentAction: ${s}`),t.raiseError)throw s}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>$t(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleAgentEnd: ${s}`),t.raiseError)throw s}},t.awaitHandlers)))}}class oM extends $f{getChild(e){const t=new On(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>$t(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolError: ${s}`),t.raiseError)throw s}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>$t(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){if((t.raiseError?console.error:console.warn)(`Error in handler ${t.constructor.name}, handleToolEnd: ${s}`),t.raiseError)throw s}},t.awaitHandlers)))}}class On extends sM{constructor(e,t){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=(t==null?void 0:t.handlers)??this.handlers,this.inheritableHandlers=(t==null?void 0:t.inheritableHandlers)??this.inheritableHandlers,this.tags=(t==null?void 0:t.tags)??this.tags,this.inheritableTags=(t==null?void 0:t.inheritableTags)??this.inheritableTags,this.metadata=(t==null?void 0:t.metadata)??this.metadata,this.inheritableMetadata=(t==null?void 0:t.inheritableMetadata)??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,t,r=void 0,s=void 0,a=void 0,o=void 0,u=void 0,c=void 0){return Promise.all(t.map(async(f,h)=>{const m=h===0&&r?r:sn();return await Promise.all(this.handlers.map(g=>{if(!g.ignoreLLM)return xl(g)&&g._createRunForLLMStart(e,[f],m,this._parentRunId,a,this.tags,this.metadata,c),$t(async()=>{var y;try{await((y=g.handleLLMStart)==null?void 0:y.call(g,e,[f],m,this._parentRunId,a,this.tags,this.metadata,c))}catch(w){if((g.raiseError?console.error:console.warn)(`Error in handler ${g.constructor.name}, handleLLMStart: ${w}`),g.raiseError)throw w}},g.awaitHandlers)})),new OS(m,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,r=void 0,s=void 0,a=void 0,o=void 0,u=void 0,c=void 0){return Promise.all(t.map(async(f,h)=>{const m=h===0&&r?r:sn();return await Promise.all(this.handlers.map(g=>{if(!g.ignoreLLM)return xl(g)&&g._createRunForChatModelStart(e,[f],m,this._parentRunId,a,this.tags,this.metadata,c),$t(async()=>{var y,w;try{if(g.handleChatModelStart)await((y=g.handleChatModelStart)==null?void 0:y.call(g,e,[f],m,this._parentRunId,a,this.tags,this.metadata,c));else if(g.handleLLMStart){const v=OC(f);await((w=g.handleLLMStart)==null?void 0:w.call(g,e,[v],m,this._parentRunId,a,this.tags,this.metadata,c))}}catch(v){if((g.raiseError?console.error:console.warn)(`Error in handler ${g.constructor.name}, handleLLMStart: ${v}`),g.raiseError)throw v}},g.awaitHandlers)})),new OS(m,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,r=sn(),s=void 0,a=void 0,o=void 0,u=void 0){return await Promise.all(this.handlers.map(c=>{if(!c.ignoreChain)return xl(c)&&c._createRunForChainStart(e,t,r,this._parentRunId,this.tags,this.metadata,s,u),$t(async()=>{var f;try{await((f=c.handleChainStart)==null?void 0:f.call(c,e,t,r,this._parentRunId,this.tags,this.metadata,s,u))}catch(h){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleChainStart: ${h}`),c.raiseError)throw h}},c.awaitHandlers)})),new iM(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,r=sn(),s=void 0,a=void 0,o=void 0,u=void 0){return await Promise.all(this.handlers.map(c=>{if(!c.ignoreAgent)return xl(c)&&c._createRunForToolStart(e,t,r,this._parentRunId,this.tags,this.metadata,u),$t(async()=>{var f;try{await((f=c.handleToolStart)==null?void 0:f.call(c,e,t,r,this._parentRunId,this.tags,this.metadata,u))}catch(h){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleToolStart: ${h}`),c.raiseError)throw h}},c.awaitHandlers)})),new oM(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,t,r=sn(),s=void 0,a=void 0,o=void 0,u=void 0){return await Promise.all(this.handlers.map(c=>{if(!c.ignoreRetriever)return xl(c)&&c._createRunForRetrieverStart(e,t,r,this._parentRunId,this.tags,this.metadata,u),$t(async()=>{var f;try{await((f=c.handleRetrieverStart)==null?void 0:f.call(c,e,t,r,this._parentRunId,this.tags,this.metadata,u))}catch(h){if((c.raiseError?console.error:console.warn)(`Error in handler ${c.constructor.name}, handleRetrieverStart: ${h}`),c.raiseError)throw h}},c.awaitHandlers)})),new aM(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,t,r,s,a){await Promise.all(this.handlers.map(o=>$t(async()=>{var u;if(!o.ignoreCustomEvent)try{await((u=o.handleCustomEvent)==null?void 0:u.call(o,e,t,r,this.tags,this.metadata))}catch(c){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleCustomEvent: ${c}`),o.raiseError)throw c}},o.awaitHandlers)))}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){this.handlers=[],this.inheritableHandlers=[];for(const r of e)this.addHandler(r,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){const r=new On(this._parentRunId);for(const s of this.handlers){const a=this.inheritableHandlers.includes(s);r.addHandler(s,a)}for(const s of this.tags){const a=this.inheritableTags.includes(s);r.addTags([s],a)}for(const s of Object.keys(this.metadata)){const a=Object.keys(this.inheritableMetadata).includes(s);r.addMetadata({[s]:this.metadata[s]},a)}for(const s of e)r.handlers.filter(a=>a.name==="console_callback_handler").some(a=>a.name===s.name)||r.addHandler(s,t);return r}static fromHandlers(e){class t extends Pu{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:sn()}),Object.assign(this,e)}}const r=new this;return r.addHandler(new t),r}static configure(e,t,r,s,a,o,u){return this._configureSync(e,t,r,s,a,o,u)}static _configureSync(e,t,r,s,a,o,u){var g,y;let c;(e||t)&&(Array.isArray(e)||!e?(c=new On,c.setHandlers((e==null?void 0:e.map(Wd))??[],!0)):c=e,c=c.copy(Array.isArray(t)?t.map(Wd):t==null?void 0:t.handlers,!1));const f=Yr("LANGCHAIN_VERBOSE")==="true"||(u==null?void 0:u.verbose),h=((g=Ml.getTraceableRunTree())==null?void 0:g.tracingEnabled)||tM(),m=h||(Yr("LANGCHAIN_TRACING")??!1);if(f||m){if(c||(c=new On),f&&!c.handlers.some(w=>w.name===RS.prototype.name)){const w=new RS;c.addHandler(w,!0)}if(m&&!c.handlers.some(w=>w.name==="langchain_tracer")&&h){const w=new Ml;c.addHandler(w,!0),c._parentRunId=((y=Ml.getTraceableRunTree())==null?void 0:y.id)??c._parentRunId}}for(const{contextVar:w,inheritable:v=!0,handlerClass:x,envVar:E}of rM()){const k=E&&Yr(E)==="true"&&x;let S;const R=w!==void 0?QC(w):void 0;R&&q3(R)?S=R:k&&(S=new x({})),S!==void 0&&(c||(c=new On),c.handlers.some(A=>A.name===S.name)||c.addHandler(S,v))}return(r||s)&&c&&(c.addTags(r??[]),c.addTags(s??[],!1)),(a||o)&&c&&(c.addMetadata(a??{}),c.addMetadata(o??{},!1)),c}}function Wd(n){return"name"in n?n:Pu.fromMethods(n)}class lM{getStore(){}run(e,t){return t()}enterWith(e){}}const uM=new lM,TS=Symbol.for("lc:child_config");class cM{getInstance(){return ou()??uM}getRunnableConfig(){var t,r;return(r=(t=this.getInstance().getStore())==null?void 0:t.extra)==null?void 0:r[TS]}runWithConfig(e,t,r){var h;const s=On._configureSync(e==null?void 0:e.callbacks,void 0,e==null?void 0:e.tags,void 0,e==null?void 0:e.metadata),a=this.getInstance(),o=a.getStore(),u=s==null?void 0:s.getParentRunId(),c=(h=s==null?void 0:s.handlers)==null?void 0:h.find(m=>(m==null?void 0:m.name)==="langchain_tracer");let f;return c&&u?f=c.convertToRunTree(u):r||(f=new zn({name:"<runnable_lambda>",tracingEnabled:!1})),f&&(f.extra={...f.extra,[TS]:e}),o!==void 0&&o[wd]!==void 0&&(f===void 0&&(f={}),f[wd]=o[wd]),a.run(f,t)}initializeGlobalInstance(e){ou()===void 0&&Y3(e)}}const ma=new cM,lg=25;async function Or(n){return On._configureSync(n==null?void 0:n.callbacks,void 0,n==null?void 0:n.tags,void 0,n==null?void 0:n.metadata)}function AS(...n){const e={};for(const t of n.filter(r=>!!r))for(const r of Object.keys(t))if(r==="metadata")e[r]={...e[r],...t[r]};else if(r==="tags"){const s=e[r]??[];e[r]=[...new Set(s.concat(t[r]??[]))]}else if(r==="configurable")e[r]={...e[r],...t[r]};else if(r==="timeout")e.timeout===void 0?e.timeout=t.timeout:t.timeout!==void 0&&(e.timeout=Math.min(e.timeout,t.timeout));else if(r==="signal")e.signal===void 0?e.signal=t.signal:t.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,t.signal]):e.signal=t.signal);else if(r==="callbacks"){const s=e.callbacks,a=t.callbacks;if(Array.isArray(a))if(!s)e.callbacks=a;else if(Array.isArray(s))e.callbacks=s.concat(a);else{const o=s.copy();for(const u of a)o.addHandler(Wd(u),!0);e.callbacks=o}else if(a)if(!s)e.callbacks=a;else if(Array.isArray(s)){const o=a.copy();for(const u of s)o.addHandler(Wd(u),!0);e.callbacks=o}else e.callbacks=new On(a._parentRunId,{handlers:s.handlers.concat(a.handlers),inheritableHandlers:s.inheritableHandlers.concat(a.inheritableHandlers),tags:Array.from(new Set(s.tags.concat(a.tags))),inheritableTags:Array.from(new Set(s.inheritableTags.concat(a.inheritableTags))),metadata:{...s.metadata,...a.metadata}})}else{const s=r;e[s]=t[s]??e[s]}return e}const dM=new Set(["string","number","boolean"]);function Ge(n){var r;const e=ma.getRunnableConfig();let t={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:s,runName:a,...o}=e;t=Object.entries(o).reduce((u,[c,f])=>(f!==void 0&&(u[c]=f),u),t)}if(n&&(t=Object.entries(n).reduce((s,[a,o])=>(o!==void 0&&(s[a]=o),s),t)),t!=null&&t.configurable)for(const s of Object.keys(t.configurable))dM.has(typeof t.configurable[s])&&!((r=t.metadata)!=null&&r[s])&&(t.metadata||(t.metadata={}),t.metadata[s]=t.configurable[s]);if(t.timeout!==void 0){if(t.timeout<=0)throw new Error("Timeout must be a positive number");const s=AbortSignal.timeout(t.timeout);t.signal!==void 0?"any"in AbortSignal&&(t.signal=AbortSignal.any([t.signal,s])):t.signal=s,delete t.timeout}return t}function an(n={},{callbacks:e,maxConcurrency:t,recursionLimit:r,runName:s,configurable:a,runId:o}={}){const u=Ge(n);return e!==void 0&&(delete u.runName,u.callbacks=e),r!==void 0&&(u.recursionLimit=r),t!==void 0&&(u.maxConcurrency=t),s!==void 0&&(u.runName=s),a!==void 0&&(u.configurable={...u.configurable,...a}),o!==void 0&&delete u.runId,u}function io(n){return n?{configurable:n.configurable,recursionLimit:n.recursionLimit,callbacks:n.callbacks,tags:n.tags,metadata:n.metadata,maxConcurrency:n.maxConcurrency,timeout:n.timeout,signal:n.signal}:void 0}async function ga(n,e){if(e===void 0)return n;let t;return Promise.race([n.catch(r=>{if(!(e!=null&&e.aborted))throw r}),new Promise((r,s)=>{t=()=>{s(new Error("Aborted"))},e.addEventListener("abort",t),e.aborted&&s(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",t))}class Wn extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const t=this.reader.cancel();this.reader.releaseLock(),await t}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const t=e.getReader();return new Wn({start(r){return s();function s(){return t.read().then(({done:a,value:o})=>{if(a){r.close();return}return r.enqueue(o),s()})}},cancel(){t.releaseLock()}})}static fromAsyncGenerator(e){return new Wn({async pull(t){const{value:r,done:s}=await e.next();s&&t.close(),t.enqueue(r)},async cancel(t){await e.return(t)}})}}function eP(n,e=2){const t=Array.from({length:e},()=>[]);return t.map(async function*(s){for(;;)if(s.length===0){const a=await n.next();for(const o of t)o.push(a)}else{if(s[0].done)return;yield s.shift().value}})}function nr(n,e){if(Array.isArray(n)&&Array.isArray(e))return n.concat(e);if(typeof n=="string"&&typeof e=="string")return n+e;if(typeof n=="number"&&typeof e=="number")return n+e;if("concat"in n&&typeof n.concat=="function")return n.concat(e);if(typeof n=="object"&&typeof e=="object"){const t={...n};for(const[r,s]of Object.entries(e))r in t&&!Array.isArray(t[r])?t[r]=nr(t[r],s):t[r]=s;return t}else throw new Error(`Cannot concat ${typeof n} and ${typeof e}`)}class xo{constructor(e){var t;Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??((t=this.config)==null?void 0:t.signal),this.setup=new Promise((r,s)=>{ma.runWithConfig(io(e.config),async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(r,s):this.firstResult.then(a=>r(void 0),s)},!0)})}async next(...e){var t;return(t=this.signal)==null||t.throwIfAborted(),this.firstResultUsed?ma.runWithConfig(io(this.config),this.signal?async()=>ga(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function fM(n,e,t,r,...s){const a=new xo({generator:e,startSetup:t,signal:r}),o=await a.setup;return{output:n(a,o,...s),setup:o}}class ia{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const t=this.ops.concat(e.ops),r=Hd({},t);return new lu({ops:t,state:r[r.length-1].newDocument})}}class lu extends ia{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const t=this.ops.concat(e.ops),r=Hd(this.state,e.ops);return new lu({ops:t,state:r[r.length-1].newDocument})}static fromRunLogPatch(e){const t=Hd({},e.ops);return new lu({ops:e.ops,state:t[t.length-1].newDocument})}}const hM=n=>n.name==="log_stream_tracer";async function $S(n,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:t}=n;if(["retriever","llm","prompt"].includes(n.run_type))return t;if(!(Object.keys(t).length===1&&(t==null?void 0:t.input)===""))return t.input}async function IS(n,e){const{outputs:t}=n;return e==="original"||["retriever","llm","prompt"].includes(n.run_type)?t:t!==void 0&&Object.keys(t).length===1&&(t==null?void 0:t.output)!==void 0?t.output:t}function pM(n){return n!==void 0&&n.message!==void 0}class NS extends ku{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this._schemaFormat=(e==null?void 0:e._schemaFormat)??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=Wn.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const t=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(r=r||t.find(s=>{var a;return(a=this.includeTags)==null?void 0:a.includes(s)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(r=r&&t.every(s=>{var a;return!((a=this.excludeTags)!=null&&a.includes(s))})),r}async*tapOutputIterable(e,t){for await(const r of t){if(e!==this.rootId){const s=this.keyMapByRunId[e];s&&await this.writer.write(new ia({ops:[{op:"add",path:`/logs/${s}/streamed_output/-`,value:r}]}))}yield r}}async onRunCreate(e){var s;if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new ia({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const t=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=t===1?e.name:`${e.name}:${t}`;const r={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(r.inputs=await $S(e,this._schemaFormat)),await this.writer.write(new ia({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:r}]}))}async onRunUpdate(e){try{const t=this.keyMapByRunId[e.id];if(t===void 0)return;const r=[];this._schemaFormat==="streaming_events"&&r.push({op:"replace",path:`/logs/${t}/inputs`,value:await $S(e,this._schemaFormat)}),r.push({op:"add",path:`/logs/${t}/final_output`,value:await IS(e,this._schemaFormat)}),e.end_time!==void 0&&r.push({op:"add",path:`/logs/${t}/end_time`,value:new Date(e.end_time).toISOString()});const s=new ia({ops:r});await this.writer.write(s)}finally{if(e.id===this.rootId){const t=new ia({ops:[{op:"replace",path:"/final_output",value:await IS(e,this._schemaFormat)}]});await this.writer.write(t),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,t,r){const s=this.keyMapByRunId[e.id];if(s===void 0)return;const a=e.inputs.messages!==void 0;let o;a?pM(r==null?void 0:r.chunk)?o=r==null?void 0:r.chunk:o=new ns({id:`run-${e.id}`,content:t}):o=t;const u=new ia({ops:[{op:"add",path:`/logs/${s}/streamed_output_str/-`,value:t},{op:"add",path:`/logs/${s}/streamed_output/-`,value:o}]});await this.writer.write(u)}}const jS="__run";class oo{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new oo({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class Qr extends oo{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new Qr({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}function nd({name:n,serialized:e}){return n!==void 0?n:(e==null?void 0:e.name)!==void 0?e.name:(e==null?void 0:e.id)!==void 0&&Array.isArray(e==null?void 0:e.id)?e.id[e.id.length-1]:"Unnamed"}const mM=n=>n.name==="event_stream_tracer";class gM extends ku{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=(e==null?void 0:e.autoClose)??!0,this.includeNames=e==null?void 0:e.includeNames,this.includeTypes=e==null?void 0:e.includeTypes,this.includeTags=e==null?void 0:e.includeTags,this.excludeNames=e==null?void 0:e.excludeNames,this.excludeTypes=e==null?void 0:e.excludeTypes,this.excludeTags=e==null?void 0:e.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=Wn.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const t=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(r=r||t.find(s=>{var a;return(a=this.includeTags)==null?void 0:a.includes(s)})!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(r=r&&t.every(s=>{var a;return!((a=this.excludeTags)!=null&&a.includes(s))})),r}async*tapOutputIterable(e,t){const r=await t.next();if(r.done)return;const s=this.runInfoMap.get(e);if(s===void 0){yield r.value;return}function a(u,c){return u==="llm"&&typeof c=="string"?new oo({text:c}):c}let o=this.tappedPromises.get(e);if(o===void 0){let u;o=new Promise(c=>{u=c}),this.tappedPromises.set(e,o);try{const c={event:`on_${s.runType}_stream`,run_id:e,name:s.name,tags:s.tags,metadata:s.metadata,data:{}};await this.send({...c,data:{chunk:a(s.runType,r.value)}},s),yield r.value;for await(const f of t)s.runType!=="tool"&&s.runType!=="retriever"&&await this.send({...c,data:{chunk:a(s.runType,f)}},s),yield f}finally{u()}}else{yield r.value;for await(const u of t)yield u}}async send(e,t){this._includeRun(t)&&await this.writer.write(e)}async sendEndEvent(e,t){const r=this.tappedPromises.get(e.run_id);r!==void 0?r.then(()=>{this.send(e,t)}):await this.send(e,t)}async onLLMStart(e){var o,u;const t=nd(e),r=e.inputs.messages!==void 0?"chat_model":"llm",s={tags:e.tags??[],metadata:((o=e.extra)==null?void 0:o.metadata)??{},name:t,runType:r,inputs:e.inputs};this.runInfoMap.set(e.id,s);const a=`on_${r}_start`;await this.send({event:a,data:{input:e.inputs},name:t,tags:e.tags??[],run_id:e.id,metadata:((u=e.extra)==null?void 0:u.metadata)??{}},s)}async onLLMNewToken(e,t,r){const s=this.runInfoMap.get(e.id);let a,o;if(s===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(s.runType==="chat_model")o="on_chat_model_stream",(r==null?void 0:r.chunk)===void 0?a=new ns({content:t,id:`run-${e.id}`}):a=r.chunk.message;else if(s.runType==="llm")o="on_llm_stream",(r==null?void 0:r.chunk)===void 0?a=new oo({text:t}):a=r.chunk;else throw new Error(`Unexpected run type ${s.runType}`);await this.send({event:o,data:{chunk:a},run_id:e.id,name:s.name,tags:s.tags,metadata:s.metadata},s)}}async onLLMEnd(e){var o,u,c;const t=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let r;if(t===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const s=(o=e.outputs)==null?void 0:o.generations;let a;if(t.runType==="chat_model"){for(const f of s??[]){if(a!==void 0)break;a=(u=f[0])==null?void 0:u.message}r="on_chat_model_end"}else if(t.runType==="llm")a={generations:s==null?void 0:s.map(f=>f.map(h=>({text:h.text,generationInfo:h.generationInfo}))),llmOutput:((c=e.outputs)==null?void 0:c.llmOutput)??{}},r="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${t.runType}`);await this.sendEndEvent({event:r,data:{output:a,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onChainStart(e){var o,u;const t=nd(e),r=e.run_type??"chain",s={tags:e.tags??[],metadata:((o=e.extra)==null?void 0:o.metadata)??{},name:t,runType:e.run_type};let a={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(a={},s.inputs={}):e.inputs.input!==void 0?(a.input=e.inputs.input,s.inputs=e.inputs.input):(a.input=e.inputs,s.inputs=e.inputs),this.runInfoMap.set(e.id,s),await this.send({event:`on_${r}_start`,data:a,name:t,tags:e.tags??[],run_id:e.id,metadata:((u=e.extra)==null?void 0:u.metadata)??{}},s)}async onChainEnd(e){var u;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const r=`on_${e.run_type}_end`,s=e.inputs??t.inputs??{},o={output:((u=e.outputs)==null?void 0:u.output)??e.outputs,input:s};s.input&&Object.keys(s).length===1&&(o.input=s.input,t.inputs=s.input),await this.sendEndEvent({event:r,data:o,run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata??{}},t)}async onToolStart(e){var s,a;const t=nd(e),r={tags:e.tags??[],metadata:((s=e.extra)==null?void 0:s.metadata)??{},name:t,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,r),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:t,run_id:e.id,tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{}},r)}async onToolEnd(e){var s;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(t.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const r=((s=e.outputs)==null?void 0:s.output)===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:r,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async onRetrieverStart(e){var a,o;const t=nd(e),s={tags:e.tags??[],metadata:((a=e.extra)==null?void 0:a.metadata)??{},name:t,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,s),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:t,tags:e.tags??[],run_id:e.id,metadata:((o=e.extra)==null?void 0:o.metadata)??{}},s)}async onRetrieverEnd(e){var r;const t=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),t===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:((r=e.outputs)==null?void 0:r.documents)??e.outputs,input:t.inputs},run_id:e.id,name:t.name,tags:t.tags,metadata:t.metadata},t)}async handleCustomEvent(e,t,r){const s=this.runInfoMap.get(r);if(s===void 0)throw new Error(`handleCustomEvent: Run ID ${r} not found in run map.`);await this.send({event:"on_custom_event",run_id:r,name:e,tags:s.tags,metadata:s.metadata,data:t},s)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const yM=[400,401,402,403,404,405,406,407,409],_M=n=>{var t,r;if(n.message.startsWith("Cancel")||n.message.startsWith("AbortError")||n.name==="AbortError"||(n==null?void 0:n.code)==="ECONNABORTED")throw n;const e=((t=n==null?void 0:n.response)==null?void 0:t.status)??(n==null?void 0:n.status);if(e&&yM.includes(+e))throw n;if(((r=n==null?void 0:n.error)==null?void 0:r.code)==="insufficient_quota"){const s=new Error(n==null?void 0:n.message);throw s.name="InsufficientQuotaError",s}};class I_{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??_M;const t="default"in Rs?Rs.default:Rs;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>Ud(()=>e(...t).catch(r=>{throw r instanceof Error?r:new Error(r)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((s,a)=>{var o;(o=e.signal)==null||o.addEventListener("abort",()=>{a(new Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}}class tP extends ku{constructor({config:e,onStart:t,onEnd:r,onError:s}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=t,this.argOnEnd=r,this.argOnError=s}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}function N_(n){return n?n.lc_runnable:!1}class wM{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,t){let r=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const s=e.tags??[];return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(t)),this.includeTags!==void 0&&(r=r||s.some(a=>{var o;return(o=this.includeTags)==null?void 0:o.includes(a)})),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(t)),this.excludeTags!==void 0&&(r=r&&s.every(a=>{var o;return!((o=this.excludeTags)!=null&&o.includes(a))})),r}}const bM=Symbol("Let zodToJsonSchema decide on which parser to use"),vM={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},xM=n=>({...vM,...n}),SM=n=>{const e=xM(n),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function nP(n,e,t,r){r!=null&&r.errorMessages&&t&&(n.errorMessage={...n.errorMessage,[e]:t})}function Ke(n,e,t,r,s){n[e]=t,nP(n,e,r,s)}function EM(){return{}}function CM(n,e){var r,s,a;const t={type:"array"};return(r=n.type)!=null&&r._def&&((a=(s=n.type)==null?void 0:s._def)==null?void 0:a.typeName)!==Z.ZodAny&&(t.items=Ze(n.type._def,{...e,currentPath:[...e.currentPath,"items"]})),n.minLength&&Ke(t,"minItems",n.minLength.value,n.minLength.message,e),n.maxLength&&Ke(t,"maxItems",n.maxLength.value,n.maxLength.message,e),n.exactLength&&(Ke(t,"minItems",n.exactLength.value,n.exactLength.message,e),Ke(t,"maxItems",n.exactLength.value,n.exactLength.message,e)),t}function PM(n,e){const t={type:"integer",format:"int64"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?Ke(t,"minimum",r.value,r.message,e):Ke(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Ke(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Ke(t,"maximum",r.value,r.message,e):Ke(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Ke(t,"maximum",r.value,r.message,e));break;case"multipleOf":Ke(t,"multipleOf",r.value,r.message,e);break}return t}function kM(){return{type:"boolean"}}function rP(n,e){return Ze(n.type._def,e)}const RM=(n,e)=>Ze(n.innerType._def,e);function sP(n,e,t){const r=t??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,a)=>sP(n,e,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return OM(n,e)}}const OM=(n,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const r of n.checks)switch(r.kind){case"min":Ke(t,"minimum",r.value,r.message,e);break;case"max":Ke(t,"maximum",r.value,r.message,e);break}return t};function TM(n,e){return{...Ze(n.innerType._def,e),default:n.defaultValue()}}function AM(n,e){return e.effectStrategy==="input"?Ze(n.schema._def,e):{}}function $M(n){return{type:"string",enum:Array.from(n.values)}}const IM=n=>"type"in n&&n.type==="string"?!1:"allOf"in n;function NM(n,e){const t=[Ze(n.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Ze(n.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return t.forEach(a=>{if(IM(a))s.push(...a.allOf),a.unevaluatedProperties===void 0&&(r=void 0);else{let o=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:u,...c}=a;o=c}else r=void 0;s.push(o)}}),s.length?{allOf:s,...r}:void 0}function jM(n,e){const t=typeof n.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(n.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[n.value]}:{type:t==="bigint"?"integer":t,const:n.value}}let ug;const gr={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(ug===void 0&&(ug=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),ug),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function aP(n,e){const t={type:"string"};if(n.checks)for(const r of n.checks)switch(r.kind){case"min":Ke(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,r.value):r.value,r.message,e);break;case"max":Ke(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,r.value):r.value,r.message,e);break;case"email":switch(e.emailStrategy){case"format:email":yr(t,"email",r.message,e);break;case"format:idn-email":yr(t,"idn-email",r.message,e);break;case"pattern:zod":hn(t,gr.email,r.message,e);break}break;case"url":yr(t,"uri",r.message,e);break;case"uuid":yr(t,"uuid",r.message,e);break;case"regex":hn(t,r.regex,r.message,e);break;case"cuid":hn(t,gr.cuid,r.message,e);break;case"cuid2":hn(t,gr.cuid2,r.message,e);break;case"startsWith":hn(t,RegExp(`^${cg(r.value,e)}`),r.message,e);break;case"endsWith":hn(t,RegExp(`${cg(r.value,e)}$`),r.message,e);break;case"datetime":yr(t,"date-time",r.message,e);break;case"date":yr(t,"date",r.message,e);break;case"time":yr(t,"time",r.message,e);break;case"duration":yr(t,"duration",r.message,e);break;case"length":Ke(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,r.value):r.value,r.message,e),Ke(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,r.value):r.value,r.message,e);break;case"includes":{hn(t,RegExp(cg(r.value,e)),r.message,e);break}case"ip":{r.version!=="v6"&&yr(t,"ipv4",r.message,e),r.version!=="v4"&&yr(t,"ipv6",r.message,e);break}case"base64url":hn(t,gr.base64url,r.message,e);break;case"jwt":hn(t,gr.jwt,r.message,e);break;case"cidr":{r.version!=="v6"&&hn(t,gr.ipv4Cidr,r.message,e),r.version!=="v4"&&hn(t,gr.ipv6Cidr,r.message,e);break}case"emoji":hn(t,gr.emoji(),r.message,e);break;case"ulid":{hn(t,gr.ulid,r.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{yr(t,"binary",r.message,e);break}case"contentEncoding:base64":{Ke(t,"contentEncoding","base64",r.message,e);break}case"pattern:zod":{hn(t,gr.base64,r.message,e);break}}break}case"nanoid":hn(t,gr.nanoid,r.message,e)}return t}function cg(n,e){return e.patternStrategy==="escape"?MM(n):n}const LM=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function MM(n){let e="";for(let t=0;t<n.length;t++)LM.has(n[t])||(e+="\\"),e+=n[t];return e}function yr(n,e,t,r){var s;n.format||(s=n.anyOf)!=null&&s.some(a=>a.format)?(n.anyOf||(n.anyOf=[]),n.format&&(n.anyOf.push({format:n.format,...n.errorMessage&&r.errorMessages&&{errorMessage:{format:n.errorMessage.format}}}),delete n.format,n.errorMessage&&(delete n.errorMessage.format,Object.keys(n.errorMessage).length===0&&delete n.errorMessage)),n.anyOf.push({format:e,...t&&r.errorMessages&&{errorMessage:{format:t}}})):Ke(n,"format",e,t,r)}function hn(n,e,t,r){var s;n.pattern||(s=n.allOf)!=null&&s.some(a=>a.pattern)?(n.allOf||(n.allOf=[]),n.pattern&&(n.allOf.push({pattern:n.pattern,...n.errorMessage&&r.errorMessages&&{errorMessage:{pattern:n.errorMessage.pattern}}}),delete n.pattern,n.errorMessage&&(delete n.errorMessage.pattern,Object.keys(n.errorMessage).length===0&&delete n.errorMessage)),n.allOf.push({pattern:LS(e,r),...t&&r.errorMessages&&{errorMessage:{pattern:t}}})):Ke(n,"pattern",LS(e,r),t,r)}function LS(n,e){var c;if(!e.applyRegexFlags||!n.flags)return n.source;const t={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},r=t.i?n.source.toLowerCase():n.source;let s="",a=!1,o=!1,u=!1;for(let f=0;f<r.length;f++){if(a){s+=r[f],a=!1;continue}if(t.i){if(o){if(r[f].match(/[a-z]/)){u?(s+=r[f],s+=`${r[f-2]}-${r[f]}`.toUpperCase(),u=!1):r[f+1]==="-"&&((c=r[f+2])!=null&&c.match(/[a-z]/))?(s+=r[f],u=!0):s+=`${r[f]}${r[f].toUpperCase()}`;continue}}else if(r[f].match(/[a-z]/)){s+=`[${r[f]}${r[f].toUpperCase()}]`;continue}}if(t.m){if(r[f]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(r[f]==="$"){s+=`($|(?=[\r
]))`;continue}}if(t.s&&r[f]==="."){s+=o?`${r[f]}\r
`:`[${r[f]}\r
]`;continue}s+=r[f],r[f]==="\\"?a=!0:o&&r[f]==="]"?o=!1:!o&&r[f]==="["&&(o=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return s}function iP(n,e){var r,s,a,o,u,c;if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&((r=n.keyType)==null?void 0:r._def.typeName)===Z.ZodEnum)return{type:"object",required:n.keyType._def.values,properties:n.keyType._def.values.reduce((f,h)=>({...f,[h]:Ze(n.valueType._def,{...e,currentPath:[...e.currentPath,"properties",h]})??{}}),{}),additionalProperties:!1};const t={type:"object",additionalProperties:Ze(n.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return t;if(((s=n.keyType)==null?void 0:s._def.typeName)===Z.ZodString&&((a=n.keyType._def.checks)!=null&&a.length)){const{type:f,...h}=aP(n.keyType._def,e);return{...t,propertyNames:h}}else{if(((o=n.keyType)==null?void 0:o._def.typeName)===Z.ZodEnum)return{...t,propertyNames:{enum:n.keyType._def.values}};if(((u=n.keyType)==null?void 0:u._def.typeName)===Z.ZodBranded&&n.keyType._def.type._def.typeName===Z.ZodString&&((c=n.keyType._def.type._def.checks)!=null&&c.length)){const{type:f,...h}=rP(n.keyType._def,e);return{...t,propertyNames:h}}}return t}function DM(n,e){if(e.mapStrategy==="record")return iP(n,e);const t=Ze(n.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},r=Ze(n.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,r],minItems:2,maxItems:2}}}function FM(n){const e=n.values,r=Object.keys(n.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),s=Array.from(new Set(r.map(a=>typeof a)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function UM(){return{not:{}}}function zM(n){return n.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const qd={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function BM(n,e){if(e.target==="openApi3")return MS(n,e);const t=n.options instanceof Map?Array.from(n.options.values()):n.options;if(t.every(r=>r._def.typeName in qd&&(!r._def.checks||!r._def.checks.length))){const r=t.reduce((s,a)=>{const o=qd[a._def.typeName];return o&&!s.includes(o)?[...s,o]:s},[]);return{type:r.length>1?r:r[0]}}else if(t.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=t.reduce((s,a)=>{const o=typeof a._def.value;switch(o){case"string":case"number":case"boolean":return[...s,o];case"bigint":return[...s,"integer"];case"object":if(a._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===t.length){const s=r.filter((a,o,u)=>u.indexOf(a)===o);return{type:s.length>1?s:s[0],enum:t.reduce((a,o)=>a.includes(o._def.value)?a:[...a,o._def.value],[])}}}else if(t.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((r,s)=>[...r,...s._def.values.filter(a=>!r.includes(a))],[])};return MS(n,e)}const MS=(n,e)=>{const t=(n.options instanceof Map?Array.from(n.options.values()):n.options).map((r,s)=>Ze(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return t.length?{anyOf:t}:void 0};function HM(n,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(n.innerType._def.typeName)&&(!n.innerType._def.checks||!n.innerType._def.checks.length))return e.target==="openApi3"?{type:qd[n.innerType._def.typeName],nullable:!0}:{type:[qd[n.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=Ze(n.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const t=Ze(n.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function VM(n,e){const t={type:"number"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"int":t.type="integer",nP(t,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?Ke(t,"minimum",r.value,r.message,e):Ke(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Ke(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Ke(t,"maximum",r.value,r.message,e):Ke(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Ke(t,"maximum",r.value,r.message,e));break;case"multipleOf":Ke(t,"multipleOf",r.value,r.message,e);break}return t}function WM(n,e){return e.removeAdditionalStrategy==="strict"?n.catchall._def.typeName==="ZodNever"?n.unknownKeys!=="strict":Ze(n.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:n.catchall._def.typeName==="ZodNever"?n.unknownKeys==="passthrough":Ze(n.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function qM(n,e){const t=e.target==="openAi",r={type:"object",...Object.entries(n.shape()).reduce((s,[a,o])=>{if(o===void 0||o._def===void 0)return s;let u=o.isOptional();u&&t&&(o instanceof Rr&&(o=o._def.innerType),o.isNullable()||(o=o.nullable()),u=!1);const c=Ze(o._def,{...e,currentPath:[...e.currentPath,"properties",a],propertyPath:[...e.currentPath,"properties",a]});return c===void 0?s:{properties:{...s.properties,[a]:c},required:u?s.required:[...s.required,a]}},{properties:{},required:[]}),additionalProperties:WM(n,e)};return r.required.length||delete r.required,r}const ZM=(n,e)=>{var r;if(e.currentPath.toString()===((r=e.propertyPath)==null?void 0:r.toString()))return Ze(n.innerType._def,e);const t=Ze(n.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}},GM=(n,e)=>{if(e.pipeStrategy==="input")return Ze(n.in._def,e);if(e.pipeStrategy==="output")return Ze(n.out._def,e);const t=Ze(n.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=Ze(n.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,r].filter(s=>s!==void 0)}};function JM(n,e){return Ze(n.type._def,e)}function KM(n,e){const r={type:"array",uniqueItems:!0,items:Ze(n.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return n.minSize&&Ke(r,"minItems",n.minSize.value,n.minSize.message,e),n.maxSize&&Ke(r,"maxItems",n.maxSize.value,n.maxSize.message,e),r}function XM(n,e){return n.rest?{type:"array",minItems:n.items.length,items:n.items.map((t,r)=>Ze(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[]),additionalItems:Ze(n.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:n.items.length,maxItems:n.items.length,items:n.items.map((t,r)=>Ze(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[])}}function YM(){return{not:{}}}function QM(){return{}}const eD=(n,e)=>Ze(n.innerType._def,e);function Ze(n,e,t=!1){var o;const r=e.seen.get(n);if(e.override){const u=(o=e.override)==null?void 0:o.call(e,n,e,r,t);if(u!==bM)return u}if(r&&!t){const u=tD(r,e);if(u!==void 0)return u}const s={def:n,path:e.currentPath,jsonSchema:void 0};e.seen.set(n,s);const a=rD(n,n.typeName,e);return a&&sD(n,e,a),s.jsonSchema=a,a}const tD=(n,e)=>{switch(e.$refStrategy){case"root":return{$ref:n.path.join("/")};case"relative":return{$ref:nD(e.currentPath,n.path)};case"none":case"seen":return n.path.length<e.currentPath.length&&n.path.every((t,r)=>e.currentPath[r]===t)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},nD=(n,e)=>{let t=0;for(;t<n.length&&t<e.length&&n[t]===e[t];t++);return[(n.length-t).toString(),...e.slice(t)].join("/")},rD=(n,e,t)=>{switch(e){case Z.ZodString:return aP(n,t);case Z.ZodNumber:return VM(n,t);case Z.ZodObject:return qM(n,t);case Z.ZodBigInt:return PM(n,t);case Z.ZodBoolean:return kM();case Z.ZodDate:return sP(n,t);case Z.ZodUndefined:return YM();case Z.ZodNull:return zM(t);case Z.ZodArray:return CM(n,t);case Z.ZodUnion:case Z.ZodDiscriminatedUnion:return BM(n,t);case Z.ZodIntersection:return NM(n,t);case Z.ZodTuple:return XM(n,t);case Z.ZodRecord:return iP(n,t);case Z.ZodLiteral:return jM(n,t);case Z.ZodEnum:return $M(n);case Z.ZodNativeEnum:return FM(n);case Z.ZodNullable:return HM(n,t);case Z.ZodOptional:return ZM(n,t);case Z.ZodMap:return DM(n,t);case Z.ZodSet:return KM(n,t);case Z.ZodLazy:return Ze(n.getter()._def,t);case Z.ZodPromise:return JM(n,t);case Z.ZodNaN:case Z.ZodNever:return UM();case Z.ZodEffects:return AM(n,t);case Z.ZodAny:return EM();case Z.ZodUnknown:return QM();case Z.ZodDefault:return TM(n,t);case Z.ZodBranded:return rP(n,t);case Z.ZodReadonly:return eD(n,t);case Z.ZodCatch:return RM(n,t);case Z.ZodPipeline:return GM(n,t);case Z.ZodFunction:case Z.ZodVoid:case Z.ZodSymbol:return;default:return(r=>{})()}},sD=(n,e,t)=>(n.description&&(t.description=n.description,e.markdownDescription&&(t.markdownDescription=n.description)),t),Ru=(n,e)=>{const t=SM(e),r=void 0,s=e==null?void 0:e.name,a=Ze(n._def,t,!1)??{},o=s===void 0?r?{...a,[t.definitionPath]:r}:a:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,s].join("/"),[t.definitionPath]:{...r,[s]:a}};return t.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(t.target==="jsonSchema2019-09"||t.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),t.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};function dg(n){return n.replace(/[^a-zA-Z-_0-9]/g,"_")}const aD=["*","_","`"];function iD(n){let e="";for(const[t,r]of Object.entries(n))e+=`	classDef ${t} ${r};
`;return e}function oD(n,e,t){const{firstNode:r,lastNode:s,nodeColors:a,withStyles:o=!0,curveStyle:u="linear",wrapLabelNWords:c=9}=t??{};let f=o?`%%{init: {'flowchart': {'curve': '${u}'}}}%%
graph TD;
`:`graph TD;
`;if(o){const y="default",w={[y]:"{0}({1})"};r!==void 0&&(w[r]="{0}([{1}]):::first"),s!==void 0&&(w[s]="{0}([{1}]):::last");for(const[v,x]of Object.entries(n)){const E=x.name.split(":").pop()??"";let S=aD.some(A=>E.startsWith(A)&&E.endsWith(A))?`<p>${E}</p>`:E;Object.keys(x.metadata??{}).length&&(S+=`<hr/><small><em>${Object.entries(x.metadata??{}).map(([A,I])=>`${A} = ${I}`).join(`
`)}</em></small>`);const R=(w[v]??w[y]).replace("{0}",dg(v)).replace("{1}",S);f+=`	${R}
`}}const h={};for(const y of e){const w=y.source.split(":"),v=y.target.split(":"),x=w.filter((E,k)=>E===v[k]).join(":");h[x]||(h[x]=[]),h[x].push(y)}const m=new Set;function g(y,w){const v=y.length===1&&y[0].source===y[0].target;if(w&&!v){const x=w.split(":").pop();if(m.has(x))throw new Error(`Found duplicate subgraph '${x}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);m.add(x),f+=`	subgraph ${x}
`}for(const x of y){const{source:E,target:k,data:S,conditional:R}=x;let A="";if(S!==void 0){let I=S;const M=I.split(" ");M.length>c&&(I=Array.from({length:Math.ceil(M.length/c)},(D,K)=>M.slice(K*c,(K+1)*c).join(" ")).join("&nbsp;<br>&nbsp;")),A=R?` -. &nbsp;${I}&nbsp; .-> `:` -- &nbsp;${I}&nbsp; --> `}else A=R?" -.-> ":" --> ";f+=`	${dg(E)}${A}${dg(k)};
`}for(const x in h)x.startsWith(`${w}:`)&&x!==w&&g(h[x],x);w&&!v&&(f+=`	end
`)}g(h[""]??[],"");for(const y in h)!y.includes(":")&&y!==""&&g(h[y],y);return o&&(f+=iD(a??{})),f}async function lD(n,e){let{backgroundColor:t="white"}=e??{};const r=btoa(n);t!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(t)||(t=`!${t}`));const s=`https://mermaid.ink/img/${r}?bgColor=${t}`,a=await fetch(s);if(!a.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${a.status}`,`Status text: ${a.statusText}`].join(`
`));return await a.blob()}function uD(n,e){if(n!==void 0&&!Nl(n))return n;if(N_(e))try{let t=e.getName();return t=t.startsWith("Runnable")?t.slice(8):t,t}catch{return e.getName()}else return e.name??"UnknownSchema"}function cD(n){return N_(n.data)?{type:"runnable",data:{id:n.data.lc_id,name:n.data.getName()}}:{type:"schema",data:{...Ru(n.data.schema),title:n.data.name}}}class If{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=(e==null?void 0:e.nodes)??this.nodes,this.edges=(e==null?void 0:e.edges)??this.edges}toJSON(){const e={};return Object.values(this.nodes).forEach((t,r)=>{e[t.id]=Nl(t.id)?r:t.id}),{nodes:Object.values(this.nodes).map(t=>({id:e[t.id],...cD(t)})),edges:this.edges.map(t=>{const r={source:e[t.source],target:e[t.target]};return typeof t.data<"u"&&(r.data=t.data),typeof t.conditional<"u"&&(r.conditional=t.conditional),r})}}addNode(e,t,r){if(t!==void 0&&this.nodes[t]!==void 0)throw new Error(`Node with id ${t} already exists`);const s=t??sn(),a={id:s,data:e,name:uD(t,e),metadata:r};return this.nodes[s]=a,a}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(t=>t.source!==e.id&&t.target!==e.id)}addEdge(e,t,r,s){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[t.id]===void 0)throw new Error(`Target node ${t.id} not in graph`);const a={source:e.id,target:t.id,data:r,conditional:s};return this.edges.push(a),a}firstNode(){return DS(this)}lastNode(){return FS(this)}extend(e,t=""){let r=t;Object.values(e.nodes).map(f=>f.id).every(Nl)&&(r="");const a=f=>r?`${r}:${f}`:f;Object.entries(e.nodes).forEach(([f,h])=>{this.nodes[a(f)]={...h,id:a(f)}});const o=e.edges.map(f=>({...f,source:a(f.source),target:a(f.target)}));this.edges=[...this.edges,...o];const u=e.firstNode(),c=e.lastNode();return[u?{id:a(u.id),data:u.data}:void 0,c?{id:a(c.id),data:c.data}:void 0]}trimFirstNode(){const e=this.firstNode();e&&DS(this,[e.id])&&this.removeNode(e)}trimLastNode(){const e=this.lastNode();e&&FS(this,[e.id])&&this.removeNode(e)}reid(){const e=Object.fromEntries(Object.values(this.nodes).map(s=>[s.id,s.name])),t=new Map;Object.values(e).forEach(s=>{t.set(s,(t.get(s)||0)+1)});const r=s=>{const a=e[s];return Nl(s)&&t.get(a)===1?a:s};return new If({nodes:Object.fromEntries(Object.entries(this.nodes).map(([s,a])=>[r(s),{...a,id:r(s)}])),edges:this.edges.map(s=>({...s,source:r(s.source),target:r(s.target)}))})}drawMermaid(e){const{withStyles:t,curveStyle:r,nodeColors:s={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:a}=e??{},o=this.reid(),u=o.firstNode(),c=o.lastNode();return oD(o.nodes,o.edges,{firstNode:u==null?void 0:u.id,lastNode:c==null?void 0:c.id,withStyles:t,curveStyle:r,nodeColors:s,wrapLabelNWords:a})}async drawMermaidPng(e){const t=this.drawMermaid(e);return lD(t,{backgroundColor:e==null?void 0:e.backgroundColor})}}function DS(n,e=[]){const t=new Set(n.edges.filter(s=>!e.includes(s.source)).map(s=>s.target)),r=[];for(const s of Object.values(n.nodes))!e.includes(s.id)&&!t.has(s.id)&&r.push(s);return r.length===1?r[0]:void 0}function FS(n,e=[]){const t=new Set(n.edges.filter(s=>!e.includes(s.target)).map(s=>s.source)),r=[];for(const s of Object.values(n.nodes))!e.includes(s.id)&&!t.has(s.id)&&r.push(s);return r.length===1?r[0]:void 0}function dD(n){const e=new TextEncoder,t=new ReadableStream({async start(r){for await(const s of n)r.enqueue(e.encode(`event: data
data: ${JSON.stringify(s)}

`));r.enqueue(e.encode(`event: end

`)),r.close()}});return Wn.fromReadableStream(t)}function US(n){return typeof n=="object"&&n!==null&&typeof n[Symbol.iterator]=="function"&&typeof n.next=="function"}const fD=n=>n!=null&&typeof n=="object"&&"next"in n&&typeof n.next=="function";function ty(n){return typeof n=="object"&&n!==null&&typeof n[Symbol.asyncIterator]=="function"}function*zS(n,e){for(;;){const{value:t,done:r}=ma.runWithConfig(io(n),e.next.bind(e),!0);if(r)break;yield t}}async function*ny(n,e){const t=e[Symbol.asyncIterator]();for(;;){const{value:r,done:s}=await ma.runWithConfig(io(n),t.next.bind(e),!0);if(s)break;yield r}}function Ut(n,e){return n&&!Array.isArray(n)&&!(n instanceof Date)&&typeof n=="object"?n:{[e]:n}}class zt extends Ja{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const t=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${t}${e}`:t}bind(e){return new Ha({bound:this,kwargs:e,config:{}})}map(){return new Zd({bound:this})}withRetry(e){return new hD({bound:this,kwargs:{},config:{},maxAttemptNumber:e==null?void 0:e.stopAfterAttempt,...e})}withConfig(e){return new Ha({bound:this,config:e,kwargs:{}})}withFallbacks(e){const t=Array.isArray(e)?e:e.fallbacks;return new mD({runnable:this,fallbacks:t})}_getOptionsList(e,t=0){if(Array.isArray(e)&&e.length!==t)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${t} inputs`);if(Array.isArray(e))return e.map(Ge);if(t>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const r=Object.fromEntries(Object.entries(e).filter(([s])=>s!=="runId"));return Array.from({length:t},(s,a)=>Ge(a===0?e:r))}return Array.from({length:t},()=>Ge(e))}async batch(e,t,r){var c;const s=this._getOptionsList(t??{},e.length),a=((c=s[0])==null?void 0:c.maxConcurrency)??(r==null?void 0:r.maxConcurrency),o=new I_({maxConcurrency:a,onFailedAttempt:f=>{throw f}}),u=e.map((f,h)=>o.call(async()=>{try{return await this.invoke(f,s[h])}catch(m){if(r!=null&&r.returnExceptions)return m;throw m}}));return Promise.all(u)}async*_streamIterator(e,t){yield this.invoke(e,t)}async stream(e,t){const r=Ge(t),s=new xo({generator:this._streamIterator(e,r),config:r});return await s.setup,Wn.fromAsyncGenerator(s)}_separateRunnableConfigFromCallOptions(e){let t;e===void 0?t=Ge(e):t=Ge({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const r={...e};return delete r.callbacks,delete r.tags,delete r.metadata,delete r.runName,delete r.configurable,delete r.recursionLimit,delete r.maxConcurrency,delete r.runId,delete r.timeout,delete r.signal,[t,r]}async _callWithConfig(e,t,r){const s=Ge(r),a=await Or(s),o=await(a==null?void 0:a.handleChainStart(this.toJSON(),Ut(t,"input"),s.runId,s==null?void 0:s.runType,void 0,void 0,(s==null?void 0:s.runName)??this.getName()));delete s.runId;let u;try{const c=e.call(this,t,s,o);u=await ga(c,r==null?void 0:r.signal)}catch(c){throw await(o==null?void 0:o.handleChainError(c)),c}return await(o==null?void 0:o.handleChainEnd(Ut(u,"output"))),u}async _batchWithConfig(e,t,r,s){var f;const a=this._getOptionsList(r??{},t.length),o=await Promise.all(a.map(Or)),u=await Promise.all(o.map(async(h,m)=>{const g=await(h==null?void 0:h.handleChainStart(this.toJSON(),Ut(t[m],"input"),a[m].runId,a[m].runType,void 0,void 0,a[m].runName??this.getName()));return delete a[m].runId,g}));let c;try{const h=e.call(this,t,a,u,s);c=await ga(h,(f=a==null?void 0:a[0])==null?void 0:f.signal)}catch(h){throw await Promise.all(u.map(m=>m==null?void 0:m.handleChainError(h))),h}return await Promise.all(u.map(h=>h==null?void 0:h.handleChainEnd(Ut(c,"output")))),c}async*_transformStreamWithConfig(e,t,r){let s,a=!0,o,u=!0;const c=Ge(r),f=await Or(c);async function*h(){for await(const g of e){if(a)if(s===void 0)s=g;else try{s=nr(s,g)}catch{s=void 0,a=!1}yield g}}let m;try{const g=await fM(t.bind(this),h(),async()=>f==null?void 0:f.handleChainStart(this.toJSON(),{input:""},c.runId,c.runType,void 0,void 0,c.runName??this.getName()),r==null?void 0:r.signal,c);delete c.runId,m=g.setup;const y=m==null?void 0:m.handlers.find(mM);let w=g.output;y!==void 0&&m!==void 0&&(w=y.tapOutputIterable(m.runId,w));const v=m==null?void 0:m.handlers.find(hM);v!==void 0&&m!==void 0&&(w=v.tapOutputIterable(m.runId,w));for await(const x of w)if(yield x,u)if(o===void 0)o=x;else try{o=nr(o,x)}catch{o=void 0,u=!1}}catch(g){throw await(m==null?void 0:m.handleChainError(g,void 0,void 0,void 0,{inputs:Ut(s,"input")})),g}await(m==null?void 0:m.handleChainEnd(o??{},void 0,void 0,void 0,{inputs:Ut(s,"input")}))}getGraph(e){const t=new If,r=t.addNode({name:`${this.getName()}Input`,schema:le.any()}),s=t.addNode(this),a=t.addNode({name:`${this.getName()}Output`,schema:le.any()});return t.addEdge(r,s),t.addEdge(s,a),t}pipe(e){return new Ps({first:this,last:Da(e)})}pick(e){return this.pipe(new gD(e))}assign(e){return this.pipe(new oP(new So({steps:e})))}async*transform(e,t){let r;for await(const s of e)r===void 0?r=s:r=nr(r,s);yield*this._streamIterator(r,Ge(t))}async*streamLog(e,t,r){const s=new NS({...r,autoClose:!1,_schemaFormat:"original"}),a=Ge(t);yield*this._streamLog(e,s,a)}async*_streamLog(e,t,r){const{callbacks:s}=r;if(s===void 0)r.callbacks=[t];else if(Array.isArray(s))r.callbacks=s.concat([t]);else{const c=s.copy();c.addHandler(t,!0),r.callbacks=c}const a=this.stream(e,r);async function o(){try{const c=await a;for await(const f of c){const h=new ia({ops:[{op:"add",path:"/streamed_output/-",value:f}]});await t.writer.write(h)}}finally{await t.writer.close()}}const u=o();try{for await(const c of t)yield c}finally{await u}}streamEvents(e,t,r){let s;if(t.version==="v1")s=this._streamEventsV1(e,t,r);else if(t.version==="v2")s=this._streamEventsV2(e,t,r);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return t.encoding==="text/event-stream"?dD(s):Wn.fromAsyncGenerator(s)}async*_streamEventsV2(e,t,r){var w;const s=new gM({...r,autoClose:!1}),a=Ge(t),o=a.runId??sn();a.runId=o;const u=a.callbacks;if(u===void 0)a.callbacks=[s];else if(Array.isArray(u))a.callbacks=u.concat(s);else{const v=u.copy();v.addHandler(s,!0),a.callbacks=v}const c=new AbortController,f=this;async function h(){try{let v;t!=null&&t.signal?"any"in AbortSignal?v=AbortSignal.any([c.signal,t.signal]):(v=t.signal,t.signal.addEventListener("abort",()=>{c.abort()},{once:!0})):v=c.signal;const x=await f.stream(e,{...a,signal:v}),E=s.tapOutputIterable(o,x);for await(const k of E)if(c.signal.aborted)break}finally{await s.finish()}}const m=h();let g=!1,y;try{for await(const v of s){if(!g){v.data.input=e,g=!0,y=v.run_id,yield v;continue}v.run_id===y&&v.event.endsWith("_end")&&(w=v.data)!=null&&w.input&&delete v.data.input,yield v}}finally{c.abort(),await m}}async*_streamEventsV1(e,t,r){let s,a=!1;const o=Ge(t),u=o.tags??[],c=o.metadata??{},f=o.runName??this.getName(),h=new NS({...r,autoClose:!1,_schemaFormat:"streaming_events"}),m=new wM({...r}),g=this._streamLog(e,h,o);for await(const w of g){if(s?s=s.concat(w):s=lu.fromRunLogPatch(w),s.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!a){a=!0;const k={...s.state},S={run_id:k.id,event:`on_${k.type}_start`,name:f,tags:u,metadata:c,data:{input:e}};m.includeEvent(S,k.type)&&(yield S)}const v=w.ops.filter(k=>k.path.startsWith("/logs/")).map(k=>k.path.split("/")[2]),x=[...new Set(v)];for(const k of x){let S,R={};const A=s.state.logs[k];if(A.end_time===void 0?A.streamed_output.length>0?S="stream":S="start":S="end",S==="start")A.inputs!==void 0&&(R.input=A.inputs);else if(S==="end")A.inputs!==void 0&&(R.input=A.inputs),R.output=A.final_output;else if(S==="stream"){const I=A.streamed_output.length;if(I!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${I} instead. Encountered in: "${A.name}"`);R={chunk:A.streamed_output[0]},A.streamed_output=[]}yield{event:`on_${A.type}_${S}`,name:A.name,run_id:A.id,tags:A.tags,metadata:A.metadata,data:R}}const{state:E}=s;if(E.streamed_output.length>0){const k=E.streamed_output.length;if(k!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${k} instead. Encountered in: "${E.name}"`);const S={chunk:E.streamed_output[0]};E.streamed_output=[];const R={event:`on_${E.type}_stream`,run_id:E.id,tags:u,metadata:c,name:f,data:S};m.includeEvent(R,E.type)&&(yield R)}}const y=s==null?void 0:s.state;if(y!==void 0){const w={event:`on_${y.type}_end`,name:f,run_id:y.id,tags:u,metadata:c,data:{output:y.final_output}};m.includeEvent(w,y.type)&&(yield w)}}static isRunnable(e){return N_(e)}withListeners({onStart:e,onEnd:t,onError:r}){return new Ha({bound:this,config:{},configFactories:[s=>({callbacks:[new tP({config:s,onStart:e,onEnd:t,onError:r})]})]})}asTool(e){return yD(this,e)}}class Ha extends zt{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const t=AS(this.config,...e);return AS(t,...this.configFactories?await Promise.all(this.configFactories.map(async r=>await r(t))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}async invoke(e,t){return this.bound.invoke(e,await this._mergeConfig(Ge(t),this.kwargs))}async batch(e,t,r){const s=Array.isArray(t)?await Promise.all(t.map(async a=>this._mergeConfig(Ge(a),this.kwargs))):await this._mergeConfig(Ge(t),this.kwargs);return this.bound.batch(e,s,r)}async*_streamIterator(e,t){yield*this.bound._streamIterator(e,await this._mergeConfig(Ge(t),this.kwargs))}async stream(e,t){return this.bound.stream(e,await this._mergeConfig(Ge(t),this.kwargs))}async*transform(e,t){yield*this.bound.transform(e,await this._mergeConfig(Ge(t),this.kwargs))}streamEvents(e,t,r){const s=this,a=async function*(){yield*s.bound.streamEvents(e,{...await s._mergeConfig(Ge(t),s.kwargs),version:t.version},r)};return Wn.fromAsyncGenerator(a())}static isRunnableBinding(e){return e.bound&&zt.isRunnable(e.bound)}withListeners({onStart:e,onEnd:t,onError:r}){return new Ha({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[s=>({callbacks:[new tP({config:s,onStart:e,onEnd:t,onError:r})]})]})}}class Zd extends zt{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new Zd({bound:this.bound.bind(e)})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _invoke(e,t,r){return this.bound.batch(e,an(t,{callbacks:r==null?void 0:r.getChild()}))}withListeners({onStart:e,onEnd:t,onError:r}){return new Zd({bound:this.bound.withListeners({onStart:e,onEnd:t,onError:r})})}}class hD extends Ha{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,t,r){const s=e>1?`retry:attempt:${e}`:void 0;return an(t,{callbacks:r==null?void 0:r.getChild(s)})}async _invoke(e,t,r){return Ud(s=>super.invoke(e,this._patchConfigForRetry(s,t,r)),{onFailedAttempt:s=>this.onFailedAttempt(s,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async _batch(e,t,r,s){const a={};try{await Ud(async o=>{const u=e.map((g,y)=>y).filter(g=>a[g.toString()]===void 0||a[g.toString()]instanceof Error),c=u.map(g=>e[g]),f=u.map(g=>this._patchConfigForRetry(o,t==null?void 0:t[g],r==null?void 0:r[g])),h=await super.batch(c,f,{...s,returnExceptions:!0});let m;for(let g=0;g<h.length;g+=1){const y=h[g],w=u[g];y instanceof Error&&m===void 0&&(m=y,m.input=c[g]),a[w.toString()]=y}if(m)throw m;return h},{onFailedAttempt:o=>this.onFailedAttempt(o,o.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(o){if((s==null?void 0:s.returnExceptions)!==!0)throw o}return Object.keys(a).sort((o,u)=>parseInt(o,10)-parseInt(u,10)).map(o=>a[parseInt(o,10)])}async batch(e,t,r){return this._batchWithConfig(this._batch.bind(this),e,t,r)}}class Ps extends zt{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,t){var c;const r=Ge(t),s=await Or(r),a=await(s==null?void 0:s.handleChainStart(this.toJSON(),Ut(e,"input"),r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));delete r.runId;let o=e,u;try{const f=[this.first,...this.middle];for(let h=0;h<f.length;h+=1){const g=f[h].invoke(o,an(r,{callbacks:a==null?void 0:a.getChild(this.omitSequenceTags?void 0:`seq:step:${h+1}`)}));o=await ga(g,t==null?void 0:t.signal)}if((c=t==null?void 0:t.signal)!=null&&c.aborted)throw new Error("Aborted");u=await this.last.invoke(o,an(r,{callbacks:a==null?void 0:a.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(f){throw await(a==null?void 0:a.handleChainError(f)),f}return await(a==null?void 0:a.handleChainEnd(Ut(u,"output"))),u}async batch(e,t,r){var c;const s=this._getOptionsList(t??{},e.length),a=await Promise.all(s.map(Or)),o=await Promise.all(a.map(async(f,h)=>{const m=await(f==null?void 0:f.handleChainStart(this.toJSON(),Ut(e[h],"input"),s[h].runId,void 0,void 0,void 0,s[h].runName));return delete s[h].runId,m}));let u=e;try{for(let f=0;f<this.steps.length;f+=1){const m=this.steps[f].batch(u,o.map((g,y)=>{const w=g==null?void 0:g.getChild(this.omitSequenceTags?void 0:`seq:step:${f+1}`);return an(s[y],{callbacks:w})}),r);u=await ga(m,(c=s[0])==null?void 0:c.signal)}}catch(f){throw await Promise.all(o.map(h=>h==null?void 0:h.handleChainError(f))),f}return await Promise.all(o.map(f=>f==null?void 0:f.handleChainEnd(Ut(u,"output")))),u}async*_streamIterator(e,t){var m;const r=await Or(t),{runId:s,...a}=t??{},o=await(r==null?void 0:r.handleChainStart(this.toJSON(),Ut(e,"input"),s,void 0,void 0,void 0,a==null?void 0:a.runName)),u=[this.first,...this.middle,this.last];let c=!0,f;async function*h(){yield e}try{let g=u[0].transform(h(),an(a,{callbacks:o==null?void 0:o.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let y=1;y<u.length;y+=1)g=await u[y].transform(g,an(a,{callbacks:o==null?void 0:o.getChild(this.omitSequenceTags?void 0:`seq:step:${y+1}`)}));for await(const y of g)if((m=t==null?void 0:t.signal)==null||m.throwIfAborted(),yield y,c)if(f===void 0)f=y;else try{f=nr(f,y)}catch{f=void 0,c=!1}}catch(g){throw await(o==null?void 0:o.handleChainError(g)),g}await(o==null?void 0:o.handleChainEnd(Ut(f,"output")))}getGraph(e){const t=new If;let r=null;return this.steps.forEach((s,a)=>{const o=s.getGraph(e);a!==0&&o.trimFirstNode(),a!==this.steps.length-1&&o.trimLastNode(),t.extend(o);const u=o.firstNode();if(!u)throw new Error(`Runnable ${s} has no first node`);r&&t.addEdge(r,u),r=o.lastNode()}),t}pipe(e){return Ps.isRunnableSequence(e)?new Ps({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new Ps({first:this.first,middle:[...this.middle,this.last],last:Da(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&zt.isRunnable(e)}static from([e,...t],r){let s={};return typeof r=="string"?s.name=r:r!==void 0&&(s=r),new Ps({...s,first:Da(e),middle:t.slice(0,-1).map(Da),last:Da(t[t.length-1])})}}class So extends zt{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[t,r]of Object.entries(e.steps))this.steps[t]=Da(r)}static from(e){return new So({steps:e})}async invoke(e,t){const r=Ge(t),s=await Or(r),a=await(s==null?void 0:s.handleChainStart(this.toJSON(),{input:e},r.runId,void 0,void 0,void 0,r==null?void 0:r.runName));delete r.runId;const o={};try{const u=Object.entries(this.steps).map(async([c,f])=>{o[c]=await f.invoke(e,an(r,{callbacks:a==null?void 0:a.getChild(`map:key:${c}`)}))});await ga(Promise.all(u),t==null?void 0:t.signal)}catch(u){throw await(a==null?void 0:a.handleChainError(u)),u}return await(a==null?void 0:a.handleChainEnd(o)),o}async*_transform(e,t,r){const s={...this.steps},a=eP(e,Object.keys(s).length),o=new Map(Object.entries(s).map(([u,c],f)=>{const h=c.transform(a[f],an(r,{callbacks:t==null?void 0:t.getChild(`map:key:${u}`)}));return[u,h.next().then(m=>({key:u,gen:h,result:m}))]}));for(;o.size;){const u=Promise.race(o.values()),{key:c,result:f,gen:h}=await ga(u,r==null?void 0:r.signal);o.delete(c),f.done||(yield{[c]:f.value},o.set(c,h.next().then(m=>({key:c,gen:h,result:m}))))}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const s=Ge(t),a=new xo({generator:this.transform(r(),s),config:s});return await a.setup,Wn.fromAsyncGenerator(a)}}class j_ extends zt{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!A_(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,t){const[r]=this._getOptionsList(t??{},1),s=await Or(r),a=this.func(an(r,{callbacks:s}),e);return ga(a,r==null?void 0:r.signal)}async*_streamIterator(e,t){var a,o;const[r]=this._getOptionsList(t??{},1),s=await this.invoke(e,t);if(ty(s)){for await(const u of s)(a=r==null?void 0:r.signal)==null||a.throwIfAborted(),yield u;return}if(fD(s)){for(;;){(o=r==null?void 0:r.signal)==null||o.throwIfAborted();const u=s.next();if(u.done)break;yield u.value}return}yield s}static from(e){return new j_({func:e})}}function pD(n){if(A_(n))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}class Eo extends zt{static lc_name(){return"RunnableLambda"}constructor(e){if(A_(e.func))return j_.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),pD(e.func),this.func=e.func}static from(e){return new Eo({func:e})}async _invoke(e,t,r){return new Promise((s,a)=>{const o=an(t,{callbacks:r==null?void 0:r.getChild(),recursionLimit:((t==null?void 0:t.recursionLimit)??lg)-1});ma.runWithConfig(io(o),async()=>{var u,c;try{let f=await this.func(e,{...o});if(f&&zt.isRunnable(f)){if((t==null?void 0:t.recursionLimit)===0)throw new Error("Recursion limit reached.");f=await f.invoke(e,{...o,recursionLimit:(o.recursionLimit??lg)-1})}else if(ty(f)){let h;for await(const m of ny(o,f))if((u=t==null?void 0:t.signal)==null||u.throwIfAborted(),h===void 0)h=m;else try{h=nr(h,m)}catch{h=m}f=h}else if(US(f)){let h;for(const m of zS(o,f))if((c=t==null?void 0:t.signal)==null||c.throwIfAborted(),h===void 0)h=m;else try{h=nr(h,m)}catch{h=m}f=h}s(f)}catch(f){a(f)}})})}async invoke(e,t){return this._callWithConfig(this._invoke.bind(this),e,t)}async*_transform(e,t,r){var u,c;let s;for await(const f of e)if(s===void 0)s=f;else try{s=nr(s,f)}catch{s=f}const a=an(r,{callbacks:t==null?void 0:t.getChild(),recursionLimit:((r==null?void 0:r.recursionLimit)??lg)-1}),o=await new Promise((f,h)=>{ma.runWithConfig(io(a),async()=>{try{const m=await this.func(s,{...a,config:a});f(m)}catch(m){h(m)}})});if(o&&zt.isRunnable(o)){if((r==null?void 0:r.recursionLimit)===0)throw new Error("Recursion limit reached.");const f=await o.stream(s,a);for await(const h of f)yield h}else if(ty(o))for await(const f of ny(a,o))(u=r==null?void 0:r.signal)==null||u.throwIfAborted(),yield f;else if(US(o))for(const f of zS(a,o))(c=r==null?void 0:r.signal)==null||c.throwIfAborted(),yield f;else yield o}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const s=Ge(t),a=new xo({generator:this.transform(r(),s),config:s});return await a.setup,Wn.fromAsyncGenerator(a)}}class mD extends zt{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,t){const r=Ge(t),s=await Or(r),{runId:a,...o}=r,u=await(s==null?void 0:s.handleChainStart(this.toJSON(),Ut(e,"input"),a,void 0,void 0,void 0,o==null?void 0:o.runName)),c=an(o,{callbacks:u==null?void 0:u.getChild()});return await ma.runWithConfig(c,async()=>{var m;let h;for(const g of this.runnables()){(m=r==null?void 0:r.signal)==null||m.throwIfAborted();try{const y=await g.invoke(e,c);return await(u==null?void 0:u.handleChainEnd(Ut(y,"output"))),y}catch(y){h===void 0&&(h=y)}}throw h===void 0?new Error("No error stored at end of fallback."):(await(u==null?void 0:u.handleChainError(h)),h)})}async*_streamIterator(e,t){var m;const r=Ge(t),s=await Or(r),{runId:a,...o}=r,u=await(s==null?void 0:s.handleChainStart(this.toJSON(),Ut(e,"input"),a,void 0,void 0,void 0,o==null?void 0:o.runName));let c,f;for(const g of this.runnables()){(m=r==null?void 0:r.signal)==null||m.throwIfAborted();const y=an(o,{callbacks:u==null?void 0:u.getChild()});try{const w=await g.stream(e,y);f=ny(y,w);break}catch(w){c===void 0&&(c=w)}}if(f===void 0){const g=c??new Error("No error stored at end of fallback.");throw await(u==null?void 0:u.handleChainError(g)),g}let h;try{for await(const g of f){yield g;try{h=h===void 0?h:nr(h,g)}catch{h=void 0}}}catch(g){throw await(u==null?void 0:u.handleChainError(g)),g}await(u==null?void 0:u.handleChainEnd(Ut(h,"output")))}async batch(e,t,r){var c;if(r!=null&&r.returnExceptions)throw new Error("Not implemented.");const s=this._getOptionsList(t??{},e.length),a=await Promise.all(s.map(f=>Or(f))),o=await Promise.all(a.map(async(f,h)=>{const m=await(f==null?void 0:f.handleChainStart(this.toJSON(),Ut(e[h],"input"),s[h].runId,void 0,void 0,void 0,s[h].runName));return delete s[h].runId,m}));let u;for(const f of this.runnables()){(c=s[0].signal)==null||c.throwIfAborted();try{const h=await f.batch(e,o.map((m,g)=>an(s[g],{callbacks:m==null?void 0:m.getChild()})),r);return await Promise.all(o.map((m,g)=>m==null?void 0:m.handleChainEnd(Ut(h[g],"output")))),h}catch(h){u===void 0&&(u=h)}}throw u?(await Promise.all(o.map(f=>f==null?void 0:f.handleChainError(u))),u):new Error("No error stored at end of fallbacks.")}}function Da(n){if(typeof n=="function")return new Eo({func:n});if(zt.isRunnable(n))return n;if(!Array.isArray(n)&&typeof n=="object"){const e={};for(const[t,r]of Object.entries(n))e[t]=Da(r);return new So({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class oP extends zt{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof So&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,t){const r=await this.mapper.invoke(e,t);return{...e,...r}}async*_transform(e,t,r){const s=this.mapper.getStepsKeys(),[a,o]=eP(e),u=this.mapper.transform(o,an(r,{callbacks:t==null?void 0:t.getChild()})),c=u.next();for await(const f of a){if(typeof f!="object"||Array.isArray(f))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof f}`);const h=Object.fromEntries(Object.entries(f).filter(([m])=>!s.includes(m)));Object.keys(h).length>0&&(yield h)}yield(await c).value;for await(const f of u)yield f}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const s=Ge(t),a=new xo({generator:this.transform(r(),s),config:s});return await a.setup,Wn.fromAsyncGenerator(a)}}class gD extends zt{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const t=this.keys.map(r=>[r,e[r]]).filter(r=>r[1]!==void 0);return t.length===0?void 0:Object.fromEntries(t)}}async invoke(e,t){return this._callWithConfig(this._pick.bind(this),e,t)}async*_transform(e){for await(const t of e){const r=await this._pick(t);r!==void 0&&(yield r)}}transform(e,t){return this._transformStreamWithConfig(e,this._transform.bind(this),t)}async stream(e,t){async function*r(){yield e}const s=Ge(t),a=new xo({generator:this.transform(r(),s),config:s});return await a.setup,Wn.fromAsyncGenerator(a)}}class BS extends Ha{constructor(e){const t=Ps.from([Eo.from(async r=>{let s;if(RC(r))try{s=await this.schema.parseAsync(r.args)}catch{throw new YL("Received tool input did not match expected schema",JSON.stringify(r.args))}else s=r;return s}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:t,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function yD(n,e){var s;const t=e.name??n.getName(),r=e.description??((s=e.schema)==null?void 0:s.description);return e.schema.constructor===le.ZodString?new BS({name:t,description:r,schema:le.object({input:le.string()}).transform(a=>a.input),bound:n}):new BS({name:t,description:r,schema:e.schema,bound:n})}/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var _D=typeof window=="object"?window:{},Me="0123456789abcdef".split(""),wD=[-2147483648,8388608,32768,128],_r=[24,16,8,0],Dt=[];function Nr(n){n?(Dt[0]=Dt[16]=Dt[1]=Dt[2]=Dt[3]=Dt[4]=Dt[5]=Dt[6]=Dt[7]=Dt[8]=Dt[9]=Dt[10]=Dt[11]=Dt[12]=Dt[13]=Dt[14]=Dt[15]=0,this.blocks=Dt):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}Nr.prototype.update=function(n){if(!this.finalized){var e=typeof n!="string";e&&n.constructor===_D.ArrayBuffer&&(n=new Uint8Array(n));for(var t,r=0,s,a=n.length||0,o=this.blocks;r<a;){if(this.hashed&&(this.hashed=!1,o[0]=this.block,o[16]=o[1]=o[2]=o[3]=o[4]=o[5]=o[6]=o[7]=o[8]=o[9]=o[10]=o[11]=o[12]=o[13]=o[14]=o[15]=0),e)for(s=this.start;r<a&&s<64;++r)o[s>>2]|=n[r]<<_r[s++&3];else for(s=this.start;r<a&&s<64;++r)t=n.charCodeAt(r),t<128?o[s>>2]|=t<<_r[s++&3]:t<2048?(o[s>>2]|=(192|t>>6)<<_r[s++&3],o[s>>2]|=(128|t&63)<<_r[s++&3]):t<55296||t>=57344?(o[s>>2]|=(224|t>>12)<<_r[s++&3],o[s>>2]|=(128|t>>6&63)<<_r[s++&3],o[s>>2]|=(128|t&63)<<_r[s++&3]):(t=65536+((t&1023)<<10|n.charCodeAt(++r)&1023),o[s>>2]|=(240|t>>18)<<_r[s++&3],o[s>>2]|=(128|t>>12&63)<<_r[s++&3],o[s>>2]|=(128|t>>6&63)<<_r[s++&3],o[s>>2]|=(128|t&63)<<_r[s++&3]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=o[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};Nr.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var n=this.blocks,e=this.lastByteIndex;n[16]=this.block,n[e>>2]|=wD[e&3],this.block=n[16],e>=56&&(this.hashed||this.hash(),n[0]=this.block,n[16]=n[1]=n[2]=n[3]=n[4]=n[5]=n[6]=n[7]=n[8]=n[9]=n[10]=n[11]=n[12]=n[13]=n[14]=n[15]=0),n[14]=this.hBytes<<3|this.bytes>>>29,n[15]=this.bytes<<3,this.hash()}};Nr.prototype.hash=function(){var n=this.h0,e=this.h1,t=this.h2,r=this.h3,s=this.h4,a,o,u,c=this.blocks;for(o=16;o<80;++o)u=c[o-3]^c[o-8]^c[o-14]^c[o-16],c[o]=u<<1|u>>>31;for(o=0;o<20;o+=5)a=e&t|~e&r,u=n<<5|n>>>27,s=u+a+s+1518500249+c[o]<<0,e=e<<30|e>>>2,a=n&e|~n&t,u=s<<5|s>>>27,r=u+a+r+1518500249+c[o+1]<<0,n=n<<30|n>>>2,a=s&n|~s&e,u=r<<5|r>>>27,t=u+a+t+1518500249+c[o+2]<<0,s=s<<30|s>>>2,a=r&s|~r&n,u=t<<5|t>>>27,e=u+a+e+1518500249+c[o+3]<<0,r=r<<30|r>>>2,a=t&r|~t&s,u=e<<5|e>>>27,n=u+a+n+1518500249+c[o+4]<<0,t=t<<30|t>>>2;for(;o<40;o+=5)a=e^t^r,u=n<<5|n>>>27,s=u+a+s+1859775393+c[o]<<0,e=e<<30|e>>>2,a=n^e^t,u=s<<5|s>>>27,r=u+a+r+1859775393+c[o+1]<<0,n=n<<30|n>>>2,a=s^n^e,u=r<<5|r>>>27,t=u+a+t+1859775393+c[o+2]<<0,s=s<<30|s>>>2,a=r^s^n,u=t<<5|t>>>27,e=u+a+e+1859775393+c[o+3]<<0,r=r<<30|r>>>2,a=t^r^s,u=e<<5|e>>>27,n=u+a+n+1859775393+c[o+4]<<0,t=t<<30|t>>>2;for(;o<60;o+=5)a=e&t|e&r|t&r,u=n<<5|n>>>27,s=u+a+s-1894007588+c[o]<<0,e=e<<30|e>>>2,a=n&e|n&t|e&t,u=s<<5|s>>>27,r=u+a+r-1894007588+c[o+1]<<0,n=n<<30|n>>>2,a=s&n|s&e|n&e,u=r<<5|r>>>27,t=u+a+t-1894007588+c[o+2]<<0,s=s<<30|s>>>2,a=r&s|r&n|s&n,u=t<<5|t>>>27,e=u+a+e-1894007588+c[o+3]<<0,r=r<<30|r>>>2,a=t&r|t&s|r&s,u=e<<5|e>>>27,n=u+a+n-1894007588+c[o+4]<<0,t=t<<30|t>>>2;for(;o<80;o+=5)a=e^t^r,u=n<<5|n>>>27,s=u+a+s-899497514+c[o]<<0,e=e<<30|e>>>2,a=n^e^t,u=s<<5|s>>>27,r=u+a+r-899497514+c[o+1]<<0,n=n<<30|n>>>2,a=s^n^e,u=r<<5|r>>>27,t=u+a+t-899497514+c[o+2]<<0,s=s<<30|s>>>2,a=r^s^n,u=t<<5|t>>>27,e=u+a+e-899497514+c[o+3]<<0,r=r<<30|r>>>2,a=t^r^s,u=e<<5|e>>>27,n=u+a+n-899497514+c[o+4]<<0,t=t<<30|t>>>2;this.h0=this.h0+n<<0,this.h1=this.h1+e<<0,this.h2=this.h2+t<<0,this.h3=this.h3+r<<0,this.h4=this.h4+s<<0};Nr.prototype.hex=function(){this.finalize();var n=this.h0,e=this.h1,t=this.h2,r=this.h3,s=this.h4;return Me[n>>28&15]+Me[n>>24&15]+Me[n>>20&15]+Me[n>>16&15]+Me[n>>12&15]+Me[n>>8&15]+Me[n>>4&15]+Me[n&15]+Me[e>>28&15]+Me[e>>24&15]+Me[e>>20&15]+Me[e>>16&15]+Me[e>>12&15]+Me[e>>8&15]+Me[e>>4&15]+Me[e&15]+Me[t>>28&15]+Me[t>>24&15]+Me[t>>20&15]+Me[t>>16&15]+Me[t>>12&15]+Me[t>>8&15]+Me[t>>4&15]+Me[t&15]+Me[r>>28&15]+Me[r>>24&15]+Me[r>>20&15]+Me[r>>16&15]+Me[r>>12&15]+Me[r>>8&15]+Me[r>>4&15]+Me[r&15]+Me[s>>28&15]+Me[s>>24&15]+Me[s>>20&15]+Me[s>>16&15]+Me[s>>12&15]+Me[s>>8&15]+Me[s>>4&15]+Me[s&15]};Nr.prototype.toString=Nr.prototype.hex;Nr.prototype.digest=function(){this.finalize();var n=this.h0,e=this.h1,t=this.h2,r=this.h3,s=this.h4;return[n>>24&255,n>>16&255,n>>8&255,n&255,e>>24&255,e>>16&255,e>>8&255,e&255,t>>24&255,t>>16&255,t>>8&255,t&255,r>>24&255,r>>16&255,r>>8&255,r&255,s>>24&255,s>>16&255,s>>8&255,s&255]};Nr.prototype.array=Nr.prototype.digest;Nr.prototype.arrayBuffer=function(){this.finalize();var n=new ArrayBuffer(20),e=new DataView(n);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),n};const bD=n=>new Nr(!0).update(n).hex(),HS=(...n)=>bD(n.join("_"));class vD{}const xD=new Map;class L_ extends vD{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(HS(e,t))??null)}async update(e,t,r){this.cache.set(HS(e,t),r)}static global(){return new L_(xD)}}class lP extends Ja{}class SD extends lP{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new no(this.value)]}}class ED extends lP{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return OC(this.messages)}toChatMessages(){return this.messages}}var Sl={},VS;function CD(){if(VS)return Sl;VS=1,Sl.byteLength=u,Sl.toByteArray=f,Sl.fromByteArray=g;for(var n=[],e=[],t=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=r.length;s<a;++s)n[s]=r[s],e[r.charCodeAt(s)]=s;e[45]=62,e[95]=63;function o(y){var w=y.length;if(w%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=y.indexOf("=");v===-1&&(v=w);var x=v===w?0:4-v%4;return[v,x]}function u(y){var w=o(y),v=w[0],x=w[1];return(v+x)*3/4-x}function c(y,w,v){return(w+v)*3/4-v}function f(y){var w,v=o(y),x=v[0],E=v[1],k=new t(c(y,x,E)),S=0,R=E>0?x-4:x,A;for(A=0;A<R;A+=4)w=e[y.charCodeAt(A)]<<18|e[y.charCodeAt(A+1)]<<12|e[y.charCodeAt(A+2)]<<6|e[y.charCodeAt(A+3)],k[S++]=w>>16&255,k[S++]=w>>8&255,k[S++]=w&255;return E===2&&(w=e[y.charCodeAt(A)]<<2|e[y.charCodeAt(A+1)]>>4,k[S++]=w&255),E===1&&(w=e[y.charCodeAt(A)]<<10|e[y.charCodeAt(A+1)]<<4|e[y.charCodeAt(A+2)]>>2,k[S++]=w>>8&255,k[S++]=w&255),k}function h(y){return n[y>>18&63]+n[y>>12&63]+n[y>>6&63]+n[y&63]}function m(y,w,v){for(var x,E=[],k=w;k<v;k+=3)x=(y[k]<<16&16711680)+(y[k+1]<<8&65280)+(y[k+2]&255),E.push(h(x));return E.join("")}function g(y){for(var w,v=y.length,x=v%3,E=[],k=16383,S=0,R=v-x;S<R;S+=k)E.push(m(y,S,S+k>R?R:S+k));return x===1?(w=y[v-1],E.push(n[w>>2]+n[w<<4&63]+"==")):x===2&&(w=(y[v-2]<<8)+y[v-1],E.push(n[w>>10]+n[w>>4&63]+n[w<<2&63]+"=")),E.join("")}return Sl}var PD=CD();const kD=ti(PD);var RD=Object.defineProperty,OD=(n,e,t)=>e in n?RD(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,TD=(n,e,t)=>(OD(n,e+"",t),t);function AD(n,e){let t=Array.from({length:n.length},(r,s)=>({start:s,end:s+1}));for(;t.length>1;){let r=null;for(let s=0;s<t.length-1;s++){const a=n.slice(t[s].start,t[s+1].end),o=e.get(a.join(","));o!=null&&(r==null||o<r[0])&&(r=[o,s])}if(r!=null){const s=r[1];t[s]={start:t[s].start,end:t[s+1].end},t.splice(s+1,1)}else break}return t}function $D(n,e){return n.length===1?[e.get(n.join(","))]:AD(n,e).map(t=>e.get(n.slice(t.start,t.end).join(","))).filter(t=>t!=null)}function ID(n){return n.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var ry=class{constructor(n,e){ea(this,"specialTokens");ea(this,"inverseSpecialTokens");ea(this,"patStr");ea(this,"textEncoder",new TextEncoder);ea(this,"textDecoder",new TextDecoder("utf-8"));ea(this,"rankMap",new Map);ea(this,"textMap",new Map);this.patStr=n.pat_str;const t=n.bpe_ranks.split(`
`).filter(Boolean).reduce((r,s)=>{const[a,o,...u]=s.split(" "),c=Number.parseInt(o,10);return u.forEach((f,h)=>r[f]=c+h),r},{});for(const[r,s]of Object.entries(t)){const a=kD.toByteArray(r);this.rankMap.set(a.join(","),s),this.textMap.set(s,a)}this.specialTokens={...n.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((r,[s,a])=>(r[a]=this.textEncoder.encode(s),r),{})}encode(n,e=[],t="all"){const r=new RegExp(this.patStr,"ug"),s=ry.specialTokenRegex(Object.keys(this.specialTokens)),a=[],o=new Set(e==="all"?Object.keys(this.specialTokens):e),u=new Set(t==="all"?Object.keys(this.specialTokens).filter(f=>!o.has(f)):t);if(u.size>0){const f=ry.specialTokenRegex([...u]),h=n.match(f);if(h!=null)throw new Error(`The text contains a special token that is not allowed: ${h[0]}`)}let c=0;for(;;){let f=null,h=c;for(;s.lastIndex=h,f=s.exec(n),!(f==null||o.has(f[0]));)h=f.index+1;const m=(f==null?void 0:f.index)??n.length;for(const y of n.substring(c,m).matchAll(r)){const w=this.textEncoder.encode(y[0]),v=this.rankMap.get(w.join(","));if(v!=null){a.push(v);continue}a.push(...$D(w,this.rankMap))}if(f==null)break;let g=this.specialTokens[f[0]];a.push(g),c=f.index+f[0].length}return a}decode(n){const e=[];let t=0;for(let a=0;a<n.length;++a){const o=n[a],u=this.textMap.get(o)??this.inverseSpecialTokens[o];u!=null&&(e.push(u),t+=u.length)}const r=new Uint8Array(t);let s=0;for(const a of e)r.set(a,s),s+=a.length;return this.textDecoder.decode(r)}},uP=ry;TD(uP,"specialTokenRegex",n=>new RegExp(n.map(e=>ID(e)).join("|"),"g"));function ND(n){switch(n){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-2024-11-20":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"o1":case"o1-2024-12-17":case"o1-mini":case"o1-preview":case"o1-preview-2024-09-12":case"o1-mini-2024-09-12":case"o3-mini":case"o3-mini-2025-01-31":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":return"o200k_base";default:throw new Error("Unknown model")}}const rd={},jD=new I_({});async function LD(n){return n in rd||(rd[n]=jD.fetch(`https://tiktoken.pages.dev/js/${n}.json`).then(e=>e.json()).then(e=>new uP(e)).catch(e=>{throw delete rd[n],e})),await rd[n]}async function MD(n){return LD(ND(n))}const DD=n=>n.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":n.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":n.startsWith("gpt-4-32k")?"gpt-4-32k":n.startsWith("gpt-4-")?"gpt-4":n.startsWith("gpt-4o")?"gpt-4o":n;function cP(n){return typeof n!="object"||!n?!1:!!("type"in n&&n.type==="function"&&"function"in n&&typeof n.function=="object"&&n.function&&"name"in n.function&&"parameters"in n.function)}const FD=()=>!1;class UD extends zt{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??FD(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class zD extends UD{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:t,...r}){const{cache:s,...a}=r;super({callbacks:e??t,...a}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof s=="object"?this.cache=s:s?this.cache=L_.global():this.cache=void 0,this.caller=new I_(r??{})}async getNumTokens(e){if(typeof e!="string")return 0;let t=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await MD("modelName"in this?DD(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{t=this._encoding.encode(e).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return t}static _convertInputToPromptValue(e){return typeof e=="string"?new SD(e):Array.isArray(e)?new ED(e.map(El)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...t}){const r={...this._identifyingParams(),...t,_type:this._llmType(),_model:this._modelType()};return Object.entries(r).filter(([o,u])=>u!==void 0).map(([o,u])=>`${o}:${JSON.stringify(u)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}class Gd extends zt{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,t){const r=Ge(t);return this.func&&await this.func(e,r),this._callWithConfig(s=>Promise.resolve(s),e,r)}async*transform(e,t){const r=Ge(t);let s,a=!0;for await(const o of this._transformStreamWithConfig(e,u=>u,r))if(yield o,a)if(s===void 0)s=o;else try{s=nr(s,o)}catch{s=void 0,a=!1}this.func&&s!==void 0&&await this.func(s,r)}static assign(e){return new oP(new So({steps:e}))}}function M_(n){var r;if(!n||typeof n!="object"||Array.isArray(n))return!1;const e=n;return e._def||Object.values(le.ZodFirstPartyTypeKind).includes(((r=e.constructor)==null?void 0:r.name)??"NOT_INCLUDED")?!0:typeof e.parse=="function"&&typeof e.parseAsync=="function"&&typeof e.safeParse=="function"&&typeof e.safeParseAsync=="function"}class Cs extends zD{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]}),Object.defineProperty(this,"disableStreaming",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_separateRunnableConfigFromCallOptionsCompat(e){const[t,r]=super._separateRunnableConfigFromCallOptions(e);return r.signal=t.signal,[t,r]}async invoke(e,t){const r=Cs._convertInputToPromptValue(e);return(await this.generatePrompt([r],t,t==null?void 0:t.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,t,r){throw new Error("Not implemented.")}async*_streamIterator(e,t){var r;if(this._streamResponseChunks===Cs.prototype._streamResponseChunks||this.disableStreaming)yield this.invoke(e,t);else{const a=Cs._convertInputToPromptValue(e).toChatMessages(),[o,u]=this._separateRunnableConfigFromCallOptionsCompat(t),c={...o.metadata,...this.getLsParams(u)},f=await On.configure(o.callbacks,this.callbacks,o.tags,this.tags,c,this.metadata,{verbose:this.verbose}),h={options:u,invocation_params:this==null?void 0:this.invocationParams(u),batch_size:1},m=await(f==null?void 0:f.handleChatModelStart(this.toJSON(),[a],o.runId,void 0,h,void 0,void 0,o.runName));let g,y;try{for await(const w of this._streamResponseChunks(a,u,m==null?void 0:m[0])){if(w.message.id==null){const v=(r=m==null?void 0:m.at(0))==null?void 0:r.runId;v!=null&&w.message._updateId(`run-${v}`)}w.message.response_metadata={...w.generationInfo,...w.message.response_metadata},yield w.message,g?g=g.concat(w):g=w,dx(w.message)&&w.message.usage_metadata!==void 0&&(y={tokenUsage:{promptTokens:w.message.usage_metadata.input_tokens,completionTokens:w.message.usage_metadata.output_tokens,totalTokens:w.message.usage_metadata.total_tokens}})}}catch(w){throw await Promise.all((m??[]).map(v=>v==null?void 0:v.handleLLMError(w))),w}await Promise.all((m??[]).map(w=>w==null?void 0:w.handleLLMEnd({generations:[[g]],llmOutput:y})))}}getLsParams(e){const t=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:t}}async _generateUncached(e,t,r,s){var m,g;const a=e.map(y=>y.map(El));let o;if(s!==void 0&&s.length===a.length)o=s;else{const y={...r.metadata,...this.getLsParams(t)},w=await On.configure(r.callbacks,this.callbacks,r.tags,this.tags,y,this.metadata,{verbose:this.verbose}),v={options:t,invocation_params:this==null?void 0:this.invocationParams(t),batch_size:1};o=await(w==null?void 0:w.handleChatModelStart(this.toJSON(),a,r.runId,void 0,v,void 0,void 0,r.runName))}const u=[],c=[];if(!!(o!=null&&o[0].handlers.find(W3))&&!this.disableStreaming&&a.length===1&&this._streamResponseChunks!==Cs.prototype._streamResponseChunks)try{const y=await this._streamResponseChunks(a[0],t,o==null?void 0:o[0]);let w,v;for await(const x of y){if(x.message.id==null){const E=(m=o==null?void 0:o.at(0))==null?void 0:m.runId;E!=null&&x.message._updateId(`run-${E}`)}w===void 0?w=x:w=nr(w,x),dx(x.message)&&x.message.usage_metadata!==void 0&&(v={tokenUsage:{promptTokens:x.message.usage_metadata.input_tokens,completionTokens:x.message.usage_metadata.output_tokens,totalTokens:x.message.usage_metadata.total_tokens}})}if(w===void 0)throw new Error("Received empty response from chat model call.");u.push([w]),await(o==null?void 0:o[0].handleLLMEnd({generations:u,llmOutput:v}))}catch(y){throw await(o==null?void 0:o[0].handleLLMError(y)),y}else{const y=await Promise.allSettled(a.map((w,v)=>this._generate(w,{...t,promptIndex:v},o==null?void 0:o[v])));await Promise.all(y.map(async(w,v)=>{var x,E,k;if(w.status==="fulfilled"){const S=w.value;for(const R of S.generations){if(R.message.id==null){const A=(x=o==null?void 0:o.at(0))==null?void 0:x.runId;A!=null&&R.message._updateId(`run-${A}`)}R.message.response_metadata={...R.generationInfo,...R.message.response_metadata}}return S.generations.length===1&&(S.generations[0].message.response_metadata={...S.llmOutput,...S.generations[0].message.response_metadata}),u[v]=S.generations,c[v]=S.llmOutput,(E=o==null?void 0:o[v])==null?void 0:E.handleLLMEnd({generations:[S.generations],llmOutput:S.llmOutput})}else return await((k=o==null?void 0:o[v])==null?void 0:k.handleLLMError(w.reason)),Promise.reject(w.reason)}))}const h={generations:u,llmOutput:c.length?(g=this._combineLLMOutput)==null?void 0:g.call(this,...c):void 0};return Object.defineProperty(h,jS,{value:o?{runIds:o==null?void 0:o.map(y=>y.runId)}:void 0,configurable:!0}),h}async _generateCached({messages:e,cache:t,llmStringKey:r,parsedOptions:s,handledOptions:a}){const o=e.map(x=>x.map(El)),u={...a.metadata,...this.getLsParams(s)},c=await On.configure(a.callbacks,this.callbacks,a.tags,this.tags,u,this.metadata,{verbose:this.verbose}),f={options:s,invocation_params:this==null?void 0:this.invocationParams(s),batch_size:1},h=await(c==null?void 0:c.handleChatModelStart(this.toJSON(),o,a.runId,void 0,f,void 0,void 0,a.runName)),m=[],y=(await Promise.allSettled(o.map(async(x,E)=>{const k=Cs._convertInputToPromptValue(x).toString(),S=await t.lookup(k,r);return S==null&&m.push(E),S}))).map((x,E)=>({result:x,runManager:h==null?void 0:h[E]})).filter(({result:x})=>x.status==="fulfilled"&&x.value!=null||x.status==="rejected"),w=[];await Promise.all(y.map(async({result:x,runManager:E},k)=>{if(x.status==="fulfilled"){const S=x.value;return w[k]=S.map(R=>("message"in R&&xf(R.message)&&xu(R.message)&&(R.message.usage_metadata={input_tokens:0,output_tokens:0,total_tokens:0}),R.generationInfo={...R.generationInfo,tokenUsage:{}},R)),S.length&&await(E==null?void 0:E.handleLLMNewToken(S[0].text)),E==null?void 0:E.handleLLMEnd({generations:[S]},void 0,void 0,void 0,{cached:!0})}else return await(E==null?void 0:E.handleLLMError(x.reason,void 0,void 0,void 0,{cached:!0})),Promise.reject(x.reason)}));const v={generations:w,missingPromptIndices:m,startedRunManagers:h};return Object.defineProperty(v,jS,{value:h?{runIds:h==null?void 0:h.map(x=>x.runId)}:void 0,configurable:!0}),v}async generate(e,t,r){let s;Array.isArray(t)?s={stop:t}:s=t;const a=e.map(w=>w.map(El)),[o,u]=this._separateRunnableConfigFromCallOptionsCompat(s);if(o.callbacks=o.callbacks??r,!this.cache)return this._generateUncached(a,u,o);const{cache:c}=this,f=this._getSerializedCacheKeyParametersForCall(u),{generations:h,missingPromptIndices:m,startedRunManagers:g}=await this._generateCached({messages:a,cache:c,llmStringKey:f,parsedOptions:u,handledOptions:o});let y={};if(m.length>0){const w=await this._generateUncached(m.map(v=>a[v]),u,o,g!==void 0?m.map(v=>g==null?void 0:g[v]):void 0);await Promise.all(w.generations.map(async(v,x)=>{const E=m[x];h[E]=v;const k=Cs._convertInputToPromptValue(a[E]).toString();return c.update(k,f,v)})),y=w.llmOutput??{}}return{generations:h,llmOutput:y}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,t,r){const s=e.map(a=>a.toChatMessages());return this.generate(s,t,r)}async call(e,t,r){return(await this.generate([e.map(El)],t,r)).generations[0][0].message}async callPrompt(e,t,r){const s=e.toChatMessages();return this.call(s,t,r)}async predictMessages(e,t,r){return this.call(e,t,r)}async predict(e,t,r){const s=new no(e),a=await this.call([s],t,r);if(typeof a.content!="string")throw new Error("Cannot use predict when output is not a string.");return a.content}withStructuredOutput(e,t){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(t!=null&&t.strict)throw new Error('"strict" mode is not supported for this model by default.');const r=e,s=t==null?void 0:t.name,a=r.description??"A function available to call.",o=t==null?void 0:t.method,u=t==null?void 0:t.includeRaw;if(o==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let c=s??"extract",f;M_(r)?f=[{type:"function",function:{name:c,description:a,parameters:Ru(r)}}]:("name"in r&&(c=r.name),f=[{type:"function",function:{name:c,description:a,parameters:r}}]);const h=this.bindTools(f),m=Eo.from(v=>{if(!v.tool_calls||v.tool_calls.length===0)throw new Error("No tool calls found in the response.");const x=v.tool_calls.find(E=>E.name===c);if(!x)throw new Error(`No tool call found with name ${c}.`);return x.args});if(!u)return h.pipe(m).withConfig({runName:"StructuredOutput"});const g=Gd.assign({parsed:(v,x)=>m.invoke(v.raw,x)}),y=Gd.assign({parsed:()=>null}),w=g.withFallbacks({fallbacks:[y]});return Ps.from([{raw:h},w]).withConfig({runName:"StructuredOutputRunnable"})}}var Gt=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof global<"u"&&global||{},pn={searchParams:"URLSearchParams"in Gt,iterable:"Symbol"in Gt&&"iterator"in Symbol,blob:"FileReader"in Gt&&"Blob"in Gt&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in Gt,arrayBuffer:"ArrayBuffer"in Gt};function BD(n){return n&&DataView.prototype.isPrototypeOf(n)}if(pn.arrayBuffer)var HD=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],VD=ArrayBuffer.isView||function(n){return n&&HD.indexOf(Object.prototype.toString.call(n))>-1};function Co(n){if(typeof n!="string"&&(n=String(n)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(n)||n==="")throw new TypeError('Invalid character in header field name: "'+n+'"');return n.toLowerCase()}function D_(n){return typeof n!="string"&&(n=String(n)),n}function F_(n){var e={next:function(){var t=n.shift();return{done:t===void 0,value:t}}};return pn.iterable&&(e[Symbol.iterator]=function(){return e}),e}function It(n){this.map={},n instanceof It?n.forEach(function(e,t){this.append(t,e)},this):Array.isArray(n)?n.forEach(function(e){if(e.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):n&&Object.getOwnPropertyNames(n).forEach(function(e){this.append(e,n[e])},this)}It.prototype.append=function(n,e){n=Co(n),e=D_(e);var t=this.map[n];this.map[n]=t?t+", "+e:e};It.prototype.delete=function(n){delete this.map[Co(n)]};It.prototype.get=function(n){return n=Co(n),this.has(n)?this.map[n]:null};It.prototype.has=function(n){return this.map.hasOwnProperty(Co(n))};It.prototype.set=function(n,e){this.map[Co(n)]=D_(e)};It.prototype.forEach=function(n,e){for(var t in this.map)this.map.hasOwnProperty(t)&&n.call(e,this.map[t],t,this)};It.prototype.keys=function(){var n=[];return this.forEach(function(e,t){n.push(t)}),F_(n)};It.prototype.values=function(){var n=[];return this.forEach(function(e){n.push(e)}),F_(n)};It.prototype.entries=function(){var n=[];return this.forEach(function(e,t){n.push([t,e])}),F_(n)};pn.iterable&&(It.prototype[Symbol.iterator]=It.prototype.entries);function fg(n){if(!n._noBody){if(n.bodyUsed)return Promise.reject(new TypeError("Already read"));n.bodyUsed=!0}}function dP(n){return new Promise(function(e,t){n.onload=function(){e(n.result)},n.onerror=function(){t(n.error)}})}function WD(n){var e=new FileReader,t=dP(e);return e.readAsArrayBuffer(n),t}function qD(n){var e=new FileReader,t=dP(e),r=/charset=([A-Za-z0-9_-]+)/.exec(n.type),s=r?r[1]:"utf-8";return e.readAsText(n,s),t}function ZD(n){for(var e=new Uint8Array(n),t=new Array(e.length),r=0;r<e.length;r++)t[r]=String.fromCharCode(e[r]);return t.join("")}function WS(n){if(n.slice)return n.slice(0);var e=new Uint8Array(n.byteLength);return e.set(new Uint8Array(n)),e.buffer}function fP(){return this.bodyUsed=!1,this._initBody=function(n){this.bodyUsed=this.bodyUsed,this._bodyInit=n,n?typeof n=="string"?this._bodyText=n:pn.blob&&Blob.prototype.isPrototypeOf(n)?this._bodyBlob=n:pn.formData&&FormData.prototype.isPrototypeOf(n)?this._bodyFormData=n:pn.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)?this._bodyText=n.toString():pn.arrayBuffer&&pn.blob&&BD(n)?(this._bodyArrayBuffer=WS(n.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):pn.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(n)||VD(n))?this._bodyArrayBuffer=WS(n):this._bodyText=n=Object.prototype.toString.call(n):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof n=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):pn.searchParams&&URLSearchParams.prototype.isPrototypeOf(n)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},pn.blob&&(this.blob=function(){var n=fg(this);if(n)return n;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var n=fg(this);return n||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(pn.blob)return this.blob().then(WD);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var n=fg(this);if(n)return n;if(this._bodyBlob)return qD(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(ZD(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},pn.formData&&(this.formData=function(){return this.text().then(KD)}),this.json=function(){return this.text().then(JSON.parse)},this}var GD=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function JD(n){var e=n.toUpperCase();return GD.indexOf(e)>-1?e:n}function ei(n,e){if(!(this instanceof ei))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');e=e||{};var t=e.body;if(n instanceof ei){if(n.bodyUsed)throw new TypeError("Already read");this.url=n.url,this.credentials=n.credentials,e.headers||(this.headers=new It(n.headers)),this.method=n.method,this.mode=n.mode,this.signal=n.signal,!t&&n._bodyInit!=null&&(t=n._bodyInit,n.bodyUsed=!0)}else this.url=String(n);if(this.credentials=e.credentials||this.credentials||"same-origin",(e.headers||!this.headers)&&(this.headers=new It(e.headers)),this.method=JD(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.signal=e.signal||this.signal||function(){if("AbortController"in Gt){var a=new AbortController;return a.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&t)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(t),(this.method==="GET"||this.method==="HEAD")&&(e.cache==="no-store"||e.cache==="no-cache")){var r=/([?&])_=[^&]*/;if(r.test(this.url))this.url=this.url.replace(r,"$1_="+new Date().getTime());else{var s=/\?/;this.url+=(s.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}ei.prototype.clone=function(){return new ei(this,{body:this._bodyInit})};function KD(n){var e=new FormData;return n.trim().split("&").forEach(function(t){if(t){var r=t.split("="),s=r.shift().replace(/\+/g," "),a=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(s),decodeURIComponent(a))}}),e}function XD(n){var e=new It,t=n.replace(/\r?\n[\t ]+/g," ");return t.split("\r").map(function(r){return r.indexOf(`
`)===0?r.substr(1,r.length):r}).forEach(function(r){var s=r.split(":"),a=s.shift().trim();if(a){var o=s.join(":").trim();try{e.append(a,o)}catch(u){console.warn("Response "+u.message)}}}),e}fP.call(ei.prototype);function as(n,e){if(!(this instanceof as))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(e||(e={}),this.type="default",this.status=e.status===void 0?200:e.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText===void 0?"":""+e.statusText,this.headers=new It(e.headers),this.url=e.url||"",this._initBody(n)}fP.call(as.prototype);as.prototype.clone=function(){return new as(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new It(this.headers),url:this.url})};as.error=function(){var n=new as(null,{status:200,statusText:""});return n.ok=!1,n.status=0,n.type="error",n};var YD=[301,302,303,307,308];as.redirect=function(n,e){if(YD.indexOf(e)===-1)throw new RangeError("Invalid status code");return new as(null,{status:e,headers:{location:n}})};var La=Gt.DOMException;try{new La}catch{La=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},La.prototype=Object.create(Error.prototype),La.prototype.constructor=La}function hP(n,e){return new Promise(function(t,r){var s=new ei(n,e);if(s.signal&&s.signal.aborted)return r(new La("Aborted","AbortError"));var a=new XMLHttpRequest;function o(){a.abort()}a.onload=function(){var f={statusText:a.statusText,headers:XD(a.getAllResponseHeaders()||"")};s.url.indexOf("file://")===0&&(a.status<200||a.status>599)?f.status=200:f.status=a.status,f.url="responseURL"in a?a.responseURL:f.headers.get("X-Request-URL");var h="response"in a?a.response:a.responseText;setTimeout(function(){t(new as(h,f))},0)},a.onerror=function(){setTimeout(function(){r(new TypeError("Network request failed"))},0)},a.ontimeout=function(){setTimeout(function(){r(new TypeError("Network request timed out"))},0)},a.onabort=function(){setTimeout(function(){r(new La("Aborted","AbortError"))},0)};function u(f){try{return f===""&&Gt.location.href?Gt.location.href:f}catch{return f}}if(a.open(s.method,u(s.url),!0),s.credentials==="include"?a.withCredentials=!0:s.credentials==="omit"&&(a.withCredentials=!1),"responseType"in a&&(pn.blob?a.responseType="blob":pn.arrayBuffer&&(a.responseType="arraybuffer")),e&&typeof e.headers=="object"&&!(e.headers instanceof It||Gt.Headers&&e.headers instanceof Gt.Headers)){var c=[];Object.getOwnPropertyNames(e.headers).forEach(function(f){c.push(Co(f)),a.setRequestHeader(f,D_(e.headers[f]))}),s.headers.forEach(function(f,h){c.indexOf(h)===-1&&a.setRequestHeader(h,f)})}else s.headers.forEach(function(f,h){a.setRequestHeader(h,f)});s.signal&&(s.signal.addEventListener("abort",o),a.onreadystatechange=function(){a.readyState===4&&s.signal.removeEventListener("abort",o)}),a.send(typeof s._bodyInit>"u"?null:s._bodyInit)})}hP.polyfill=!0;Gt.fetch||(Gt.fetch=hP,Gt.Headers=It,Gt.Request=ei,Gt.Response=as);const QD="0.5.12";var eF=Object.defineProperty,tF=(n,e,t)=>e in n?eF(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,hg=(n,e,t)=>(tF(n,typeof e!="symbol"?e+"":e,t),t);class U_ extends Error{constructor(e,t){super(e),this.error=e,this.status_code=t,this.name="ResponseError",Error.captureStackTrace&&Error.captureStackTrace(this,U_)}}class nF{constructor(e,t,r){hg(this,"abortController"),hg(this,"itr"),hg(this,"doneCallback"),this.abortController=e,this.itr=t,this.doneCallback=r}abort(){this.abortController.abort()}async*[Symbol.asyncIterator](){for await(const e of this.itr){if("error"in e)throw new Error(e.error);if(yield e,e.done||e.status==="success"){this.doneCallback();return}}throw new Error("Did not receive done or success response in stream.")}}const z_=async n=>{var r;if(n.ok)return;let e=`Error ${n.status}: ${n.statusText}`,t=null;if((r=n.headers.get("content-type"))!=null&&r.includes("application/json"))try{t=await n.json(),e=t.error||e}catch{console.log("Failed to parse error response as JSON")}else try{console.log("Getting text from response"),e=await n.text()||e}catch{console.log("Failed to get text from error response")}throw new U_(e,n.status)};function rF(){return typeof window<"u"&&window.navigator?`${window.navigator.platform.toLowerCase()} Browser/${navigator.userAgent};`:typeof process<"u"?`${process.arch} ${process.platform} Node.js/${process.version}`:""}const B_=async(n,e,t={})=>{const r={"Content-Type":"application/json",Accept:"application/json","User-Agent":`ollama-js/${QD} (${rF()})`};t.headers||(t.headers={});const s=Object.fromEntries(Object.entries(t.headers).filter(([a])=>!Object.keys(r).some(o=>o.toLowerCase()===a.toLowerCase())));return t.headers={...r,...s},n(e,t)},qS=async(n,e,t)=>{const r=await B_(n,e,{headers:t==null?void 0:t.headers});return await z_(r),r},ji=async(n,e,t,r)=>{const a=(u=>u!==null&&typeof u=="object"&&!Array.isArray(u))(t)?JSON.stringify(t):t,o=await B_(n,e,{method:"POST",body:a,signal:r==null?void 0:r.signal,headers:r==null?void 0:r.headers});return await z_(o),o},sF=async(n,e,t,r)=>{const s=await B_(n,e,{method:"DELETE",body:JSON.stringify(t),headers:r==null?void 0:r.headers});return await z_(s),s},aF=async function*(n){const e=new TextDecoder("utf-8");let t="";const r=n.getReader();for(;;){const{done:s,value:a}=await r.read();if(s)break;t+=e.decode(a);const o=t.split(`
`);t=o.pop()??"";for(const u of o)try{yield JSON.parse(u)}catch{console.warn("invalid json: ",u)}}for(const s of t.split(`
`).filter(a=>a!==""))try{yield JSON.parse(s)}catch{console.warn("invalid json: ",s)}},iF=n=>{if(!n)return"http://127.0.0.1:11434";let e=n.includes("://");n.startsWith(":")&&(n=`http://127.0.0.1${n}`,e=!0),e||(n=`http://${n}`);const t=new URL(n);let r=t.port;r||(e?r=t.protocol==="https:"?"443":"80":r="11434");let s=`${t.protocol}//${t.hostname}:${r}${t.pathname}`;return s.endsWith("/")&&(s=s.slice(0,-1)),s};var oF=Object.defineProperty,lF=(n,e,t)=>e in n?oF(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,pg=(n,e,t)=>(lF(n,typeof e!="symbol"?e+"":e,t),t);let pP=class{constructor(e){pg(this,"config"),pg(this,"fetch"),pg(this,"ongoingStreamedRequests",[]),this.config={host:"",headers:e==null?void 0:e.headers},e!=null&&e.proxy||(this.config.host=iF((e==null?void 0:e.host)??"http://127.0.0.1:11434")),this.fetch=(e==null?void 0:e.fetch)??fetch}abort(){for(const e of this.ongoingStreamedRequests)e.abort();this.ongoingStreamedRequests.length=0}async processStreamableRequest(e,t){t.stream=t.stream??!1;const r=`${this.config.host}/api/${e}`;if(t.stream){const a=new AbortController,o=await ji(this.fetch,r,t,{signal:a.signal,headers:this.config.headers});if(!o.body)throw new Error("Missing body");const u=aF(o.body),c=new nF(a,u,()=>{const f=this.ongoingStreamedRequests.indexOf(c);f>-1&&this.ongoingStreamedRequests.splice(f,1)});return this.ongoingStreamedRequests.push(c),c}return await(await ji(this.fetch,r,t,{headers:this.config.headers})).json()}async encodeImage(e){if(typeof e!="string"){const t=new Uint8Array(e);let r="";const s=t.byteLength;for(let a=0;a<s;a++)r+=String.fromCharCode(t[a]);return btoa(r)}return e}async generate(e){return e.images&&(e.images=await Promise.all(e.images.map(this.encodeImage.bind(this)))),this.processStreamableRequest("generate",e)}async chat(e){if(e.messages)for(const t of e.messages)t.images&&(t.images=await Promise.all(t.images.map(this.encodeImage.bind(this))));return this.processStreamableRequest("chat",e)}async create(e){return this.processStreamableRequest("create",{...e})}async pull(e){return this.processStreamableRequest("pull",{name:e.model,stream:e.stream,insecure:e.insecure})}async push(e){return this.processStreamableRequest("push",{name:e.model,stream:e.stream,insecure:e.insecure})}async delete(e){return await sF(this.fetch,`${this.config.host}/api/delete`,{name:e.model},{headers:this.config.headers}),{status:"success"}}async copy(e){return await ji(this.fetch,`${this.config.host}/api/copy`,{...e},{headers:this.config.headers}),{status:"success"}}async list(){return await(await qS(this.fetch,`${this.config.host}/api/tags`,{headers:this.config.headers})).json()}async show(e){return await(await ji(this.fetch,`${this.config.host}/api/show`,{...e},{headers:this.config.headers})).json()}async embed(e){return await(await ji(this.fetch,`${this.config.host}/api/embed`,{...e},{headers:this.config.headers})).json()}async embeddings(e){return await(await ji(this.fetch,`${this.config.host}/api/embeddings`,{...e},{headers:this.config.headers})).json()}async ps(){return await(await qS(this.fetch,`${this.config.host}/api/ps`,{headers:this.config.headers})).json()}};new pP;function uF(n){return n!==void 0&&Array.isArray(n.lc_namespace)}function cF(n){return n!==void 0&&zt.isRunnable(n)&&"lc_name"in n.constructor&&typeof n.constructor.lc_name=="function"&&n.constructor.lc_name()==="RunnableToolLike"}function dF(n){return!!n&&typeof n=="object"&&"name"in n&&"schema"in n&&M_(n.schema)}function mP(n){return dF(n)||cF(n)||uF(n)}function sy(n,e){const t=typeof n;if(t!==typeof e)return!1;if(Array.isArray(n)){if(!Array.isArray(e))return!1;const r=n.length;if(r!==e.length)return!1;for(let s=0;s<r;s++)if(!sy(n[s],e[s]))return!1;return!0}if(t==="object"){if(!n||!e)return n===e;const r=Object.keys(n),s=Object.keys(e);if(r.length!==s.length)return!1;for(const o of r)if(!sy(n[o],e[o]))return!1;return!0}return n===e}function fF(n){return M_(n)?Ru(n):n}function hF(n,e){return{name:n.name,description:n.description,parameters:fF(n.schema)}}function ay(n,e){let t;return mP(n)?t={type:"function",function:hF(n)}:t=n,t}function ZS(n,e){var t;return new ns({content:n.content??"",tool_call_chunks:(t=n.tool_calls)==null?void 0:t.map(r=>({name:r.function.name,args:JSON.stringify(r.function.arguments),type:"tool_call_chunk",index:0,id:sn()})),response_metadata:e==null?void 0:e.responseMetadata,usage_metadata:e==null?void 0:e.usageMetadata})}function GS(n){const e=n.match(/^data:.*?;base64,(.*)$/);return e?e[1]:""}function pF(n){var s,a,o;if(typeof n.content=="string")return[{role:"assistant",content:n.content}];const t=n.content.filter(u=>u.type==="text"&&typeof u.text=="string").map(u=>({role:"assistant",content:u.text}));let r;if(n.content.find(u=>u.type==="tool_use")&&((s=n.tool_calls)!=null&&s.length)){const u=(a=n.tool_calls)==null?void 0:a.map(c=>({id:c.id,type:"function",function:{name:c.name,arguments:c.args}}));u&&(r={role:"assistant",tool_calls:u,content:""})}else if(n.content.find(u=>u.type==="tool_use")&&!((o=n.tool_calls)!=null&&o.length))throw new Error("'tool_use' content type is not supported without tool calls.");return[...t,...r?[r]:[]]}function mF(n){return typeof n.content=="string"?[{role:"user",content:n.content}]:n.content.map(e=>{if(e.type==="text")return{role:"user",content:e.text};if(e.type==="image_url"){if(typeof e.image_url=="string")return{role:"user",content:"",images:[GS(e.image_url)]};if(e.image_url.url&&typeof e.image_url.url=="string")return{role:"user",content:"",images:[GS(e.image_url.url)]}}throw new Error(`Unsupported content type: ${e.type}`)})}function gF(n){if(typeof n.content=="string")return[{role:"system",content:n.content}];if(n.content.every(e=>e.type==="text"&&typeof e.text=="string"))return n.content.map(e=>({role:"system",content:e.text}));throw new Error(`Unsupported content type(s): ${n.content.map(e=>e.type).join(", ")}`)}function yF(n){if(typeof n.content!="string")throw new Error("Non string tool message content is not supported");return[{role:"tool",content:n.content}]}function _F(n){return n.flatMap(e=>{if(["human","generic"].includes(e._getType()))return mF(e);if(e._getType()==="ai")return pF(e);if(e._getType()==="system")return gF(e);if(e._getType()==="tool")return yF(e);throw new Error(`Unsupported message type: ${e._getType()}`)})}class JS extends Cs{static lc_name(){return"ChatOllama"}constructor(e){super(e??{}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"llama3"}),Object.defineProperty(this,"numa",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numCtx",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numBatch",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numGpu",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mainGpu",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lowVram",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"f16Kv",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logitsAll",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"vocabOnly",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"useMmap",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"useMlock",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"embeddingOnly",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numThread",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numKeep",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"seed",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"numPredict",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tfsZ",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"typicalP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"repeatLastN",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"repeatPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mirostat",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mirostatTau",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"mirostatEta",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"penalizeNewline",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"format",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keepAlive",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"checkOrPullModel",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"baseUrl",{enumerable:!0,configurable:!0,writable:!0,value:"http://127.0.0.1:11434"}),this.client=new pP({host:e==null?void 0:e.baseUrl,headers:e==null?void 0:e.headers}),this.baseUrl=(e==null?void 0:e.baseUrl)??this.baseUrl,this.model=(e==null?void 0:e.model)??this.model,this.numa=e==null?void 0:e.numa,this.numCtx=e==null?void 0:e.numCtx,this.numBatch=e==null?void 0:e.numBatch,this.numGpu=e==null?void 0:e.numGpu,this.mainGpu=e==null?void 0:e.mainGpu,this.lowVram=e==null?void 0:e.lowVram,this.f16Kv=e==null?void 0:e.f16Kv,this.logitsAll=e==null?void 0:e.logitsAll,this.vocabOnly=e==null?void 0:e.vocabOnly,this.useMmap=e==null?void 0:e.useMmap,this.useMlock=e==null?void 0:e.useMlock,this.embeddingOnly=e==null?void 0:e.embeddingOnly,this.numThread=e==null?void 0:e.numThread,this.numKeep=e==null?void 0:e.numKeep,this.seed=e==null?void 0:e.seed,this.numPredict=e==null?void 0:e.numPredict,this.topK=e==null?void 0:e.topK,this.topP=e==null?void 0:e.topP,this.tfsZ=e==null?void 0:e.tfsZ,this.typicalP=e==null?void 0:e.typicalP,this.repeatLastN=e==null?void 0:e.repeatLastN,this.temperature=e==null?void 0:e.temperature,this.repeatPenalty=e==null?void 0:e.repeatPenalty,this.presencePenalty=e==null?void 0:e.presencePenalty,this.frequencyPenalty=e==null?void 0:e.frequencyPenalty,this.mirostat=e==null?void 0:e.mirostat,this.mirostatTau=e==null?void 0:e.mirostatTau,this.mirostatEta=e==null?void 0:e.mirostatEta,this.penalizeNewline=e==null?void 0:e.penalizeNewline,this.streaming=e==null?void 0:e.streaming,this.format=e==null?void 0:e.format,this.keepAlive=e==null?void 0:e.keepAlive,this.checkOrPullModel=(e==null?void 0:e.checkOrPullModel)??this.checkOrPullModel}_llmType(){return"ollama"}async pull(e,t){const{stream:r,insecure:s,logProgress:a}={stream:!0,...t};if(r)for await(const o of await this.client.pull({model:e,insecure:s,stream:r}))a&&console.log(o);else{const o=await this.client.pull({model:e,insecure:s});a&&console.log(o)}}bindTools(e,t){return this.bind({tools:e.map(r=>ay(r)),...t})}getLsParams(e){var r,s;const t=this.invocationParams(e);return{ls_provider:"ollama",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:((r=t.options)==null?void 0:r.temperature)??void 0,ls_max_tokens:((s=t.options)==null?void 0:s.num_predict)??void 0,ls_stop:e.stop}}invocationParams(e){var t;if(e!=null&&e.tool_choice)throw new Error("Tool choice is not supported for ChatOllama.");return{model:this.model,format:this.format,keep_alive:this.keepAlive,options:{numa:this.numa,num_ctx:this.numCtx,num_batch:this.numBatch,num_gpu:this.numGpu,main_gpu:this.mainGpu,low_vram:this.lowVram,f16_kv:this.f16Kv,logits_all:this.logitsAll,vocab_only:this.vocabOnly,use_mmap:this.useMmap,use_mlock:this.useMlock,embedding_only:this.embeddingOnly,num_thread:this.numThread,num_keep:this.numKeep,seed:this.seed,num_predict:this.numPredict,top_k:this.topK,top_p:this.topP,tfs_z:this.tfsZ,typical_p:this.typicalP,repeat_last_n:this.repeatLastN,temperature:this.temperature,repeat_penalty:this.repeatPenalty,presence_penalty:this.presencePenalty,frequency_penalty:this.frequencyPenalty,mirostat:this.mirostat,mirostat_tau:this.mirostatTau,mirostat_eta:this.mirostatEta,penalize_newline:this.penalizeNewline,stop:e==null?void 0:e.stop},tools:(t=e==null?void 0:e.tools)!=null&&t.length?e.tools.map(r=>ay(r)):void 0}}async checkModelExistsOnMachine(e){const{models:t}=await this.client.list();return!!t.find(r=>r.name===e||r.name===`${e}:latest`)}async _generate(e,t,r){this.checkOrPullModel&&(await this.checkModelExistsOnMachine(this.model)||await this.pull(this.model,{logProgress:!0}));let s;for await(const o of this._streamResponseChunks(e,t,r))s?s=nr(s,o.message):s=o.message;const a=new Ka({id:s==null?void 0:s.id,content:(s==null?void 0:s.content)??"",tool_calls:s==null?void 0:s.tool_calls,response_metadata:s==null?void 0:s.response_metadata,usage_metadata:s==null?void 0:s.usage_metadata});return{generations:[{text:typeof a.content=="string"?a.content:"",message:a}]}}async*_streamResponseChunks(e,t,r){var f;this.checkOrPullModel&&(await this.checkModelExistsOnMachine(this.model)||await this.pull(this.model,{logProgress:!0}));const s=this.invocationParams(t),a=_F(e),o={input_tokens:0,output_tokens:0,total_tokens:0};if(s.tools&&s.tools.length>0){const h=await this.client.chat({...s,messages:a,stream:!1}),{message:m,...g}=h;return o.input_tokens+=g.prompt_eval_count??0,o.output_tokens+=g.eval_count??0,o.total_tokens=o.input_tokens+o.output_tokens,yield new Qr({text:m.content,message:ZS(m,{responseMetadata:g,usageMetadata:o})}),r==null?void 0:r.handleLLMNewToken(m.content)}const u=await this.client.chat({...s,messages:a,stream:!0});let c;for await(const h of u){(f=t.signal)!=null&&f.aborted&&this.client.abort();const{message:m,...g}=h;o.input_tokens+=g.prompt_eval_count??0,o.output_tokens+=g.eval_count??0,o.total_tokens=o.input_tokens+o.output_tokens,c=g,yield new Qr({text:m.content??"",message:ZS(m)}),await(r==null?void 0:r.handleLLMNewToken(m.content??""))}yield new Qr({text:"",message:new ns({content:"",response_metadata:c,usage_metadata:o})})}}const iy="RFC3986",oy={RFC1738:n=>String(n).replace(/%20/g,"+"),RFC3986:n=>String(n)},wF="RFC1738",bF=Array.isArray,Hr=(()=>{const n=[];for(let e=0;e<256;++e)n.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return n})(),mg=1024,vF=(n,e,t,r,s)=>{if(n.length===0)return n;let a=n;if(typeof n=="symbol"?a=Symbol.prototype.toString.call(n):typeof n!="string"&&(a=String(n)),t==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(u){return"%26%23"+parseInt(u.slice(2),16)+"%3B"});let o="";for(let u=0;u<a.length;u+=mg){const c=a.length>=mg?a.slice(u,u+mg):a,f=[];for(let h=0;h<c.length;++h){let m=c.charCodeAt(h);if(m===45||m===46||m===95||m===126||m>=48&&m<=57||m>=65&&m<=90||m>=97&&m<=122||s===wF&&(m===40||m===41)){f[f.length]=c.charAt(h);continue}if(m<128){f[f.length]=Hr[m];continue}if(m<2048){f[f.length]=Hr[192|m>>6]+Hr[128|m&63];continue}if(m<55296||m>=57344){f[f.length]=Hr[224|m>>12]+Hr[128|m>>6&63]+Hr[128|m&63];continue}h+=1,m=65536+((m&1023)<<10|c.charCodeAt(h)&1023),f[f.length]=Hr[240|m>>18]+Hr[128|m>>12&63]+Hr[128|m>>6&63]+Hr[128|m&63]}o+=f.join("")}return o};function xF(n){return!n||typeof n!="object"?!1:!!(n.constructor&&n.constructor.isBuffer&&n.constructor.isBuffer(n))}function KS(n,e){if(bF(n)){const t=[];for(let r=0;r<n.length;r+=1)t.push(e(n[r]));return t}return e(n)}const SF=Object.prototype.hasOwnProperty,gP={brackets(n){return String(n)+"[]"},comma:"comma",indices(n,e){return String(n)+"["+e+"]"},repeat(n){return String(n)}},Wr=Array.isArray,EF=Array.prototype.push,yP=function(n,e){EF.apply(n,Wr(e)?e:[e])},CF=Date.prototype.toISOString,At={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:vF,encodeValuesOnly:!1,format:iy,formatter:oy[iy],indices:!1,serializeDate(n){return CF.call(n)},skipNulls:!1,strictNullHandling:!1};function PF(n){return typeof n=="string"||typeof n=="number"||typeof n=="boolean"||typeof n=="symbol"||typeof n=="bigint"}const gg={};function _P(n,e,t,r,s,a,o,u,c,f,h,m,g,y,w,v,x,E){let k=n,S=E,R=0,A=!1;for(;(S=S.get(gg))!==void 0&&!A;){const X=S.get(n);if(R+=1,typeof X<"u"){if(X===R)throw new RangeError("Cyclic object value");A=!0}typeof S.get(gg)>"u"&&(R=0)}if(typeof f=="function"?k=f(e,k):k instanceof Date?k=g==null?void 0:g(k):t==="comma"&&Wr(k)&&(k=KS(k,function(X){return X instanceof Date?g==null?void 0:g(X):X})),k===null){if(a)return c&&!v?c(e,At.encoder,x,"key",y):e;k=""}if(PF(k)||xF(k)){if(c){const X=v?e:c(e,At.encoder,x,"key",y);return[(w==null?void 0:w(X))+"="+(w==null?void 0:w(c(k,At.encoder,x,"value",y)))]}return[(w==null?void 0:w(e))+"="+(w==null?void 0:w(String(k)))]}const I=[];if(typeof k>"u")return I;let M;if(t==="comma"&&Wr(k))v&&c&&(k=KS(k,c)),M=[{value:k.length>0?k.join(",")||null:void 0}];else if(Wr(f))M=f;else{const X=Object.keys(k);M=h?X.sort(h):X}const D=u?String(e).replace(/\./g,"%2E"):String(e),K=r&&Wr(k)&&k.length===1?D+"[]":D;if(s&&Wr(k)&&k.length===0)return K+"[]";for(let X=0;X<M.length;++X){const ae=M[X],he=typeof ae=="object"&&typeof ae.value<"u"?ae.value:k[ae];if(o&&he===null)continue;const ce=m&&u?ae.replace(/\./g,"%2E"):ae,W=Wr(k)?typeof t=="function"?t(K,ce):K:K+(m?"."+ce:"["+ce+"]");E.set(n,R);const G=new WeakMap;G.set(gg,E),yP(I,_P(he,W,t,r,s,a,o,u,t==="comma"&&v&&Wr(k)?null:c,f,h,m,g,y,w,v,x,G))}return I}function kF(n=At){if(typeof n.allowEmptyArrays<"u"&&typeof n.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof n.encodeDotInKeys<"u"&&typeof n.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(n.encoder!==null&&typeof n.encoder<"u"&&typeof n.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=n.charset||At.charset;if(typeof n.charset<"u"&&n.charset!=="utf-8"&&n.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let t=iy;if(typeof n.format<"u"){if(!SF.call(oy,n.format))throw new TypeError("Unknown format option provided.");t=n.format}const r=oy[t];let s=At.filter;(typeof n.filter=="function"||Wr(n.filter))&&(s=n.filter);let a;if(n.arrayFormat&&n.arrayFormat in gP?a=n.arrayFormat:"indices"in n?a=n.indices?"indices":"repeat":a=At.arrayFormat,"commaRoundTrip"in n&&typeof n.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof n.allowDots>"u"?n.encodeDotInKeys?!0:At.allowDots:!!n.allowDots;return{addQueryPrefix:typeof n.addQueryPrefix=="boolean"?n.addQueryPrefix:At.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof n.allowEmptyArrays=="boolean"?!!n.allowEmptyArrays:At.allowEmptyArrays,arrayFormat:a,charset:e,charsetSentinel:typeof n.charsetSentinel=="boolean"?n.charsetSentinel:At.charsetSentinel,commaRoundTrip:!!n.commaRoundTrip,delimiter:typeof n.delimiter>"u"?At.delimiter:n.delimiter,encode:typeof n.encode=="boolean"?n.encode:At.encode,encodeDotInKeys:typeof n.encodeDotInKeys=="boolean"?n.encodeDotInKeys:At.encodeDotInKeys,encoder:typeof n.encoder=="function"?n.encoder:At.encoder,encodeValuesOnly:typeof n.encodeValuesOnly=="boolean"?n.encodeValuesOnly:At.encodeValuesOnly,filter:s,format:t,formatter:r,serializeDate:typeof n.serializeDate=="function"?n.serializeDate:At.serializeDate,skipNulls:typeof n.skipNulls=="boolean"?n.skipNulls:At.skipNulls,sort:typeof n.sort=="function"?n.sort:null,strictNullHandling:typeof n.strictNullHandling=="boolean"?n.strictNullHandling:At.strictNullHandling}}function RF(n,e={}){let t=n;const r=kF(e);let s,a;typeof r.filter=="function"?(a=r.filter,t=a("",t)):Wr(r.filter)&&(a=r.filter,s=a);const o=[];if(typeof t!="object"||t===null)return"";const u=gP[r.arrayFormat],c=u==="comma"&&r.commaRoundTrip;s||(s=Object.keys(t)),r.sort&&s.sort(r.sort);const f=new WeakMap;for(let g=0;g<s.length;++g){const y=s[g];r.skipNulls&&t[y]===null||yP(o,_P(t[y],y,u,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,f))}const h=o.join(r.delimiter);let m=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?m+="utf8=%26%2310003%3B&":m+="utf8=%E2%9C%93&"),h.length>0?m+h:""}const zi="4.95.1";let XS=!1,Fl,wP,bP,ly,vP,xP,SP,EP,CP;function OF(n,e={auto:!1}){if(XS)throw new Error(`you must \`import 'openai/shims/${n.kind}'\` before importing anything else from openai`);if(Fl)throw new Error(`can't \`import 'openai/shims/${n.kind}'\` after \`import 'openai/shims/${Fl}'\``);XS=e.auto,Fl=n.kind,wP=n.fetch,bP=n.FormData,ly=n.File,vP=n.ReadableStream,xP=n.getMultipartRequestOptions,SP=n.getDefaultAgent,EP=n.fileFromPath,CP=n.isFsReadStream}class TF{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function AF({manuallyImported:n}={}){const e=n?"You may need to use polyfills":"Add one of these imports before your first `import  from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let t,r,s,a;try{t=fetch,r=Request,s=Response,a=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:t,Request:r,Response:s,Headers:a,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,u)=>({...u,body:new TF(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}const PP=()=>{Fl||OF(AF(),{auto:!0})};PP();class Te extends Error{}class Kt extends Te{constructor(e,t,r,s){super(`${Kt.makeMessage(e,t,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=t;const a=t;this.code=a==null?void 0:a.code,this.param=a==null?void 0:a.param,this.type=a==null?void 0:a.type}static makeMessage(e,t,r){const s=t!=null&&t.message?typeof t.message=="string"?t.message:JSON.stringify(t.message):t?JSON.stringify(t):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,t,r,s){if(!e||!s)return new Nf({message:r,cause:cy(t)});const a=t==null?void 0:t.error;return e===400?new kP(e,a,r,s):e===401?new RP(e,a,r,s):e===403?new OP(e,a,r,s):e===404?new TP(e,a,r,s):e===409?new AP(e,a,r,s):e===422?new $P(e,a,r,s):e===429?new IP(e,a,r,s):e>=500?new NP(e,a,r,s):new Kt(e,a,r,s)}}class Bn extends Kt{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class Nf extends Kt{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class jf extends Nf{constructor({message:e}={}){super({message:e??"Request timed out."})}}class kP extends Kt{}class RP extends Kt{}class OP extends Kt{}class TP extends Kt{}class AP extends Kt{}class $P extends Kt{}class IP extends Kt{}class NP extends Kt{}class jP extends Te{constructor(){super("Could not parse response content as the length limit was reached")}}class LP extends Te{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var sd=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},Ia=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Fn;class Lf{constructor(){Fn.set(this,void 0),this.buffer=new Uint8Array,sd(this,Fn,null,"f")}decode(e){if(e==null)return[];const t=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let r=new Uint8Array(this.buffer.length+t.length);r.set(this.buffer),r.set(t,this.buffer.length),this.buffer=r;const s=[];let a;for(;(a=$F(this.buffer,Ia(this,Fn,"f")))!=null;){if(a.carriage&&Ia(this,Fn,"f")==null){sd(this,Fn,a.index,"f");continue}if(Ia(this,Fn,"f")!=null&&(a.index!==Ia(this,Fn,"f")+1||a.carriage)){s.push(this.decodeText(this.buffer.slice(0,Ia(this,Fn,"f")-1))),this.buffer=this.buffer.slice(Ia(this,Fn,"f")),sd(this,Fn,null,"f");continue}const o=Ia(this,Fn,"f")!==null?a.preceding-1:a.preceding,u=this.decodeText(this.buffer.slice(0,o));s.push(u),this.buffer=this.buffer.slice(a.index),sd(this,Fn,null,"f")}return s}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Te(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Te(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Te("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}Fn=new WeakMap;Lf.NEWLINE_CHARS=new Set([`
`,"\r"]);Lf.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function $F(n,e){for(let s=e??0;s<n.length;s++){if(n[s]===10)return{preceding:s,index:s+1,carriage:!1};if(n[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function IF(n){for(let r=0;r<n.length-1;r++){if(n[r]===10&&n[r+1]===10||n[r]===13&&n[r+1]===13)return r+2;if(n[r]===13&&n[r+1]===10&&r+3<n.length&&n[r+2]===13&&n[r+3]===10)return r+4}return-1}function MP(n){if(n[Symbol.asyncIterator])return n;const e=n.getReader();return{async next(){try{const t=await e.read();return t!=null&&t.done&&e.releaseLock(),t}catch(t){throw e.releaseLock(),t}},async return(){const t=e.cancel();return e.releaseLock(),await t,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class Jr{constructor(e,t){this.iterator=e,this.controller=t}static fromSSEResponse(e,t){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const o of NF(e,t))if(!a){if(o.data.startsWith("[DONE]")){a=!0;continue}if(o.event===null||o.event.startsWith("response.")||o.event.startsWith("transcript.")){let u;try{u=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(u&&u.error)throw new Kt(void 0,u.error,void 0,VP(e.headers));yield u}else{let u;try{u=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(o.event=="error")throw new Kt(void 0,u.error,u.message,void 0);yield{event:o.event,data:u}}}a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||t.abort()}}return new Jr(s,t)}static fromReadableStream(e,t){let r=!1;async function*s(){const o=new Lf,u=MP(e);for await(const c of u)for(const f of o.decode(c))yield f;for(const c of o.flush())yield c}async function*a(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const u of s())o||u&&(yield JSON.parse(u));o=!0}catch(u){if(u instanceof Error&&u.name==="AbortError")return;throw u}finally{o||t.abort()}}return new Jr(a,t)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],t=[],r=this.iterator(),s=a=>({next:()=>{if(a.length===0){const o=r.next();e.push(o),t.push(o)}return a.shift()}});return[new Jr(()=>s(e),this.controller),new Jr(()=>s(t),this.controller)]}toReadableStream(){const e=this;let t;const r=new TextEncoder;return new vP({async start(){t=e[Symbol.asyncIterator]()},async pull(s){try{const{value:a,done:o}=await t.next();if(o)return s.close();const u=r.encode(JSON.stringify(a)+`
`);s.enqueue(u)}catch(a){s.error(a)}},async cancel(){var s;await((s=t.return)==null?void 0:s.call(t))}})}}async function*NF(n,e){if(!n.body)throw e.abort(),new Te("Attempted to iterate over a response with no body");const t=new LF,r=new Lf,s=MP(n.body);for await(const a of jF(s))for(const o of r.decode(a)){const u=t.decode(o);u&&(yield u)}for(const a of r.flush()){const o=t.decode(a);o&&(yield o)}}async function*jF(n){let e=new Uint8Array;for await(const t of n){if(t==null)continue;const r=t instanceof ArrayBuffer?new Uint8Array(t):typeof t=="string"?new TextEncoder().encode(t):t;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let a;for(;(a=IF(e))!==-1;)yield e.slice(0,a),e=e.slice(a)}e.length>0&&(yield e)}class LF{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const a={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],a}if(this.chunks.push(e),e.startsWith(":"))return null;let[t,r,s]=MF(e,":");return s.startsWith(" ")&&(s=s.substring(1)),t==="event"?this.event=s:t==="data"&&this.data.push(s),null}}function MF(n,e){const t=n.indexOf(e);return t!==-1?[n.substring(0,t),e,n.substring(t+e.length)]:[n,"",""]}const DP=n=>n!=null&&typeof n=="object"&&typeof n.url=="string"&&typeof n.blob=="function",FP=n=>n!=null&&typeof n=="object"&&typeof n.name=="string"&&typeof n.lastModified=="number"&&Mf(n),Mf=n=>n!=null&&typeof n=="object"&&typeof n.size=="number"&&typeof n.type=="string"&&typeof n.text=="function"&&typeof n.slice=="function"&&typeof n.arrayBuffer=="function",DF=n=>FP(n)||DP(n)||CP(n);async function UP(n,e,t){var s;if(n=await n,FP(n))return n;if(DP(n)){const a=await n.blob();e||(e=new URL(n.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=Mf(a)?[await a.arrayBuffer()]:[a];return new ly(o,e,t)}const r=await FF(n);if(e||(e=zF(n)??"unknown_file"),!(t!=null&&t.type)){const a=(s=r[0])==null?void 0:s.type;typeof a=="string"&&(t={...t,type:a})}return new ly(r,e,t)}async function FF(n){var t;let e=[];if(typeof n=="string"||ArrayBuffer.isView(n)||n instanceof ArrayBuffer)e.push(n);else if(Mf(n))e.push(await n.arrayBuffer());else if(BF(n))for await(const r of n)e.push(r);else throw new Error(`Unexpected data type: ${typeof n}; constructor: ${(t=n==null?void 0:n.constructor)==null?void 0:t.name}; props: ${UF(n)}`);return e}function UF(n){return`[${Object.getOwnPropertyNames(n).map(t=>`"${t}"`).join(", ")}]`}function zF(n){var e;return yg(n.name)||yg(n.filename)||((e=yg(n.path))==null?void 0:e.split(/[\\/]/).pop())}const yg=n=>{if(typeof n=="string")return n;if(typeof Buffer<"u"&&n instanceof Buffer)return String(n)},BF=n=>n!=null&&typeof n=="object"&&typeof n[Symbol.asyncIterator]=="function",YS=n=>n&&typeof n=="object"&&n.body&&n[Symbol.toStringTag]==="MultipartBody",lo=async n=>{const e=await HF(n.body);return xP(e,n)},HF=async n=>{const e=new bP;return await Promise.all(Object.entries(n||{}).map(([t,r])=>uy(e,t,r))),e},uy=async(n,e,t)=>{if(t!==void 0){if(t==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof t=="string"||typeof t=="number"||typeof t=="boolean")n.append(e,String(t));else if(DF(t)){const r=await UP(t);n.append(e,r)}else if(Array.isArray(t))await Promise.all(t.map(r=>uy(n,e+"[]",r)));else if(typeof t=="object")await Promise.all(Object.entries(t).map(([r,s])=>uy(n,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${t} instead`)}};var Ki={},VF=function(n,e,t,r,s){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(n,t),t},WF=function(n,e,t,r){if(typeof e=="function"?n!==e||!0:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},ad;PP();async function zP(n){var o;const{response:e}=n;if(n.options.stream)return la("response",e.status,e.url,e.headers,e.body),n.options.__streamClass?n.options.__streamClass.fromSSEResponse(e,n.controller):Jr.fromSSEResponse(e,n.controller);if(e.status===204)return null;if(n.options.__binaryResponse)return e;const t=e.headers.get("content-type"),r=(o=t==null?void 0:t.split(";")[0])==null?void 0:o.trim();if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.endsWith("+json"))){const u=await e.json();return la("response",e.status,e.url,e.headers,u),BP(u,e)}const a=await e.text();return la("response",e.status,e.url,e.headers,a),a}function BP(n,e){return!n||typeof n!="object"||Array.isArray(n)?n:Object.defineProperty(n,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class Df extends Promise{constructor(e,t=zP){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=t}_thenUnwrap(e){return new Df(this.responsePromise,async t=>BP(e(await this.parseResponse(t),t),t.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class qF{constructor({baseURL:e,maxRetries:t=2,timeout:r=6e5,httpAgent:s,fetch:a}){this.baseURL=e,this.maxRetries=_g("maxRetries",t),this.timeout=_g("timeout",r),this.httpAgent=s,this.fetch=a??wP}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...XF(),...this.authHeaders(e)}}validateHeaders(e,t){}defaultIdempotencyKey(){return`stainless-node-retry-${t9()}`}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,r){return this.request(Promise.resolve(r).then(async s=>{const a=s&&Mf(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:t,...s,body:a}}))}getAPIList(e,t,r){return this.requestAPIList(t,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:t=0}={}){var v;const r={...e},{method:s,path:a,query:o,headers:u={}}=r,c=ArrayBuffer.isView(r.body)||r.__binaryRequest&&typeof r.body=="string"?r.body:YS(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,f=this.calculateContentLength(c),h=this.buildURL(a,o);"timeout"in r&&_g("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const m=r.httpAgent??this.httpAgent??SP(h),g=r.timeout+1e3;typeof((v=m==null?void 0:m.options)==null?void 0:v.timeout)=="number"&&g>(m.options.timeout??0)&&(m.options.timeout=g),this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),u[this.idempotencyHeader]=e.idempotencyKey);const y=this.buildHeaders({options:r,headers:u,contentLength:f,retryCount:t});return{req:{method:s,...c&&{body:c},headers:y,...m&&{agent:m},signal:r.signal??null},url:h,timeout:r.timeout}}buildHeaders({options:e,headers:t,contentLength:r,retryCount:s}){const a={};r&&(a["content-length"]=r);const o=this.defaultHeaders(e);return n1(a,o),n1(a,t),YS(e.body)&&Fl!=="node"&&delete a["content-type"],od(o,"x-stainless-retry-count")===void 0&&od(t,"x-stainless-retry-count")===void 0&&(a["x-stainless-retry-count"]=String(s)),od(o,"x-stainless-timeout")===void 0&&od(t,"x-stainless-timeout")===void 0&&e.timeout&&(a["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(a,t),a}async prepareOptions(e){}async prepareRequest(e,{url:t,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(t=>[...t])):{...e}:{}}makeStatusError(e,t,r,s){return Kt.generate(e,t,r,s)}request(e,t=null){return new Df(this.makeRequest(e,t))}async makeRequest(e,t){var m,g;const r=await e,s=r.maxRetries??this.maxRetries;t==null&&(t=s),await this.prepareOptions(r);const{req:a,url:o,timeout:u}=this.buildRequest(r,{retryCount:s-t});if(await this.prepareRequest(a,{url:o,options:r}),la("request",o,r,a.headers),(m=r.signal)!=null&&m.aborted)throw new Bn;const c=new AbortController,f=await this.fetchWithTimeout(o,a,u,c).catch(cy);if(f instanceof Error){if((g=r.signal)!=null&&g.aborted)throw new Bn;if(t)return this.retryRequest(r,t);throw f.name==="AbortError"?new jf:new Nf({cause:f})}const h=VP(f.headers);if(!f.ok){if(t&&this.shouldRetry(f)){const k=`retrying, ${t} attempts remaining`;return la(`response (error; ${k})`,f.status,o,h),this.retryRequest(r,t,h)}const y=await f.text().catch(k=>cy(k).message),w=YF(y),v=w?void 0:y;throw la(`response (error; ${t?"(error; no more retries left)":"(error; not retryable)"})`,f.status,o,h,v),this.makeStatusError(f.status,w,v,h)}return{response:f,options:r,controller:c}}requestAPIList(e,t){const r=this.makeRequest(t,null);return new ZF(this,r,e)}buildURL(e,t){const r=e9(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return WP(s)||(t={...s,...t}),typeof t=="object"&&t&&!Array.isArray(t)&&(r.search=this.stringifyQuery(t)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([t,r])=>typeof r<"u").map(([t,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(t)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(t)}=`;throw new Te(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,t,r,s){const{signal:a,...o}=t||{};a&&a.addEventListener("abort",()=>s.abort());const u=setTimeout(()=>s.abort(),r),c={signal:s.signal,...o};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,e,c).finally(()=>{clearTimeout(u)})}shouldRetry(e){const t=e.headers.get("x-should-retry");return t==="true"?!0:t==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,t,r){let s;const a=r==null?void 0:r["retry-after-ms"];if(a){const u=parseFloat(a);Number.isNaN(u)||(s=u)}const o=r==null?void 0:r["retry-after"];if(o&&!s){const u=parseFloat(o);Number.isNaN(u)?s=Date.parse(o)-Date.now():s=u*1e3}if(!(s&&0<=s&&s<60*1e3)){const u=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(t,u)}return await Ou(s),this.makeRequest(e,t-1)}calculateDefaultRetryTimeoutMillis(e,t){const a=t-e,o=Math.min(.5*Math.pow(2,a),8),u=1-Math.random()*.25;return o*u*1e3}getUserAgent(){return`${this.constructor.name}/JS ${zi}`}}class HP{constructor(e,t,r,s){ad.set(this,void 0),VF(this,ad,e),this.options=s,this.response=t,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Te("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const t={...this.options};if("params"in e&&typeof t.query=="object")t.query={...t.query,...e.params};else if("url"in e){const r=[...Object.entries(t.query||{}),...e.url.searchParams.entries()];for(const[s,a]of r)e.url.searchParams.set(s,a);t.query=void 0,t.path=e.url.toString()}return await WF(this,ad,"f").requestAPIList(this.constructor,t)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(ad=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const t of e.getPaginatedItems())yield t}}class ZF extends Df{constructor(e,t,r){super(t,async s=>new r(e,s.response,await zP(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const t of e)yield t}}const VP=n=>new Proxy(Object.fromEntries(n.entries()),{get(e,t){const r=t.toString();return e[r.toLowerCase()]||e[r]}}),GF={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},wt=n=>typeof n=="object"&&n!==null&&!WP(n)&&Object.keys(n).every(e=>qP(GF,e)),JF=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zi,"X-Stainless-OS":e1(Deno.build.os),"X-Stainless-Arch":QS(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zi,"X-Stainless-OS":e1(process.platform),"X-Stainless-Arch":QS(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const n=KF();return n?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${n.browser}`,"X-Stainless-Runtime-Version":n.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":zi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function KF(){if(typeof navigator>"u"||!navigator)return null;const n=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:t}of n){const r=t.exec(navigator.userAgent);if(r){const s=r[1]||0,a=r[2]||0,o=r[3]||0;return{browser:e,version:`${s}.${a}.${o}`}}}return null}const QS=n=>n==="x32"?"x32":n==="x86_64"||n==="x64"?"x64":n==="arm"?"arm":n==="aarch64"||n==="arm64"?"arm64":n?`other:${n}`:"unknown",e1=n=>(n=n.toLowerCase(),n.includes("ios")?"iOS":n==="android"?"Android":n==="darwin"?"MacOS":n==="win32"?"Windows":n==="freebsd"?"FreeBSD":n==="openbsd"?"OpenBSD":n==="linux"?"Linux":n?`Other:${n}`:"Unknown");let t1;const XF=()=>t1??(t1=JF()),YF=n=>{try{return JSON.parse(n)}catch{return}},QF=/^[a-z][a-z0-9+.-]*:/i,e9=n=>QF.test(n),Ou=n=>new Promise(e=>setTimeout(e,n)),_g=(n,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Te(`${n} must be an integer`);if(e<0)throw new Te(`${n} must be a positive integer`);return e},cy=n=>{if(n instanceof Error)return n;if(typeof n=="object"&&n!==null)try{return new Error(JSON.stringify(n))}catch{}return new Error(n)},id=n=>{var e,t,r,s;if(typeof process<"u")return((e=Ki==null?void 0:Ki[n])==null?void 0:e.trim())??void 0;if(typeof Deno<"u")return(s=(r=(t=Deno.env)==null?void 0:t.get)==null?void 0:r.call(t,n))==null?void 0:s.trim()};function WP(n){if(!n)return!0;for(const e in n)return!1;return!0}function qP(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function n1(n,e){for(const t in e){if(!qP(e,t))continue;const r=t.toLowerCase();if(!r)continue;const s=e[t];s===null?delete n[r]:s!==void 0&&(n[r]=s)}}const r1=new Set(["authorization","api-key"]);function la(n,...e){if(typeof process<"u"&&(Ki==null?void 0:Ki.DEBUG)==="true"){const t=e.map(r=>{if(!r)return r;if(r.headers){const a={...r,headers:{...r.headers}};for(const o in r.headers)r1.has(o.toLowerCase())&&(a.headers[o]="REDACTED");return a}let s=null;for(const a in r)r1.has(a.toLowerCase())&&(s??(s={...r}),s[a]="REDACTED");return s??r});console.log(`OpenAI:DEBUG:${n}`,...t)}}const t9=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=Math.random()*16|0;return(n==="x"?e:e&3|8).toString(16)}),n9=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",r9=n=>typeof(n==null?void 0:n.get)=="function",od=(n,e)=>{var r;const t=e.toLowerCase();if(r9(n)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(a,o,u)=>o+u.toUpperCase());for(const a of[e,t,e.toUpperCase(),s]){const o=n.get(a);if(o)return o}}for(const[s,a]of Object.entries(n))if(s.toLowerCase()===t)return Array.isArray(a)?(a.length<=1||console.warn(`Received ${a.length} entries for the ${e} header, using the first entry.`),a[0]):a},s9=n=>{if(typeof Buffer<"u"){const e=Buffer.from(n,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(n),t=e.length,r=new Uint8Array(t);for(let s=0;s<t;s++)r[s]=e.charCodeAt(s);return Array.from(new Float32Array(r.buffer))}};function wg(n){return n!=null&&typeof n=="object"&&!Array.isArray(n)}class Ff extends HP{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Xt extends HP{constructor(e,t,r,s){super(e,t,r,s),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const t=Object.fromEntries(e.url.searchParams);return Object.keys(t).length?t:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const t=(r=e[e.length-1])==null?void 0:r.id;return t?{params:{after:t}}:null}}class Fe{constructor(e){this._client=e}}let ZP=class extends Fe{list(e,t={},r){return wt(t)?this.list(e,{},t):this._client.getAPIList(`/chat/completions/${e}/messages`,a9,{query:t,...r})}},Uf=class extends Fe{constructor(){super(...arguments),this.messages=new ZP(this._client)}create(e,t){return this._client.post("/chat/completions",{body:e,...t,stream:e.stream??!1})}retrieve(e,t){return this._client.get(`/chat/completions/${e}`,t)}update(e,t,r){return this._client.post(`/chat/completions/${e}`,{body:t,...r})}list(e={},t){return wt(e)?this.list({},e):this._client.getAPIList("/chat/completions",zf,{query:e,...t})}del(e,t){return this._client.delete(`/chat/completions/${e}`,t)}};class zf extends Xt{}class a9 extends Xt{}Uf.ChatCompletionsPage=zf;Uf.Messages=ZP;let Bf=class extends Fe{constructor(){super(...arguments),this.completions=new Uf(this._client)}};Bf.Completions=Uf;Bf.ChatCompletionsPage=zf;class GP extends Fe{create(e,t){return this._client.post("/audio/speech",{body:e,...t,headers:{Accept:"application/octet-stream",...t==null?void 0:t.headers},__binaryResponse:!0})}}class JP extends Fe{create(e,t){return this._client.post("/audio/transcriptions",lo({body:e,...t,stream:e.stream??!1,__metadata:{model:e.model}}))}}class KP extends Fe{create(e,t){return this._client.post("/audio/translations",lo({body:e,...t,__metadata:{model:e.model}}))}}class Tu extends Fe{constructor(){super(...arguments),this.transcriptions=new JP(this._client),this.translations=new KP(this._client),this.speech=new GP(this._client)}}Tu.Transcriptions=JP;Tu.Translations=KP;Tu.Speech=GP;class H_ extends Fe{create(e,t){return this._client.post("/batches",{body:e,...t})}retrieve(e,t){return this._client.get(`/batches/${e}`,t)}list(e={},t){return wt(e)?this.list({},e):this._client.getAPIList("/batches",V_,{query:e,...t})}cancel(e,t){return this._client.post(`/batches/${e}/cancel`,t)}}class V_ extends Xt{}H_.BatchesPage=V_;class W_ extends Fe{create(e,t){return this._client.post("/assistants",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/assistants/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return wt(e)?this.list({},e):this._client.getAPIList("/assistants",q_,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/assistants/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class q_ extends Xt{}W_.AssistantsPage=q_;function s1(n){return typeof n.parse=="function"}const Xi=n=>(n==null?void 0:n.role)==="assistant",XP=n=>(n==null?void 0:n.role)==="function",YP=n=>(n==null?void 0:n.role)==="tool";var vr=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},pt=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},dy,bd,vd,kl,Rl,xd,Ol,Ss,Tl,Jd,Kd,Bi,QP;class Z_{constructor(){dy.add(this),this.controller=new AbortController,bd.set(this,void 0),vd.set(this,()=>{}),kl.set(this,()=>{}),Rl.set(this,void 0),xd.set(this,()=>{}),Ol.set(this,()=>{}),Ss.set(this,{}),Tl.set(this,!1),Jd.set(this,!1),Kd.set(this,!1),Bi.set(this,!1),vr(this,bd,new Promise((e,t)=>{vr(this,vd,e,"f"),vr(this,kl,t,"f")}),"f"),vr(this,Rl,new Promise((e,t)=>{vr(this,xd,e,"f"),vr(this,Ol,t,"f")}),"f"),pt(this,bd,"f").catch(()=>{}),pt(this,Rl,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},pt(this,dy,"m",QP).bind(this))},0)}_connected(){this.ended||(pt(this,vd,"f").call(this),this._emit("connect"))}get ended(){return pt(this,Tl,"f")}get errored(){return pt(this,Jd,"f")}get aborted(){return pt(this,Kd,"f")}abort(){this.controller.abort()}on(e,t){return(pt(this,Ss,"f")[e]||(pt(this,Ss,"f")[e]=[])).push({listener:t}),this}off(e,t){const r=pt(this,Ss,"f")[e];if(!r)return this;const s=r.findIndex(a=>a.listener===t);return s>=0&&r.splice(s,1),this}once(e,t){return(pt(this,Ss,"f")[e]||(pt(this,Ss,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,r)=>{vr(this,Bi,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,t)})}async done(){vr(this,Bi,!0,"f"),await pt(this,Rl,"f")}_emit(e,...t){if(pt(this,Tl,"f"))return;e==="end"&&(vr(this,Tl,!0,"f"),pt(this,xd,"f").call(this));const r=pt(this,Ss,"f")[e];if(r&&(pt(this,Ss,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...t))),e==="abort"){const s=t[0];!pt(this,Bi,"f")&&!(r!=null&&r.length)&&Promise.reject(s),pt(this,kl,"f").call(this,s),pt(this,Ol,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=t[0];!pt(this,Bi,"f")&&!(r!=null&&r.length)&&Promise.reject(s),pt(this,kl,"f").call(this,s),pt(this,Ol,"f").call(this,s),this._emit("end")}}_emitFinal(){}}bd=new WeakMap,vd=new WeakMap,kl=new WeakMap,Rl=new WeakMap,xd=new WeakMap,Ol=new WeakMap,Ss=new WeakMap,Tl=new WeakMap,Jd=new WeakMap,Kd=new WeakMap,Bi=new WeakMap,dy=new WeakSet,QP=function(e){if(vr(this,Jd,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new Bn),e instanceof Bn)return vr(this,Kd,!0,"f"),this._emit("abort",e);if(e instanceof Te)return this._emit("error",e);if(e instanceof Error){const t=new Te(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new Te(String(e)))};function i9(n,e){const t={...n};return Object.defineProperties(t,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),t}function G_(n){return(n==null?void 0:n.$brand)==="auto-parseable-response-format"}function Au(n){return(n==null?void 0:n.$brand)==="auto-parseable-tool"}function o9(n,e){return!e||!ek(e)?{...n,choices:n.choices.map(t=>({...t,message:{...t.message,parsed:null,...t.message.tool_calls?{tool_calls:t.message.tool_calls}:void 0}}))}:J_(n,e)}function J_(n,e){const t=n.choices.map(r=>{var s;if(r.finish_reason==="length")throw new jP;if(r.finish_reason==="content_filter")throw new LP;return{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(a=>u9(e,a)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?l9(e,r.message.content):null}}});return{...n,choices:t}}function l9(n,e){var t,r;return((t=n.response_format)==null?void 0:t.type)!=="json_schema"?null:((r=n.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in n.response_format?n.response_format.$parseRaw(e):JSON.parse(e):null}function u9(n,e){var r;const t=(r=n.tools)==null?void 0:r.find(s=>{var a;return((a=s.function)==null?void 0:a.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:Au(t)?t.$parseRaw(e.function.arguments):t!=null&&t.function.strict?JSON.parse(e.function.arguments):null}}}function c9(n,e){var r;if(!n)return!1;const t=(r=n.tools)==null?void 0:r.find(s=>{var a;return((a=s.function)==null?void 0:a.name)===e.function.name});return Au(t)||(t==null?void 0:t.function.strict)||!1}function ek(n){var e;return G_(n.response_format)?!0:((e=n.tools)==null?void 0:e.some(t=>Au(t)||t.type==="function"&&t.function.strict===!0))??!1}function d9(n){for(const e of n??[]){if(e.type!=="function")throw new Te(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new Te(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Rn=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},nn,fy,Xd,hy,py,my,tk,gy;const a1=10;class nk extends Z_{constructor(){super(...arguments),nn.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const t=(r=e.choices[0])==null?void 0:r.message;return t&&this._addMessage(t),e}_addMessage(e,t=!0){if("content"in e||(e.content=null),this.messages.push(e),t){if(this._emit("message",e),(XP(e)||YP(e))&&e.content)this._emit("functionCallResult",e.content);else if(Xi(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Xi(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new Te("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),Rn(this,nn,"m",fy).call(this)}async finalMessage(){return await this.done(),Rn(this,nn,"m",Xd).call(this)}async finalFunctionCall(){return await this.done(),Rn(this,nn,"m",hy).call(this)}async finalFunctionCallResult(){return await this.done(),Rn(this,nn,"m",py).call(this)}async totalUsage(){return await this.done(),Rn(this,nn,"m",my).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const t=Rn(this,nn,"m",Xd).call(this);t&&this._emit("finalMessage",t);const r=Rn(this,nn,"m",fy).call(this);r&&this._emit("finalContent",r);const s=Rn(this,nn,"m",hy).call(this);s&&this._emit("finalFunctionCall",s);const a=Rn(this,nn,"m",py).call(this);a!=null&&this._emit("finalFunctionCallResult",a),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",Rn(this,nn,"m",my).call(this))}async _createChatCompletion(e,t,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Rn(this,nn,"m",tk).call(this,t);const a=await e.chat.completions.create({...t,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(J_(a,t))}async _runChatCompletion(e,t,r){for(const s of t.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,t,r)}async _runFunctions(e,t,r){var g;const s="function",{function_call:a="auto",stream:o,...u}=t,c=typeof a!="string"&&(a==null?void 0:a.name),{maxChatCompletions:f=a1}=r||{},h={};for(const y of t.functions)h[y.name||y.function.name]=y;const m=t.functions.map(y=>({name:y.name||y.function.name,parameters:y.parameters,description:y.description}));for(const y of t.messages)this._addMessage(y,!1);for(let y=0;y<f;++y){const v=(g=(await this._createChatCompletion(e,{...u,function_call:a,functions:m,messages:[...this.messages]},r)).choices[0])==null?void 0:g.message;if(!v)throw new Te("missing message in ChatCompletion response");if(!v.function_call)return;const{name:x,arguments:E}=v.function_call,k=h[x];if(k){if(c&&c!==x){const I=`Invalid function_call: ${JSON.stringify(x)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,name:x,content:I});continue}}else{const I=`Invalid function_call: ${JSON.stringify(x)}. Available options are: ${m.map(M=>JSON.stringify(M.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:x,content:I});continue}let S;try{S=s1(k)?await k.parse(E):E}catch(I){this._addMessage({role:s,name:x,content:I instanceof Error?I.message:String(I)});continue}const R=await k.function(S,this),A=Rn(this,nn,"m",gy).call(this,R);if(this._addMessage({role:s,name:x,content:A}),c)return}}async _runTools(e,t,r){var y,w,v;const s="tool",{tool_choice:a="auto",stream:o,...u}=t,c=typeof a!="string"&&((y=a==null?void 0:a.function)==null?void 0:y.name),{maxChatCompletions:f=a1}=r||{},h=t.tools.map(x=>{if(Au(x)){if(!x.$callback)throw new Te("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:x.$callback,name:x.function.name,description:x.function.description||"",parameters:x.function.parameters,parse:x.$parseRaw,strict:!0}}}return x}),m={};for(const x of h)x.type==="function"&&(m[x.function.name||x.function.function.name]=x.function);const g="tools"in t?h.map(x=>x.type==="function"?{type:"function",function:{name:x.function.name||x.function.function.name,parameters:x.function.parameters,description:x.function.description,strict:x.function.strict}}:x):void 0;for(const x of t.messages)this._addMessage(x,!1);for(let x=0;x<f;++x){const k=(w=(await this._createChatCompletion(e,{...u,tool_choice:a,tools:g,messages:[...this.messages]},r)).choices[0])==null?void 0:w.message;if(!k)throw new Te("missing message in ChatCompletion response");if(!((v=k.tool_calls)!=null&&v.length))return;for(const S of k.tool_calls){if(S.type!=="function")continue;const R=S.id,{name:A,arguments:I}=S.function,M=m[A];if(M){if(c&&c!==A){const ae=`Invalid tool_call: ${JSON.stringify(A)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,tool_call_id:R,content:ae});continue}}else{const ae=`Invalid tool_call: ${JSON.stringify(A)}. Available options are: ${Object.keys(m).map(he=>JSON.stringify(he)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:R,content:ae});continue}let D;try{D=s1(M)?await M.parse(I):I}catch(ae){const he=ae instanceof Error?ae.message:String(ae);this._addMessage({role:s,tool_call_id:R,content:he});continue}const K=await M.function(D,this),X=Rn(this,nn,"m",gy).call(this,K);if(this._addMessage({role:s,tool_call_id:R,content:X}),c)return}}}}nn=new WeakSet,fy=function(){return Rn(this,nn,"m",Xd).call(this).content??null},Xd=function(){let e=this.messages.length;for(;e-- >0;){const t=this.messages[e];if(Xi(t)){const{function_call:r,...s}=t,a={...s,content:t.content??null,refusal:t.refusal??null};return r&&(a.function_call=r),a}}throw new Te("stream ended without producing a ChatCompletionMessage with role=assistant")},hy=function(){var e,t;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(Xi(s)&&(s!=null&&s.function_call))return s.function_call;if(Xi(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(t=s.tool_calls.at(-1))==null?void 0:t.function}},py=function(){for(let e=this.messages.length-1;e>=0;e--){const t=this.messages[e];if(XP(t)&&t.content!=null||YP(t)&&t.content!=null&&typeof t.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(a=>a.type==="function"&&a.id===t.tool_call_id))}))return t.content}},my=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:t}of this._chatCompletions)t&&(e.completion_tokens+=t.completion_tokens,e.prompt_tokens+=t.prompt_tokens,e.total_tokens+=t.total_tokens);return e},tk=function(e){if(e.n!=null&&e.n>1)throw new Te("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},gy=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class uu extends nk{static runFunctions(e,t,r){const s=new uu,a={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,a)),s}static runTools(e,t,r){const s=new uu,a={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,a)),s}_addMessage(e,t=!0){super._addMessage(e,t),Xi(e)&&e.content&&this._emit("content",e.content)}}const rk=1,sk=2,ak=4,ik=8,ok=16,lk=32,uk=64,ck=128,dk=256,f9=ck|dk,h9=ok|lk|f9|uk,p9=rk|sk|h9,m9=ak|ik,g9=p9|m9,Ft={STR:rk,NUM:sk,ARR:ak,OBJ:ik,NULL:ok,BOOL:lk,NAN:uk,INFINITY:ck,MINUS_INFINITY:dk,ALL:g9};class y9 extends Error{}class _9 extends Error{}function w9(n,e=Ft.ALL){if(typeof n!="string")throw new TypeError(`expecting str, got ${typeof n}`);if(!n.trim())throw new Error(`${n} is empty`);return b9(n.trim(),e)}const b9=(n,e)=>{const t=n.length;let r=0;const s=g=>{throw new y9(`${g} at position ${r}`)},a=g=>{throw new _9(`${g} at position ${r}`)},o=()=>(m(),r>=t&&s("Unexpected end of input"),n[r]==='"'?u():n[r]==="{"?c():n[r]==="["?f():n.substring(r,r+4)==="null"||Ft.NULL&e&&t-r<4&&"null".startsWith(n.substring(r))?(r+=4,null):n.substring(r,r+4)==="true"||Ft.BOOL&e&&t-r<4&&"true".startsWith(n.substring(r))?(r+=4,!0):n.substring(r,r+5)==="false"||Ft.BOOL&e&&t-r<5&&"false".startsWith(n.substring(r))?(r+=5,!1):n.substring(r,r+8)==="Infinity"||Ft.INFINITY&e&&t-r<8&&"Infinity".startsWith(n.substring(r))?(r+=8,1/0):n.substring(r,r+9)==="-Infinity"||Ft.MINUS_INFINITY&e&&1<t-r&&t-r<9&&"-Infinity".startsWith(n.substring(r))?(r+=9,-1/0):n.substring(r,r+3)==="NaN"||Ft.NAN&e&&t-r<3&&"NaN".startsWith(n.substring(r))?(r+=3,NaN):h()),u=()=>{const g=r;let y=!1;for(r++;r<t&&(n[r]!=='"'||y&&n[r-1]==="\\");)y=n[r]==="\\"?!y:!1,r++;if(n.charAt(r)=='"')try{return JSON.parse(n.substring(g,++r-Number(y)))}catch(w){a(String(w))}else if(Ft.STR&e)try{return JSON.parse(n.substring(g,r-Number(y))+'"')}catch{return JSON.parse(n.substring(g,n.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},c=()=>{r++,m();const g={};try{for(;n[r]!=="}";){if(m(),r>=t&&Ft.OBJ&e)return g;const y=u();m(),r++;try{const w=o();Object.defineProperty(g,y,{value:w,writable:!0,enumerable:!0,configurable:!0})}catch(w){if(Ft.OBJ&e)return g;throw w}m(),n[r]===","&&r++}}catch{if(Ft.OBJ&e)return g;s("Expected '}' at end of object")}return r++,g},f=()=>{r++;const g=[];try{for(;n[r]!=="]";)g.push(o()),m(),n[r]===","&&r++}catch{if(Ft.ARR&e)return g;s("Expected ']' at end of array")}return r++,g},h=()=>{if(r===0){n==="-"&&Ft.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n)}catch(y){if(Ft.NUM&e)try{return n[n.length-1]==="."?JSON.parse(n.substring(0,n.lastIndexOf("."))):JSON.parse(n.substring(0,n.lastIndexOf("e")))}catch{}a(String(y))}}const g=r;for(n[r]==="-"&&r++;n[r]&&!",]}".includes(n[r]);)r++;r==t&&!(Ft.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(n.substring(g,r))}catch{n.substring(g,r)==="-"&&Ft.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(n.substring(g,n.lastIndexOf("e")))}catch(w){a(String(w))}}},m=()=>{for(;r<t&&` 
\r	`.includes(n[r]);)r++};return o()},i1=n=>w9(n,Ft.ALL^Ft.NUM);var Li=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},et=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Tt,vs,Mi,ra,bg,ld,vg,xg,Sg,ud,Eg,o1;class cu extends nk{constructor(e){super(),Tt.add(this),vs.set(this,void 0),Mi.set(this,void 0),ra.set(this,void 0),Li(this,vs,e,"f"),Li(this,Mi,[],"f")}get currentChatCompletionSnapshot(){return et(this,ra,"f")}static fromReadableStream(e){const t=new cu(null);return t._run(()=>t._fromReadableStream(e)),t}static createChatCompletion(e,t,r){const s=new cu(t);return s._run(()=>s._runChatCompletion(e,{...t,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,t,r){var o;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),et(this,Tt,"m",bg).call(this);const a=await e.chat.completions.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const u of a)et(this,Tt,"m",vg).call(this,u);if((o=a.controller.signal)!=null&&o.aborted)throw new Bn;return this._addChatCompletion(et(this,Tt,"m",ud).call(this))}async _fromReadableStream(e,t){var o;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),et(this,Tt,"m",bg).call(this),this._connected();const s=Jr.fromReadableStream(e,this.controller);let a;for await(const u of s)a&&a!==u.id&&this._addChatCompletion(et(this,Tt,"m",ud).call(this)),et(this,Tt,"m",vg).call(this,u),a=u.id;if((o=s.controller.signal)!=null&&o.aborted)throw new Bn;return this._addChatCompletion(et(this,Tt,"m",ud).call(this))}[(vs=new WeakMap,Mi=new WeakMap,ra=new WeakMap,Tt=new WeakSet,bg=function(){this.ended||Li(this,ra,void 0,"f")},ld=function(t){let r=et(this,Mi,"f")[t.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},et(this,Mi,"f")[t.index]=r,r)},vg=function(t){var s,a,o,u,c,f,h,m,g,y,w,v,x,E,k;if(this.ended)return;const r=et(this,Tt,"m",o1).call(this,t);this._emit("chunk",t,r);for(const S of t.choices){const R=r.choices[S.index];S.delta.content!=null&&((s=R.message)==null?void 0:s.role)==="assistant"&&((a=R.message)!=null&&a.content)&&(this._emit("content",S.delta.content,R.message.content),this._emit("content.delta",{delta:S.delta.content,snapshot:R.message.content,parsed:R.message.parsed})),S.delta.refusal!=null&&((o=R.message)==null?void 0:o.role)==="assistant"&&((u=R.message)!=null&&u.refusal)&&this._emit("refusal.delta",{delta:S.delta.refusal,snapshot:R.message.refusal}),((c=S.logprobs)==null?void 0:c.content)!=null&&((f=R.message)==null?void 0:f.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(h=S.logprobs)==null?void 0:h.content,snapshot:((m=R.logprobs)==null?void 0:m.content)??[]}),((g=S.logprobs)==null?void 0:g.refusal)!=null&&((y=R.message)==null?void 0:y.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(w=S.logprobs)==null?void 0:w.refusal,snapshot:((v=R.logprobs)==null?void 0:v.refusal)??[]});const A=et(this,Tt,"m",ld).call(this,R);R.finish_reason&&(et(this,Tt,"m",Sg).call(this,R),A.current_tool_call_index!=null&&et(this,Tt,"m",xg).call(this,R,A.current_tool_call_index));for(const I of S.delta.tool_calls??[])A.current_tool_call_index!==I.index&&(et(this,Tt,"m",Sg).call(this,R),A.current_tool_call_index!=null&&et(this,Tt,"m",xg).call(this,R,A.current_tool_call_index)),A.current_tool_call_index=I.index;for(const I of S.delta.tool_calls??[]){const M=(x=R.message.tool_calls)==null?void 0:x[I.index];M!=null&&M.type&&((M==null?void 0:M.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(E=M.function)==null?void 0:E.name,index:I.index,arguments:M.function.arguments,parsed_arguments:M.function.parsed_arguments,arguments_delta:((k=I.function)==null?void 0:k.arguments)??""}):(M==null||M.type,void 0))}}},xg=function(t,r){var o,u,c;if(et(this,Tt,"m",ld).call(this,t).done_tool_calls.has(r))return;const a=(o=t.message.tool_calls)==null?void 0:o[r];if(!a)throw new Error("no tool call snapshot");if(!a.type)throw new Error("tool call snapshot missing `type`");if(a.type==="function"){const f=(c=(u=et(this,vs,"f"))==null?void 0:u.tools)==null?void 0:c.find(h=>h.type==="function"&&h.function.name===a.function.name);this._emit("tool_calls.function.arguments.done",{name:a.function.name,index:r,arguments:a.function.arguments,parsed_arguments:Au(f)?f.$parseRaw(a.function.arguments):f!=null&&f.function.strict?JSON.parse(a.function.arguments):null})}else a.type},Sg=function(t){var s,a;const r=et(this,Tt,"m",ld).call(this,t);if(t.message.content&&!r.content_done){r.content_done=!0;const o=et(this,Tt,"m",Eg).call(this);this._emit("content.done",{content:t.message.content,parsed:o?o.$parseRaw(t.message.content):null})}t.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:t.message.refusal})),(s=t.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:t.logprobs.content})),(a=t.logprobs)!=null&&a.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:t.logprobs.refusal}))},ud=function(){if(this.ended)throw new Te("stream has ended, this shouldn't happen");const t=et(this,ra,"f");if(!t)throw new Te("request ended without sending any chunks");return Li(this,ra,void 0,"f"),Li(this,Mi,[],"f"),v9(t,et(this,vs,"f"))},Eg=function(){var r;const t=(r=et(this,vs,"f"))==null?void 0:r.response_format;return G_(t)?t:null},o1=function(t){var r,s,a,o;let u=et(this,ra,"f");const{choices:c,...f}=t;u?Object.assign(u,f):u=Li(this,ra,{...f,choices:[]},"f");for(const{delta:h,finish_reason:m,index:g,logprobs:y=null,...w}of t.choices){let v=u.choices[g];if(v||(v=u.choices[g]={finish_reason:m,index:g,message:{},logprobs:y,...w}),y)if(!v.logprobs)v.logprobs=Object.assign({},y);else{const{content:I,refusal:M,...D}=y;Object.assign(v.logprobs,D),I&&((r=v.logprobs).content??(r.content=[]),v.logprobs.content.push(...I)),M&&((s=v.logprobs).refusal??(s.refusal=[]),v.logprobs.refusal.push(...M))}if(m&&(v.finish_reason=m,et(this,vs,"f")&&ek(et(this,vs,"f")))){if(m==="length")throw new jP;if(m==="content_filter")throw new LP}if(Object.assign(v,w),!h)continue;const{content:x,refusal:E,function_call:k,role:S,tool_calls:R,...A}=h;if(Object.assign(v.message,A),E&&(v.message.refusal=(v.message.refusal||"")+E),S&&(v.message.role=S),k&&(v.message.function_call?(k.name&&(v.message.function_call.name=k.name),k.arguments&&((a=v.message.function_call).arguments??(a.arguments=""),v.message.function_call.arguments+=k.arguments)):v.message.function_call=k),x&&(v.message.content=(v.message.content||"")+x,!v.message.refusal&&et(this,Tt,"m",Eg).call(this)&&(v.message.parsed=i1(v.message.content))),R){v.message.tool_calls||(v.message.tool_calls=[]);for(const{index:I,id:M,type:D,function:K,...X}of R){const ae=(o=v.message.tool_calls)[I]??(o[I]={});Object.assign(ae,X),M&&(ae.id=M),D&&(ae.type=D),K&&(ae.function??(ae.function={name:K.name??"",arguments:""})),K!=null&&K.name&&(ae.function.name=K.name),K!=null&&K.arguments&&(ae.function.arguments+=K.arguments,c9(et(this,vs,"f"),ae)&&(ae.function.parsed_arguments=i1(ae.function.arguments)))}}}return u},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("chunk",s=>{const a=t.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>t.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new Jr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function v9(n,e){const{id:t,choices:r,created:s,model:a,system_fingerprint:o,...u}=n,c={...u,id:t,choices:r.map(({message:f,finish_reason:h,index:m,logprobs:g,...y})=>{if(!h)throw new Te(`missing finish_reason for choice ${m}`);const{content:w=null,function_call:v,tool_calls:x,...E}=f,k=f.role;if(!k)throw new Te(`missing role for choice ${m}`);if(v){const{arguments:S,name:R}=v;if(S==null)throw new Te(`missing function_call.arguments for choice ${m}`);if(!R)throw new Te(`missing function_call.name for choice ${m}`);return{...y,message:{content:w,function_call:{arguments:S,name:R},role:k,refusal:f.refusal??null},finish_reason:h,index:m,logprobs:g}}return x?{...y,index:m,finish_reason:h,logprobs:g,message:{...E,role:k,content:w,refusal:f.refusal??null,tool_calls:x.map((S,R)=>{const{function:A,type:I,id:M,...D}=S,{arguments:K,name:X,...ae}=A||{};if(M==null)throw new Te(`missing choices[${m}].tool_calls[${R}].id
${cd(n)}`);if(I==null)throw new Te(`missing choices[${m}].tool_calls[${R}].type
${cd(n)}`);if(X==null)throw new Te(`missing choices[${m}].tool_calls[${R}].function.name
${cd(n)}`);if(K==null)throw new Te(`missing choices[${m}].tool_calls[${R}].function.arguments
${cd(n)}`);return{...D,id:M,type:I,function:{...ae,name:X,arguments:K}}})}}:{...y,message:{...E,content:w,role:k,refusal:f.refusal??null},finish_reason:h,index:m,logprobs:g}}),created:s,model:a,object:"chat.completion",...o?{system_fingerprint:o}:{}};return o9(c,e)}function cd(n){return JSON.stringify(n)}class Yi extends cu{static fromReadableStream(e){const t=new Yi(null);return t._run(()=>t._fromReadableStream(e)),t}static runFunctions(e,t,r){const s=new Yi(null),a={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,t,a)),s}static runTools(e,t,r){const s=new Yi(t),a={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,t,a)),s}}let fk=class extends Fe{parse(e,t){return d9(e.tools),this._client.chat.completions.create(e,{...t,headers:{...t==null?void 0:t.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>J_(r,e))}runFunctions(e,t){return e.stream?Yi.runFunctions(this._client,e,t):uu.runFunctions(this._client,e,t)}runTools(e,t){return e.stream?Yi.runTools(this._client,e,t):uu.runTools(this._client,e,t)}stream(e,t){return cu.createChatCompletion(this._client,e,t)}};class yy extends Fe{constructor(){super(...arguments),this.completions=new fk(this._client)}}(function(n){n.Completions=fk})(yy||(yy={}));class hk extends Fe{create(e,t){return this._client.post("/realtime/sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class pk extends Fe{create(e,t){return this._client.post("/realtime/transcription_sessions",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}}class Hf extends Fe{constructor(){super(...arguments),this.sessions=new hk(this._client),this.transcriptionSessions=new pk(this._client)}}Hf.Sessions=hk;Hf.TranscriptionSessions=pk;var Ce=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Mn=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},Zt,_y,qr,Sd,xr,Fa,qi,Ma,Yd,Un,Ed,Cd,Ul,Al,$l,l1,u1,c1,d1,f1,h1,p1;class Cr extends Z_{constructor(){super(...arguments),Zt.add(this),_y.set(this,[]),qr.set(this,{}),Sd.set(this,{}),xr.set(this,void 0),Fa.set(this,void 0),qi.set(this,void 0),Ma.set(this,void 0),Yd.set(this,void 0),Un.set(this,void 0),Ed.set(this,void 0),Cd.set(this,void 0),Ul.set(this,void 0)}[(_y=new WeakMap,qr=new WeakMap,Sd=new WeakMap,xr=new WeakMap,Fa=new WeakMap,qi=new WeakMap,Ma=new WeakMap,Yd=new WeakMap,Un=new WeakMap,Ed=new WeakMap,Cd=new WeakMap,Ul=new WeakMap,Zt=new WeakSet,Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",s=>{const a=t.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>t.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const t=new Cr;return t._run(()=>t._fromReadableStream(e)),t}async _fromReadableStream(e,t){var a;const r=t==null?void 0:t.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=Jr.fromReadableStream(e,this.controller);for await(const o of s)Ce(this,Zt,"m",Al).call(this,o);if((a=s.controller.signal)!=null&&a.aborted)throw new Bn;return this._addRun(Ce(this,Zt,"m",$l).call(this))}toReadableStream(){return new Jr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,t,r,s,a){const o=new Cr;return o._run(()=>o._runToolAssistantStream(e,t,r,s,{...a,headers:{...a==null?void 0:a.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,t,r,s,a){var f;const o=a==null?void 0:a.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const u={...s,stream:!0},c=await e.submitToolOutputs(t,r,u,{...a,signal:this.controller.signal});this._connected();for await(const h of c)Ce(this,Zt,"m",Al).call(this,h);if((f=c.controller.signal)!=null&&f.aborted)throw new Bn;return this._addRun(Ce(this,Zt,"m",$l).call(this))}static createThreadAssistantStream(e,t,r){const s=new Cr;return s._run(()=>s._threadAssistantStream(e,t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,t,r,s){const a=new Cr;return a._run(()=>a._runAssistantStream(e,t,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),a}currentEvent(){return Ce(this,Ed,"f")}currentRun(){return Ce(this,Cd,"f")}currentMessageSnapshot(){return Ce(this,xr,"f")}currentRunStepSnapshot(){return Ce(this,Ul,"f")}async finalRunSteps(){return await this.done(),Object.values(Ce(this,qr,"f"))}async finalMessages(){return await this.done(),Object.values(Ce(this,Sd,"f"))}async finalRun(){if(await this.done(),!Ce(this,Fa,"f"))throw Error("Final run was not received.");return Ce(this,Fa,"f")}async _createThreadAssistantStream(e,t,r){var u;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const a={...t,stream:!0},o=await e.createAndRun(a,{...r,signal:this.controller.signal});this._connected();for await(const c of o)Ce(this,Zt,"m",Al).call(this,c);if((u=o.controller.signal)!=null&&u.aborted)throw new Bn;return this._addRun(Ce(this,Zt,"m",$l).call(this))}async _createAssistantStream(e,t,r,s){var c;const a=s==null?void 0:s.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},u=await e.create(t,o,{...s,signal:this.controller.signal});this._connected();for await(const f of u)Ce(this,Zt,"m",Al).call(this,f);if((c=u.controller.signal)!=null&&c.aborted)throw new Bn;return this._addRun(Ce(this,Zt,"m",$l).call(this))}static accumulateDelta(e,t){for(const[r,s]of Object.entries(t)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let a=e[r];if(a==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof a=="string"&&typeof s=="string")a+=s;else if(typeof a=="number"&&typeof s=="number")a+=s;else if(wg(a)&&wg(s))a=this.accumulateDelta(a,s);else if(Array.isArray(a)&&Array.isArray(s)){if(a.every(o=>typeof o=="string"||typeof o=="number")){a.push(...s);continue}for(const o of s){if(!wg(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const u=o.index;if(u==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof u!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${u}`);const c=a[u];c==null?a.push(o):a[u]=this.accumulateDelta(c,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${a}`);e[r]=a}return e}_addRun(e){return e}async _threadAssistantStream(e,t,r){return await this._createThreadAssistantStream(t,e,r)}async _runAssistantStream(e,t,r,s){return await this._createAssistantStream(t,e,r,s)}async _runToolAssistantStream(e,t,r,s,a){return await this._createToolAssistantStream(r,e,t,s,a)}}Al=function(e){if(!this.ended)switch(Mn(this,Ed,e,"f"),Ce(this,Zt,"m",c1).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Ce(this,Zt,"m",p1).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Ce(this,Zt,"m",u1).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Ce(this,Zt,"m",l1).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},$l=function(){if(this.ended)throw new Te("stream has ended, this shouldn't happen");if(!Ce(this,Fa,"f"))throw Error("Final run has not been received");return Ce(this,Fa,"f")},l1=function(e){const[t,r]=Ce(this,Zt,"m",f1).call(this,e,Ce(this,xr,"f"));Mn(this,xr,t,"f"),Ce(this,Sd,"f")[t.id]=t;for(const s of r){const a=t.content[s.index];(a==null?void 0:a.type)=="text"&&this._emit("textCreated",a.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,t),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let a=s.text,o=t.content[s.index];if(o&&o.type=="text")this._emit("textDelta",a,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=Ce(this,qi,"f")){if(Ce(this,Ma,"f"))switch(Ce(this,Ma,"f").type){case"text":this._emit("textDone",Ce(this,Ma,"f").text,Ce(this,xr,"f"));break;case"image_file":this._emit("imageFileDone",Ce(this,Ma,"f").image_file,Ce(this,xr,"f"));break}Mn(this,qi,s.index,"f")}Mn(this,Ma,t.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(Ce(this,qi,"f")!==void 0){const s=e.data.content[Ce(this,qi,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,Ce(this,xr,"f"));break;case"text":this._emit("textDone",s.text,Ce(this,xr,"f"));break}}Ce(this,xr,"f")&&this._emit("messageDone",e.data),Mn(this,xr,void 0,"f")}},u1=function(e){const t=Ce(this,Zt,"m",d1).call(this,e);switch(Mn(this,Ul,t,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&t.step_details.type=="tool_calls")for(const a of r.step_details.tool_calls)a.index==Ce(this,Yd,"f")?this._emit("toolCallDelta",a,t.step_details.tool_calls[a.index]):(Ce(this,Un,"f")&&this._emit("toolCallDone",Ce(this,Un,"f")),Mn(this,Yd,a.index,"f"),Mn(this,Un,t.step_details.tool_calls[a.index],"f"),Ce(this,Un,"f")&&this._emit("toolCallCreated",Ce(this,Un,"f")));this._emit("runStepDelta",e.data.delta,t);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Mn(this,Ul,void 0,"f"),e.data.step_details.type=="tool_calls"&&Ce(this,Un,"f")&&(this._emit("toolCallDone",Ce(this,Un,"f")),Mn(this,Un,void 0,"f")),this._emit("runStepDone",e.data,t);break}},c1=function(e){Ce(this,_y,"f").push(e),this._emit("event",e)},d1=function(e){switch(e.event){case"thread.run.step.created":return Ce(this,qr,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let t=Ce(this,qr,"f")[e.data.id];if(!t)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=Cr.accumulateDelta(t,r.delta);Ce(this,qr,"f")[e.data.id]=s}return Ce(this,qr,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Ce(this,qr,"f")[e.data.id]=e.data;break}if(Ce(this,qr,"f")[e.data.id])return Ce(this,qr,"f")[e.data.id];throw new Error("No snapshot available")},f1=function(e,t){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!t)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const a of s.delta.content)if(a.index in t.content){let o=t.content[a.index];t.content[a.index]=Ce(this,Zt,"m",h1).call(this,a,o)}else t.content[a.index]=a,r.push(a);return[t,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(t)return[t,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},h1=function(e,t){return Cr.accumulateDelta(t,e)},p1=function(e){switch(Mn(this,Cd,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Mn(this,Fa,e.data,"f"),Ce(this,Un,"f")&&(this._emit("toolCallDone",Ce(this,Un,"f")),Mn(this,Un,void 0,"f"));break}};class K_ extends Fe{create(e,t,r){return this._client.post(`/threads/${e}/messages`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,s){return this._client.post(`/threads/${e}/messages/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},r){return wt(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/messages`,X_,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/threads/${e}/messages/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class X_ extends Xt{}K_.MessagesPage=X_;class Y_ extends Fe{retrieve(e,t,r,s={},a){return wt(s)?this.retrieve(e,t,r,{},s):this._client.get(`/threads/${e}/runs/${t}/steps/${r}`,{query:s,...a,headers:{"OpenAI-Beta":"assistants=v2",...a==null?void 0:a.headers}})}list(e,t,r={},s){return wt(r)?this.list(e,t,{},r):this._client.getAPIList(`/threads/${e}/runs/${t}/steps`,Q_,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class Q_ extends Xt{}Y_.RunStepsPage=Q_;let $u=class extends Fe{constructor(){super(...arguments),this.steps=new Y_(this._client)}create(e,t,r){const{include:s,...a}=t;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:a,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:t.stream??!1})}retrieve(e,t,r){return this._client.get(`/threads/${e}/runs/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,s){return this._client.post(`/threads/${e}/runs/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},r){return wt(t)?this.list(e,{},t):this._client.getAPIList(`/threads/${e}/runs`,ew,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/threads/${e}/runs/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t,r);return await this.poll(e,s.id,r)}createAndStream(e,t,r){return Cr.createAssistantStream(e,this._client.beta.threads.runs,t,r)}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:a,response:o}=await this.retrieve(e,t,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(a.status){case"queued":case"in_progress":case"cancelling":let u=5e3;if(r!=null&&r.pollIntervalMs)u=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(u=f)}}await Ou(u);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return a}}}stream(e,t,r){return Cr.createAssistantStream(e,this._client.beta.threads.runs,t,r)}submitToolOutputs(e,t,r,s){return this._client.post(`/threads/${e}/runs/${t}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,t,r,s){const a=await this.submitToolOutputs(e,t,r,s);return await this.poll(e,a.id,s)}submitToolOutputsStream(e,t,r,s){return Cr.createToolAssistantStream(e,t,this._client.beta.threads.runs,r,s)}};class ew extends Xt{}$u.RunsPage=ew;$u.Steps=Y_;$u.RunStepsPage=Q_;class Po extends Fe{constructor(){super(...arguments),this.runs=new $u(this._client),this.messages=new K_(this._client)}create(e={},t){return wt(e)?this.create({},e):this._client.post("/threads",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/threads/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t){return this._client.delete(`/threads/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}createAndRun(e,t){return this._client.post("/threads/runs",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers},stream:e.stream??!1})}async createAndRunPoll(e,t){const r=await this.createAndRun(e,t);return await this.runs.poll(r.thread_id,r.id,t)}createAndRunStream(e,t){return Cr.createThreadAssistantStream(e,this._client.beta.threads,t)}}Po.Runs=$u;Po.RunsPage=ew;Po.Messages=K_;Po.MessagesPage=X_;class ko extends Fe{constructor(){super(...arguments),this.realtime=new Hf(this._client),this.chat=new yy(this._client),this.assistants=new W_(this._client),this.threads=new Po(this._client)}}ko.Realtime=Hf;ko.Assistants=W_;ko.AssistantsPage=q_;ko.Threads=Po;class mk extends Fe{create(e,t){return this._client.post("/completions",{body:e,...t,stream:e.stream??!1})}}class gk extends Fe{create(e,t){const r=!!e.encoding_format;let s=r?e.encoding_format:"base64";r&&la("Request","User defined encoding_format:",e.encoding_format);const a=this._client.post("/embeddings",{body:{...e,encoding_format:s},...t});return r?a:(la("response","Decoding base64 embeddings to float32 array"),a._thenUnwrap(o=>(o&&o.data&&o.data.forEach(u=>{const c=u.embedding;u.embedding=s9(c)}),o)))}}class tw extends Fe{retrieve(e,t,r,s){return this._client.get(`/evals/${e}/runs/${t}/output_items/${r}`,s)}list(e,t,r={},s){return wt(r)?this.list(e,t,{},r):this._client.getAPIList(`/evals/${e}/runs/${t}/output_items`,nw,{query:r,...s})}}class nw extends Xt{}tw.OutputItemListResponsesPage=nw;class Iu extends Fe{constructor(){super(...arguments),this.outputItems=new tw(this._client)}create(e,t,r){return this._client.post(`/evals/${e}/runs`,{body:t,...r})}retrieve(e,t,r){return this._client.get(`/evals/${e}/runs/${t}`,r)}list(e,t={},r){return wt(t)?this.list(e,{},t):this._client.getAPIList(`/evals/${e}/runs`,rw,{query:t,...r})}del(e,t,r){return this._client.delete(`/evals/${e}/runs/${t}`,r)}cancel(e,t,r){return this._client.post(`/evals/${e}/runs/${t}`,r)}}class rw extends Xt{}Iu.RunListResponsesPage=rw;Iu.OutputItems=tw;Iu.OutputItemListResponsesPage=nw;class Nu extends Fe{constructor(){super(...arguments),this.runs=new Iu(this._client)}create(e,t){return this._client.post("/evals",{body:e,...t})}retrieve(e,t){return this._client.get(`/evals/${e}`,t)}update(e,t,r){return this._client.post(`/evals/${e}`,{body:t,...r})}list(e={},t){return wt(e)?this.list({},e):this._client.getAPIList("/evals",sw,{query:e,...t})}del(e,t){return this._client.delete(`/evals/${e}`,t)}}class sw extends Xt{}Nu.EvalListResponsesPage=sw;Nu.Runs=Iu;Nu.RunListResponsesPage=rw;let aw=class extends Fe{create(e,t){return this._client.post("/files",lo({body:e,...t}))}retrieve(e,t){return this._client.get(`/files/${e}`,t)}list(e={},t){return wt(e)?this.list({},e):this._client.getAPIList("/files",iw,{query:e,...t})}del(e,t){return this._client.delete(`/files/${e}`,t)}content(e,t){return this._client.get(`/files/${e}/content`,{...t,headers:{Accept:"application/binary",...t==null?void 0:t.headers},__binaryResponse:!0})}retrieveContent(e,t){return this._client.get(`/files/${e}/content`,t)}async waitForProcessing(e,{pollInterval:t=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),a=Date.now();let o=await this.retrieve(e);for(;!o.status||!s.has(o.status);)if(await Ou(t),o=await this.retrieve(e),Date.now()-a>r)throw new jf({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}};class iw extends Xt{}aw.FileObjectsPage=iw;class ow extends Fe{create(e,t,r){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,lw,{body:t,method:"post",...r})}retrieve(e,t={},r){return wt(t)?this.retrieve(e,{},t):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:t,...r})}del(e,t){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions`,t)}}class lw extends Ff{}ow.PermissionCreateResponsesPage=lw;let Vf=class extends Fe{constructor(){super(...arguments),this.permissions=new ow(this._client)}};Vf.Permissions=ow;Vf.PermissionCreateResponsesPage=lw;class uw extends Fe{list(e,t={},r){return wt(t)?this.list(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,cw,{query:t,...r})}}class cw extends Xt{}uw.FineTuningJobCheckpointsPage=cw;class Ro extends Fe{constructor(){super(...arguments),this.checkpoints=new uw(this._client)}create(e,t){return this._client.post("/fine_tuning/jobs",{body:e,...t})}retrieve(e,t){return this._client.get(`/fine_tuning/jobs/${e}`,t)}list(e={},t){return wt(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",dw,{query:e,...t})}cancel(e,t){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,t)}listEvents(e,t={},r){return wt(t)?this.listEvents(e,{},t):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,fw,{query:t,...r})}}class dw extends Xt{}class fw extends Xt{}Ro.FineTuningJobsPage=dw;Ro.FineTuningJobEventsPage=fw;Ro.Checkpoints=uw;Ro.FineTuningJobCheckpointsPage=cw;class Oo extends Fe{constructor(){super(...arguments),this.jobs=new Ro(this._client),this.checkpoints=new Vf(this._client)}}Oo.Jobs=Ro;Oo.FineTuningJobsPage=dw;Oo.FineTuningJobEventsPage=fw;Oo.Checkpoints=Vf;class yk extends Fe{createVariation(e,t){return this._client.post("/images/variations",lo({body:e,...t}))}edit(e,t){return this._client.post("/images/edits",lo({body:e,...t}))}generate(e,t){return this._client.post("/images/generations",{body:e,...t})}}class hw extends Fe{retrieve(e,t){return this._client.get(`/models/${e}`,t)}list(e){return this._client.getAPIList("/models",pw,e)}del(e,t){return this._client.delete(`/models/${e}`,t)}}class pw extends Ff{}hw.ModelsPage=pw;class _k extends Fe{create(e,t){return this._client.post("/moderations",{body:e,...t})}}function x9(n,e){return!e||!E9(e)?{...n,output_parsed:null,output:n.output.map(t=>t.type==="function_call"?{...t,parsed_arguments:null}:t.type==="message"?{...t,content:t.content.map(r=>({...r,parsed:null}))}:t)}:wk(n,e)}function wk(n,e){const t=n.output.map(s=>{if(s.type==="function_call")return{...s,parsed_arguments:k9(e,s)};if(s.type==="message"){const a=s.content.map(o=>o.type==="output_text"?{...o,parsed:S9(e,o.text)}:o);return{...s,content:a}}return s}),r=Object.assign({},n,{output:t});return Object.getOwnPropertyDescriptor(n,"output_text")||bk(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const s of r.output)if(s.type==="message"){for(const a of s.content)if(a.type==="output_text"&&a.parsed!==null)return a.parsed}return null}}),r}function S9(n,e){var t,r,s,a;return((r=(t=n.text)==null?void 0:t.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((s=n.text)==null?void 0:s.format)?((a=n.text)==null?void 0:a.format).$parseRaw(e):JSON.parse(e)}function E9(n){var e;return!!G_((e=n.text)==null?void 0:e.format)}function C9(n){return(n==null?void 0:n.$brand)==="auto-parseable-tool"}function P9(n,e){return n.find(t=>t.type==="function"&&t.name===e)}function k9(n,e){const t=P9(n.tools??[],e.name);return{...e,...e,parsed_arguments:C9(t)?t.$parseRaw(e.arguments):t!=null&&t.strict?JSON.parse(e.arguments):null}}function bk(n){const e=[];for(const t of n.output)if(t.type==="message")for(const r of t.content)r.type==="output_text"&&e.push(r.text);n.output_text=e.join("")}class vk extends Fe{list(e,t={},r){return wt(t)?this.list(e,{},t):this._client.getAPIList(`/responses/${e}/input_items`,O9,{query:t,...r})}}var Di=function(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t},sa=function(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)},Fi,dd,aa,fd,m1,g1,y1,_1;class mw extends Z_{constructor(e){super(),Fi.add(this),dd.set(this,void 0),aa.set(this,void 0),fd.set(this,void 0),Di(this,dd,e,"f")}static createResponse(e,t,r){const s=new mw(t);return s._run(()=>s._createResponse(e,t,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createResponse(e,t,r){var o;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),sa(this,Fi,"m",m1).call(this);const a=await e.responses.create({...t,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const u of a)sa(this,Fi,"m",g1).call(this,u);if((o=a.controller.signal)!=null&&o.aborted)throw new Bn;return sa(this,Fi,"m",y1).call(this)}[(dd=new WeakMap,aa=new WeakMap,fd=new WeakMap,Fi=new WeakSet,m1=function(){this.ended||Di(this,aa,void 0,"f")},g1=function(t){if(this.ended)return;const r=sa(this,Fi,"m",_1).call(this,t);switch(this._emit("event",t),t.type){case"response.output_text.delta":{const s=r.output[t.output_index];if(!s)throw new Te(`missing output at index ${t.output_index}`);if(s.type==="message"){const a=s.content[t.content_index];if(!a)throw new Te(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new Te(`expected content to be 'output_text', got ${a.type}`);this._emit("response.output_text.delta",{...t,snapshot:a.text})}break}case"response.function_call_arguments.delta":{const s=r.output[t.output_index];if(!s)throw new Te(`missing output at index ${t.output_index}`);s.type==="function_call"&&this._emit("response.function_call_arguments.delta",{...t,snapshot:s.arguments});break}default:this._emit(t.type,t);break}},y1=function(){if(this.ended)throw new Te("stream has ended, this shouldn't happen");const t=sa(this,aa,"f");if(!t)throw new Te("request ended without sending any events");Di(this,aa,void 0,"f");const r=R9(t,sa(this,dd,"f"));return Di(this,fd,r,"f"),r},_1=function(t){let r=sa(this,aa,"f");if(!r){if(t.type!=="response.created")throw new Te(`When snapshot hasn't been set yet, expected 'response.created' event, got ${t.type}`);return r=Di(this,aa,t.response,"f"),r}switch(t.type){case"response.output_item.added":{r.output.push(t.item);break}case"response.content_part.added":{const s=r.output[t.output_index];if(!s)throw new Te(`missing output at index ${t.output_index}`);s.type==="message"&&s.content.push(t.part);break}case"response.output_text.delta":{const s=r.output[t.output_index];if(!s)throw new Te(`missing output at index ${t.output_index}`);if(s.type==="message"){const a=s.content[t.content_index];if(!a)throw new Te(`missing content at index ${t.content_index}`);if(a.type!=="output_text")throw new Te(`expected content to be 'output_text', got ${a.type}`);a.text+=t.delta}break}case"response.function_call_arguments.delta":{const s=r.output[t.output_index];if(!s)throw new Te(`missing output at index ${t.output_index}`);s.type==="function_call"&&(s.arguments+=t.delta);break}case"response.completed":{Di(this,aa,t.response,"f");break}}return r},Symbol.asyncIterator)](){const e=[],t=[];let r=!1;return this.on("event",s=>{const a=t.shift();a?a.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of t)s.resolve(void 0);t.length=0}),this.on("abort",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),this.on("error",s=>{r=!0;for(const a of t)a.reject(s);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((a,o)=>t.push({resolve:a,reject:o})).then(a=>a?{value:a,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=sa(this,fd,"f");if(!e)throw new Te("stream ended without producing a ChatCompletion");return e}}function R9(n,e){return x9(n,e)}class gw extends Fe{constructor(){super(...arguments),this.inputItems=new vk(this._client)}create(e,t){return this._client.post("/responses",{body:e,...t,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&bk(r),r))}retrieve(e,t={},r){return wt(t)?this.retrieve(e,{},t):this._client.get(`/responses/${e}`,{query:t,...r})}del(e,t){return this._client.delete(`/responses/${e}`,{...t,headers:{Accept:"*/*",...t==null?void 0:t.headers}})}parse(e,t){return this._client.responses.create(e,t)._thenUnwrap(r=>wk(r,e))}stream(e,t){return mw.createResponse(this._client,e,t)}}class O9 extends Xt{}gw.InputItems=vk;class xk extends Fe{create(e,t,r){return this._client.post(`/uploads/${e}/parts`,lo({body:t,...r}))}}class yw extends Fe{constructor(){super(...arguments),this.parts=new xk(this._client)}create(e,t){return this._client.post("/uploads",{body:e,...t})}cancel(e,t){return this._client.post(`/uploads/${e}/cancel`,t)}complete(e,t,r){return this._client.post(`/uploads/${e}/complete`,{body:t,...r})}}yw.Parts=xk;const T9=async n=>{const e=await Promise.allSettled(n),t=e.filter(s=>s.status==="rejected");if(t.length){for(const s of t)console.error(s.reason);throw new Error(`${t.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};class Wf extends Fe{create(e,t,r){return this._client.post(`/vector_stores/${e}/files`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,t,r,s){return this._client.post(`/vector_stores/${e}/files/${t}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,t={},r){return wt(t)?this.list(e,{},t):this._client.getAPIList(`/vector_stores/${e}/files`,qf,{query:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,t,r){return this._client.delete(`/vector_stores/${e}/files/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t,r);return await this.poll(e,s.id,r)}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const a=await this.retrieve(e,t,{...r,headers:s}).withResponse(),o=a.data;switch(o.status){case"in_progress":let u=5e3;if(r!=null&&r.pollIntervalMs)u=r.pollIntervalMs;else{const c=a.response.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(u=f)}}await Ou(u);break;case"failed":case"completed":return o}}}async upload(e,t,r){const s=await this._client.files.create({file:t,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,t,r){const s=await this.upload(e,t,r);return await this.poll(e,s.id,r)}content(e,t,r){return this._client.getAPIList(`/vector_stores/${e}/files/${t}/content`,_w,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class qf extends Xt{}class _w extends Ff{}Wf.VectorStoreFilesPage=qf;Wf.FileContentResponsesPage=_w;class Sk extends Fe{create(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,t,r){return this._client.get(`/vector_stores/${e}/file_batches/${t}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,t,r){return this._client.post(`/vector_stores/${e}/file_batches/${t}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,t,r){const s=await this.create(e,t);return await this.poll(e,s.id,r)}listFiles(e,t,r={},s){return wt(r)?this.listFiles(e,t,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${t}/files`,qf,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,t,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:a,response:o}=await this.retrieve(e,t,{...r,headers:s}).withResponse();switch(a.status){case"in_progress":let u=5e3;if(r!=null&&r.pollIntervalMs)u=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const f=parseInt(c);isNaN(f)||(u=f)}}await Ou(u);break;case"failed":case"cancelled":case"completed":return a}}}async uploadAndPoll(e,{files:t,fileIds:r=[]},s){if(t==null||t.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const a=(s==null?void 0:s.maxConcurrency)??5,o=Math.min(a,t.length),u=this._client,c=t.values(),f=[...r];async function h(g){for(let y of g){const w=await u.files.create({file:y,purpose:"assistants"},s);f.push(w.id)}}const m=Array(o).fill(c).map(h);return await T9(m),await this.createAndPoll(e,{file_ids:f})}}class _a extends Fe{constructor(){super(...arguments),this.files=new Wf(this._client),this.fileBatches=new Sk(this._client)}create(e,t){return this._client.post("/vector_stores",{body:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}retrieve(e,t){return this._client.get(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}update(e,t,r){return this._client.post(`/vector_stores/${e}`,{body:t,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},t){return wt(e)?this.list({},e):this._client.getAPIList("/vector_stores",ww,{query:e,...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}del(e,t){return this._client.delete(`/vector_stores/${e}`,{...t,headers:{"OpenAI-Beta":"assistants=v2",...t==null?void 0:t.headers}})}search(e,t,r){return this._client.getAPIList(`/vector_stores/${e}/search`,bw,{body:t,method:"post",...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class ww extends Xt{}class bw extends Ff{}_a.VectorStoresPage=ww;_a.VectorStoreSearchResponsesPage=bw;_a.Files=Wf;_a.VectorStoreFilesPage=qf;_a.FileContentResponsesPage=_w;_a.FileBatches=Sk;var Ek;let Le=class extends qF{constructor({baseURL:e=id("OPENAI_BASE_URL"),apiKey:t=id("OPENAI_API_KEY"),organization:r=id("OPENAI_ORG_ID")??null,project:s=id("OPENAI_PROJECT_ID")??null,...a}={}){if(t===void 0)throw new Te("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:t,organization:r,project:s,...a,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&n9())throw new Te(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new mk(this),this.chat=new Bf(this),this.embeddings=new gk(this),this.files=new aw(this),this.images=new yk(this),this.audio=new Tu(this),this.moderations=new _k(this),this.models=new hw(this),this.fineTuning=new Oo(this),this.vectorStores=new _a(this),this.beta=new ko(this),this.batches=new H_(this),this.uploads=new yw(this),this.responses=new gw(this),this.evals=new Nu(this),this._options=o,this.apiKey=t,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return RF(e,{arrayFormat:"brackets"})}};Ek=Le;Le.OpenAI=Ek;Le.DEFAULT_TIMEOUT=6e5;Le.OpenAIError=Te;Le.APIError=Kt;Le.APIConnectionError=Nf;Le.APIConnectionTimeoutError=jf;Le.APIUserAbortError=Bn;Le.NotFoundError=TP;Le.ConflictError=AP;Le.RateLimitError=IP;Le.BadRequestError=kP;Le.AuthenticationError=RP;Le.InternalServerError=NP;Le.PermissionDeniedError=OP;Le.UnprocessableEntityError=$P;Le.toFile=UP;Le.fileFromPath=EP;Le.Completions=mk;Le.Chat=Bf;Le.ChatCompletionsPage=zf;Le.Embeddings=gk;Le.Files=aw;Le.FileObjectsPage=iw;Le.Images=yk;Le.Audio=Tu;Le.Moderations=_k;Le.Models=hw;Le.ModelsPage=pw;Le.FineTuning=Oo;Le.VectorStores=_a;Le.VectorStoresPage=ww;Le.VectorStoreSearchResponsesPage=bw;Le.Beta=ko;Le.Batches=H_;Le.BatchesPage=V_;Le.Uploads=yw;Le.Responses=gw;Le.Evals=Nu;Le.EvalListResponsesPage=sw;class A9 extends zt{parseResultWithPrompt(e,t,r){return this.parseResult(e,r)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,t){return typeof e=="string"?this._callWithConfig(async(r,s)=>this.parseResult([{text:r}],s==null?void 0:s.callbacks),e,{...t,runType:"parser"}):this._callWithConfig(async(r,s)=>this.parseResult([{message:r,text:this._baseMessageToString(r)}],s==null?void 0:s.callbacks),e,{...t,runType:"parser"})}}class Ck extends A9{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,r){return this.parse(e,r)}_type(){throw new Error("_type not implemented")}}class vw extends Error{constructor(e,t,r,s=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=t,this.observation=r,this.sendToLLM=s,s&&(r===void 0||t===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");kC(this,"OUTPUT_PARSING_FAILURE")}}class $9 extends Ck{async*_transform(e){for await(const t of e)typeof t=="string"?yield this.parseResult([{text:t}]):yield this.parseResult([{message:t,text:this._baseMessageToString(t)}])}async*transform(e,t){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...t,runType:"parser"})}}class Pk extends $9{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=(e==null?void 0:e.diff)??this.diff}async*_transform(e){let t,r;for await(const s of e){if(typeof s!="string"&&typeof s.content!="string")throw new Error("Cannot handle non-string output.");let a;if(JL(s)){if(typeof s.content!="string")throw new Error("Cannot handle non-string message output.");a=new Qr({message:s,text:s.content})}else if(xf(s)){if(typeof s.content!="string")throw new Error("Cannot handle non-string message output.");a=new Qr({message:t2(s),text:s.content})}else a=new oo({text:s});r===void 0?r=a:r=r.concat(a);const o=await this.parsePartialResult([r]);o!=null&&!sy(o,t)&&(this.diff?yield this._diff(t,o):yield o,t=o)}}getFormatInstructions(){return""}}class w1 extends Ck{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const t=le.object(Object.fromEntries(Object.entries(e).map(([r,s])=>[r,le.string().describe(s)])));return new this(t)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(Ru(this.schema))}
\`\`\`
`}async parse(e){try{const r=(e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(s,a)=>`"${a.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(r))}catch(t){throw new vw(`Failed to parse. Text: "${e}". Error: ${t}`,e)}}}class b1 extends Pk{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,t){if(t)return e?M3(e,t):[{op:"replace",path:"",value:t}]}async parsePartialResult(e){return ox(e[0].text)}async parse(e){return ox(e,JSON.parse)}getFormatInstructions(){return""}}function xw(n,e){if(n.function===void 0)return;let t;if(e!=null&&e.partial)try{t=x_(n.function.arguments??"{}")}catch{return}else try{t=JSON.parse(n.function.arguments)}catch(s){throw new vw([`Function "${n.function.name}" arguments:`,"",n.function.arguments,"","are not valid JSON.",`Error: ${s.message}`].join(`
`))}const r={name:n.function.name,args:t,type:"tool_call"};return e!=null&&e.returnId&&(r.id=n.id),r}function I9(n){if(n.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:n.id,type:"function",function:{name:n.name,arguments:JSON.stringify(n.args)}}}function kk(n,e){var t,r;return{name:(t=n.function)==null?void 0:t.name,args:(r=n.function)==null?void 0:r.arguments,id:n.id,error:e,type:"invalid_tool_call"}}class N9 extends Pk{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=(e==null?void 0:e.returnId)??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(e){return await this.parsePartialResult(e,!1)}async parsePartialResult(e,t=!0){var o;const r=e[0].message;let s;if(xu(r)&&((o=r.tool_calls)!=null&&o.length)?s=r.tool_calls.map(u=>{const{id:c,...f}=u;return this.returnId?{id:c,...f}:f}):r.additional_kwargs.tool_calls!==void 0&&(s=JSON.parse(JSON.stringify(r.additional_kwargs.tool_calls)).map(c=>xw(c,{returnId:this.returnId,partial:t}))),!s)return[];const a=[];for(const u of s)if(u!==void 0){const c={type:u.name,args:u.args,id:u.id};a.push(c)}return a}}class v1 extends N9{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const t=await this.zodSchema.safeParseAsync(e);if(t.success)return t.data;throw new vw(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(t.error.errors)}`,JSON.stringify(e,null,2))}async parsePartialResult(e){const r=(await super.parsePartialResult(e)).filter(a=>a.type===this.keyName);let s=r;if(r.length)return this.returnId||(s=r.map(a=>a.args)),this.returnSingle?s[0]:s}async parseResult(e){const r=(await super.parsePartialResult(e,!1)).filter(o=>o.type===this.keyName);let s=r;return r.length?(this.returnId||(s=r.map(o=>o.args)),this.returnSingle?this._validateResult(s[0]):await Promise.all(s.map(o=>this._validateResult(o)))):void 0}}const j9=Symbol("Let zodToJsonSchema decide on which parser to use"),x1={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},L9=n=>typeof n=="string"?{...x1,basePath:["#"],definitions:{},name:n}:{...x1,basePath:["#"],definitions:{},...n},wy=n=>"_def"in n?n._def:n;function M9(n){if(!n)return!0;for(const e in n)return!1;return!0}const D9=n=>{const e=L9(n),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:t,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map(([r,s])=>[wy(s),{def:wy(s),path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function Rk(n,e,t,r){r!=null&&r.errorMessages&&t&&(n.errorMessage={...n.errorMessage,[e]:t})}function Xe(n,e,t,r,s){n[e]=t,Rk(n,e,r,s)}function F9(){return{}}function U9(n,e){var r,s;const t={type:"array"};return((s=(r=n.type)==null?void 0:r._def)==null?void 0:s.typeName)!==Z.ZodAny&&(t.items=qe(n.type._def,{...e,currentPath:[...e.currentPath,"items"]})),n.minLength&&Xe(t,"minItems",n.minLength.value,n.minLength.message,e),n.maxLength&&Xe(t,"maxItems",n.maxLength.value,n.maxLength.message,e),n.exactLength&&(Xe(t,"minItems",n.exactLength.value,n.exactLength.message,e),Xe(t,"maxItems",n.exactLength.value,n.exactLength.message,e)),t}function z9(n,e){const t={type:"integer",format:"int64"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?Xe(t,"minimum",r.value,r.message,e):Xe(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Xe(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Xe(t,"maximum",r.value,r.message,e):Xe(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Xe(t,"maximum",r.value,r.message,e));break;case"multipleOf":Xe(t,"multipleOf",r.value,r.message,e);break}return t}function B9(){return{type:"boolean"}}function H9(n,e){return qe(n.type._def,e)}const V9=(n,e)=>qe(n.innerType._def,e);function Ok(n,e,t){const r=t??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,a)=>Ok(n,e,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return W9(n,e)}}const W9=(n,e)=>{const t={type:"integer",format:"unix-time"};if(e.target==="openApi3")return t;for(const r of n.checks)switch(r.kind){case"min":Xe(t,"minimum",r.value,r.message,e);break;case"max":Xe(t,"maximum",r.value,r.message,e);break}return t};function q9(n,e){return{...qe(n.innerType._def,e),default:n.defaultValue()}}function Z9(n,e,t){return e.effectStrategy==="input"?qe(n.schema._def,e,t):{}}function G9(n){return{type:"string",enum:[...n.values]}}const J9=n=>"type"in n&&n.type==="string"?!1:"allOf"in n;function K9(n,e){const t=[qe(n.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),qe(n.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(a=>!!a);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return t.forEach(a=>{if(J9(a))s.push(...a.allOf),a.unevaluatedProperties===void 0&&(r=void 0);else{let o=a;if("additionalProperties"in a&&a.additionalProperties===!1){const{additionalProperties:u,...c}=a;o=c}else r=void 0;s.push(o)}}),s.length?{allOf:s,...r}:void 0}function X9(n,e){const t=typeof n.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(n.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[n.value]}:{type:t==="bigint"?"integer":t,const:n.value}}let Cg;const Na={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Cg===void 0&&(Cg=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Cg),base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function Tk(n,e){const t={type:"string"};function r(s){return e.patternStrategy==="escape"?Y9(s):s}if(n.checks)for(const s of n.checks)switch(s.kind){case"min":Xe(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,s.value):s.value,s.message,e);break;case"max":Xe(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,s.value):s.value,s.message,e);break;case"email":switch(e.emailStrategy){case"format:email":wr(t,"email",s.message,e);break;case"format:idn-email":wr(t,"idn-email",s.message,e);break;case"pattern:zod":br(t,Na.email,s.message,e);break}break;case"url":wr(t,"uri",s.message,e);break;case"uuid":wr(t,"uuid",s.message,e);break;case"regex":br(t,s.regex,s.message,e);break;case"cuid":br(t,Na.cuid,s.message,e);break;case"cuid2":br(t,Na.cuid2,s.message,e);break;case"startsWith":br(t,RegExp(`^${r(s.value)}`),s.message,e);break;case"endsWith":br(t,RegExp(`${r(s.value)}$`),s.message,e);break;case"datetime":wr(t,"date-time",s.message,e);break;case"date":wr(t,"date",s.message,e);break;case"time":wr(t,"time",s.message,e);break;case"duration":wr(t,"duration",s.message,e);break;case"length":Xe(t,"minLength",typeof t.minLength=="number"?Math.max(t.minLength,s.value):s.value,s.message,e),Xe(t,"maxLength",typeof t.maxLength=="number"?Math.min(t.maxLength,s.value):s.value,s.message,e);break;case"includes":{br(t,RegExp(r(s.value)),s.message,e);break}case"ip":{s.version!=="v6"&&wr(t,"ipv4",s.message,e),s.version!=="v4"&&wr(t,"ipv6",s.message,e);break}case"emoji":br(t,Na.emoji,s.message,e);break;case"ulid":{br(t,Na.ulid,s.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{wr(t,"binary",s.message,e);break}case"contentEncoding:base64":{Xe(t,"contentEncoding","base64",s.message,e);break}case"pattern:zod":{br(t,Na.base64,s.message,e);break}}break}case"nanoid":br(t,Na.nanoid,s.message,e)}return t}const Y9=n=>Array.from(n).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),wr=(n,e,t,r)=>{var s;n.format||(s=n.anyOf)!=null&&s.some(a=>a.format)?(n.anyOf||(n.anyOf=[]),n.format&&(n.anyOf.push({format:n.format,...n.errorMessage&&r.errorMessages&&{errorMessage:{format:n.errorMessage.format}}}),delete n.format,n.errorMessage&&(delete n.errorMessage.format,Object.keys(n.errorMessage).length===0&&delete n.errorMessage)),n.anyOf.push({format:e,...t&&r.errorMessages&&{errorMessage:{format:t}}})):Xe(n,"format",e,t,r)},br=(n,e,t,r)=>{var s;n.pattern||(s=n.allOf)!=null&&s.some(a=>a.pattern)?(n.allOf||(n.allOf=[]),n.pattern&&(n.allOf.push({pattern:n.pattern,...n.errorMessage&&r.errorMessages&&{errorMessage:{pattern:n.errorMessage.pattern}}}),delete n.pattern,n.errorMessage&&(delete n.errorMessage.pattern,Object.keys(n.errorMessage).length===0&&delete n.errorMessage)),n.allOf.push({pattern:S1(e,r),...t&&r.errorMessages&&{errorMessage:{pattern:t}}})):Xe(n,"pattern",S1(e,r),t,r)},S1=(n,e)=>{var f;const t=typeof n=="function"?n():n;if(!e.applyRegexFlags||!t.flags)return t.source;const r={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},s=r.i?t.source.toLowerCase():t.source;let a="",o=!1,u=!1,c=!1;for(let h=0;h<s.length;h++){if(o){a+=s[h],o=!1;continue}if(r.i){if(u){if(s[h].match(/[a-z]/)){c?(a+=s[h],a+=`${s[h-2]}-${s[h]}`.toUpperCase(),c=!1):s[h+1]==="-"&&((f=s[h+2])!=null&&f.match(/[a-z]/))?(a+=s[h],c=!0):a+=`${s[h]}${s[h].toUpperCase()}`;continue}}else if(s[h].match(/[a-z]/)){a+=`[${s[h]}${s[h].toUpperCase()}]`;continue}}if(r.m){if(s[h]==="^"){a+=`(^|(?<=[\r
]))`;continue}else if(s[h]==="$"){a+=`($|(?=[\r
]))`;continue}}if(r.s&&s[h]==="."){a+=u?`${s[h]}\r
`:`[${s[h]}\r
]`;continue}a+=s[h],s[h]==="\\"?o=!0:u&&s[h]==="]"?u=!1:!u&&s[h]==="["&&(u=!0)}try{const h=new RegExp(a)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return a};function Ak(n,e){var r,s,a,o;if(e.target==="openApi3"&&((r=n.keyType)==null?void 0:r._def.typeName)===Z.ZodEnum)return{type:"object",required:n.keyType._def.values,properties:n.keyType._def.values.reduce((u,c)=>({...u,[c]:qe(n.valueType._def,{...e,currentPath:[...e.currentPath,"properties",c]})??{}}),{}),additionalProperties:!1};const t={type:"object",additionalProperties:qe(n.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return t;if(((s=n.keyType)==null?void 0:s._def.typeName)===Z.ZodString&&((a=n.keyType._def.checks)!=null&&a.length)){const u=Object.entries(Tk(n.keyType._def,e)).reduce((c,[f,h])=>f==="type"?c:{...c,[f]:h},{});return{...t,propertyNames:u}}else if(((o=n.keyType)==null?void 0:o._def.typeName)===Z.ZodEnum)return{...t,propertyNames:{enum:n.keyType._def.values}};return t}function Q9(n,e){if(e.mapStrategy==="record")return Ak(n,e);const t=qe(n.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},r=qe(n.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[t,r],minItems:2,maxItems:2}}}function e5(n){const e=n.values,r=Object.keys(n.values).filter(a=>typeof e[e[a]]!="number").map(a=>e[a]),s=Array.from(new Set(r.map(a=>typeof a)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function t5(){return{not:{}}}function n5(n){return n.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Qd={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function r5(n,e){if(e.target==="openApi3")return E1(n,e);const t=n.options instanceof Map?Array.from(n.options.values()):n.options;if(t.every(r=>r._def.typeName in Qd&&(!r._def.checks||!r._def.checks.length))){const r=t.reduce((s,a)=>{const o=Qd[a._def.typeName];return o&&!s.includes(o)?[...s,o]:s},[]);return{type:r.length>1?r:r[0]}}else if(t.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=t.reduce((s,a)=>{const o=typeof a._def.value;switch(o){case"string":case"number":case"boolean":return[...s,o];case"bigint":return[...s,"integer"];case"object":if(a._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===t.length){const s=r.filter((a,o,u)=>u.indexOf(a)===o);return{type:s.length>1?s:s[0],enum:t.reduce((a,o)=>a.includes(o._def.value)?a:[...a,o._def.value],[])}}}else if(t.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:t.reduce((r,s)=>[...r,...s._def.values.filter(a=>!r.includes(a))],[])};return E1(n,e)}const E1=(n,e)=>{const t=(n.options instanceof Map?Array.from(n.options.values()):n.options).map((r,s)=>qe(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return t.length?{anyOf:t}:void 0};function s5(n,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(n.innerType._def.typeName)&&(!n.innerType._def.checks||!n.innerType._def.checks.length))return e.target==="openApi3"||e.nullableStrategy==="property"?{type:Qd[n.innerType._def.typeName],nullable:!0}:{type:[Qd[n.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=qe(n.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const t=qe(n.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return t&&{anyOf:[t,{type:"null"}]}}function a5(n,e){const t={type:"number"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"int":t.type="integer",Rk(t,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?Xe(t,"minimum",r.value,r.message,e):Xe(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),Xe(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Xe(t,"maximum",r.value,r.message,e):Xe(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),Xe(t,"maximum",r.value,r.message,e));break;case"multipleOf":Xe(t,"multipleOf",r.value,r.message,e);break}return t}function i5(n,e){return e.removeAdditionalStrategy==="strict"?n.catchall._def.typeName==="ZodNever"?n.unknownKeys!=="strict":qe(n.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:n.catchall._def.typeName==="ZodNever"?n.unknownKeys==="passthrough":qe(n.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function o5(n,e){const t={type:"object",...Object.entries(n.shape()).reduce((r,[s,a])=>{if(a===void 0||a._def===void 0)return r;const o=[...e.currentPath,"properties",s],u=qe(a._def,{...e,currentPath:o,propertyPath:o});return u===void 0?r:(e.openaiStrictMode&&a.isOptional()&&!a.isNullable()&&console.warn(`Zod field at \`${o.join("/")}\` uses \`.optional()\` without \`.nullable()\` which is not supported by the API. See: https://platform.openai.com/docs/guides/structured-outputs?api-mode=responses#all-fields-must-be-required
This will become an error in a future version of the SDK.`),{properties:{...r.properties,[s]:u},required:a.isOptional()&&!e.openaiStrictMode?r.required:[...r.required,s]})},{properties:{},required:[]}),additionalProperties:i5(n,e)};return t.required.length||delete t.required,t}const l5=(n,e)=>{var r;if(e.currentPath.toString()===((r=e.propertyPath)==null?void 0:r.toString()))return qe(n.innerType._def,e);const t=qe(n.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return t?{anyOf:[{not:{}},t]}:{}},u5=(n,e)=>{if(e.pipeStrategy==="input")return qe(n.in._def,e);if(e.pipeStrategy==="output")return qe(n.out._def,e);const t=qe(n.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=qe(n.out._def,{...e,currentPath:[...e.currentPath,"allOf",t?"1":"0"]});return{allOf:[t,r].filter(s=>s!==void 0)}};function c5(n,e){return qe(n.type._def,e)}function d5(n,e){const r={type:"array",uniqueItems:!0,items:qe(n.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return n.minSize&&Xe(r,"minItems",n.minSize.value,n.minSize.message,e),n.maxSize&&Xe(r,"maxItems",n.maxSize.value,n.maxSize.message,e),r}function f5(n,e){return n.rest?{type:"array",minItems:n.items.length,items:n.items.map((t,r)=>qe(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[]),additionalItems:qe(n.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:n.items.length,maxItems:n.items.length,items:n.items.map((t,r)=>qe(t._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((t,r)=>r===void 0?t:[...t,r],[])}}function h5(){return{not:{}}}function p5(){return{}}const m5=(n,e)=>qe(n.innerType._def,e);function qe(n,e,t=!1){var o;const r=e.seen.get(n);if(e.override){const u=(o=e.override)==null?void 0:o.call(e,n,e,r,t);if(u!==j9)return u}if(r&&!t){const u=g5(r,e);if(u!==void 0)return"$ref"in u&&e.seenRefs.add(u.$ref),u}const s={def:n,path:e.currentPath,jsonSchema:void 0};e.seen.set(n,s);const a=_5(n,n.typeName,e,t);return a&&w5(n,e,a),s.jsonSchema=a,a}const g5=(n,e)=>{switch(e.$refStrategy){case"root":return{$ref:n.path.join("/")};case"extract-to-root":const t=n.path.slice(e.basePath.length+1).join("_");return t!==e.name&&e.nameStrategy==="duplicate-ref"&&(e.definitions[t]=n.def),{$ref:[...e.basePath,e.definitionPath,t].join("/")};case"relative":return{$ref:y5(e.currentPath,n.path)};case"none":case"seen":return n.path.length<e.currentPath.length&&n.path.every((r,s)=>e.currentPath[s]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},y5=(n,e)=>{let t=0;for(;t<n.length&&t<e.length&&n[t]===e[t];t++);return[(n.length-t).toString(),...e.slice(t)].join("/")},_5=(n,e,t,r)=>{switch(e){case Z.ZodString:return Tk(n,t);case Z.ZodNumber:return a5(n,t);case Z.ZodObject:return o5(n,t);case Z.ZodBigInt:return z9(n,t);case Z.ZodBoolean:return B9();case Z.ZodDate:return Ok(n,t);case Z.ZodUndefined:return h5();case Z.ZodNull:return n5(t);case Z.ZodArray:return U9(n,t);case Z.ZodUnion:case Z.ZodDiscriminatedUnion:return r5(n,t);case Z.ZodIntersection:return K9(n,t);case Z.ZodTuple:return f5(n,t);case Z.ZodRecord:return Ak(n,t);case Z.ZodLiteral:return X9(n,t);case Z.ZodEnum:return G9(n);case Z.ZodNativeEnum:return e5(n);case Z.ZodNullable:return s5(n,t);case Z.ZodOptional:return l5(n,t);case Z.ZodMap:return Q9(n,t);case Z.ZodSet:return d5(n,t);case Z.ZodLazy:return qe(n.getter()._def,t);case Z.ZodPromise:return c5(n,t);case Z.ZodNaN:case Z.ZodNever:return t5();case Z.ZodEffects:return Z9(n,t,r);case Z.ZodAny:return F9();case Z.ZodUnknown:return p5();case Z.ZodDefault:return q9(n,t);case Z.ZodBranded:return H9(n,t);case Z.ZodReadonly:return m5(n,t);case Z.ZodCatch:return V9(n,t);case Z.ZodPipeline:return u5(n,t);case Z.ZodFunction:case Z.ZodVoid:case Z.ZodSymbol:return;default:return(s=>{})()}},w5=(n,e,t)=>(n.description&&(t.description=n.description,e.markdownDescription&&(t.markdownDescription=n.description)),t),b5=(n,e)=>{const t=D9(e),r=typeof e=="string"?e:(e==null?void 0:e.nameStrategy)==="title"||e==null?void 0:e.name,s=qe(n._def,r===void 0?t:{...t,currentPath:[...t.basePath,t.definitionPath,r]},!1)??{},a=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;a!==void 0&&(s.title=a);const o=(()=>{if(M9(t.definitions))return;const c={},f=new Set;for(let h=0;h<500;h++){const m=Object.entries(t.definitions).filter(([g])=>!f.has(g));if(m.length===0)break;for(const[g,y]of m)c[g]=qe(wy(y),{...t,currentPath:[...t.basePath,t.definitionPath,g]},!0)??{},f.add(g)}return c})(),u=r===void 0?o?{...s,[t.definitionPath]:o}:s:t.nameStrategy==="duplicate-ref"?{...s,...o||t.seenRefs.size?{[t.definitionPath]:{...o,...t.seenRefs.size?{[r]:s}:void 0}}:void 0}:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,r].join("/"),[t.definitionPath]:{...o,[r]:s}};return t.target==="jsonSchema7"?u.$schema="http://json-schema.org/draft-07/schema#":t.target==="jsonSchema2019-09"&&(u.$schema="https://json-schema.org/draft/2019-09/schema#"),u};function v5(n,e){return b5(n,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function x5(n,e,t){return i9({type:"json_schema",json_schema:{...t,name:e,strict:!0,schema:v5(n,{name:e})}},r=>n.parse(JSON.parse(r)))}function S5(n){const{azureOpenAIApiDeploymentName:e,azureOpenAIApiInstanceName:t,azureOpenAIApiKey:r,azureOpenAIBasePath:s,baseURL:a,azureADTokenProvider:o,azureOpenAIEndpoint:u}=n;if((r||o)&&s&&e)return`${s}/${e}`;if((r||o)&&u&&e)return`${u}/openai/deployments/${e}`;if(r||o){if(!t)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${t}.openai.azure.com/openai/deployments/${e}`}return a}function hd(n,e){return n.lc_error_code=e,n.message=`${n.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,n}function Pg(n){let e;return n.constructor.name===jf.name?(e=new Error(n.message),e.name="TimeoutError"):n.constructor.name===Bn.name?(e=new Error(n.message),e.name="AbortError"):n.status===400&&n.message.includes("tool_calls")?e=hd(n,"INVALID_TOOL_RESULTS"):n.status===401?e=hd(n,"MODEL_AUTHENTICATION"):n.status===429?e=hd(n,"MODEL_RATE_LIMIT"):n.status===404?e=hd(n,"MODEL_NOT_FOUND"):e=n,e}function C1(n){if(n)return n==="any"||n==="required"?"required":n==="auto"?"auto":n==="none"?"none":typeof n=="string"?{type:"function",function:{name:n}}:n}function E5(n){return n.anyOf!==void 0&&Array.isArray(n.anyOf)}function C5(n){const e=["namespace functions {",""];for(const t of n)t.description&&e.push(`// ${t.description}`),Object.keys(t.parameters.properties??{}).length>0?(e.push(`type ${t.name} = (_: {`),e.push($k(t.parameters,0)),e.push("}) => any;")):e.push(`type ${t.name} = () => any;`),e.push("");return e.push("} // namespace functions"),e.join(`
`)}function $k(n,e){var r;const t=[];for(const[s,a]of Object.entries(n.properties??{}))a.description&&e<2&&t.push(`// ${a.description}`),(r=n.required)!=null&&r.includes(s)?t.push(`${s}: ${ef(a,e)},`):t.push(`${s}?: ${ef(a,e)},`);return t.map(s=>" ".repeat(e)+s).join(`
`)}function ef(n,e){if(E5(n))return n.anyOf.map(t=>ef(t,e)).join(" | ");switch(n.type){case"string":return n.enum?n.enum.map(t=>`"${t}"`).join(" | "):"string";case"number":return n.enum?n.enum.map(t=>`${t}`).join(" | "):"number";case"integer":return n.enum?n.enum.map(t=>`${t}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",$k(n,e+2),"}"].join(`
`);case"array":return n.items?`${ef(n.items,e)}[]`:"any[]";default:return""}}function P5(n,e){let t;return mP(n)?t=ay(n):t=n,(e==null?void 0:e.strict)!==void 0&&(t.function.strict=e.strict),t}function k5(n){return n.role!=="system"&&n.role!=="developer"&&n.role!=="assistant"&&n.role!=="user"&&n.role!=="function"&&n.role!=="tool"&&console.warn(`Unknown message role: ${n.role}`),n.role}function Sw(n){const e=n._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!Su.isInstance(n))throw new Error("Invalid generic chat message");return k5(n)}default:throw new Error(`Unknown message type: ${e}`)}}function P1(n,e){return n.flatMap(t=>{var a;let r=Sw(t);r==="system"&&Ew(e)&&(r="developer");const s={role:r,content:t.content};if(t.name!=null&&(s.name=t.name),t.additional_kwargs.function_call!=null&&(s.function_call=t.additional_kwargs.function_call,s.content=""),xu(t)&&((a=t.tool_calls)!=null&&a.length)?(s.tool_calls=t.tool_calls.map(I9),s.content=""):(t.additional_kwargs.tool_calls!=null&&(s.tool_calls=t.additional_kwargs.tool_calls),t.tool_call_id!=null&&(s.tool_call_id=t.tool_call_id)),t.additional_kwargs.audio&&typeof t.additional_kwargs.audio=="object"&&"id"in t.additional_kwargs.audio){const o={role:"assistant",audio:{id:t.additional_kwargs.audio.id}};return[s,o]}return s})}const Zi="__openai_function_call_ids__";function k1(n,e){return n.flatMap(t=>{var a,o,u;let r=Sw(t);if(r==="system"&&Ew(e)&&(r="developer"),r==="function")throw new Error("Function messages are not supported in Responses API");if(r==="tool"){const c=t;return((a=c.additional_kwargs)==null?void 0:a.type)==="computer_call_output"?{type:"computer_call_output",output:(()=>{if(typeof c.content=="string")return{type:"computer_screenshot",image_url:c.content};if(Array.isArray(c.content)){const h=c.content.find(g=>g.type==="computer_screenshot");if(h)return h;const m=c.content.find(g=>g.type==="image_url");if(m)return{type:"computer_screenshot",image_url:typeof m.image_url=="string"?m.image_url:m.image_url.url}}throw new Error("Invalid computer call output")})(),call_id:c.tool_call_id}:{type:"function_call_output",call_id:c.tool_call_id,id:c.id,output:typeof c.content!="string"?JSON.stringify(c.content):c.content}}if(r==="assistant"){const c=[];t.additional_kwargs.reasoning!=null&&(y=>typeof y=="object"&&y!=null&&"type"in y&&y.type==="reasoning")(t.additional_kwargs.reasoning)&&c.push(t.additional_kwargs.reasoning);let{content:f}=t;t.additional_kwargs.refusal!=null&&(typeof f=="string"&&(f=[{type:"output_text",text:f,annotations:[]}]),f=[...f,{type:"refusal",refusal:t.additional_kwargs.refusal}]),c.push({type:"message",role:"assistant",content:typeof f=="string"?f:f.flatMap(g=>g.type==="text"?{type:"output_text",text:g.text,annotations:g.annotations??[]}:g.type==="output_text"||g.type==="refusal"?g:[])});const h=t.additional_kwargs[Zi];xu(t)&&((o=t.tool_calls)!=null&&o.length)?c.push(...t.tool_calls.map(g=>({type:"function_call",name:g.name,arguments:JSON.stringify(g.args),call_id:g.id,id:h==null?void 0:h[g.id]}))):t.additional_kwargs.tool_calls!=null&&c.push(...t.additional_kwargs.tool_calls.map(g=>({type:"function_call",name:g.function.name,call_id:g.id,id:h==null?void 0:h[g.id],arguments:g.function.arguments})));const m=(u=t.response_metadata.output)!=null&&u.length?t.response_metadata.output:t.additional_kwargs.tool_outputs;if(m!=null){const g=m,y=g==null?void 0:g.filter(v=>v.type==="reasoning"),w=g==null?void 0:g.filter(v=>v.type==="computer_call");y.length>0&&w.length>0&&c.push(...y),w.length>0&&c.push(...w)}return c}const s=typeof t.content=="string"?t.content:t.content.flatMap(c=>{if(c.type==="text")return{type:"input_text",text:c.text};if(c.type==="image_url"){const f=typeof c.image_url=="string"?c.image_url:c.image_url.url,h=typeof c.image_url=="string"?"auto":c.image_url.detail;return{type:"input_image",image_url:f,detail:h}}return c.type==="input_text"||c.type==="input_image"||c.type==="input_file"?c:[]});return r==="user"||r==="system"||r==="developer"?{type:"message",role:r,content:s}:(console.warn(`Unsupported role found when converting to OpenAI Responses API: ${r}`),[])})}function Ik(n){if(n.error){const o=new Error(n.error.message);throw o.name=n.error.code,o}const e=[],t=[],r=[],s={model:n.model,created_at:n.created_at,id:n.id,incomplete_details:n.incomplete_details,metadata:n.metadata,object:n.object,status:n.status,user:n.user,model_name:n.model},a={};for(const o of n.output)if(o.type==="message")e.push(...o.content.flatMap(u=>u.type==="output_text"?("parsed"in u&&u.parsed!=null&&(a.parsed=u.parsed),{type:"text",text:u.text,annotations:u.annotations}):u.type==="refusal"?(a.refusal=u.refusal,[]):u));else if(o.type==="function_call"){const u={function:{name:o.name,arguments:o.arguments},id:o.call_id};try{t.push(xw(u,{returnId:!0}))}catch(c){let f;typeof c=="object"&&c!=null&&"message"in c&&typeof c.message=="string"&&(f=c.message),r.push(kk(u,f))}a[Zi]??(a[Zi]={}),o.id&&(a[Zi][o.call_id]=o.id)}else o.type==="reasoning"?a.reasoning=o:(a.tool_outputs??(a.tool_outputs=[]),a.tool_outputs.push(o));return new Ka({id:n.id,content:e,tool_calls:t,invalid_tool_calls:r,usage_metadata:n.usage,additional_kwargs:a,response_metadata:s})}function R5(n){var c,f;const e=[];let t={},r;const s=[],a={},o={};let u;if(n.type==="response.output_text.delta")e.push({type:"text",text:n.delta,index:n.content_index});else if(n.type==="response.output_text.annotation.added")e.push({type:"text",text:"",annotations:[n.annotation],index:n.content_index});else if(n.type==="response.output_item.added"&&n.item.type==="message")u=n.item.id;else if(n.type==="response.output_item.added"&&n.item.type==="function_call")s.push({type:"tool_call_chunk",name:n.item.name,args:n.item.arguments,id:n.item.id,index:n.output_index}),o[Zi]={[n.item.call_id]:n.item.id};else if(n.type==="response.output_item.done"&&(n.item.type==="web_search_call"||n.item.type==="file_search_call"||n.item.type==="computer_call"))o.tool_outputs=[n.item];else if(n.type==="response.created")a.id=n.response.id,a.model_name=n.response.model,a.model=n.response.model;else if(n.type==="response.completed"){const h=Ik(n.response);r=n.response.usage,((f=(c=n.response.text)==null?void 0:c.format)==null?void 0:f.type)==="json_schema"&&(o.parsed??(o.parsed=JSON.parse(h.text)));for(const[m,g]of Object.entries(n.response))m!=="id"&&(a[m]=g)}else if(n.type==="response.function_call_arguments.delta")s.push({type:"tool_call_chunk",args:n.delta,index:n.output_index});else if(n.type==="response.web_search_call.completed"||n.type==="response.file_search_call.completed")t={tool_outputs:{id:n.item_id,type:n.type.replace("response.","").replace(".completed",""),status:"completed"}};else if(n.type==="response.refusal.done")o.refusal=n.refusal;else return null;return new Qr({text:e.map(h=>h.text).join(""),message:new ns({id:u,content:e,tool_call_chunks:s,usage_metadata:r,additional_kwargs:o,response_metadata:a}),generationInfo:t})}function kg(n){return"type"in n&&n.type!=="function"}function O5(n){return n!=null&&typeof n=="object"&&"type"in n&&n.type!=="function"}function R1(n,e){return cP(n)?(e==null?void 0:e.strict)!==void 0?{...n,function:{...n.function,strict:e.strict}}:n:P5(n,e)}function Ew(n){return(n==null?void 0:n.startsWith("o1"))||(n==null?void 0:n.startsWith("o3"))||(n==null?void 0:n.startsWith("o4"))}class O1 extends Cs{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning_effort"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key"}}get lc_serializable_keys(){return["configuration","logprobs","topLogprobs","prefixMessages","supportsStrictToolCalling","modalities","audio","reasoningEffort","temperature","maxTokens","topP","frequencyPenalty","presencePenalty","n","logitBias","user","streaming","streamUsage","modelName","model","modelKwargs","stop","stopSequences","timeout","openAIApiKey","apiKey","cache","maxConcurrency","maxRetries","verbose","callbacks","tags","metadata","disableStreaming"]}constructor(e){var t,r;super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoningEffort",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"useResponsesApi",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.openAIApiKey=(e==null?void 0:e.apiKey)??(e==null?void 0:e.openAIApiKey)??((t=e==null?void 0:e.configuration)==null?void 0:t.apiKey)??Yr("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.organization=((r=e==null?void 0:e.configuration)==null?void 0:r.organization)??Yr("OPENAI_ORGANIZATION"),this.model=(e==null?void 0:e.model)??(e==null?void 0:e.modelName)??this.model,this.modelName=this.model,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.logprobs=e==null?void 0:e.logprobs,this.topLogprobs=e==null?void 0:e.topLogprobs,this.n=(e==null?void 0:e.n)??this.n,this.logitBias=e==null?void 0:e.logitBias,this.stop=(e==null?void 0:e.stopSequences)??(e==null?void 0:e.stop),this.stopSequences=this.stop,this.user=e==null?void 0:e.user,this.__includeRawResponse=e==null?void 0:e.__includeRawResponse,this.audio=e==null?void 0:e.audio,this.modalities=e==null?void 0:e.modalities,this.reasoningEffort=e==null?void 0:e.reasoningEffort,this.maxTokens=(e==null?void 0:e.maxCompletionTokens)??(e==null?void 0:e.maxTokens),this.useResponsesApi=(e==null?void 0:e.useResponsesApi)??this.useResponsesApi,this.disableStreaming=(e==null?void 0:e.disableStreaming)??this.disableStreaming,this.model==="o1"&&(this.disableStreaming=!0),this.streaming=(e==null?void 0:e.streaming)??!1,this.disableStreaming&&(this.streaming=!1),this.streamUsage=(e==null?void 0:e.streamUsage)??this.streamUsage,this.disableStreaming&&(this.streamUsage=!1),this.clientConfig={apiKey:this.apiKey,organization:this.organization,dangerouslyAllowBrowser:!0,...e==null?void 0:e.configuration},(e==null?void 0:e.supportsStrictToolCalling)!==void 0&&(this.supportsStrictToolCalling=e.supportsStrictToolCalling)}getLsParams(e){const t=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:t.temperature??void 0,ls_max_tokens:t.max_tokens??void 0,ls_stop:e.stop}}bindTools(e,t){let r;return(t==null?void 0:t.strict)!==void 0?r=t.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling),this.bind({tools:e.map(s=>kg(s)?s:R1(s,{strict:r})),...t})}createResponseFormat(e){return e&&e.type==="json_schema"&&e.json_schema.schema&&pd(e.json_schema.schema)?x5(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}invocationParams(e,t){var u,c;let r;if((e==null?void 0:e.strict)!==void 0?r=e.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling),this._useResponseApi(e)){const f={model:this.model,temperature:this.temperature,top_p:this.topP,user:this.user,stream:this.streaming,previous_response_id:e==null?void 0:e.previous_response_id,truncation:e==null?void 0:e.truncation,include:e==null?void 0:e.include,tools:(u=e==null?void 0:e.tools)!=null&&u.length?e.tools.map(m=>kg(m)?m:cP(m)?{type:"function",name:m.function.name,parameters:m.function.parameters,description:m.function.description,strict:r}:null).filter(m=>m!==null):void 0,tool_choice:O5(e==null?void 0:e.tool_choice)?e==null?void 0:e.tool_choice:(()=>{const m=C1(e==null?void 0:e.tool_choice);if(typeof m=="object"&&"type"in m)return{type:"function",name:m.function.name}})(),text:(()=>{if(e!=null&&e.text)return e.text;const m=this.createResponseFormat(e==null?void 0:e.response_format);return(m==null?void 0:m.type)==="json_schema"?m.json_schema.schema!=null?{format:{type:"json_schema",schema:m.json_schema.schema,description:m.json_schema.description,name:m.json_schema.name,strict:m.json_schema.strict}}:void 0:{format:m}})(),parallel_tool_calls:e==null?void 0:e.parallel_tool_calls,max_output_tokens:this.maxTokens===-1?void 0:this.maxTokens,...this.modelKwargs},h=(e==null?void 0:e.reasoning_effort)??this.reasoningEffort;return h!==void 0&&(f.reasoning={effort:h}),f}let s={};(e==null?void 0:e.stream_options)!==void 0?s={stream_options:e.stream_options}:this.streamUsage&&(this.streaming||t!=null&&t.streaming)&&(s={stream_options:{include_usage:!0}});const a={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:(e==null?void 0:e.stop)??this.stopSequences,user:this.user,stream:this.streaming,functions:e==null?void 0:e.functions,function_call:e==null?void 0:e.function_call,tools:(c=e==null?void 0:e.tools)!=null&&c.length?e.tools.map(f=>R1(f,{strict:r})):void 0,tool_choice:C1(e==null?void 0:e.tool_choice),response_format:this.createResponseFormat(e==null?void 0:e.response_format),seed:e==null?void 0:e.seed,...s,parallel_tool_calls:e==null?void 0:e.parallel_tool_calls,...this.audio||e!=null&&e.audio?{audio:this.audio||(e==null?void 0:e.audio)}:{},...this.modalities||e!=null&&e.modalities?{modalities:this.modalities||(e==null?void 0:e.modalities)}:{},...this.modelKwargs};(e==null?void 0:e.prediction)!==void 0&&(a.prediction=e.prediction);const o=(e==null?void 0:e.reasoning_effort)??this.reasoningEffort;return o!==void 0&&(a.reasoning_effort=o),Ew(a.model)?a.max_completion_tokens=this.maxTokens===-1?void 0:this.maxTokens:a.max_tokens=this.maxTokens===-1?void 0:this.maxTokens,a}_convertOpenAIChatCompletionMessageToBaseMessage(e,t){const r=e.tool_calls;switch(e.role){case"assistant":{const s=[],a=[];for(const c of r??[])try{s.push(xw(c,{returnId:!0}))}catch(f){a.push(kk(c,f.message))}const o={function_call:e.function_call,tool_calls:r};this.__includeRawResponse!==void 0&&(o.__raw_response=t);const u={model_name:t.model,...t.system_fingerprint?{usage:{...t.usage},system_fingerprint:t.system_fingerprint}:{}};return e.audio&&(o.audio=e.audio),new Ka({content:e.content||"",tool_calls:s,invalid_tool_calls:a,additional_kwargs:o,response_metadata:u,id:t.id})}default:return new Su(e.content||"",e.role??"unknown")}}_convertOpenAIDeltaToBaseMessageChunk(e,t,r){var c,f;const s=e.role??r,a=e.content??"";let o;e.function_call?o={function_call:e.function_call}:e.tool_calls?o={tool_calls:e.tool_calls}:o={},this.__includeRawResponse&&(o.__raw_response=t),e.audio&&(o.audio={...e.audio,index:t.choices[0].index});const u={usage:{...t.usage}};if(s==="user")return new Cf({content:a,response_metadata:u});if(s==="assistant"){const h=[];if(Array.isArray(e.tool_calls))for(const m of e.tool_calls)h.push({name:(c=m.function)==null?void 0:c.name,args:(f=m.function)==null?void 0:f.arguments,id:m.id,index:m.index,type:"tool_call_chunk"});return new ns({content:a,tool_call_chunks:h,additional_kwargs:o,id:t.id,response_metadata:u})}else return s==="system"?new ql({content:a,response_metadata:u}):s==="developer"?new ql({content:a,response_metadata:u,additional_kwargs:{__openai_role__:"developer"}}):s==="function"?new Ef({content:a,additional_kwargs:o,name:e.name,response_metadata:u}):s==="tool"?new S_({content:a,additional_kwargs:o,tool_call_id:e.tool_call_id,response_metadata:u}):new Sf({content:a,role:s,response_metadata:u})}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(e,t,r){var f,h,m,g,y,w,v,x,E,k;if(this._useResponseApi(t)){const S=await this.responseApiWithRetry({...this.invocationParams(t,{streaming:!0}),input:k1(e,this.model),stream:!0},t);for await(const R of S){const A=R5(R);A!=null&&(yield A)}return}const s=P1(e,this.model),a={...this.invocationParams(t,{streaming:!0}),messages:s,stream:!0};let o;const u=await this.completionWithRetry(a,t);let c;for await(const S of u){const R=(f=S==null?void 0:S.choices)==null?void 0:f[0];if(S.usage&&(c=S.usage),!R)continue;const{delta:A}=R;if(!A)continue;const I=this._convertOpenAIDeltaToBaseMessageChunk(A,S,o);o=A.role??o;const M={prompt:t.promptIndex??0,completion:R.index??0};if(typeof I.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const D={...M};R.finish_reason!=null&&(D.finish_reason=R.finish_reason,D.system_fingerprint=S.system_fingerprint,D.model_name=S.model),this.logprobs&&(D.logprobs=R.logprobs);const K=new Qr({message:I,text:I.content,generationInfo:D});yield K,await(r==null?void 0:r.handleLLMNewToken(K.text??"",M,void 0,void 0,void 0,{chunk:K}))}if(c){const S={...((h=c.prompt_tokens_details)==null?void 0:h.audio_tokens)!==null&&{audio:(m=c.prompt_tokens_details)==null?void 0:m.audio_tokens},...((g=c.prompt_tokens_details)==null?void 0:g.cached_tokens)!==null&&{cache_read:(y=c.prompt_tokens_details)==null?void 0:y.cached_tokens}},R={...((w=c.completion_tokens_details)==null?void 0:w.audio_tokens)!==null&&{audio:(v=c.completion_tokens_details)==null?void 0:v.audio_tokens},...((x=c.completion_tokens_details)==null?void 0:x.reasoning_tokens)!==null&&{reasoning:(E=c.completion_tokens_details)==null?void 0:E.reasoning_tokens}};yield new Qr({message:new ns({content:"",response_metadata:{usage:{...c}},usage_metadata:{input_tokens:c.prompt_tokens,output_tokens:c.completion_tokens,total_tokens:c.total_tokens,...Object.keys(S).length>0&&{input_token_details:S},...Object.keys(R).length>0&&{output_token_details:R}}}),text:""})}if((k=t.signal)!=null&&k.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _responseApiGenerate(e,t,r){var u;const s=this.invocationParams(t);if(s.stream){const c=this._streamResponseChunks(e,t,r);let f;for await(const h of c)h.message.response_metadata={...h.generationInfo,...h.message.response_metadata},f=(f==null?void 0:f.concat(h))??h;return{generations:f?[f]:[],llmOutput:{estimatedTokenUsage:(u=f==null?void 0:f.message)==null?void 0:u.usage_metadata}}}const a=k1(e,this.model),o=await this.responseApiWithRetry({input:a,...s},{signal:t==null?void 0:t.signal,...t==null?void 0:t.options});return{generations:[{text:o.output_text,message:Ik(o)}],llmOutput:{id:o.id,estimatedTokenUsage:o.usage?{promptTokens:o.usage.input_tokens,completionTokens:o.usage.output_tokens,totalTokens:o.usage.total_tokens}:void 0}}}_useResponseApi(e){var s;const t=(s=e==null?void 0:e.tools)==null?void 0:s.some(kg),r=(e==null?void 0:e.previous_response_id)!=null||(e==null?void 0:e.text)!=null||(e==null?void 0:e.truncation)!=null||(e==null?void 0:e.include)!=null;return this.useResponsesApi||t||r}async _generate(e,t,r){var u,c;if(this._useResponseApi(t))return this._responseApiGenerate(e,t,r);const s={},a=this.invocationParams(t),o=P1(e,this.model);if(a.stream){const f=this._streamResponseChunks(e,t,r),h={};for await(const x of f){x.message.response_metadata={...x.generationInfo,...x.message.response_metadata};const E=((u=x.generationInfo)==null?void 0:u.completion)??0;h[E]===void 0?h[E]=x:h[E]=h[E].concat(x)}const m=Object.entries(h).sort(([x],[E])=>parseInt(x,10)-parseInt(E,10)).map(([x,E])=>E),{functions:g,function_call:y}=this.invocationParams(t),w=await this.getEstimatedTokenCountFromPrompt(e,g,y),v=await this.getNumTokensFromGenerations(m);return s.input_tokens=w,s.output_tokens=v,s.total_tokens=w+v,{generations:m,llmOutput:{estimatedTokenUsage:{promptTokens:s.input_tokens,completionTokens:s.output_tokens,totalTokens:s.total_tokens}}}}else{let f;t.response_format&&t.response_format.type==="json_schema"?f=await this.betaParsedCompletionWithRetry({...a,stream:!1,messages:o},{signal:t==null?void 0:t.signal,...t==null?void 0:t.options}):f=await this.completionWithRetry({...a,stream:!1,messages:o},{signal:t==null?void 0:t.signal,...t==null?void 0:t.options});const{completion_tokens:h,prompt_tokens:m,total_tokens:g,prompt_tokens_details:y,completion_tokens_details:w}=(f==null?void 0:f.usage)??{};h&&(s.output_tokens=(s.output_tokens??0)+h),m&&(s.input_tokens=(s.input_tokens??0)+m),g&&(s.total_tokens=(s.total_tokens??0)+g),((y==null?void 0:y.audio_tokens)!==null||(y==null?void 0:y.cached_tokens)!==null)&&(s.input_token_details={...(y==null?void 0:y.audio_tokens)!==null&&{audio:y==null?void 0:y.audio_tokens},...(y==null?void 0:y.cached_tokens)!==null&&{cache_read:y==null?void 0:y.cached_tokens}}),((w==null?void 0:w.audio_tokens)!==null||(w==null?void 0:w.reasoning_tokens)!==null)&&(s.output_token_details={...(w==null?void 0:w.audio_tokens)!==null&&{audio:w==null?void 0:w.audio_tokens},...(w==null?void 0:w.reasoning_tokens)!==null&&{reasoning:w==null?void 0:w.reasoning_tokens}});const v=[];for(const x of(f==null?void 0:f.choices)??[]){const k={text:((c=x.message)==null?void 0:c.content)??"",message:this._convertOpenAIChatCompletionMessageToBaseMessage(x.message??{role:"assistant"},f)};k.generationInfo={...x.finish_reason?{finish_reason:x.finish_reason}:{},...x.logprobs?{logprobs:x.logprobs}:{}},xu(k.message)&&(k.message.usage_metadata=s),k.message=new Ka(Object.fromEntries(Object.entries(k.message).filter(([S])=>!S.startsWith("lc_")))),v.push(k)}return{generations:v,llmOutput:{tokenUsage:{promptTokens:s.input_tokens,completionTokens:s.output_tokens,totalTokens:s.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(e,t,r){let s=(await this.getNumTokensFromMessages(e)).totalCount;if(t&&r!=="auto"){const a=C5(t);s+=await this.getNumTokens(a),s+=9}return t&&e.find(a=>a._getType()==="system")&&(s-=4),r==="none"?s+=1:typeof r=="object"&&(s+=await this.getNumTokens(r.name)+4),s}async getNumTokensFromGenerations(e){return(await Promise.all(e.map(async r=>{var s;return(s=r.message.additional_kwargs)!=null&&s.function_call?(await this.getNumTokensFromMessages([r.message])).countPerMessage[0]:await this.getNumTokens(r.message.content)}))).reduce((r,s)=>r+s,0)}async getNumTokensFromMessages(e){let t=0,r=0,s=0;this.model==="gpt-3.5-turbo-0301"?(r=4,s=-1):(r=3,s=1);const a=await Promise.all(e.map(async o=>{var g,y,w,v,x,E;const u=await this.getNumTokens(o.content),c=await this.getNumTokens(Sw(o)),f=o.name!==void 0?s+await this.getNumTokens(o.name):0;let h=u+r+c+f;const m=o;if(m._getType()==="function"&&(h-=2),(g=m.additional_kwargs)!=null&&g.function_call&&(h+=3),(y=m==null?void 0:m.additional_kwargs.function_call)!=null&&y.name&&(h+=await this.getNumTokens((w=m.additional_kwargs.function_call)==null?void 0:w.name)),(v=m.additional_kwargs.function_call)!=null&&v.arguments)try{h+=await this.getNumTokens(JSON.stringify(JSON.parse((x=m.additional_kwargs.function_call)==null?void 0:x.arguments)))}catch(k){console.error("Error parsing function arguments",k,JSON.stringify(m.additional_kwargs.function_call)),h+=await this.getNumTokens((E=m.additional_kwargs.function_call)==null?void 0:E.arguments)}return t+=h,h}));return t+=3,{totalCount:t,countPerMessage:a}}async completionWithRetry(e,t){const r=this._getClientOptions(t);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(e,r)}catch(s){throw Pg(s)}})}async responseApiWithRetry(e,t){return this.caller.call(async()=>{var s,a;const r=this._getClientOptions(t);try{return((a=(s=e.text)==null?void 0:s.format)==null?void 0:a.type)==="json_schema"&&!e.stream?await this.client.responses.parse(e,r):await this.client.responses.create(e,r)}catch(o){throw Pg(o)}})}async betaParsedCompletionWithRetry(e,t){const r=this._getClientOptions(t);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(e,r)}catch(s){throw Pg(s)}})}_getClientOptions(e){if(!this.client){const r={baseURL:this.clientConfig.baseURL},s=S5(r),a={...this.clientConfig,baseURL:s,timeout:this.timeout,maxRetries:0};a.baseURL||delete a.baseURL,this.client=new Le(a)}return{...this.clientConfig,...e}}_llmType(){return"openai"}_combineLLMOutput(...e){return e.reduce((t,r)=>(r&&r.tokenUsage&&(t.tokenUsage.completionTokens+=r.tokenUsage.completionTokens??0,t.tokenUsage.promptTokens+=r.tokenUsage.promptTokens??0,t.tokenUsage.totalTokens+=r.tokenUsage.totalTokens??0),t),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(e,t){let r,s,a,o;T5(e)?(r=e.schema,s=e.name,a=e.method,o=e.includeRaw):(r=e,s=t==null?void 0:t.name,a=t==null?void 0:t.method,o=t==null?void 0:t.includeRaw);let u,c;if((t==null?void 0:t.strict)!==void 0&&a==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(!this.model.startsWith("gpt-3")&&!this.model.startsWith("gpt-4-")&&this.model!=="gpt-4"?a===void 0&&(a="jsonSchema"):a==="jsonSchema"&&console.warn(`[WARNING]: JSON Schema is not supported for model "${this.model}". Falling back to tool calling.`),a==="jsonMode")u=this.bind({response_format:{type:"json_object"}}),pd(r)?c=w1.fromZodSchema(r):c=new b1;else if(a==="jsonSchema")if(u=this.bind({response_format:{type:"json_schema",json_schema:{name:s??"extract",description:r.description,schema:r,strict:t==null?void 0:t.strict}}}),pd(r)){const g=w1.fromZodSchema(r);c=Eo.from(y=>"parsed"in y.additional_kwargs?y.additional_kwargs.parsed:g)}else c=new b1;else{let g=s??"extract";if(pd(r)){const y=Ru(r);u=this.bind({tools:[{type:"function",function:{name:g,description:y.description,parameters:y}}],tool_choice:{type:"function",function:{name:g}},...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}),c=new v1({returnSingle:!0,keyName:g,zodSchema:r})}else{let y;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(y=r,g=r.name):(g=r.title??g,y={name:g,description:r.description??"",parameters:r}),u=this.bind({tools:[{type:"function",function:y}],tool_choice:{type:"function",function:{name:g}},...(t==null?void 0:t.strict)!==void 0?{strict:t.strict}:{}}),c=new v1({returnSingle:!0,keyName:g})}}if(!o)return u.pipe(c);const f=Gd.assign({parsed:(g,y)=>c.invoke(g.raw,y)}),h=Gd.assign({parsed:()=>null}),m=f.withFallbacks({fallbacks:[h]});return Ps.from([{raw:u},m])}}function pd(n){return typeof(n==null?void 0:n.parse)=="function"}function T5(n){return n!==void 0&&typeof n.schema=="object"}const A5=({chapters:n,onChapterChange:e,onSceneChange:t,handleClearChapters:r,loading:s})=>O.jsxs(ke,{children:[O.jsxs(mn,{justify:"space-between",align:"center",mb:"xs",children:[O.jsx(tr,{order:4,children:""}),O.jsx(Pr,{variant:"outline",color:"gray",size:"xs",onClick:r,disabled:s,children:"Clear Chapters"})]}),O.jsx(za,{gap:"lg",children:n.map((a,o)=>O.jsxs(ke,{p:"md",bd:"1px solid gray",style:{borderRadius:"4px"},children:[O.jsxs(tr,{order:5,mb:"sm",children:["",a.id,""]}),O.jsx(it,{label:"",value:a.summary||"",onChange:u=>e(o,"summary",u.currentTarget.value),autosize:!0,minRows:2,mb:"xs"}),O.jsx(it,{label:"",value:a.goal||"",onChange:u=>e(o,"goal",u.currentTarget.value),autosize:!0,minRows:2,mb:"md"}),O.jsx(rt,{label:"",value:a.title,onChange:u=>e(o,"title",u.currentTarget.value),mb:"md"}),O.jsx(tr,{order:6,mb:"xs",children:""}),O.jsx(za,{gap:"md",children:a.scenes.map((u,c)=>{var f;return O.jsxs(ke,{p:"sm",bd:"1px solid gray",style:{borderRadius:"4px"},children:[O.jsxs(tr,{order:6,mb:"xs",children:[" ",u.id]}),O.jsx(it,{value:u.content,onChange:h=>t(o,c,"content",h.currentTarget.value),autosize:!0,minRows:5,mb:"xs"}),O.jsx(it,{label:"",value:u.settingNotes||"",onChange:h=>t(o,c,"settingNotes",h.currentTarget.value),autosize:!0,minRows:1,mb:"xs"}),O.jsx(rt,{label:"",value:u.timeElapsed||"",onChange:h=>t(o,c,"timeElapsed",h.currentTarget.value),mb:"xs"}),O.jsx(it,{label:"",value:u.characterNotes||"",onChange:h=>t(o,c,"characterNotes",h.currentTarget.value),autosize:!0,minRows:1,mb:"xs"}),O.jsx(it,{label:"",value:u.foreshadowing||"",onChange:h=>t(o,c,"foreshadowing",h.currentTarget.value),autosize:!0,minRows:1,mb:"xs"}),O.jsx(it,{label:"",value:u.payoff||"",onChange:h=>t(o,c,"payoff",h.currentTarget.value),autosize:!0,minRows:1,mb:"xs"}),O.jsx(it,{label:" ()",value:((f=u.keyEvents)==null?void 0:f.join(`
`))||"",onChange:h=>t(o,c,"keyEvents",h.currentTarget.value),autosize:!0,minRows:2,mb:"xs"})]},u.id)})})]},a.id))})]}),$5=({characters:n,onChange:e,handleClearCharacters:t,loading:r})=>O.jsxs(ke,{mb:"md",children:[" ",O.jsxs(mn,{justify:"space-between",align:"center",mb:"xs",children:[O.jsx(tr,{order:4,children:""}),O.jsx(Pr,{variant:"outline",color:"gray",size:"xs",onClick:t,disabled:r,children:"Clear Characters"})]}),O.jsx(dt,{variant:"separated",children:n.map((s,a)=>O.jsxs(dt.Item,{value:`char-${s.id}`,children:[O.jsxs(dt.Control,{children:["#",s.id," ",s.name," (",s.role,")"]}),O.jsxs(dt.Panel,{children:[O.jsx(rt,{label:"",value:s.role,onChange:o=>e(a,"role",o.currentTarget.value),mb:"xs"}),O.jsx(rt,{label:"",value:s.name,onChange:o=>e(a,"name",o.currentTarget.value),mb:"xs"}),O.jsx(rt,{label:"",value:String(s.age??""),onChange:o=>e(a,"age",o.currentTarget.value),mb:"xs"}),O.jsx(rt,{label:"",value:s.sex,onChange:o=>e(a,"sex",o.currentTarget.value),mb:"xs"}),O.jsx(rt,{label:"",value:s.aliases||"",onChange:o=>e(a,"aliases",o.currentTarget.value),mb:"xs"}),O.jsx(it,{label:"",value:s.appearance,onChange:o=>e(a,"appearance",o.currentTarget.value),autosize:!0,minRows:2,mb:"xs"}),O.jsx(it,{label:"",value:s.personality,onChange:o=>e(a,"personality",o.currentTarget.value),autosize:!0,minRows:2,mb:"xs"}),O.jsx(it,{label:"",value:s.abilities||"",onChange:o=>e(a,"abilities",o.currentTarget.value),autosize:!0,minRows:2,mb:"xs"}),O.jsx(it,{label:"",value:s.backstory||"",onChange:o=>e(a,"backstory",o.currentTarget.value),autosize:!0,minRows:2,mb:"xs"}),O.jsx(it,{label:"",value:s.motivation||"",onChange:o=>e(a,"motivation",o.currentTarget.value),autosize:!0,minRows:2,mb:"xs"}),O.jsx(it,{label:"",value:s.goal||"",onChange:o=>e(a,"goal",o.currentTarget.value),autosize:!0,minRows:2,mb:"xs"}),O.jsx(it,{label:"",value:s.relationships||"",onChange:o=>e(a,"relationships",o.currentTarget.value),autosize:!0,minRows:2,mb:"xs"}),O.jsx(it,{label:"",value:s.flaws||"",onChange:o=>e(a,"flaws",o.currentTarget.value),autosize:!0,minRows:1,mb:"xs"}),O.jsx(it,{label:"",value:s.strengths||"",onChange:o=>e(a,"strengths",o.currentTarget.value),autosize:!0,minRows:1,mb:"xs"}),O.jsx(it,{label:"",value:s.belonging||"",onChange:o=>e(a,"belonging",o.currentTarget.value),autosize:!0,minRows:1,mb:"xs"}),O.jsx(it,{label:"",value:s.inner_conflict_arc||"",onChange:o=>e(a,"inner_conflict_arc",o.currentTarget.value),autosize:!0,minRows:3,mb:"md"})]})]},s.id))})]}),T1=n=>(n==null?void 0:n.map(e=>`${e.name}: ${e.description}`).join(`
`))||"",I5=({settings:n,onChange:e,onWorldBuildingChange:t,onWritingStyleChange:r,handleClearSettings:s,loading:a})=>{var o,u,c,f,h,m,g,y,w,v,x,E,k,S;return O.jsxs(ke,{mb:"md",children:[" ",O.jsxs(mn,{justify:"space-between",align:"center",mb:"xs",children:[O.jsx(tr,{order:5,children:""}),O.jsx(Pr,{variant:"outline",color:"gray",size:"xs",onClick:s,disabled:a,children:"Clear Settings"})]}),O.jsxs(za,{gap:"xs",mb:"md",children:[" ",O.jsx(rt,{label:"",value:n.theme,onChange:R=>e("theme",R.currentTarget.value)}),O.jsx(rt,{label:"",value:n.genre,onChange:R=>e("genre",R.currentTarget.value)}),O.jsx(rt,{label:"",value:n.era||"",onChange:R=>e("era",R.currentTarget.value)}),O.jsx(rt,{label:"",value:n.stage||"",onChange:R=>e("stage",R.currentTarget.value)}),O.jsx(rt,{label:"",value:n.logline||"",onChange:R=>e("logline",R.currentTarget.value)}),O.jsx(rt,{label:"",value:n.concept||"",onChange:R=>e("concept",R.currentTarget.value)})]}),O.jsxs(dt,{multiple:!0,defaultValue:["settings-worldbuilding"],children:[" ",O.jsxs(dt.Item,{value:"settings-worldbuilding",children:[O.jsx(dt.Control,{children:O.jsx(tr,{order:5,children:""})}),O.jsx(dt.Panel,{children:O.jsxs(za,{gap:"xs",mt:"xs",children:[" ",O.jsx(rt,{label:"",value:((o=n.worldBuilding)==null?void 0:o.governance)||"",onChange:R=>t("governance",R.currentTarget.value)}),O.jsx(rt,{label:"",value:((u=n.worldBuilding)==null?void 0:u.socialStructure)||"",onChange:R=>t("socialStructure",R.currentTarget.value)}),O.jsx(rt,{label:"",value:((c=n.worldBuilding)==null?void 0:c.economy)||"",onChange:R=>t("economy",R.currentTarget.value)}),O.jsx(rt,{label:"",value:((f=n.worldBuilding)==null?void 0:f.technologyLevel)||"",onChange:R=>t("technologyLevel",R.currentTarget.value)}),O.jsx(rt,{label:"",value:((h=n.worldBuilding)==null?void 0:h.magicSystem)||"",onChange:R=>t("magicSystem",R.currentTarget.value)}),O.jsx(it,{label:" (:  )",value:T1((m=n.worldBuilding)==null?void 0:m.keyLocations),onChange:R=>t("keyLocations",R.currentTarget.value),autosize:!0,minRows:2}),O.jsx(it,{label:" (:  )",value:T1((g=n.worldBuilding)==null?void 0:g.keyGroups),onChange:R=>t("keyGroups",R.currentTarget.value),autosize:!0,minRows:2}),O.jsx(rt,{label:"",value:((y=n.worldBuilding)==null?void 0:y.history)||"",onChange:R=>t("history",R.currentTarget.value)}),O.jsx(rt,{label:"",value:((w=n.worldBuilding)==null?void 0:w.rules)||"",onChange:R=>t("rules",R.currentTarget.value)})]})})]}),O.jsxs(dt.Item,{value:"settings-writingstyle",children:[O.jsx(dt.Control,{children:O.jsx(tr,{order:5,children:""})}),O.jsx(dt.Panel,{children:O.jsxs(za,{gap:"xs",mt:"xs",children:[" ",O.jsx(rt,{label:"",value:((v=n.writingStyle)==null?void 0:v.pov)||"",onChange:R=>r("pov",R.currentTarget.value)}),O.jsx(rt,{label:"",value:((x=n.writingStyle)==null?void 0:x.tense)||"",onChange:R=>r("tense",R.currentTarget.value)}),O.jsx(rt,{label:"",value:((E=n.writingStyle)==null?void 0:E.tone)||"",onChange:R=>r("tone",R.currentTarget.value)}),O.jsx(rt,{label:"",value:((k=n.writingStyle)==null?void 0:k.targetAudience)||"",onChange:R=>r("targetAudience",R.currentTarget.value)}),O.jsx(rt,{label:"",value:((S=n.writingStyle)==null?void 0:S.contentAdvisory)||"",onChange:R=>r("contentAdvisory",R.currentTarget.value)})]})})]})]})]})},N5=({config:n,onChange:e})=>O.jsx(dt,{defaultValue:"prompt-config",mb:"md",children:O.jsxs(dt.Item,{value:"prompt-config",children:[O.jsx(dt.Control,{children:""}),O.jsxs(dt.Panel,{children:[O.jsx(it,{label:"",value:n.persona,onChange:t=>e("persona",t.currentTarget.value),autosize:!0,minRows:2,mb:"xs"}),O.jsx(it,{label:"",value:n.goal,onChange:t=>e("goal",t.currentTarget.value),autosize:!0,minRows:3,mb:"xs"})]})]})});function j5(n,e){const t=structuredClone(n);return e.forEach(r=>{var s,a;switch(r.type){case"update_setting":t.settings[r.field]=r.value;break;case"update_world_building_field":{if(t.settings.worldBuilding||(t.settings.worldBuilding={}),(r.field==="keyLocations"||r.field==="keyGroups")&&typeof r.value=="string"){const o=r.value.split(`
`).map(u=>u.trim()).filter(u=>u.includes(":")).map(u=>{const c=u.split(":"),f=c[0].trim(),h=c.slice(1).join(":").trim();return{name:f,description:h}});t.settings.worldBuilding[r.field]=o}else t.settings.worldBuilding[r.field]=r.value;break}case"update_writing_style_field":{t.settings.writingStyle||(t.settings.writingStyle={}),t.settings.writingStyle[r.field]=r.value;break}case"update_character_field":{const o=t.characters[r.index];if(o)if(r.field==="age"){const u=Number(r.value);o[r.field]=isNaN(u)?r.value:u}else o[r.field]=r.value;break}case"add_character":t.characters.push(r.character);break;case"add_chapter":t.chapters.push(r.chapter);break;case"add_scene":{const o=t.chapters[r.chapterIndex];o&&o.scenes.push(r.scene);break}case"update_scene_content":{const o=(s=t.chapters[r.chapterIndex])==null?void 0:s.scenes[r.sceneIndex];o&&(o[r.field]=r.value);break}case"update_chapter_field":{const o=t.chapters[r.chapterIndex];o&&(o[r.field]=r.value);break}case"update_scene_field":{const o=(a=t.chapters[r.chapterIndex])==null?void 0:a.scenes[r.sceneIndex];o&&(r.field==="keyEvents"&&typeof r.value=="string"?o.keyEvents=r.value.split(`
`).filter(u=>u.trim()):o[r.field]=r.value);break}}}),t}function L5(n){const e=n.replace(/<think>[\s\S]*?<\/think>/,"").trim(),t=e.indexOf("{"),r=e.lastIndexOf("}");return t===-1||r===-1?null:e.slice(t,r+1)}const M5=le.enum(["theme","genre","era","stage","logline","concept"]).describe("Updatable setting fields"),D5=le.enum(["role","name","aliases","age","sex","appearance","personality","abilities","backstory","motivation","goal","relationships","flaws","strengths","belonging","inner_conflict_arc"]).describe("Updatable character attributes"),F5=le.enum(["content"]).describe("Updatable scene attributes"),U5=le.enum(["governance","socialStructure","economy","technologyLevel","magicSystem","keyLocations","keyGroups","history","rules"]).describe("Updatable world building fields"),z5=le.enum(["pov","tense","tone","targetAudience","contentAdvisory"]).describe("Updatable writing style fields"),B5=le.object({type:le.literal("update_setting").describe("Operation type: Update setting"),field:M5.describe("Name of the setting field to update"),value:le.string().describe("New value for the setting field")}).describe("Operation to update a novel setting field"),H5=le.object({type:le.literal("update_world_building_field").describe("Operation type: Update world building attribute"),field:U5.describe("Name of the world building attribute to update"),value:le.string().describe("New value for the world building attribute")}).describe("Operation to update a specific attribute of the world building"),V5=le.object({type:le.literal("update_writing_style_field").describe("Operation type: Update writing style attribute"),field:z5.describe("Name of the writing style attribute to update"),value:le.string().describe("New value for the writing style attribute")}).describe("Operation to update a specific attribute of the writing style"),W5=le.object({type:le.literal("update_character_field").describe("Operation type: Update character attribute"),index:le.number().int().describe("0-based index of the character to update"),field:D5.describe("Name of the character attribute to update"),value:le.string().describe("New value for the character attribute")}).describe("Operation to update a specific attribute of an existing character"),q5=le.object({id:le.number().int().describe("Unique identifier for the character"),role:le.string().describe("Role of the character in the story (e.g., , , )"),name:le.string().describe("Full name of the character"),aliases:le.string().optional().describe("Nicknames, titles, or other names the character goes by"),age:le.string().describe("Age of the character (can be a number or descriptive string like '')"),sex:le.string().optional().describe("Gender or sex of the character"),appearance:le.string().optional().describe("Physical appearance description"),personality:le.string().optional().describe("Personality traits and temperament"),abilities:le.string().optional().describe("Special skills, powers, or abilities"),backstory:le.string().optional().describe("Background history of the character"),motivation:le.string().optional().describe("What drives the character's actions"),goal:le.string().optional().describe("The character's primary objective or desire"),relationships:le.string().optional().describe("Description of relationships with other characters (free text)"),flaws:le.string().optional().describe("Weaknesses or negative traits"),strengths:le.string().optional().describe("Strengths or positive traits"),belonging:le.string().optional().describe("Group, organization, or place the character belongs to"),inner_conflict_arc:le.string().optional().describe("Description of the character's internal changes and development throughout the story")}).describe("Detailed information of the character"),Z5=le.object({type:le.literal("add_character").describe("Operation type: Add character"),character:q5.describe("Detailed information of the character to add")}).describe("Operation to add a new character to the novel"),Nk=le.object({id:le.number().int(),content:le.string(),settingNotes:le.string(),timeElapsed:le.string(),keyEvents:le.array(le.string()),characterNotes:le.string(),foreshadowing:le.string(),payoff:le.string()}),G5=le.object({id:le.number().int(),title:le.string(),summary:le.string(),goal:le.string(),scenes:le.array(Nk)}),J5=le.object({type:le.literal("add_chapter").describe("Operation type: Add chapter"),chapter:G5.describe("Detailed information of the chapter to add")}).describe("Operation to add a new chapter to the novel"),K5=le.object({type:le.literal("add_scene").describe("Operation type: Add scene"),chapterIndex:le.number().int().describe("0-based index of the chapter to add the scene to"),scene:Nk.describe("Detailed information of the scene to add")}).describe("Operation to add a new scene to an existing chapter"),X5=le.object({type:le.literal("update_scene_content").describe("Operation type: Update scene content"),chapterIndex:le.number().int().describe("0-based index of the chapter containing the scene to update"),sceneIndex:le.number().int().describe("0-based index of the scene to update"),field:F5.describe("Name of the scene attribute to update (currently only 'content')"),value:le.string().describe("New value for the scene content")}).describe("Operation to update the content of an existing scene"),Y5=le.object({type:le.literal("update_chapter_field"),chapterIndex:le.number().int(),field:le.enum(["id","title","summary","goal"]),value:le.string()}),Q5=le.object({type:le.literal("update_scene_field"),chapterIndex:le.number().int(),sceneIndex:le.number().int(),field:le.enum(["id","content","settingNotes","timeElapsed","keyEvents","characterNotes","foreshadowing","payoff"]),value:le.string()}),e6=le.discriminatedUnion("type",[B5,H5,V5,W5,Z5,J5,K5,X5,Y5,Q5]).describe("One of the possible operation objects to modify the novel state"),t6=le.object({reply:le.string().describe("Reply message to the user (in Japanese)"),operations:le.array(e6).describe("List of operations to execute (empty array if no changes)")}).describe("Overall structure of the JSON response generated by the agent"),n6={theme:"",genre:"",era:"",stage:"",logline:"",concept:"",worldBuilding:{},writingStyle:{}},jk=P.memo(({novel:n,systemPromptConfig:e,loading:t,fileInputRef:r,handleFileChange:s,handleExport:a,handleExportMarkdown:o,handleSystemPromptChange:u,handleSettingChange:c,handleWorldBuildingChange:f,handleWritingStyleChange:h,handleCharacterChange:m,handleChapterChange:g,handleSceneChange:y,handleClearSettings:w,handleClearCharacters:v,handleClearChapters:x})=>O.jsxs(_f,{shadow:"sm",p:"md",pr:"sm",radius:"md",withBorder:!0,w:"40%",children:[O.jsxs(mn,{justify:"space-between",align:"center",mb:"md",children:[O.jsx(tr,{order:3,children:""}),O.jsxs(mn,{align:"center",gap:"xs",wrap:"wrap",children:[" ",O.jsx(DN,{ref:r,onChange:s,accept:"application/json",style:{display:"none"}}),O.jsx(Pr,{variant:"outline",size:"xs",onClick:()=>{var E;return(E=r.current)==null?void 0:E.click()},disabled:t,children:"Import"}),O.jsx(Pr,{variant:"outline",size:"xs",onClick:a,disabled:t,children:"Export"}),O.jsx(Pr,{variant:"outline",size:"xs",onClick:o,disabled:t,children:"Markdown"})]})]}),O.jsxs(si,{h:"calc(100vh - 120px)",offsetScrollbars:!0,children:[" ",O.jsx(N5,{config:e,onChange:u}),O.jsx(I5,{settings:n.settings,onChange:c,onWorldBuildingChange:f,onWritingStyleChange:h,handleClearSettings:w,loading:t}),O.jsx($5,{characters:n.characters,onChange:m,handleClearCharacters:v,loading:t}),O.jsx(A5,{chapters:n.chapters,onChapterChange:g,onSceneChange:y,handleClearChapters:x,loading:t})]})]}));jk.displayName="ProjectPanel";const r6={persona:"",goal:""},s6=()=>{const[n,e]=P.useState(()=>localStorage.getItem("apiProvider")==="openai"?"openai":"ollama"),[t,r]=P.useState(()=>localStorage.getItem("openaiModelName")||"gpt-4o"),[s,a]=P.useState(()=>localStorage.getItem("selectedModel")||""),[o,u]=P.useState([]),[c,f]=P.useState({settings:{theme:"AI",genre:"SF",era:"2093",stage:"",worldBuilding:{rules:"AIAI"}},characters:[{id:1,role:"",name:" ",age:24,sex:"",appearance:"",personality:"",abilities:""},{id:2,role:"",name:" No.107",age:20,sex:"",appearance:"",personality:"",abilities:""}],chapters:[]}),[h,m]=P.useState(r6),[g,y]=P.useState(""),[w,v]=P.useState([]),[x,E]=P.useState(""),[k,S]=P.useState(!1),[R,A]=P.useState(!1),I=P.useRef(null);P.useEffect(()=>{(async()=>{if(n!=="ollama"){v([]),a(""),A(!1);return}A(!0),v([]),a("");try{const oe=await fetch("http://localhost:11434/api/tags");if(!oe.ok)console.warn(`Ollama fetch failed: ${oe.status}`),v([]),a("");else{const ge=(await oe.json()).models.map(_e=>_e.name);v(ge),ge.length>0?a(ge[0]):(console.warn("No Ollama models found."),a(""))}}catch(oe){console.error("Failed to fetch Ollama models:",oe),v([]),a("")}finally{A(!1)}})()},[n]),P.useEffect(()=>{localStorage.setItem("apiProvider",n)},[n]),P.useEffect(()=>{localStorage.setItem("selectedModel",s)},[s]),P.useEffect(()=>{localStorage.setItem("openaiModelName",t)},[t]);const M=P.useCallback((Y,oe)=>{f(ue=>({...ue,settings:{...ue.settings,[Y]:oe}}))},[]),D=P.useCallback((Y,oe)=>{f(ue=>{let ge=oe;return(Y==="keyLocations"||Y==="keyGroups")&&(ge=oe.split(`
`).map(_e=>_e.trim()).filter(_e=>_e.includes(":")).map(_e=>{const Ie=_e.split(":"),Nt=Ie[0].trim(),Bt=Ie.slice(1).join(":").trim();return{name:Nt,description:Bt}})),{...ue,settings:{...ue.settings,worldBuilding:{...ue.settings.worldBuilding||{},[Y]:ge}}}})},[]),K=P.useCallback((Y,oe)=>{f(ue=>({...ue,settings:{...ue.settings,writingStyle:{...ue.settings.writingStyle||{},[Y]:oe}}}))},[]),X=P.useCallback((Y,oe)=>{m(ue=>({...ue,[Y]:oe}))},[]),ae=P.useCallback((Y,oe,ue)=>{f(ge=>{const _e=[...ge.characters];return _e[Y]&&(_e[Y][oe]=ue),{...ge,characters:_e}})},[]),he=P.useCallback((Y,oe,ue)=>{f(ge=>{const _e=[...ge.chapters];return _e[Y]&&(_e[Y][oe]=ue),{...ge,chapters:_e}})},[]),ce=P.useCallback((Y,oe,ue,ge)=>{f(_e=>{const Ie=[..._e.chapters],Nt=Ie[Y];return Nt&&Nt.scenes[oe]&&(Nt.scenes[oe][ue]=ge),{..._e,chapters:Ie}})},[]),W=P.useCallback(()=>{window.confirm(" ")&&f(Y=>({...Y,settings:n6}))},[]),G=P.useCallback(()=>{window.confirm(" ")&&f(Y=>({...Y,characters:[]}))},[]),q=P.useCallback(()=>{window.confirm(" ")&&f(Y=>({...Y,chapters:[]}))},[]),J=P.useCallback(()=>{const oe=JSON.stringify({promptConfig:h,novel:c},null,2),ue=new Blob([oe],{type:"application/json"}),ge=URL.createObjectURL(ue),_e=document.createElement("a");_e.href=ge,_e.download="novel-project.json",document.body.appendChild(_e),_e.click(),document.body.removeChild(_e),URL.revokeObjectURL(ge)},[c,h]),j=P.useCallback(()=>{const Y=c.chapters.map(_e=>`# Chapter ${_e.id}: ${_e.title}

`+_e.scenes.map(Ie=>`## Scene ${Ie.id}

${Ie.content}`).join(`

`)).join(`

`),oe=new Blob([Y],{type:"text/markdown"}),ue=URL.createObjectURL(oe),ge=document.createElement("a");ge.href=ue,ge.download="novel.md",document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),URL.revokeObjectURL(ue)},[c]),B=P.useCallback(Y=>{if(!Y)return;const oe=new FileReader;oe.onload=ue=>{var ge;try{const _e=(ge=ue.target)==null?void 0:ge.result,Ie=JSON.parse(_e);if(Ie&&typeof Ie=="object"&&"promptConfig"in Ie&&"novel"in Ie&&"settings"in Ie.novel&&"characters"in Ie.novel&&"chapters"in Ie.novel&&typeof Ie.promptConfig.persona=="string"&&typeof Ie.promptConfig.goal=="string")m(Ie.promptConfig),f(Ie.novel),u([]),alert("");else throw new Error("Invalid or unrecognized project file structure.")}catch(_e){console.error("Failed to import project:",_e),alert(`
Error: ${_e instanceof Error?_e.message:String(_e)}`)}},oe.onerror=ue=>{console.error("Error reading file:",ue),alert("")},oe.readAsText(Y)},[]),V=P.useCallback(async()=>{var Bt;const Y=x.trim();let oe=null;if(n==="ollama"){if(!s){alert("Ollama");return}oe=new JS({model:s})}else if(n==="openai"){if(!g){alert("OpenAI API");return}if(!t.trim()){alert("OpenAI");return}oe=new O1({apiKey:g,modelName:t.trim()})}if(!Y||!oe)return;u(Qe=>[...Qe,{role:"user",content:Y}]),E(""),S(!0);const{persona:ue,goal:ge}=h,_e=`${ue}

# Goal
${ge}

# Output Format
 JSON 
\`\`\`json
{
  "reply": "operations",
  "operations": [ /*  [] */ ]
}
\`\`\`

# Permitted operation objects
- update_setting: { "type": "update_setting", "field": "theme|genre|era|stage|logline|concept", "value": "..." }
- update_world_building_field: { "type": "update_world_building_field", "field": "governance|socialStructure|economy|technologyLevel|magicSystem|keyLocations|keyGroups|history|rules", "value": "..." }
- update_writing_style_field: { "type": "update_writing_style_field", "field": "pov|tense|tone|targetAudience|contentAdvisory", "value": "..." } // Add definition for writing style
- update_character_field: { "type": "update_character_field", "index": 0-based, "field": "role|name|aliases|age|sex|appearance|personality|abilities|backstory|motivation|goal|relationships|flaws|strengths|belonging|inner_conflict_arc", "value": "..." } // Add inner_conflict_arc here
- add_character: { "type": "add_character", "character": { "id": number, "role": string, "name": string, "age": string, "sex": string, "appearance": string, "personality": string, "abilities": string, "backstory": string, "motivation": string, "goal": string, "relationships": string, "flaws": string, "strengths": string, "belonging": string } }
- add_chapter: { "type": "add_chapter", "chapter": { "id": number, "title": string, "scenes": { "id": number, "content": string }[] }
- add_scene: { "type": "add_scene", "chapterIndex": 0-based, "scene": { "id": number, "content": string } }

# Strict rules
- JSON 
- "reply"  \\n 
- <think></think>  JSON 
- **"operations"  # Permitted operation objects  type  type **
- **XYZ1JSON \`index\`  \`chapterIndex\`, \`sceneIndex\` 013\`chapterIndex\`  \`0\`\`sceneIndex\`  \`2\` **
- **For "keyLocations" and "keyGroups", the "value" must be a string with each item on a new line, formatted as "Name: Description". Example: "1: 1\\n2: 2"**`,Ie=[new Hg(_e)];o.slice(-8).forEach(Qe=>{Qe.role==="user"?Ie.push(new no(Qe.content)):Ie.push(new Ka(Qe.content))}),Ie.push(new no(`${Y}

# 
${JSON.stringify(c,null,2)}`));try{let Qe;if(n==="openai"&&oe instanceof O1)Qe=await oe.withStructuredOutput(t6).invoke(Ie);else if(n==="ollama"&&oe instanceof JS){let Ct="";for await(const st of await oe.stream(Ie))Ct+=st.content;const ot=L5(Ct);if(!ot)throw new Error("JSON payload not found in Ollama response");Qe=JSON.parse(ot)}else throw new Error("Invalid API provider or model instance.");(Bt=Qe.operations)!=null&&Bt.length&&f(Ct=>j5(Ct,Qe.operations)),u(Ct=>[...Ct,{role:"assistant",content:Qe.reply}])}catch(Qe){console.error(Qe);const Ct=Qe instanceof Error?Qe.message:"Unknown error occurred";Qe instanceof le.ZodError?u(ot=>[...ot,{role:"assistant",content:` :
${Qe.errors.map(st=>`${st.path.join(".")} - ${st.message}`).join(`
`)}`}]):u(ot=>[...ot,{role:"assistant",content:` : ${Ct}`}])}finally{S(!1)}},[x,o,c,h,n,s,g,t]),$=P.useCallback(Y=>{const oe=!k&&x.trim()&&(n==="ollama"?!!s:!!g&&!!t.trim());(Y.ctrlKey||Y.metaKey)&&Y.key==="Enter"&&oe&&(Y.preventDefault(),V())},[V,k,x,n,s,g,t]),U=(Y,oe)=>O.jsx(mn,{align:Y.role==="user"?"flex-end":"flex-start",bg:Y.role==="user"?"blue.6":"gray.7",c:"white",children:O.jsx(t_,{size:"sm",children:Y.content})},oe),re=k||!x.trim()||n==="ollama"&&(!s||R)||n==="openai"&&(!g||!t),pe=k||n==="ollama"&&(!s||R)||n==="openai"&&(!g||!t),de=n==="ollama"?R?"Ollama...":s?"...":"Ollama":g?t?"...":"OpenAI":"OpenAI API";return O.jsxs(mn,{direction:"row",gap:"md",p:"md",w:"100%",h:"100vh",bg:"dark.8",children:[O.jsxs(mn,{direction:"column",w:"60%",h:"100%",children:[O.jsxs(mn,{justify:"space-between",align:"center",mb:"xs",gap:"xs",children:[O.jsx(tr,{order:2,c:"gray.2",children:"Novel Agent"}),O.jsxs(mn,{gap:"md",children:[O.jsx(Il,{data:[{value:"ollama",label:"Ollama"},{value:"openai",label:"OpenAI"}],value:n,onChange:Y=>e(Y),disabled:k,allowDeselect:!1,w:120}),n==="ollama"?O.jsx(Il,{placeholder:R?"Loading models...":"Choose Ollama model",data:w,value:s,onChange:Y=>a(Y||""),disabled:k||R||w.length===0,allowDeselect:!1,w:200,searchable:!0}):O.jsx(Il,{placeholder:"Choose OpenAI model",data:["gpt-4o","gpt-4.1","o4-mini"],value:t,onChange:Y=>r(Y||""),disabled:k,allowDeselect:!1,w:200})]})]}),n==="openai"&&O.jsx(g_,{placeholder:"Enter OpenAI API Key",value:g,onChange:Y=>y(Y.currentTarget.value),disabled:k,mb:"xs"}),O.jsx(si,{style:{flex:1},offsetScrollbars:!0,children:O.jsxs(mn,{direction:"column",gap:"xs",p:"xs",children:[o.map(U),k&&O.jsx(mn,{align:"flex-start",children:O.jsx(Ga,{size:"sm"})})]})}),O.jsxs(mn,{mt:"xs",gap:"xs",children:[O.jsx(it,{placeholder:de,value:x,onChange:Y=>E(Y.currentTarget.value),onKeyDown:$,autosize:!0,minRows:1,maxRows:4,style:{flex:1},disabled:pe}),O.jsx(Pr,{onClick:V,disabled:re,w:100,children:k?O.jsx(Ga,{color:"white",size:"sm"}):""})]})]}),O.jsx(jk,{novel:c,systemPromptConfig:h,loading:k,fileInputRef:I,handleFileChange:B,handleExport:J,handleExportMarkdown:j,handleSystemPromptChange:X,handleSettingChange:M,handleWorldBuildingChange:D,handleWritingStyleChange:K,handleCharacterChange:ae,handleChapterChange:he,handleSceneChange:ce,handleClearSettings:W,handleClearCharacters:G,handleClearChapters:q})]})};function a6(){return O.jsx(RL,{children:O.jsx(sL,{children:O.jsx(bC,{path:"/novel-agent/",element:O.jsx(s6,{})})})})}function i6(){return O.jsx(J1,{defaultColorScheme:"dark",children:O.jsx(a6,{})})}zO.createRoot(document.getElementById("root")).render(O.jsx(P.StrictMode,{children:O.jsx(i6,{})}));
